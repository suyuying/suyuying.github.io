"use strict";(self.webpackChunkwebsitev_1=self.webpackChunkwebsitev_1||[]).push([[1477],{10:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"/2023/03/11/github-action/1.github-action-demo","metadata":{"permalink":"/blog/2023/03/11/github-action/1.github-action-demo","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-11-github-action/1.github-action-demo.md","source":"@site/blog/2023-03-11-github-action/1.github-action-demo.md","title":"github action basic demo","description":"use github action to demo how to use","date":"2023-03-11T00:00:00.000Z","formattedDate":"March 11, 2023","tags":[{"label":"github action","permalink":"/blog/tags/github-action"},{"label":"CICD","permalink":"/blog/tags/cicd"}],"readingTime":7.54,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"github action basic demo","description":"use github action to demo how to use","authors":"suyuying","tags":["github action","CICD"]},"nextItem":{"title":"learn github action from github docs","permalink":"/blog/2023/03/11/github-action/2.githubaction-learing"}},"content":"## \u57fa\u672c\u4ecb\u7d39\\n\\nGitHub Action \u662f continuous integration and continuous delivery (CI/CD)\u5e73\u53f0\uff0c\\n\u9664\u4e86\u4e00\u822c\u7684 build test deploy \u4ed6\u53e6\u5916\u6709\u7d66\u5c08\u6848\u7ba1\u7406\u7684\u5404\u7a2e\u5c0f\u529f\u80fd\uff0c\u4f8b\u5982\u7d66 pull request \u6253\u6a19\u7c64\u3002\\n\u63d0\u4f9b\u514d\u8cbb\u7684 runner \u5e6b\u4f60\u57f7\u884c\u4efb\u52d9\uff0c\u4e5f\u63a5\u53d7 self-hosted runner\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n## GitHub Actions \u57fa\u672c\u5143\u7d20\\n\\n```\\nWorkflow-> Event -> Job-> Steps\\n```\\n\\n### Workflow\\n\\n\u4e00\u500b repository \u53ef\u4ee5\u6709\u591a\u500b workflow,\u6bcf\u500b workflow \u505a\u7684\u4e8b\u5b9a\u7fa9\u5728 yml\uff0c\u4e14\u898f\u5b9a\u5728.github/workflows \u5e95\u4e0b\uff0cworkflow \u5305\u542b\u4e00\u6b21\u8981\u904b\u884c\u7684\u6574\u500b\u904e\u7a0b\uff0c\u53ef\u4ee5\u7528\u624b\u52d5\u89f8\u767c\u6216\u8005 yml \u6a94\u5167\u5236\u5b9a\u689d\u4ef6\u89f8\u767c\u3002\\n\u8209\u4f8b\uff1a\u53ef\u4ee5\u7528\u4e00\u689d workflow \u505a build and test,\u53e6\u4e00\u500b workflow \u505a deploy\\n\\n### Events\\n\\n\u89f8\u767c Workflow \u7684\u4e8b\u4ef6\u7a31\u70ba Events\u3002\\n\\n### Jobs\\n\\n\u7531\u591a\u500b steps \u7d44\u6210\uff0c\u6bcf\u500b step \u53ef\u4ee5\u662f\u4e00\u500b shell script \u6216\u8005 action\uff0cstep \u6703\u4f9d\u5e8f\u5728\u540c\u4e00\u500b runner \u57f7\u884c\uff0c\u4e26\u53ef\u4ee5\u5171\u4eab data\uff0c\\n\u8209\u4f8b\u4f86\u8aaa\uff0cbuild \u5b8c\u5f8c\u7684\u6a94\u6848\uff0c\u53ef\u4ee5\u50b3\u7d66\u4e0b\u4e00\u500b test step \u6e2c\u8a66 build \u7d50\u679c\u3002\\n\\n\u4e00\u500b workflow \u53ef\u4ee5\u6709\u591a\u500b job,job \u9593\u5f7c\u6b64\u9810\u8a2d\u662f\u5e73\u884c\u57f7\u884c\uff0c\u4e5f\u53ef\u4ee5\u8a2d\u5b9a dependencies \u7b49\u5f85\u53e6\u4e00\u500b job\uff0c\\n\u8209\u4f8b\u4f86\u8aaa\uff0c\u4e00\u5305 code \u88e1\u9762\u8981 build \u591a\u500b\u6a94\u6848\uff0c\u6bcf\u500b build \u904e\u7a0b\u53ef\u4ee5\u662f\u4e00\u500b job \u5f7c\u6b64\u5e73\u884c\uff0c\u7b49\u5230\u90fd build \u7d50\u675f\uff0c\u5728\u57f7\u884c\u7d71\u4e00\u5230 packaging \u5de5\u4f5c\u3002\\n\\n### Actions\\n\\n\u52d5\u4f5c\u662f\u57f7\u884c\u8907\u96dc\u4f46\u7d93\u5e38\u91cd\u8907\u4efb\u52d9\uff0c GitHub Action \u5e73\u53f0\u63d0\u4f9b\u81ea\u5b9a\u7fa9\u61c9\u7528\u7a0b\u5e8f\u7684\u4e0a\u50b3\uff0c\u7c21\u55ae\u8aaa\u5c31\u662f\u628a\u67d0\u4e9b\u6703\u91cd\u8907\u51fa\u73fe\u7684 step \u505a\u6210 module \u4e26\u4f7f\u7528\uff0c\u56e0\u70ba\u9019\u683c\u539f\u56e0\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u5f15\u7528\u5225\u4eba\u5beb\u597d\u5f97\uff0c\u6216\u81ea\u5efa\u5f97\uff0c\u5c31\u50cf\u662f\u5beb\u7a0b\u5f0f\u7528\u7684 package \u4e00\u6a23\u3002\\n\\n[\u5b98\u65b9\u7684 action \u5eab](https://github.com/marketplace?category=chat&type=actions&query=)\\n\\n[\u5982\u4f55\u5efa\u7acb\u81ea\u5df1\u7684 github action \u7684 actions](https://docs.github.com/zh/actions/creating-actions/about-custom-actions)\\n\\n### Runners\\n\\n\u57f7\u884c workflow \u7684\u6a5f\u5668\u3002\\n\\n## Demo\\n\\n### demo github actions\\n\\n```\\nname: learn-github-actions\\nrun-name: ${{ github.actor }} is learning GitHub Actions\\non: [push]\\njobs:\\n  check-bats-version:\\n    runs-on: ubuntu-latest\\n    steps:\\n      - uses: actions/checkout@v3\\n      - uses: actions/setup-node@v3\\n        with:\\n          node-version: \'14\'\\n      - run: npm install -g bats\\n      - run: bats -v\\n```\\n\\n`name`: All wolkflows \u96a8\u4fbf\u6311\u4e00\u500b\u9ede\u9032\u53bb\u770b\u5230\u5230 workflow \u540d\u5b57\uff0c\u5de5\u4f5c\u6d41\u7a0b\u7684\u540d\u7a31 learn-github-actions\\n\\n`run-name`: github \u9ede\u9032\u53bb Actions \u88e1\u9762\u770b\u5230 All wolkflows \u773e\u591a\u7684\u540d\u7a31\uff0c\u70ba\u5de5\u4f5c\u6d41\u7a0b\u904b\u884c\u6642\u7684\u540d\u7a31\uff0c${{ github.actor }} \u5167\u5efa\u8b8a\u6578\u3002\\n\\n`on`:\u6b64 workflow \u7684\u89f8\u767c\u689d\u4ef6\uff0c\u8a2d\u5b9a push \u662f\u63a8\u9001\u6216\u8005\u767c pull request \u5c31\u6703\u89f8\u767c\uff0c\u9032\u968e\u7248\u8acb\u6d3d\u5b98\u7db2\u63d0\u4f9b\u7684\\n[\u66f4\u7cbe\u7d30\u8a2d\u5b9a](https://docs.github.com/zh/actions/using-workflows/workflow-syntax-for-github-actions#onpushpull_requestpull_request_targetpathspaths-ignore)\\n\\n`jobs`:\u7d44\u5408\u591a\u500b work or action\uff0c\u76ee\u524d\u6709\u4e00\u683c\u4f5c\u696d\u53eb\u505a check-bats-version \u7684 work\\n\\n`check-bats-version`: \u4e00\u500b\u540d\u7232 check-bats-version \u7684\u4f5c\u696d\uff0c\u5b50\u9375\u5b9a\u7fa9\u4f5c\u696d\u5c6c\u6027\uff0c\u53ef\u4ee5\u63db\u6210\u5176\u4ed6\u7b26\u5408\u8a72 work \u5de5\u4f5c\u7684\u540d\u5b57\uff0c\u547d\u540d\u98a8\u683c\u662f-\u76f8\u9023\\n\\n`runs-on`: \u4f7f\u7528 github \u8a17\u7ba1\u7684 runner\uff0c\u4f5c\u696d\u904b\u884c\u7684\u64cd\u4f5c\u7cfb\u7d71\uff0c\u7232 ubuntu-latest\u3002\\n\\n`steps`: \u5b9a\u7fa9\u4f5c\u696d\u57f7\u884c\u6b65\u9a5f\uff0c\u53ef\u4ee5\u5305\u542b\u591a\u500b \u6307\u4ee4\u3001shell script\u3001action\uff08\u4e00\u5806\u6307\u4ee4\u7d44\u5408\u7684 module\uff09\\n\\n`uses`: \u904b\u4f5c\u67d0\u5ba2\u88fd\u5316 action\uff0caction \u5c31\u662f\u500b\u6307\u4ee4\u96c6\u5408\\n\\n- `actions/checkout@v3`\uff1a\u4f7f\u7528 v3 \u7248\u672c\u7684 `actions/checkout` Action\uff0c\u5f9e\u4ee3\u78bc\u5eab\u4e2d\u6aa2\u51fa\u4ee3\u78bc\u3002\\n- `actions/setup-node@v3`\uff1a\u4f7f\u7528 v3 \u7248\u672c\u7684 `actions/setup-node` Action\uff0c\u5b89\u88dd Node.js \u74b0\u5883\u3002\\n  with: \u5e36\u53c3\u6578\u5230 action \u88e1\u9762\\n\\n`run`: \u5728 runner \u4e0a\u904b\u884c\u7684\u6307\u4ee4\\n\\n- `run: npm install -g bats`\uff1a\u904b\u884c\u547d\u4ee4 `npm install -g bats`\uff0c\u5b89\u88dd Bats \u6e2c\u8a66\u6846\u67b6\u3002\\n- `run: bats -v`\uff1a\u904b\u884c\u547d\u4ee4 `bats -v`\uff0c\u986f\u793a Bats \u7684\u7248\u672c\u865f\u3002\\n\\n`name`: \u5b9a\u7fa9\u8a72 run \u7684\u540d\u5b57\uff0c\u4e0d\u5b9a\u7fa9\u5c31\u53ea\u7528 Run + \u5f8c\u9762\u57f7\u884c run \u5f97\u6307\u4ee4\\n\\n### \u88dc\u5145 actions \u5beb\u6cd5\\n\\nactions/checkout@v3 \u662f GitHub Action \u4e2d\u4e00\u500b\u5e38\u7528\u7684 action\uff0c\u7528\u65bc\u5c07\u7a0b\u5f0f\u78bc\u5009\u5eab\u7684\u7a0b\u5f0f\u78bc\u6aa2\u51fa\u5230\u5de5\u4f5c\u5340\u3002v3 \u662f\u9019\u500b action \u7684\u7248\u672c\u865f\u3002\u9019\u500b action \u7684\u4ee3\u78bc\u5009\u5eab\u4e2d\uff0c\u6709\u4e00\u500b action.yml \u6587\u4ef6\uff0c\u5b9a\u7fa9\u4e86\u9019\u500b action \u7684\u8f38\u5165\u548c\u8f38\u51fa\u53c3\u6578\u3002\u5177\u9ad4\u5982\u4e0b\uff1a\\n\\n```jsx title=\\"actions/checkout@v3\\"\\nname: \'Checkout\'\\ndescription: \'Checkout a Git repository\'\\ninputs:\\n  ref:\\n    description: \'The branch, tag or SHA to checkout\'\\n  repository:\\n    description: \'The name of the repository to checkout\'\\n    required: false\\n    default: ${{ github.repository }}\\n  submodules:\\n    description: \'Whether to checkout submodules\'\\n    required: false\\n    default: \'false\'\\n  ssh-key:\\n    description: \'SSH key used for fetching the repository. The key should have access to the repository or be able to authenticate for the repository URL.\'\\n    required: false\\n  persist-credentials:\\n    description: \'Whether to persist GITHUB_TOKEN and SSH_AUTH_SOCK environment variables when persisting the workspace\'\\n    required: false\\n    default: \'true\'\\n  fetch-depth:\\n    description: \'Depth of commits to fetch. Defaults to all commits.\'\\n    required: false\\n    default: \'0\'\\n  lfs:\\n    description: \'Whether to download Git LFS files\'\\n    required: false\\n    default: \'false\'\\n  clean:\\n    description: \\"Whether to run \'git clean\' before checkout\\"\\n    required: false\\n    default: \'false\'\\n  workspace:\\n    description: \'Directory to which checkout the repository\'\\n    required: false\\n    default: \'.\'\\noutputs:\\n  path:\\n    description: \'The path of the checked-out repository\'\\n    value: ${{ steps.checkout.outputs.path }}\\nruns:\\n  using: \'composite\'\\n  steps:\\n    - name: Checkout\\n      shell: bash\\n      run: echo \\"Error: No checkout implementation found.\\"\\n\\n```\\n\\n\u9019\u500b\u6587\u4ef6\u4e2d\uff0c\u5b9a\u7fa9\u4e86\u9019\u500b action \u7684\u8f38\u5165\u53c3\u6578\u5305\u62ec ref\u3001repository\u3001submodules\u3001ssh-key\u3001persist-credentials\u3001fetch-depth\u3001lfs\u3001clean \u548c workspace\u3002\\nGitHub Action `actions/checkout@v3` \u4e0b\u9762\u662f\u5b83\u7684\u8f38\u5165\u53c3\u6578\u5b9a\u7fa9\uff1a\\n<highlight color=\\"#25c2a0\\">actions/checkout@v3 \u53c3\u6578\u7bc7</highlight>\\n\\n- `ref`\uff1a\u8981\u6aa2\u51fa\u7684\u5206\u652f\u3001\u6a19\u7c64\u6216\u63d0\u4ea4 ID\u3002\\n- `repository`\uff1a\u8981\u6aa2\u51fa\u7684\u5132\u5b58\u5eab\u540d\u7a31\u3002\\n- `submodules`\uff1a\u662f\u5426\u6aa2\u51fa\u5b50\u6a21\u7d44\u3002\\n- `ssh-key`\uff1a\u7528\u65bc\u5f9e\u5132\u5b58\u5eab\u7372\u53d6\u7a0b\u5f0f\u78bc\u7684 SSH \u91d1\u9470\u3002\\n- `persist-credentials`\uff1a\u662f\u5426\u5728\u6301\u4e45\u5316\u5de5\u4f5c\u5340\u6642\u4fdd\u5b58 GITHUB_TOKEN \u548c SSH_AUTH_SOCK \u74b0\u5883\u8b8a\u6578\u3002\\n- `fetch-depth`\uff1a\u8981\u6aa2\u51fa\u7684\u63d0\u4ea4\u6578\u91cf\u3002\\n- `lfs`\uff1a\u662f\u5426\u4e0b\u8f09 Git LFS \u6587\u4ef6\u3002\\n- `clean`\uff1a\u662f\u5426\u5728\u6aa2\u51fa\u524d\u904b\u884c `git clean`\u3002\\n- `workspace`\uff1a\u6aa2\u51fa\u7684\u5132\u5b58\u5eab\u7684\u76ee\u9304\u3002\\n\\n\u5176\u4e2d\uff0cref \u662f\u5fc5\u9700\u7684\u53c3\u6578\uff0c\u5176\u4ed6\u53c3\u6578\u5747\u70ba\u53ef\u9078\u53c3\u6578\u3002\\n\\n\u8f38\u51fa\u53c3\u6578\u53ea\u6709\u4e00\u500b\uff0c\u5373 path\uff0c\u8868\u793a\u7a0b\u5f0f\u78bc\u5009\u5eab\u7684\u8def\u5f91\u3002\\n\\n\u6700\u5f8c\uff0c\u9019\u500b action \u5728\u904b\u884c\u6642\uff0c\u6703\u57f7\u884c\u4e00\u500b\u540d\u7232 Checkout \u7684\u5b50\u6b65\u9a5f\uff0c\u8a72\u5b50\u6b65\u9a5f\u6703\u8abf\u7528\u4e0d\u540c\u5e73\u81fa\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5c07\u7a0b\u5f0f\u78bc\u5009\u5eab\u6aa2\u51fa\u5230\u6307\u5b9a\u7684\u5de5\u4f5c\u5340\u3002\\n\\n<highlight color=\\"#1877F2\\"> actions/setup-node@v3 \u53c3\u6578\u7bc7</highlight>\\n\\n- `node-version`\uff1a\u8981\u5b89\u88dd\u7684 Node.js \u7248\u672c\uff0c\u9ed8\u8a8d\u662f\u6700\u65b0\u7684\u7a69\u5b9a\u7248\u3002\\n- `registry-url`\uff1aNode.js \u7684\u5305\u7ba1\u7406\u5668\u4f7f\u7528\u7684\u9810\u8a2d\u5009\u5eab\u5730\u5740\uff0c\u9ed8\u8a8d\u662f npm \u7684\u5b98\u65b9\u5730\u5740\u3002\\n- `scope`\uff1aNode.js \u7684\u5305\u7ba1\u7406\u5668\u4f7f\u7528\u7684\u9810\u8a2d\u4f5c\u7528\u57df\uff0c\u9ed8\u8a8d\u662f\u7a7a\u3002\\n- `token`\uff1a\u7528\u65bc\u8a2a\u554f\u79c1\u6709\u9805\u76ee\u7684 GitHub \u6b0a\u6756\uff0c\u9ed8\u8a8d\u662f\u7a7a\u3002\\n- `always-auth`\uff1a\u662f\u5426\u7e3d\u662f\u4f7f\u7528\u6388\u6b0a\u4fe1\u606f\u8a2a\u554f\u9805\u76ee\uff0c\u9ed8\u8a8d\u662f false\u3002\\n- `check-latest`\uff1a\u662f\u5426\u6aa2\u67e5\u662f\u5426\u5b89\u88dd\u4e86\u6700\u65b0\u7684\u7248\u672c\uff0c\u9ed8\u8a8d\u662f false\u3002\\n- `debug`\uff1a\u662f\u5426\u5553\u7528 Debug \u6a21\u5f0f\uff0c\u9ed8\u8a8d\u662f false\u3002\\n\\n\u7e3d\u7684\u4f86\u8aaa\uff0cactions/setup-node@v3 \u53ef\u4ee5\u65b9\u4fbf\u5730\u5b89\u88dd Node.js \u74b0\u5883\uff0c\u4e26\u652f\u6301\u8a31\u591a\u81ea\u5b9a\u7fa9\u53c3\u6578\uff0c\u7528\u6236\u53ef\u4ee5\u6839\u64da\u81ea\u5df1\u7684\u9700\u8981\u9032\u884c\u914d\u7f6e\u3002\\n\\n:::tip\\n\u5728 github action \u8981\u5e36\u5165\u53c3\u6578\u5230 actions \u88e1\u9762\u8acb\u4f7f\u7528 with\\n\\n```\\n    steps:\\n      - uses: actions/checkout@v3\\n      - uses: actions/setup-node@v3\\n        with:\\n          node-version: \'14\'\\n```\\n\\n:::\\n\\n:::info\\n\\n1.[\u5be6\u4f5c\u958b\u6e90\u5c0f\u5de5\u5177\uff0c\u8207 Github Actions \u7684\u7b2c\u4e00\u6b21\u76f8\u9047\uff01](https://medium.com/starbugs/%E5%AF%A6%E4%BD%9C%E9%96%8B%E6%BA%90%E5%B0%8F%E5%B7%A5%E5%85%B7-%E8%88%87-github-actions-%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%9B%B8%E9%81%87-3dd2d70eeb)\\n\\n2. [github action quick start \u5b98\u7db2](https://docs.github.com/en/actions/quickstart)\\n   :::"},{"id":"/2023/03/11/github-action/2.githubaction-learing","metadata":{"permalink":"/blog/2023/03/11/github-action/2.githubaction-learing","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-11-github-action/2.githubaction-learing.md","source":"@site/blog/2023-03-11-github-action/2.githubaction-learing.md","title":"learn github action from github docs","description":"github action\u5728\u8a2d\u8a08\u4e0a\u63d0\u4f9b\u8a31\u591a\u8868\u793a\u5f0f\uff0c\u8ddf\u5167\u5efa\u51fd\u793a\uff0c\u4e0a\u4e0b\u6587\uff0c\u9019\u908a\u5c07\u6574\u7406\u5b98\u7db2\u6559\u5b78\u77e5\u8b58\uff0c\u4ee5\u53ca\u4f7f\u7528\u5fc3\u5f97","date":"2023-03-11T00:00:00.000Z","formattedDate":"March 11, 2023","tags":[{"label":"github action","permalink":"/blog/tags/github-action"},{"label":"CICD","permalink":"/blog/tags/cicd"}],"readingTime":9.115,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"learn github action from github docs","description":"github action\u5728\u8a2d\u8a08\u4e0a\u63d0\u4f9b\u8a31\u591a\u8868\u793a\u5f0f\uff0c\u8ddf\u5167\u5efa\u51fd\u793a\uff0c\u4e0a\u4e0b\u6587\uff0c\u9019\u908a\u5c07\u6574\u7406\u5b98\u7db2\u6559\u5b78\u77e5\u8b58\uff0c\u4ee5\u53ca\u4f7f\u7528\u5fc3\u5f97","authors":"suyuying","tags":["github action","CICD"]},"prevItem":{"title":"github action basic demo","permalink":"/blog/2023/03/11/github-action/1.github-action-demo"},"nextItem":{"title":"use github action to build image and push to git hub container registry","permalink":"/blog/2023/03/11/github-action/githib-action-CI-to-github-container"}},"content":"## \u524d\u8a00\\n\\n\u4e00\u958b\u59cb\u662f\u8df3\u8457\u5b78\uff0c\u76f4\u63a5 google \u600e\u9ebc\u7528 github action \u505a\u5230 CI \u5efa\u7acb image \u4e26\u63a8\u5230 github container\uff0c\u4e0d\u904e\u9019\u95dc\u904e\u5b8c\u5f8c\uff0c\u5728 deploy \u5230 azure web container \u5c31\u5361\u95dc\u4e86\uff0c\u9019\u908a\u8cbc\u5361\u95dc\u7684[\u90e8\u5206](https://docs.github.com/en/actions/deployment/deploying-to-your-cloud-provider/deploying-to-azure/deploying-docker-to-azure-app-service)\\n\\n```\\n  deploy:\\n    runs-on: ubuntu-latest\\n\\n    needs: build\\n\\n    environment:\\n      name: \'production\'\\n      url: ${{ steps.deploy-to-webapp.outputs.webapp-url }}\\n\\n    steps:\\n      - name: Lowercase the repo name\\n        run: echo \\"REPO=${GITHUB_REPOSITORY,,}\\" >>${GITHUB_ENV}\\n\\n      - name: Deploy to Azure Web App\\n        id: deploy-to-webapp\\n        uses: azure/webapps-deploy@0b651ed7546ecfc75024011f76944cb9b381ef1e\\n        with:\\n          app-name: ${{ env.AZURE_WEBAPP_NAME }}\\n          publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}\\n          images: \'ghcr.io/${{ env.REPO }}:${{ github.sha }}\'\\n```\\n\\n\u5982\u679c\u6c92\u770b\u904e\u5b98\u7db2\u6559\u5b78\uff0c\u770b\u5230`${{ steps.deploy-to-webapp.outputs.webapp-url }}` `${{ env.AZURE_WEBAPP_NAME }}` `${{ github.sha }}` `${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}`\\n\u9019\u4e9b\u6771\u897f\u81ea\u7136\u6703\u50bb\u4f4f\uff0c\u7136\u5f8c\u56de\u53bb google\uff0c\u6703\u767c\u73fe\u5b98\u7db2\u7d66\u4e86\u4e00\u5927\u5806 context \u4ecb\u7d39\uff0c\u7c21\u8a00\u4e4b\uff0c\u9084\u662f\u8173\u8e0f\u5be6\u5730\u4f86\\n[Understanding GitHub Actions](https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions)\u5427\uff01\\n\\n## \u57fa\u672c\u529f\\n\\n[\u56de\u9867\u4e00\u4e0b github action basic demo](./1.github-action-demo)\uff0cgithub action \u662f\u7531 git \u6839\u76ee\u9304\u540c\u5c64\u7684\\n.github/workflows \u4e2d\u7684 xxxx.yml \u7d44\u6210\uff0cworkflow \u7684\u7d50\u69cb\u901a\u5e38\u662f\\n\\n```\\nEvent \u89f8\u767c -> Job -> steps\\n```\\n\\nEvent: \u63cf\u8ff0\u89f8\u767c\u8a72 pipline \u689d\u4ef6\\n\\nJob: \u5b9a\u7fa9 runner, \u74b0\u5883\u8b8a\u6578\u5f8c\uff0c\u5728\u9019\u500b\u689d\u4ef6\u4e0b\u57f7\u884c\u591a\u500b step \uff0c\u8209\u4f8b\uff1a \u7de8\u8b6f\u6a94\u6848 \u53ef\u4ee5\u7576\u4e00\u500b job\uff0c\u55ae\u5143\u6e2c\u8a66\u4e5f\u53ef\u4ee5\u7576\u4e00\u500b job\u3002 \u8981\u6ce8\u610f\u7684\u662f\uff0cjob \u9593\u662f\u5e73\u884c\u57f7\u884c\uff0c\u6240\u4ee5\u8981\u5728\u55ae\u5143\u6e2c\u8a66\u904e\u95dc\u5728\u57f7\u884c\u7de8\u8b6f\u7684\u8a71\uff0c\u8981\u984d\u5916\u5beb depends\u3002job \u9593\u53ef\u4ee5\u900f\u904e artifacts \u628a job \u7522\u51fa\u6a94\u6848\uff0c\u50b3\u7d66\u5225\u7684 job \u7528\u3002\\n\\nsteps: \u5b9a\u7fa9\u591a\u500b\u6307\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5225\u4eba\u63d0\u4f9b\u7684\u5957\u4ef6 actions\uff0c\u4e5f\u53ef\u4ee5\u662f\u67d0\u96bb shell script\\n\\n### Expressions\\n\\n\u5982\u679c\u4f60\u6709\u4e00\u500b job \u8981\u57f7\u884c\uff0c\u4f46\u60f3\u8a2d\u5b9a\u57f7\u884c\u524d\u63d0\u662f\u67d0\u500b\u74b0\u5883\u53c3\u6578 \u70ba true\uff0c\u8981\u600e\u9ebc\u57f7\u884c\uff1f\\n\u9019\u908a\u6709\u5e7e\u500b\u89c0\u5ff5\\n\\n1. \u74b0\u5883\u53c3\u6578:\\n\\n\u5728 github action \u6240\u6709\u7cfb\u7d71\u5167\u5efa\u8b8a\u6578\uff0c\u74b0\u5883\u8b8a\u6578\uff0c\u52a0\u5bc6\u7684\u8b8a\u6578\uff0c\u8a2d\u5b9a\u5728 configuration \u7684\u8b8a\u6578\u9019\u4e9b\u6771\u897f\u90fd\u88ab\u7576\u4f5c<highlight color=\\"blue\\">Contexts</highlight> \u7ba1\u7406\u3002\\n\\n2. \u8868\u9054\u5f0f\\n\\n\u7d50\u69cb\u90fd\u9577\u9019\u6a23`${{ <expression> }}`,\\n\\n\u652f\u63f4\u7684\u6578\u64da\u985e\u578b `boolen` `null` `number` `string`\uff0c\u5beb\u6cd5\u5982\u4e0b\\n\\n```\\nenv:\\n  myNull: ${{ null }}\\n  myBoolean: ${{ false }}\\n  myIntegerNumber: ${{ 711 }}\\n  myFloatNumber: ${{ -9.2 }}\\n  myHexNumber: ${{ 0xff }}\\n  myExponentialNumber: ${{ -2.99e-2 }}\\n  myString: Mona the Octocat\\n  myStringInBraces: ${{ \'It\'\'s open source!\' }}\\n```\\n\\n\u904b\u7b97\u5b50\u5982\u4e0b\\n\\n```\\n( )\\tLogical grouping\\n[ ]\\tIndex\\n.\\tProperty de-reference\\n!\\tNot\\n<\\tLess than\\n<=\\tLess than or equal\\n>\\tGreater than\\n>=\\tGreater than or equal\\n==\\tEqual\\n!=\\tNot equal\\n&&\\tAnd\\n||\\tOr\\n```\\n\\nif \u5224\u65b7\u5beb\u6cd5\\n\\n```\\n  prod-check:\\n    if: ${{ github.ref == \'refs/heads/main\' }}\\n    runs-on: ubuntu-latest\\n    steps:\\n```\\n\\n\u6b64\u5916 github action \u4e5f\u63d0\u4f9b\u5f88\u591a\u5167\u5efa function\uff0c\u4f8b\u5982\uff1a\\n\\n`contains( search, item )` \uff0c\u5982\u679c search \u542b\u6709 item\uff0c\u9019\u500b\u51fd\u6578\u5c07\u8fd4\u56de true\u3002\u5982\u679c search \u662f\u6578\u7d44\u4e2d\u3002\u5982\u679c item \u662f\u4e00\u500b search \u7684\u5143\u7d20\uff0c\u9019\u500b\u51fd\u6578\u5c07\u8fd4\u56de true\uff0c\u5982\u679c\u9805\u76ee\u662f\u641c\u7d22\u7684\u5b50\u5b57\u7b26\u4e32\u3002\u9019\u500b\u51fd\u6578\u4e0d\u5340\u5206\u5927\u5c0f\u5beb\u3002\u5b83\u5c07\u503c\u8f49\u63db\u70ba\u5b57\u7b26\u4e32\u9032\u884c\u6bd4\u8f03\u3002\\n\\ncontains(\'Hello world\', \'llo\') returns true.\\n\\ncontains(github.event.issue.labels.\\\\*.name, \'bug\') returns true if the issue related to the event has a label \\"bug\\".\\n\\n\u9084\u6709\u5f88\u591a\u5167\u5efa\u65b9\u6cd5\uff0c\u53ef\u4ee5[\u53c3\u8003\u5b98\u7db2](https://docs.github.com/en/actions/learn-github-actions/expressions)\\n\\n### Contexts\\n\\n\u4f60\u904b\u884c\u7684 workflow \u4e2d\u7684\u8cc7\u8a0a\uff0c\u53ef\u4ee5\u900f\u904e Contexts \u53d6\u7684\uff0c\u6bcf\u500b Context \u90fd\u662f\u4e00\u500b\u7269\u4ef6\uff0c\u5b83\u5e36\u6709\u7684\u5c6c\u6027\u53ef\u4ee5\u662f strings \u6216 \u7269\u4ef6\u3002\\n\\n\u8981\u4f7f\u7528 contexts \u9700\u8981\u6309\u7167\u9019\u500b\u683c\u5f0f`${{ <context> }}`\\n\\nContext \u7a2e\u985e\u8d85\u591a\uff0c\u9019\u908a\u6703\u5927\u81f4\u8b1b\u4ed6\u7684\u4f5c\u7528\\n\\n`github`- \u7576\u524d workflow \u7684 branch,\u89f8\u767c\u6a21\u5f0f\uff0crepo \u540d\u5b57\uff0cowner \u540d\u5b57\u7b49\u7b49\u3002\\n\\n`env` - \u5728 workflow or job or steps \u88e1\u9762\u8a2d\u5b9a\u5f97\u74b0\u5883\u8b8a\u6578\\n\\n`vars` - \u5728 repo \u6216 \u7d44\u7e54 \u6216 environment \u968e\u6bb5\uff0c\u8a2d\u5b9a\u5728 Variable \u7684 key value(\u5c31\u662f setting \u7684 variable \u76f8\u95dc\u6771\u897f)\\n\\n`job` - \u8ddf\u73fe\u5728\u6b63\u5728 run \u7684 job \u6709\u95dc\u4e8b\u9805\uff0c\u4f8b\u5982\u73fe\u5728\u8dd1\u7684 runner \u7684 id,\u8dd1\u6210\u529f\u6216\u5931\u6557\u3002\\n\\n`jobs` - \u50c5\u5728\u53ef\u91cd\u7528\u5de5\u4f5c\u6d41\u4e2d\u53ef\u7528\uff0c\u4e26\u4e14\u53ea\u80fd\u7528\u65bc\u8a2d\u7f6e\u53ef\u91cd\u7528\u5de5\u4f5c\u6d41\u7684\u8f38\u51fa\u3002\\n\\n`steps` - \u5b9a\u7fa9 steps \u968e\u6bb5\u8f38\u51fa\u7684\u6210\u54c1\uff0c\u4ee5\u53ca\u6b64 steps \u904b\u4f5c\u7d50\u679c\uff08\u6210\u529f \u5931\u6557 \u53d6\u6d88 \u8df3\u904e\uff09\\n\\n`runner` - Information about the runner that is running the current job\\n\\n`sercets` - \u5728 repo \u6216 \u7d44\u7e54 \u6216 environment \u968e\u6bb5\u8a2d\u5b9a\u5728 secrect \u7684 key value\\n\\n`strategy` - \u7b56\u7565\uff0c\u4e3b\u8981\u7528\u65bc\u5728 matrix \u77e9\u9663\u60c5\u6cc1\u74b0\u5883\u4e0b\u7684 job \u72c0\u614b\u63cf\u8ff0\\n\\n`matrix` - \u77e9\u9663\u8f38\u5165\uff0c\u5982\u679c\u4f60\u7684 job \u88e1\u9762\u7684\u6e2c\u8a66\u7cfb\u7d71\u8981\u6e2c\u8a66\u4f60\u7684 code \u5728 mac \u8ddf windows \u57f7\u884c\u90fd\u6c92\u554f\u984c\uff0c\u723e\u4e14\u4e5f\u8981\u78ba\u4fdd\u5728 node 14 \u8ddf node16 \u904b\u884c\u90fd\u6b63\u5e38\u3002\\n\\n```\\njobs:\\n  test:\\n    runs-on: ${{ matrix.os }}\\n    strategy:\\n      matrix:\\n        os: [ubuntu-latest, windows-latest]\\n        node: [14, 16]\\n```\\n\\n`needs`- \u7576\u524d\u4f5c\u696d\u7684\u4f9d\u8cf4\u9805\uff0c\u8981\u7528 id \u6307\u5b9a\\n\\n<details>\\n  <summary>needs demo</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n\\n```\\nname: Build and deploy\\non: push\\n\\njobs:\\n  build:\\n    runs-on: ubuntu-latest\\n    outputs:\\n      build_id: ${{ steps.build_step.outputs.build_id }}\\n    steps:\\n      - uses: actions/checkout@v3\\n      - name: Build\\n        id: build_step\\n        run: |\\n          ./build\\n          echo \\"build_id=$BUILD_ID\\" >> $GITHUB_OUTPUT\\n  deploy:\\n    needs: build\\n    runs-on: ubuntu-latest\\n    steps:\\n      - uses: actions/checkout@v3\\n      - run: ./deploy --build ${{ needs.build.outputs.build_id }}\\n  debug:\\n    needs: [build, deploy]\\n    runs-on: ubuntu-latest\\n    if: ${{ failure() }}\\n    steps:\\n      - uses: actions/checkout@v3\\n      - run: ./debug\\n```\\n\\n  </div>\\n</details>\\n\\n`inputs`- \u770b\u4e0d\u61c2\uff0c\u4e4b\u5f8c\u6709\u7528\u5230\u518d\u88dc\\n\\n### Variables\\n\\n\u57fa\u672c\u4e0a\u662f Contexts \u7684\u5ef6\u4f38\uff0c\u8b8a\u91cf\u4ee5\u662f\u5426\u8de8 workflow \u505a\u5340\u5206\u3002\\n\\n1. \u6c92\u6709\u8de8 workflow \u7684 Variable \u5b9a\u7fa9\u65b9\u6cd5\uff0c\u5728 workflow,job,step \u5b9a\u7fa9 key value\\n\\n<details>\\n  <summary>demo</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n\\n```\\nname: Greeting on variable day\\n\\non:\\n  workflow_dispatch\\n\\nenv:\\n  DAY_OF_WEEK: Monday\\n\\njobs:\\n  greeting_job:\\n    runs-on: ubuntu-latest\\n    env:\\n      Greeting: Hello\\n    steps:\\n      - name: \\"Say Hello Mona it\'s Monday\\"\\n        run: echo \\"$Greeting $First_Name. Today is $DAY_OF_WEEK!\\"\\n        env:\\n          First_Name: Mona\\n```\\n\\n  </div>\\n</details>\\n\\nrun: env\uff1a\u60a8\u53ef\u4ee5\u901a\u904e\u5728\u6b65\u9a5f\u4e2d\u4f7f\u7528\u7136\u5f8c\u6aa2\u67e5\u6b65\u9a5f\u7684\u8f38\u51fa\u4f86\u5217\u51fa\u53ef\u7528\u65bc\u5de5\u4f5c\u6d41\u6b65\u9a5f\u7684\u6574\u7d44\u74b0\u5883\u8b8a\u91cf\u3002\\n\\n2. \u8de8 workflow \u7684 variable \u5b9a\u7fa9\u65b9\u6cd5\\n\\n\u5728\u4e0a\u4e0b\u6587\u4e2d\u81ea\u52d5\u53ef\u7528 vars\uff0c\u4f7f\u7528\u65b9\u5f0f${{ vars.\uff38\uff38\uff38\uff38 }}\uff0c\u6709\u591a\u7a2e\u5b9a\u7fa9\u65b9\u5f0f\\n\u5b58\u5132\u5eab\u3001\u74b0\u5883\u5275\u5efa\u914d\u7f6e\u8b8a\u91cf\u3001\u7d44\u7e54\u5275\u5efa\u914d\u7f6e\u8b8a\u91cf\\n\\n<details>\\n  <summary>demo</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n\\n```\\non:\\n  workflow_dispatch:\\nenv:\\n  # Setting an environment variable with the value of a configuration variable\\n  env_var: ${{ vars.ENV_CONTEXT_VAR }}\\n\\njobs:\\n  display-variables:\\n    name: ${{ vars.JOB_NAME }}\\n    # You can use configuration variables with the `vars` context for dynamic jobs\\n    if: ${{ vars.USE_VARIABLES == \'true\' }}\\n    runs-on: ${{ vars.RUNNER }}\\n    environment: ${{ vars.ENVIRONMENT_STAGE }}\\n    steps:\\n    - name: Use variables\\n      run: |\\n        echo \\"repository variable : ${{ vars.REPOSITORY_VAR }}\\"\\n        echo \\"organization variable : ${{ vars.ORGANIZATION_VAR }}\\"\\n        echo \\"overridden variable : ${{ vars.OVERRIDE_VAR }}\\"\\n        echo \\"variable from shell environment : $env_var\\"\\n\\n    - name: ${{ vars.HELLO_WORLD_STEP }}\\n      if: ${{ vars.HELLO_WORLD_ENABLED == \'true\' }}\\n      uses: actions/hello-world-javascript-action@main\\n      with:\\n        who-to-greet: ${{ vars.GREET_NAME }}\\n\\n```\\n\\n  </div>\\n</details>\\n\\n:::tip\\n\u5728 github action \u4f7f\u7528\u8b8a\u91cf\u6642\uff0c\u8981\u8003\u616e\u9019\u500b\u8b8a\u91cf\u57f7\u884c\u6642\u662f\u5426\u5728 runner \u5167\u57f7\u884c\uff01\\n\\n\u5728 runner \u5167\u57f7\u884c\u9810\u8a2d\u662f\u53ef\u4ee5\u7528$Greeting(linux) or $env:NAME(windows)\u53bb\u53d6\u5f97\u8b8a\u91cf\uff0c\\n\\n\u5728 runner \u5916\u57f7\u884c\u7684\u4f8b\u5b50\uff0c\u8981\u4f7f\u7528`${{ env.DAY_OF_WEEK == \'Monday\' }}`\u9019\u6a23\u7684\u8868\u9054\u5f0f\uff0c\u4f7f\u7528\u60c5\u5883\u4f8b\u5982\u8981\u5148\u5224\u65b7 workflow \u74b0\u5883\u8b8a\u91cf\uff0c\u518d\u6c7a\u5b9a\u662f\u5426\u8dd1\u9019\u500b step \u7684\u904e\u7a0b\u3002\\n\u7bc4\u4f8b\uff1a\\n\\n<details>\\n  <summary>demo</summary>\\n  <div>\\n    <br />\\n\\n```\\nenv:\\n  DAY_OF_WEEK: Monday\\n\\njobs:\\n  greeting_job:\\n    runs-on: ubuntu-latest\\n    env:\\n      Greeting: Hello\\n    steps:\\n      - name: \\"Say Hello Mona it\'s Monday\\"\\n        if: ${{ env.DAY_OF_WEEK == \'Monday\' }}\\n        run: echo \\"$Greeting $First_Name. Today is $DAY_OF_WEEK!\\"\\n        env:\\n          First_Name: Mona\\n```\\n\\n  </div>\\n</details>\\n:::\\n\\n### Default environment variables\\n\\nThe default environment variables that GitHub sets are available to every step in a workflow.\\n[\u5167\u5efa\u74b0\u5883\u8b8a\u91cf](https://docs.github.com/en/actions/learn-github-actions/variables#default-environment-variables)\\n\\n\u56e0\u70ba\u5f88\u591a\uff0c\u6240\u4ee5\u6311\u5e7e\u500b\u8a18\u9304\u4e00\u4e0b\\n\\n1. GITHUB_SHA - The commit SHA that triggered the workflow.\\n\\n2. RUNNER_ARCH - \u5e95\u5c64\u67b6\u69cb\uff0cThe architecture of the runner executing the job. Possible values are X86, X64, ARM, or ARM64.\\n\\n3. GITHUB_REPOSITORY_OWNER - The repository owner\'s name. For example, octocat.\\n\\n4. GITHUB_REF_TYPE- The type of ref that triggered the workflow run. Valid values are branch or tag.\\n\\n5. GITHUB_REF- The fully-formed ref of the branch or tag that triggered the workflow run.\\n\\n6. GITHUB_JOB - The job_id of the current job. For example, greeting_job.\\n   \u4ee5\u4e0b job_id \u5206\u5225\u70ba My first job \u3001My second job\\n\\n```\\njobs:\\n  my_first_job:\\n    name: My first job\\n  my_second_job:\\n    name: My second job\\n```\\n\\n7. GITHUB_EVENT_NAME- The name of the event that triggered the workflow. For example, workflow_dispatch.\\n\\n8. GITHUB_ACTOR - The name of the person or app that initiated the workflow. For example, octocat.\\n\\n9. GITHUB_ACTION_REPOSITORY - For a step executing an action, this is the owner and repository name of the action. For example, actions/checkout.\\n\\n10. GITHUB_ACTION - \u7576\u524d\u904b\u884c\u7684\u64cd\u4f5c\u7684\u540d\u7a31\uff0c\u6216 id \u6b65\u9a5f\u7684\u540d\u7a31,id \u662f A unique identifier for the step. You can use the id to reference the step in contexts.\\n\\n:::info\\n[\u53c3\u8003\u7684\u7ba1\u7db2\u8cc7\u6599-contexts](https://docs.github.com/en/actions/learn-github-actions/contexts#matrix-context)\\n\\n[\u53c3\u8003\u7684\u7ba1\u7db2\u8cc7\u6599-expression](https://docs.github.com/en/actions/learn-github-actions/expressions)\\n\\n[\u53c3\u8003\u7684\u7ba1\u7db2\u8cc7\u6599-variables](https://docs.github.com/en/actions/learn-github-actions/variables)\\n:::"},{"id":"/2023/03/11/github-action/githib-action-CI-to-github-container","metadata":{"permalink":"/blog/2023/03/11/github-action/githib-action-CI-to-github-container","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-11-github-action/githib-action-CI-to-github-container.md","source":"@site/blog/2023-03-11-github-action/githib-action-CI-to-github-container.md","title":"use github action to build image and push to git hub container registry","description":"use CI in github action ,and variable in environments to build image and push to registry. github action \u5165\u9580\u653b\u7565\uff0cCI \u63a8image\u5230github","date":"2023-03-11T00:00:00.000Z","formattedDate":"March 11, 2023","tags":[{"label":"github action","permalink":"/blog/tags/github-action"},{"label":"CICD","permalink":"/blog/tags/cicd"}],"readingTime":4.675,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"use github action to build image and push to git hub container registry","description":"use CI in github action ,and variable in environments to build image and push to registry. github action \u5165\u9580\u653b\u7565\uff0cCI \u63a8image\u5230github","authors":"suyuying","tags":["github action","CICD"]},"prevItem":{"title":"learn github action from github docs","permalink":"/blog/2023/03/11/github-action/2.githubaction-learing"},"nextItem":{"title":"docker context\u6307\u4ee4","permalink":"/blog/2023/03/10/docker/docker-create-context"}},"content":"## Build code registry\\n\\n\u628a code \u63a8\u5230 github \u6559\u5b78\u5f88\u591a\uff0c\u53ef\u4ee5 google \u4e00\u4e0b\uff0c\u4e0d\u904e\u8981\u6ce8\u610f\u7684\u662f\u73fe\u5728\u63a8 code \u90fd\u8981\u5148\u5728\u5b98\u7db2\u7533\u8acb token\uff0c\u65b0\u624b\u5f88\u5bb9\u6613\u5361\u5728\u9019\u3002\\n\\n## ways to build image and push\\n\\n\u57f7\u884c CI \u524d\uff0c\u8981\u78ba\u8a8d\u6709 Dockerfile \u4e26\u4e14\u5728\u5730\u7aef\u53ef\u4ee5 docker run \u670d\u52d9\u8d77\u4f86\uff0cCI \u904e\u7a0b\u6703\u7528\u8a72 Dokcerfile \u7522\u751f image\u3002\\n\\n### way1. build image and push from local side by docker command,use CI after to renew\\n\\n1. \u5728\u5730\u7aef build \u5b8c\uff0c\u7136\u5f8c\u63a8\u5230 github container registry(\u9700\u8981\u7528 github ui \u5efa\u7acb token,\u4e26\u7d66 token)\\n   \uff0c\u7136\u5f8c\u628a token \u5b58\u5230 txt \u6a94\\n\\n2. \u7528 token \u767b\u5165 github\\n\\n```\\ncat token.txt | docker login ghcr.io -u suyuying --password-stdin\\n```\\n\\n`-u` \u63db\u6210\u81ea\u5df1\u7684 username\\n\\n`token.txt`\u628a token \u653e\u5728\u88e1\u9762\\n\\n\x3c!--truncate--\x3e\\n\\n3. \u63a8 image \u5230 github container registry DONe\\n\\n```\\ndocker buildx build --platform=linux/arm64,linux/amd64 --push -t ghcr.io/suyuying/fastapi-backend:1.0 .\\n```\\n\\n:::info\\n\u9019\u500b\u65b9\u6cd5\u7576\u4e0b\u6c92\u5565\u554f\u984c\uff0c\u6703\u6210\u529f\u5efa\u7acb\uff0c\u5982\u679c\u4ee5\u4e0a\u65b9\u6cd5\u8981\u63a5\uff23\uff29\uff0c\u9084\u6709 step 4.\\nimage\uff0c\u4f46\u4e4b\u5f8c\u63a5 CI \u7684\u6642\u5019\u6703\\n\u9047\u5230\u6b0a\u9650\u554f\u984c\uff0c\u8c8c\u4f3c\u7528 token \u5efa\u7acb\u4ee5\u5f8c\uff0c\u4f60 CI \u88e1\u9762\u4f7f\u7528 registry \u7684 `password: ${{ secrets.GITHUB_TOKEN }} ` \u7684 token \u6703\u5931\u6548\uff0c[\u539f\u672c issue \u4f4d\u7f6e](https://github.com/orgs/community/discussions/26274)\\n\\n4.\u8acb\u524d\u5f80 $yourOrganization \u2192 Packages \u2192 $yourPackage \u2192 Package settings\uff08\u53f3\u5074/\u5e95\u90e8\uff09\uff0c\u4e26\u914d\u7f6e\u201c\u7ba1\u7406\u64cd\u4f5c\u8a2a\u554f\\"\u90e8\u5206\u4ee5\u5141\u8a31\u6709\u554f\u984c\u7684 git \u5b58\u5132\u5eab\u5c0d\u6b64\u5305 code \u5b58\u5132\u5eab\u6709 write \u6b0a\u9650\\n\\n:::\\n\\n### way2. use CI to create and push image first, and afterwards\\n\\n1.\u5728.github/workflows \u8cc7\u6599\u593e\u5efa\u7acb xxx.yml \u6a94\u6848\uff0c\u5167\u5bb9\\n\\n```\\n# This workflow uses actions that are not certified by GitHub.\\n# They are provided by a third-party and are governed by\\n# separate terms of service, privacy policy, and support\\n# documentation.\\n\\n# GitHub recommends pinning actions to a commit SHA.\\n# To get a newer version, you will need to update the SHA.\\n# You can also reference a tag or branch, but the action may change without warning.\\n\\nname: Create and publish a Docker image\\n\\non:\\n  push:\\n    branches: [\'main\']\\n\\njobs:\\n  build-and-push-image:\\n  // \u9019\u500b\u662f\u4e4b\u5f8c\u793a\u7bc4import config environment variable ,optional\\n    environment: prod\\n    runs-on: ubuntu-latest\\n    permissions:\\n      contents: read\\n      packages: write\\n    // \u9019\u500b\u662f\u5efa\u7acb\u9019\u4efd\u6587\u4ef6\u7684env\u8b8a\u6578\\n    env:\\n      Greeting: Hello\\n\\n    steps:\\n      - name: Checkout repository\\n        uses: actions/checkout@v3\\n\\n      - name: Log in to the Container registry\\n        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9\\n        with:\\n          registry: ghcr.io\\n          username: ${{ github.actor }}\\n          password: ${{ secrets.GITHUB_TOKEN }}\\n    //\u9019\u908a\u7684secrets\u8981\u7528Actions secrets and variables\u8a2d\u5b9a\\n      - uses: mr-smithers-excellent/docker-build-push@v6\\n        with:\\n    // \u9019\u908a\u683c\u5f0f\u5c31\u8a18\u4e0b\u4f86\uff0c\u56e0\u70ba\u4ed6\u5b98\u7db2\u5beb\u7684\u4e5f\u4e0d\u6e05\u4e0d\u695a\u7684\uff0c\u9019\u6a23\u6703\u505a\u51faghcr.io/suyuying/fastapi-backend\\n          image: fastapi-backend\\n          registry: ghcr.io\\n          username: ${{ secrets.GHCR_USERNAME }}\\n          password: ${{ secrets.GHCR_TOKEN }}\\n\\n```\\n\\n2. \u653e\u8b8a\u6578\u503c\u5230 github repo \u4e0a\\n<>\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./repo-secrect.png\\").default}\\n      style={{ width: \\"100%\\" }}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n\\nGHCR_USERNAME=\\"yourUserName\\"\\n\\nGHCR_TOKEN=\\"classic token \u7522\u51fa\u7684 token\\"\\n:::info\\n\u53ef\u4ee5\u7528 Environment secrets \u6216 Repository secrets\\n\u5c0d workflow \u800c\u8a00\u4ed6\u5011\u90fd\u6703\u653e\u5728 secrets \u9019\u500b\u7269\u4ef6\u88e1\u9762\uff0c\\n\u4f7f\u7528\u65b9\u5f0f\u5411\u662f\\n`${{ secrets.GHCR_TOKEN }}`\\n:::\\n\\n3.  \u56e0\u7232\u689d\u4ef6\u8a2d\u5b9a push main\uff0c\u6240\u4ee5\u78ba\u8a8d\u597d main branch \u76f4\u63a5\u63a8\u5c31\u6703\u767c\u73fe\u6709\u65b0\u4f5c image \u4e86\\n\\n:::tip\\n\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./vars-env.png\\").default}\\n      style={{ width: \\"100%\\" }}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n\\n\u5982\u679c\u8981\u4f7f\u7528\u4e0a\u9762\u518d environment \u74b0\u5883\u8b8a\u6578\u53d6\u503c\uff0c\u8981\u4f7f\u7528\u9019\u7a2e\u683c\u5f0f\\n`${{ vars.READ_MY_NAME }}` \u53bb\u53d6\u503c\\n:::\\n\\n:::info\\n\\n1. github action \u63d0\u4f9b\u4e86\u4e00\u5927\u5806 context\uff0c[\u53c3\u8003\u8cc7\u6599](https://docs.github.com/en/actions/learn-github-actions/contexts#vars-context) \uff0c\u4e0d\u77e5\u9053\u70ba\u5565\u7db2\u8def\u8b1b\u5230\u9019\u500b\u8cc7\u6e90\u5f88\u5c11\\n\\n2. \u5b98\u7db2\u6559\u5b78 CI build image \u63a8\u5230 container registry \u4f7f\u7528\u7684\u662f\u53e6\u4e00\u500b action\uff0c\u5169\u500b\u90fd\u7528\u904e\uff0c\u90fd\u53ef\u4ee5\u7528\u3002\\n   [\u53c3\u8003 actions](https://docs.github.com/en/actions/publishing-packages/publishing-docker-images#publishing-images-to-github-packages)\\n\\n```\\n# This workflow uses actions that are not certified by GitHub.\\n# They are provided by a third-party and are governed by\\n# separate terms of service, privacy policy, and support\\n# documentation.\\n\\n# GitHub recommends pinning actions to a commit SHA.\\n# To get a newer version, you will need to update the SHA.\\n# You can also reference a tag or branch, but the action may change without warning.\\n\\nname: Publish Docker image\\n\\non:\\n  release:\\n    types: [published]\\n\\njobs:\\n  push_to_registries:\\n    name: Push Docker image to multiple registries\\n    runs-on: ubuntu-latest\\n    permissions:\\n      packages: write\\n      contents: read\\n    steps:\\n      - name: Check out the repo\\n        uses: actions/checkout@v3\\n\\n      - name: Log in to Docker Hub\\n        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9\\n        with:\\n          username: ${{ secrets.DOCKER_USERNAME }}\\n          password: ${{ secrets.DOCKER_PASSWORD }}\\n\\n      - name: Log in to the Container registry\\n        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9\\n        with:\\n          registry: ghcr.io\\n          username: ${{ github.actor }}\\n          password: ${{ secrets.GITHUB_TOKEN }}\\n\\n      - name: Extract metadata (tags, labels) for Docker\\n        id: meta\\n        uses: docker/metadata-action@98669ae865ea3cffbcbaa878cf57c20bbf1c6c38\\n        with:\\n          images: |\\n            my-docker-hub-namespace/my-docker-hub-repository\\n            ghcr.io/${{ github.repository }}\\n\\n      - name: Build and push Docker images\\n        uses: docker/build-push-action@ad44023a93711e3deb337508980b4b5e9bcdc5dc\\n        with:\\n          context: .\\n          push: true\\n          tags: ${{ steps.meta.outputs.tags }}\\n          labels: ${{ steps.meta.outputs.labels }}\\n```\\n\\n:::"},{"id":"/2023/03/10/docker/docker-create-context","metadata":{"permalink":"/blog/2023/03/10/docker/docker-create-context","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-10-docker/docker-create-context.md","source":"@site/blog/2023-03-10-docker/docker-create-context.md","title":"docker context\u6307\u4ee4","description":"docker \u652f\u63f4\u591a\u500b\u4e0d\u540cremote docker deamon\u7ba1\u7406","date":"2023-03-10T00:00:00.000Z","formattedDate":"March 10, 2023","tags":[{"label":"docker","permalink":"/blog/tags/docker"}],"readingTime":1.625,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"docker context\u6307\u4ee4","description":"docker \u652f\u63f4\u591a\u500b\u4e0d\u540cremote docker deamon\u7ba1\u7406","authors":"suyuying","tags":["docker"]},"prevItem":{"title":"use github action to build image and push to git hub container registry","permalink":"/blog/2023/03/11/github-action/githib-action-CI-to-github-container"},"nextItem":{"title":"conatiner log\u592a\u5927\u5c0e\u81f4container\u639b\u6389\u89e3\u6c7a\u65b9\u6cd5","permalink":"/blog/2023/03/10/docker/docker-management"}},"content":"`docker create context` \u662f\u7528\u4f86\u5efa\u7acb\u4e00\u500b\u65b0\u7684 context\uff0c\u4ee5\u6307\u5411\u4e00\u500b remote Docker daemon\uff0c\u7528\u65bc\u7ba1\u7406 Docker \u4e3b\u6a5f\u548c Docker registry \u7684\u6a5f\u5236\u3002\\n\\n\u53ef\u4ee5\u4f7f\u7528 `docker context use` \u6307\u4ee4\u4f86\u5207\u63db context\uff0c\u5207\u63db\u5b8c\u6210\u5f8c\u5373\u53ef\u4f7f\u7528 docker \u6307\u4ee4\u64cd\u4f5c remote Docker daemon\u3002\u5982\u679c\u4f7f\u7528\u96f2\u7aef container\uff0c\u4f8b\u5982 azure web container service\uff0c\u5c31\u53ef\u4ee5\u7528\u9019\u500b\u6307\u4ee4\u53bb\u7ba1\u7406\u96f2\u7aef container\u3002\u5305\u542b\u65b0\u5efa \u522a\u9664\u90fd\u53ef\u4ee5\u4f7f\u7528\uff0c\u6240\u4ee5\u4e0d\u8981\u592a\u958b\u5fc3\u4e00\u6b21\u8d77\u4e00\u5927\u5806\u96f2\u7aef container \u9019\u6a23\u6703\u88ab charging \u5230\u7206\u3002\\n:::info\\n\u5982\u679c\u6709\u7528\u5230 docker buildx \u53ef\u80fd\u6703\u628a docker context \u8ddf docker buildx create --name \u641e\u6df7\uff0c\\n\u5169\u500b\u662f\u4e0d\u540c\u7684\uff0c[\u53ef\u4ee5\u770b\u9019\u88e1](./docker-muiltiplatform%20copy#docker-buildx-create---name-my-node-%E6%98%AF%E5%BB%BA%E7%AB%8B%E7%AF%80%E9%BB%9E%E5%97%8E])\\n:::\\n\\n\u4ee5\u4e0b\u662f `docker create context` \u6307\u4ee4\u7684\u6559\u5b78\uff1a\\n\\n\u4f7f\u7528 `docker create context` \u6307\u4ee4\u53ef\u4ee5\u5efa\u7acb\u4e00\u500b\u65b0\u7684 context\uff0c\u7528\u4f86\u6307\u5411\u4e00\u500b remote Docker daemon\u3002\u4ee5\u4e0b\u662f\u6307\u4ee4\u7684\u8a73\u7d30\u8aaa\u660e\uff1a\\n\\n```\\ndocker context create CONTEXT_NAME --docker \\"host=REMOTE_DOCKER_HOST\\" --description \\"CONTEXT_DESCRIPTION\\"\\n```\\n\\n- `CONTEXT_NAME`: \u6307\u5b9a\u65b0\u5efa\u7acb\u7684 context \u7684\u540d\u7a31\u3002\\n- `REMOTE_DOCKER_HOST`: \u6307\u5b9a remote Docker daemon \u7684\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u662f\u4e00\u500b IP \u6216\u662f\u4e00\u500b domain name\u3002\\n- `CONTEXT_DESCRIPTION`: \u53ef\u4ee5\u52a0\u5165\u5c0d context \u7684\u63cf\u8ff0\uff0c\u65b9\u4fbf\u7ba1\u7406\u3002\\n\\n\u4f8b\u5982\uff0c\u4ee5\u4e0b\u6307\u4ee4\u5efa\u7acb\u4e00\u500b\u540d\u70ba `mycontext` \u7684 context\uff0c\u6307\u5411\u4e00\u500b remote Docker daemon\uff0c\u4e26\u52a0\u5165\u63cf\u8ff0\uff1a\\n\\n```\\ndocker context create mycontext --docker \\"host=myremotehost:2376\\" --description \\"My remote Docker daemon\\"\\n```\\n\\n\u5efa\u7acb\u5b8c\u6210\u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528 `docker context use` \u6307\u4ee4\u4f86\u5207\u63db context\uff1a\\n\\n```\\ndocker context use mycontext\\n```"},{"id":"/2023/03/10/docker/docker-management","metadata":{"permalink":"/blog/2023/03/10/docker/docker-management","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-10-docker/docker-management.md","source":"@site/blog/2023-03-10-docker/docker-management.md","title":"conatiner log\u592a\u5927\u5c0e\u81f4container\u639b\u6389\u89e3\u6c7a\u65b9\u6cd5","description":"\u7576\u9047\u5230container log\u592a\u5927 \u9020\u6210\u670d\u52d9\u639b\u6389\u7684\u6392\u67e5\u65b9\u5411\uff0c\u4ee5\u53ca\u5982\u4f55\u907f\u514d\u3002","date":"2023-03-10T00:00:00.000Z","formattedDate":"March 10, 2023","tags":[{"label":"docker","permalink":"/blog/tags/docker"}],"readingTime":4.485,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"conatiner log\u592a\u5927\u5c0e\u81f4container\u639b\u6389\u89e3\u6c7a\u65b9\u6cd5","description":"\u7576\u9047\u5230container log\u592a\u5927 \u9020\u6210\u670d\u52d9\u639b\u6389\u7684\u6392\u67e5\u65b9\u5411\uff0c\u4ee5\u53ca\u5982\u4f55\u907f\u514d\u3002","authors":"suyuying","tags":["docker"]},"prevItem":{"title":"docker context\u6307\u4ee4","permalink":"/blog/2023/03/10/docker/docker-create-context"},"nextItem":{"title":"docker buildx\u6307\u4ee4","permalink":"/blog/2023/03/10/docker/docker-muiltiplatform"}},"content":"## volume of docker\\n\\n\u4ee5\u524d\u90fd\u5728\u5f04\u81ea\u5df1\u7684\u5c0f\u5c08\u6848\uff0c\u53ea\u8981\u6771\u897f\u8dd1\u5f97\u8d77\u4f86\u5c31\u597d\uff0c\u6c92\u60f3\u904e\u6703\u9047\u904e\u56e0\u70ba\u786c\u789f\u5403\u6eff\u5c0e\u81f4 container \u670d\u52d9\u639b\u6389\u7684\u554f\u984c\u3002\\n\\ndocker \u639b\u8f09 volume \u6703\u6709\u4e09\u7a2e\u65b9\u5f0f\uff0c\u7d81\u5b9a\u639b\u8f09\uff08Bind Mount\uff09\uff0c\u547d\u540d\u5377\uff08Named Volume\uff09\uff0c\u533f\u540d\u5377\uff08Anonymous Volume\uff09\uff0c\u524d\u5169\u7a2e\u5728 container \u88ab\u522a\u9664\u6642\u4e0d\u6703\u88ab\u522a\uff0c\u6703\u6c38\u4e45\u4fdd\u5b58\uff0cdocker \u5167\u6c92\u88ab\u639b\u8f09\u6216\u4f7f\u7528 Anonymous Volume \u5247\u90fd\u6703\u88ab\u522a\u9664\u3002\\n\\n:::info\\ndocker logs \u8cc7\u6599\u5305\u542b\u54ea\u4e9b\uff1f\\nDocker \u6703\u6355\u6349\u6240\u6709\u5bb9\u5668\u7684\u6a19\u51c6\u8f38\u51fa\uff08\u548c\u6a19\u51c6\u932f\u8aa4\uff09\uff0c\u4e26\u4ee5 JSON \u683c\u5f0f\u5c07\u5176\u5beb\u5165\u6587\u4ef6\u4e2d\u3002 JSON \u683c\u5f0f\u5c07\u6bcf\u884c\u6ce8\u91cb\u70ba\u5176\u6e90\uff08stdout \u6216 stderr\uff09\u548c\u5176\u6642\u9593\u6233\u3002 \u6bcf\u500b\u65e5\u8a8c\u6587\u4ef6\u50c5\u5305\u542b\u6709\u95dc\u4e00\u500b\u5bb9\u5668\u7684\u4fe1\u606f\u3002\\n:::\\n\\n### \u5982\u4f55\u6e1b\u5c11\u4e0d\u5fc5\u8981\u7684\u786c\u9ad4\u4f54\u7528\\n\\n\u56e0\u70ba docker \u904b\u884c\u904e\u7a0b\u672c\u8eab log \u4e5f\u6703\u4f54\u7528\u786c\u789f\u8cc7\u6e90\uff0c\u70ba\u4e86\u4e0d\u8b93\u9019\u500b log \u904e\u5ea6\u81a8\u8139\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u9650\u5236\\n\\n1. \u4fee\u6539 docker \u8a2d\u5b9a\u6a94\\n\\n```jsx title=\\"/etc/docker/daemon.json\\"\\n{\\n  \\"log-driver\\":\\"json-file\\",\\n  \\"log-opts\\": {\\"max-size\\":\\"500m\\", \\"max-file\\":\\"3\\"}\\n}\\n\\n`systemctl daemon-reload`\\n`systemctl restart docker\\n`\\n```\\n\\n2. \u4fee\u6539 docker-compose.yml\\n\\n```\\nservices:\\n  hellow:\\n    build: .\\n    container_name: mattermost\\n    restart: always\\n    logging:\\n      driver: \\"json-file\\"\\n      options:\\n          max-size: \\"100m\\"\\n          max-file: \\"10\\"\\n```\\n\\n\u4e26\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u91cd\u555f\uff0c\u4e00\u822c restart \u4e0d\u6703\u5403\u65b0 config\\n\\n```\\ndocker-compose -f docker-compose.yml up -d --force-recreate mm\\n```\\n\\n:::danger\\n\u4e0b\u9019\u500b\u6307\u4ee4\u524d\u52d9\u5fc5\u60f3\u597d\u662f\u5426\u91cd\u8981\u8cc7\u8a0a\u6709\u7528 Bind Mount or Named Volume \u639b\u8f09\u51fa\u4f86\uff01\\n:::\\n\\n3. docker \u6307\u4ee4\\n\\n```\\ndocker run -d --log-opt max-size=1g nginx\\n```\\n\\n[\u5b98\u7db2 log \u7ba1\u7406](https://docs.docker.com/config/containers/logging/json-file/)\uff0c\u7ba1\u7406 docker log \u65b9\u5f0f\u5f88\u591a\uff0c\u9810\u8a2d\u90fd\u9069\u7528 json-file\uff0c\u8a2d\u5b9a\u53ef\u5df2\u900f\u904e\u4fee\u6539/etc/docker/daemon.json \u4e26\u91cd\u555f\u9054\u6210\u3002\\n\\n\u9810\u8a2d\u662f\u5728\u540c\u4e00\u4efd\u6a94\u6848\uff0c\u7121\u9650\u5927\u5c0f\u5beb\u5165\uff0c\u900f\u904e\u4ee5\u4e0a\u65b9\u6cd5\uff0c\u53ef\u4ee5\u9650\u5b9a\u6a94\u6848\u5927\u5c0f\u8ddf\u53ef\u7522\u751f\u6a94\u6848\u6578\u91cf\uff0c\u7576 log \u5bb9\u91cf\u5230\u9054\u4e0a\u9650\u6642\uff0cDocker \u7a0b\u5e8f\u5c07\u505c\u6b62\u5beb\u5165\u8a72\u65e5\u8a8c\u6587\u4ef6\uff0c\u4e26\u958b\u59cb\u4f7f\u7528\u65b0\u540d\u7a31\u555f\u52d5\u65b0\u7684\u65e5\u8a8c\u6587\u4ef6\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u65b0\u65e5\u8a8c\u6587\u4ef6\u5c07\u5177\u6709\u8207\u820a\u65e5\u8a8c\u6587\u4ef6\u76f8\u540c\u7684\u540d\u7a31\uff0c\u4f46\u6703\u5728\u672b\u5c3e\u6dfb\u52a0\u9023\u7e8c\u865f\uff08\u4f8b\u5982\uff0caccess.log.1\u3001access.log.2 \u7b49\uff09\u3002\\n\\nDocker \u4fdd\u7559\u7684\u65e5\u8a8c\u6587\u4ef6\u6578\u91cf\u7531`max-file`\u9078\u9805\u6c7a\u5b9a\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cDocker \u5c07\u4fdd\u7559\u6700\u591a 1 \u500b\u65e5\u8a8c\u6587\u4ef6(\u8981\u914d\u7f6e`max-size`\u624d\u6703\u751f\u6548)\u3002\u7576\u9054\u5230\u6700\u5927\u65e5\u8a8c\u6587\u4ef6\u6578\u91cf\u6642\uff0cDocker \u5c07\u958b\u59cb\u4f7f\u7528\u65b0\u7684\u65e5\u8a8c\u6578\u64da\u8986\u84cb\u6700\u820a\u7684\u65e5\u8a8c\u6587\u4ef6\u3002\\n\\n\uff08ps:\u8cc7\u8a0a\u4ee5\u6b64[\u9023\u7d50](https://docs.docker.com/config/containers/logging/json-file/)\u70ba\u6e96\uff0c\u8a2d\u5b9a\u53ef\u80fd\u6703\u6539\u8b8a\u7684\uff09\\n\\n## what should do when you find / or /var are full\\n\\n:::info\\n\u9810\u8a2d docker \u7684\u6771\u897f\u90fd\u653e\u5728/var/lib/docker \u5e95\u4e0b\\n\\n```jsx title=\\"/var/lib/docker\\"\\nbuilder  buildkit  containers  image  network  overlay2  plugins  runtimes  swarm  tmp  trust  volumes\\n```\\n\\n\u53ef\u4ee5\u5728\u8a72\u8cc7\u6599\u593e\u5e95\u4e0b\u7528`du -sh ./*`\u78ba\u8a8d\u54ea\u500b\u5730\u65b9\u5403\u5f97\u7570\u5e38\u5147\uff0c\\n\u4e26\u7528`docker system df`\u770b\u8cc7\u6599\u4f54\u7528\uff0c\u5982\u679c\u4e0d\u7528\u7684 image \u5f88\u591a\u53ef\u4ee5\u6e05\u9664\\n\\n`docker image prune --all`\\n\\n\u4ed6\u6703\u522a\u9664\u6240\u6709\u6c92\u6709\u88ab container \u4f7f\u7528\u7684 image\uff0c\u8b66\u793a\u5982\u4e0b\uff1a\\n\\nWARNING! This will remove all images without at least one container associated to them.\\n:::\\n\\n1.  \u5982\u679c\u7576\u521d\u6c92\u6709\u505a\u4efb\u4f55\u9810\u9632\uff0c\u5c0e\u81f4/var \u771f\u7684\u7206\u4e86\uff0c\u53ef\u4ee5\u512a\u5148\u6aa2\u67e5\u4ee5\u4e0b\u5e7e\u9805\\n\\n### \u6aa2\u67e5 docker logs \u662f\u5426\u4f54\u592a\u5147\\n\\n\u5176\u5be6\u5c31\u662f\u53bb/var/lib/docker/containers\uff0c\u57f7\u884c`du -sh ./* `\u770b\u54ea\u500b container \u4f54\u6700\u591a\u8cc7\u6e90\uff0c\u7136\u5f8c\u53bb\u770b\u88e1\u9762\u90a3\u96bb\u653e docker logs \u7684\u6a94\u540d\u70ba container-id-json.log \u7684\u6a94\u6848\u662f\u5426\u9577\u592a\u5927\uff0c\u78ba\u8a8d\u5f8c\u53ef\u4ee5\u780d\u6389\u3002\\n\\n### \u6aa2\u67e5 named volume \u4e2d\u5b58\u653e\u8cc7\u8a0a\\n\\n\u5176\u5be6\u5c31\u662f\u53bb/var/lib/docker/volumes \u5e95\u4e0b\uff0c\u770b\u6709\u6c92\u6709\u67d0\u500b volume \u4f54\u592a\u591a\u8cc7\u6e90\uff0c\u7136\u5f8c\u88e1\u9762\u653e\u7684\u6771\u897f\u53ef\u80fd\u4e0d\u91cd\u8981(\u4f8b\u5982 nginx log)\\n\\n### \u6aa2\u67e5 image \u8ddf\u6c92\u7528\u7684 container\\n\\nimage \u6307\u4ee4:\u522a\u9664\u6c92\u6709\u88ab\u6d3b\u52d5\u7684 container \u4f7f\u7528\u7684 image\\n`docker image prune --all`\\n\\ncontainer \u6307\u4ee4\uff1a\u522a\u9664\u505c\u6b62\u7684 container\\n`docker container prune`\\n\\n:::info\\n\\n[Prune unused Docker objects](https://docs.docker.com/config/pruning/)\\n[\u9650\u5236 Docker \u65e5\u5fd7\u5927\u5c0f](https://blog.csdn.net/fishinhouse/article/details/105310948)\\n:::"},{"id":"/2023/03/10/docker/docker-muiltiplatform","metadata":{"permalink":"/blog/2023/03/10/docker/docker-muiltiplatform","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-10-docker/docker-muiltiplatform.md","source":"@site/blog/2023-03-10-docker/docker-muiltiplatform.md","title":"docker buildx\u6307\u4ee4","description":"docker \u652f\u63f4\u591a\u5e73\u53f0image\u7684build\u6307\u4ee4","date":"2023-03-10T00:00:00.000Z","formattedDate":"March 10, 2023","tags":[{"label":"docker","permalink":"/blog/tags/docker"}],"readingTime":4.93,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"docker buildx\u6307\u4ee4","description":"docker \u652f\u63f4\u591a\u5e73\u53f0image\u7684build\u6307\u4ee4","authors":"suyuying","tags":["docker"]},"prevItem":{"title":"conatiner log\u592a\u5927\u5c0e\u81f4container\u639b\u6389\u89e3\u6c7a\u65b9\u6cd5","permalink":"/blog/2023/03/10/docker/docker-management"},"nextItem":{"title":"linux\u4e09\u5927\u795e\u5668\u4e4b\u4e00 sed\u8907\u7fd2\u7b46\u8a18","permalink":"/blog/2023/03/08/linux-command-repratice"}},"content":"## \u57fa\u672c\u4ecb\u7d39\\n\\n:::danger\\n\u5982\u679c\u4e0d\u652f\u63f4\u591a\u5e73\u53f0\uff0c\u5c31\u6703\u51fa\u73fe\u5728 arm build\uff0c\u7136\u5f8c\u5728 amd deploy \u5931\u6557\uff0c\u4e0a\u7db2\u67e5\u4e0d\u5230\u539f\u56e0\u7684\u554f\u984c\u3002\\n:::\\n\\nDocker Buildx \u662f Docker \u5b98\u65b9\u63d0\u4f9b\u7684\u4e00\u500b\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u65bc\u901a\u904e Dockerfile \u6784\u5efa Docker \u6620\u50cf\u3002\u5b83\u7684\u4e3b\u8981\u7279\u9ede\u662f\u53ef\u4ee5\u8de8\u5e73\u81fa\u69cb\u5efa Docker \u6620\u50cf\uff0c\u4e26\u652f\u6301\u591a\u7a2e CPU \u67b6\u69cb\uff08\u5982 x86\u3001ARM\u3001IBM Power \u7b49\uff09\uff0c\u662f\u4e00\u500b\u7528\u4f86\u5efa\u7acb\u548c\u7ba1\u7406 multi-arch Docker image \u7684\u5de5\u5177\u3002\\n\\n:::info\\ndocker buildx \u7684\u55ae\u4f4d\u662f node\uff0c\u8ddf docker context \u4e0d\u540c\uff0c\u524d\u8005\u662f\u5efa\u7acb\u5f71\u50cf\u7684\u4e3b\u6a5f\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u500b\u7bc0\u9ede\u4f86\u52a0\u901f Docker \u6620\u50cf\u7684\u5efa\u7acb\u904e\u7a0b\uff0c\u5f8c\u8005\u5247\u662f\u7528\u4f86\u7ba1\u7406 Docker \u4e3b\u6a5f\u548c Docker registry \u7684\u6a5f\u5236\uff0c\u5b9a\u7fa9\u4e86\u4e00\u500b\u6216\u591a\u500b Docker \u4e3b\u6a5f\u548c Docker registry \u7684\u8a2d\u5b9a\u3002\\n\\n:::\\n\\n\u4ee5\u4e0b\u662f\u4f7f\u7528 Docker Buildx \u69cb\u5efa Docker \u6620\u50cf\u7684\u57fa\u672c\u6b65\u9a5f\uff1a\\n\\n## 1. \u555f\u7528 multi-arch \u652f\u63f4\\n\\n\u8981\u4f7f\u7528 `docker buildx` \u5efa\u7acb multi-arch Docker image\uff0c\u5fc5\u9808\u5148\u555f\u7528 multi-arch \u652f\u63f4(Docker Desktop \u9810\u914d\u7f6e\u4e86 binfmt_misc \u5c0d\u5176\u4ed6\u5e73\u53f0\u7684\u652f\u6301\uff0c\u53ef\u4ee5\u5ffd\u7565\u6b64\u6307\u4ee4)\u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u555f\u7528 multi-arch \u652f\u63f4\uff1a\\n\\n```\\ndocker run --rm --privileged multiarch/qemu-user-static --reset -p yes\\n```\\n\\n## 2. \u5efa\u7acb builder(node)\\n\\n\u8981\u4f7f\u7528 `docker buildx` \u5efa\u7acb multi-arch Docker image\uff0c\u5fc5\u9808\u5148\u5efa\u7acb\u4e00\u500b builder\u3002\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u5efa\u7acb builder\uff1a\\n\\n```\\ndocker buildx create --name mybuilder\\n```\\n\\n## 3. \u8a2d\u5b9a builder\\n\\n\u5efa\u7acb builder \u5f8c\uff0c\u5fc5\u9808\u5c07 builder \u8a2d\u5b9a\u70ba\u76ee\u524d\u4f7f\u7528\u7684 builder\u3002\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u8a2d\u5b9a builder\uff1a\\n\\n```\\ndocker buildx use mybuilder\\n```\\n\\n## 4. \u5efa\u7acb Dockerfile\\n\\n\u63a5\u4e0b\u4f86\uff0c\u5efa\u7acb\u4e00\u500b Dockerfile\uff0c\u4e26\u5728\u5176\u4e2d\u6307\u5b9a\u8981\u5efa\u7acb\u7684 Docker image\u3002\u4f8b\u5982\uff0c\u5728 Dockerfile \u4e2d\u53ef\u4ee5\u6307\u5b9a\u8981\u5efa\u7acb\u7684 image \u70ba `ubuntu:latest`\uff0c\u4e26\u5728\u5176\u4e2d\u5b89\u88dd\u4e00\u4e9b\u8edf\u9ad4\u5957\u4ef6\uff1a\\n\\n```\\nFROM --platform=$TARGETPLATFORM ubuntu:latest\\n\\nRUN apt-get update && \\\\\\\\\\n    apt-get install -y software-properties-common && \\\\\\\\\\n    add-apt-repository -y ppa:nginx/stable && \\\\\\\\\\n    apt-get update && \\\\\\\\\\n    apt-get install -y nginx\\n```\\n\\n## 5. \u5efa\u7acb multi-arch Docker image\\n\\n\u5efa\u7acb Dockerfile \u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u5efa\u7acb multi-arch Docker image\uff1a\\n\\n```\\ndocker buildx build --platform linux/arm/v7 -t myimage:latest --load .\\n```\\n\\n\u5728\u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff0c`--platform` \u53c3\u6578\u6307\u5b9a\u4e86\u8981\u69cb\u5efa\u7684 CPU \u67b6\u69cb\uff0c`-t` \u53c3\u6578\u6307\u5b9a\u4e86\u6620\u50cf\u7684\u6a19\u7c64\uff0c`.` \u8868\u793a\u7576\u524d\u76ee\u9304\u662f Dockerfile \u6240\u5728\u7684\u76ee\u9304\u3002\\n\\n--load \u76f8\u7576\u65bc`--output=type=docker` \u6c92\u6709\u6307\u5b9a\u6703\u51fa\u73fe warning\\n\\n```\\nWARN[0000] No output specified for docker-container driver. Build result will only remain in the build cache. To push result image into registry use --push or to load image into docker use --load\\n```\\n\\n--push \u9060\u7aef registry \u76f8\u7576\u65bc`--output=type=registry`\\n\\n:::info\\nhttps://github.com/docker/buildx/issues/59\\n2023/3/9 \u4f7f\u7528--platform \u914d\u5408--load\uff0c\u4e0d\u80fd\u652f\u63f4\u591a\u5e73\u53f0\uff0c\u4e00\u6b21\u4e00\u500b\u5e73\u53f0\uff0c\u5426\u5247\u6703\u5831\u932f\\n--push \u652f\u63f4\u4e00\u6b21\u591a\u5e73\u53f0 image\\n\\n```\\nerror: docker exporter does not currently support exporting manifest lists\\n```\\n\\n:::\\n\\n\u5efa\u7acb\u5b8c\u6210\u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u67e5\u770b\u5efa\u7acb\u7684 Docker image\uff1a\\n\\n```\\ndocker images myimage\\n```\\n\\n\u63a8\u9001 Docker \u6620\u50cf\uff1a\\n\\n```\\n$ docker push myimage:latest\\n```\\n\\n\u4ee5\u4e0a\u5c31\u662f\u4f7f\u7528 Docker Buildx \u69cb\u5efa Docker \u6620\u50cf\u7684\u57fa\u672c\u6b65\u9a5f\u3002\u4f7f\u7528 Docker Buildx \u53ef\u4ee5\u8b93\u6211\u5011\u66f4\u65b9\u4fbf\u5730\u69cb\u5efa\u8de8\u5e73\u81fa\u7684 Docker \u6620\u50cf\uff0c\u63d0\u9ad8\u4e86\u958b\u767c\u6548\u7387\u3002\\n\\n:::info\\n`docker buildx rm docker-test` \u522a\u9664\\n\\n`docker buildx use docker-test`\u5207\u63db\\n:::\\n\\n## docker buildx create --name my-node \u662f\u5efa\u7acb\u7bc0\u9ede\u55ce\uff1f\\n\\n\u662f\u7684\uff0c`docker buildx create --name my-node` \u6307\u4ee4\u6703\u5efa\u7acb\u4e00\u500b\u540d\u70ba `my-node` \u7684\u7bc0\u9ede\u3002\u7bc0\u9ede\u662f\u7528\u4f86\u5efa\u7acb Docker \u6620\u50cf\u7684\u4e3b\u6a5f\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u500b\u7bc0\u9ede\u4f86\u52a0\u901f Docker \u6620\u50cf\u7684\u5efa\u7acb\u904e\u7a0b\uff0c\u6216\u8005\u5efa\u7acb\u4e0d\u540c\u5e73\u53f0\u7684 Docker \u6620\u50cf\u3002\\n\\n\u5efa\u7acb\u7bc0\u9ede\u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 `--driver` \u9078\u9805\u6307\u5b9a\u7bc0\u9ede\u7684\u9a45\u52d5\u7a0b\u5f0f\uff0c\u4f8b\u5982 `docker-container` \u6216 `docker`\u3002\u9a45\u52d5\u7a0b\u5f0f\u9084\u53ef\u4ee5\u662f\u5176\u4ed6\u7b2c\u4e09\u65b9\u5e73\u53f0\uff0c\u4f8b\u5982 AWS\u3001Azure \u6216 Google Cloud\u3002\\n\\n\u5728\u5efa\u7acb\u7bc0\u9ede\u6642\uff0c\u53ef\u4ee5\u6307\u5b9a\u7bc0\u9ede\u7684\u540d\u7a31\u3001\u9a45\u52d5\u7a0b\u5f0f\u3001\u9a45\u52d5\u7a0b\u5f0f\u9078\u9805\u3001Docker \u6620\u50cf\u7b49\u8cc7\u8a0a\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u662f\u5efa\u7acb\u4e00\u500b\u540d\u70ba `my-node` \u7684\u7bc0\u9ede\uff0c\u4f7f\u7528 Docker \u5bb9\u5668\u4f5c\u70ba\u9a45\u52d5\u7a0b\u5f0f\uff0c\u4f7f\u7528 `moby/buildkit:v0.8.1` \u4f5c\u70ba Docker \u6620\u50cf\u7684\u793a\u7bc4\u6307\u4ee4\uff1a\\n\\n```\\ndocker buildx create --name my-node --driver docker-container --driver-opt image=moby/buildkit:v0.8.1\\n\\n```\\n\\n\u5efa\u7acb\u7bc0\u9ede\u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528 `docker buildx ls` \u6307\u4ee4\u5217\u51fa\u6240\u6709\u7bc0\u9ede\u3002\u5efa\u7acb Docker \u6620\u50cf\u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 `--builder` \u9078\u9805\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u7bc0\u9ede\u3002\u4f8b\u5982\uff1a\\n\\n```\\ndocker buildx build --builder my-node --platform linux/amd64 -t myimage:latest .\\n\\n```\\n\\n\u53ef\u4ee5\u4f7f\u7528\u540d\u70ba my-node \u7684\u7bc0\u9ede\u5efa\u7acb Docker \u6620\u50cf\uff0c\u4e26\u6307\u5b9a\u8981\u5efa\u7acb\u7684\u5e73\u53f0\u70ba linux/amd64\u3002"},{"id":"/2023/03/08/linux-command-repratice","metadata":{"permalink":"/blog/2023/03/08/linux-command-repratice","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-08-linux-command-repratice.md","source":"@site/blog/2023-03-08-linux-command-repratice.md","title":"linux\u4e09\u5927\u795e\u5668\u4e4b\u4e00 sed\u8907\u7fd2\u7b46\u8a18","description":"\u6574\u7406\u5de5\u4f5c\u4e2d\u6709\u4f7f\u7528\u5230\u7684\u8cc7\u6599","date":"2023-03-08T00:00:00.000Z","formattedDate":"March 8, 2023","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"sed","permalink":"/blog/tags/sed"}],"readingTime":0.485,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"linux\u4e09\u5927\u795e\u5668\u4e4b\u4e00 sed\u8907\u7fd2\u7b46\u8a18","description":"\u6574\u7406\u5de5\u4f5c\u4e2d\u6709\u4f7f\u7528\u5230\u7684\u8cc7\u6599","authors":"suyuying","tags":["linux","sed"]},"prevItem":{"title":"docker buildx\u6307\u4ee4","permalink":"/blog/2023/03/10/docker/docker-muiltiplatform"},"nextItem":{"title":"Brief summary of Domain Hijacking vs DNS Poisoning","permalink":"/blog/2023/03/07/dns-pollution-hijack"}},"content":"## sed\\n\\n\u4e00\u822c\u6253\u5370\\n\u5370 5~7 \u884c \u5176\u4ed6\u884c\u6578 silence\\n\\n```\\ncat -n xxxx.md | sed -n \'5,7p\'\\n\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n\u5370\u51fa\u6307\u5b9a\u5b57\u6a23\u7bc4\u570d\\n\u5f9e\u6709\u95dc\u9375\u5b57\u70ba QOO \u90a3\u4e00\u884c\u5230\u4ee5}\u70ba\u958b\u982d\u7684\u90a3\u4e00\u884c(^\u4ee3\u8868\u6b63\u5247\u958b\u982d\u5b57\u5143)\\n\\n```\\nsed -n \\"/QOO/,/^}/p\\" common.js\\n```\\n\\n## grep\\n\\nsort \u6392\u5217\\nuniq \u53bb\u6389\u91cd\u8907\uff0c\u8981\u8a08\u6578\u53ef\u4ee5\u7528 uniq -c\\n\\n```\\ngrep -r \\"bin\\" * | grep -Eo \\"code\\\\\\":[0-9]{0,}\\" |sort | uniq\\n```\\n\\n## awk"},{"id":"/2023/03/07/dns-pollution-hijack","metadata":{"permalink":"/blog/2023/03/07/dns-pollution-hijack","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-07-dns-pollution-hijack.md","source":"@site/blog/2023-03-07-dns-pollution-hijack.md","title":"Brief summary of Domain Hijacking vs DNS Poisoning","description":"record what is Domain Hijacking and DNS Poisoning, and the difference between them","date":"2023-03-07T00:00:00.000Z","formattedDate":"March 7, 2023","tags":[{"label":"dns","permalink":"/blog/tags/dns"},{"label":"Domain Hijacking","permalink":"/blog/tags/domain-hijacking"},{"label":"DNS Poisoning","permalink":"/blog/tags/dns-poisoning"}],"readingTime":0.855,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"Brief summary of Domain Hijacking vs DNS Poisoning","description":"record what is Domain Hijacking and DNS Poisoning, and the difference between them","authors":"suyuying","tags":["dns","Domain Hijacking","DNS Poisoning"]},"prevItem":{"title":"linux\u4e09\u5927\u795e\u5668\u4e4b\u4e00 sed\u8907\u7fd2\u7b46\u8a18","permalink":"/blog/2023/03/08/linux-command-repratice"},"nextItem":{"title":"Introduction and demo Azure container service","permalink":"/blog/2023/03/06/azure/azure-cloud-container"}},"content":"<>\\n\\n<ol>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex max-h-[24px]  w-full max-w-[24px]  items-center justify-center rounded-full text-base  text-white\\"\\n    >\\n      1\\n    </span>\\n    \u52ab\u6301\uff1adns server \u7ba1\u7406\u7aef\u6216\u8005\u4f60\u7684\u57df\u540d\u89e3\u6790\u5546\u628a\u4f60\u7684 url \u5c0d\u61c9 ip \u63db\u6210\u5176\u4ed6 ip \u6216 url\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      2\\n    </span>\\n    \u6c61\u67d3\uff1adns serer \u7684\u67d0\u500b\u7bc0\u9edecatch \u88ab\u99ed\u7136\u5f8c\u6539\u6389\uff0c\u628a\u9019\u500b url \u63db\u6210\u5176\u4ed6 ip \u6216 url\\n  </li>\\n\\n</ol>\\n\\n<p>\u5c0f\u7d50\uff1a\u52ab\u6301\u662f\u5b98\u65b9\u88ab\u99ed\u6216\u6545\u610f\u6539\u7684\uff08\u5927\u9678\u5e38\u767c\u751f\uff09\uff0c\u6c61\u67d3\u662f\u8def\u7531\u5230dns server\u904e\u7a0b\u67d0\u53f0\u8def\u7531\u5668\u88ab\u99ed\u3002\\n</p>\\n\\n</>\\n\\n\x3c!--truncate--\x3e\\n\\n:::info\\n\u53c3\u8003\u8cc7\u6599:\\n\\n1. [Domain Hijacking vs DNS Poisoning: Do You Know the Difference](https://heimdalsecurity.com/blog/domain-hijacking-vs-dns-poisoning-do-you-know-the-difference/#:~:text=1.,and%20changes%20its%20DNS%20settings.)\\n2. [DNS \u52ab\u6301\u548c DNS \u6c61\u67d3\u7684\u533a\u522b](https://www.williamlong.info/archives/3356.html)\\n\\n:::"},{"id":"/2023/03/06/azure/azure-cloud-container","metadata":{"permalink":"/blog/2023/03/06/azure/azure-cloud-container","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-06-azure/azure-cloud-container.md","source":"@site/blog/2023-03-06-azure/azure-cloud-container.md","title":"Introduction and demo Azure container service","description":"\u4ecb\u7d39azure\u96f2\u7aefcontainer\u8cc7\u6e90\u6642\uff0c\u4e26\u5206\u6790\u5982\u4f55\u9078\u64c7\u670d\u52d9\uff0c\u6700\u5f8c\u63d0\u4f9b\u81ea\u5df1\u4f7f\u7528\u4e0a\u9047\u5230\u7684\u554f\u984c\u53ca\u89e3\u6cd5","date":"2023-03-06T00:00:00.000Z","formattedDate":"March 6, 2023","tags":[{"label":"cloud","permalink":"/blog/tags/cloud"},{"label":"Azure","permalink":"/blog/tags/azure"}],"readingTime":5.715,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"Introduction and demo Azure container service","description":"\u4ecb\u7d39azure\u96f2\u7aefcontainer\u8cc7\u6e90\u6642\uff0c\u4e26\u5206\u6790\u5982\u4f55\u9078\u64c7\u670d\u52d9\uff0c\u6700\u5f8c\u63d0\u4f9b\u81ea\u5df1\u4f7f\u7528\u4e0a\u9047\u5230\u7684\u554f\u984c\u53ca\u89e3\u6cd5","authors":"suyuying","tags":["cloud","Azure"]},"prevItem":{"title":"Brief summary of Domain Hijacking vs DNS Poisoning","permalink":"/blog/2023/03/07/dns-pollution-hijack"},"nextItem":{"title":"docusaurus add gitcus comment system but meet giscus.app refused to connect.","permalink":"/blog/2023/03/03/Docusaurus/comment-in-docusaurus"}},"content":":::tip\\n\u5982\u679c\u63d0\u4f9b\u7684\u8cc7\u8a0a\u6709\u932f\uff0c\u8acb\u7528 comment \u7cfb\u7d71\u544a\u77e5\uff5e\\n:::\\n\\n## Basic demand\\n\\n:::info\\n\u9700\u6c42\uff1a 1.\u514d\u8cbb\u7684 server \u8ddf db\uff0c\u55ae\u7d14\u639b\u6d41\u91cf\u5f88\u5c0f\uff0c\u6c92\u6709\u904b\u7b97\u5bc6\u96c6\u8ddf\u5403\u8a18\u61b6\u9ad4\u7684\u7a0b\u5f0f\u3002 2.\u4f7f\u7528 CICD \u914d\u5408 container \u90e8\u7f72 \u7c21\u5316\u5e03\u7248\u6d41\u7a0b\\n\\n:::\\n\\nserver \u90e8\u5206\u514d\u8cbb\u6eff\u591a\u7684\uff0c\u4f46\u90fd 12 \u500b\u6708\u8a66\u7528\u5c45\u591a\uff0c\u6700\u5f8c\u5c31\u5148\u6311\u4e86 azure\uff0c\u4e4b\u5f8c\u6703\u88dc\u4e0a gcp \u3001 AWS\u3002\\n\\nps: [render](https://render.com/) \u5f8c\u4f86\u540c\u4e8b\u63a8\u85a6\uff0c\u9019\u500b\u662f\u514d\u8cbb\u7684\uff0c\u4e4b\u5f8c\u88dc CICD \u90e8\u7f72\u5230\u9019\u88e1\u7684\u65b9\u6cd5\uff01\\n\\ndb \u57fa\u672c\u4e0a\u5c31\u6c92\u6709\u4e86\uff0c\u514d\u8cbb\u7684\u6709 heroku clear db \u4e0d\u904e\u4ed6\u53ea\u6709 5MB \u53ef\u4ee5\u7528...... \u6240\u4ee5\u76ee\u524d\u9084\u662f\u4e56\u4e56\u7528 squlite \u5427\\n\\n\x3c!--truncate--\x3e\\n\\n\u8cc7\u6599\u6536\u96c6:\\n\\n1.\u4e09\u5bb6\u77e5\u540d\u7684\u96f2\u670d\u52d9\u5ee0\u5546\u90fd\u6709\u63d0\u4f9b\u514d\u8cbb\u984d\u5ea6\uff0c\u9019\u908a\u63d0\u4f9b azure \u65b9\u9762\u8cc7\u8a0a\\nhttps://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree\\n\\n2.\u56e0\u70ba\u76ee\u7684\u53ea\u662f\u8981\u55ae\u7368\u8981\u505a api server\uff0c\u6240\u4ee5\u5728 web app, VM,container-based app \u4e4b\u9593\u505a\u9078\u64c7\u3002\\n\u56e0\u70ba\u7121\u5176\u4ed6\u7528\u9014\uff0c\u6240\u4ee5\u4e0d\u8003\u616e VM\uff0c\u800c\u53c8\u8981\u7528\u5230 container \u6240\u4ee5\u6700\u5f8c\u6311 Deploy and run a container-based app \u88e1\u9762\\n\u63d0\u4f9b\u7684\u4e09\u7a2e\u670d\u52d9 Azure Kubernetes Service(AKS)\u3001Azure Container Instances(ACI)\u3001Azure Container Apps\\n\u518d\u505a\u9078\u64c7\u3002\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./azure-quick-start.png\\").default}\\n      alt=\\"azure-quick-start.png\\"\\n    />\\n  </div>\\n</>\\n\\nAzure \u5b98\u7db2\u4e5f\u6709\u63d0\u4f9b\u4e00\u500b[\u5224\u65b7\u6a39](https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree)\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./compute-choices.png\\").default}\\n      alt=\\"azure-quick-start.png\\"\\n    />\\n  </div>\\n</>\\n\\n## Azure container service\\n\\n\u57fa\u672c\u4e0a Azure \u96f2\u670d\u52d9\uff0c\u8ddf container \u6709\u95dc\u7684\u5c31\u662f Azure Container Instances,Azure Kubernetes Service,\\nAzure Container Apps\\n\\n### Azure Kubernetes Service(AKS)\\n\\nAKS \u57fa\u672c\u4e0a\u5c31\u662f\u8ddf azure \u79df\u591a\u53f0 VM(\u770b\u4f60\u7684 node \u6a39\uff09\uff0c\u7136\u5f8c\u4f7f\u7528 mastet node \u7ba1\u7406 node cluster\uff0c\u505a\u5230\u63d0\u9ad8 HA\uff0c\u4e5f\u9054\u5230\u63d0\u9ad8\u6a5f\u5668\u6548\u80fd\u4f7f\u7528\u7387\\n\\n:::info\\n\u4ee5\u5c0f\u578b\u7684\u5f8c\u7aef\u7a0b\u5f0f\u70ba\u4f8b\uff0c\u6574\u5957\u9700\u8981 mysql,redis,api \u670d\u52d9\uff0c\u5f8c\u53f0\u7d71\u8a08\u670d\u52d9 \u70ba\u80cc\u666f\\n:::\\n\\n#### K8s \u5143\u4ef6\u8aaa\u660e\\n\\nContainer\u3001Pod\u3001Node\u3002\\n\\nwhat is container?\\n\u901a\u5e38\u4e00\u500b\u529f\u80fd\u4e00\u500b container\uff08\u7576\u7136\u4f60\u8981\u5168\u786c\u585e\u540c\u500b\u4e5f\u53ef\u4ee5\uff0c\u4e0d\u904e\u4e0d\u5efa\u8b70\uff09\uff0c\u5982\u679c\u4f60\u4e0d\u7528 cloud db\uff0c\u90a3\u9ebc\u4ee5\u4e0a\u9762 info \u7684\u80cc\u666f\u60c5\u6cc1\uff0c\u6703\u6709 4 \u500b container\u3002\\n\\nWhat is pod in Kubernetes?\\n\u662f k8s \u6700\u5c0f\u57f7\u884c\u55ae\u4f4d\uff0c\u8209\u4f8b\u4f86\u8aaa\uff0c\u4f60\u7684\u6574\u5957\u670d\u52d9\u5171\u56db\u500b container \u4e0b\u4f86\u7b97\u662f\u4e00\u500b pod\u3002\\n\\nwhat is node in Kubernetes? \u4e00\u500b node \u4ee3\u8868\u4e00\u53f0 VM\\n\u7531 Worker Node \u8ddf Control Plane \u7d44\u6210\u3002\\nWorker Node(\u90e8\u7f72 pod \u7684 vm\uff0c\u5167\u90e8\u9084\u53ef\u7d30\u5206\u70ba kubelet\u3001kube-proxy \u53ca Container Runtime 3 \u500b\u5143\u4ef6\u3002)\\nControl Plane \u8ca0\u8cac\u5404\u500b Worker Node \u7684\u7ba1\u7406\\n\\nwhat is Kubernetes cluster?\\n\u56e0\u70ba\u9ad8\u53ef\u7528\u6027\u8ddf\u64f4\u5c55\u6703\u6709\u591a\u500b node\uff0c\u6240\u4ee5\u5c31\u6709\u4e86 cluster\u3002\\n\u7531 control panels \u8ddf nodes \u7d44\u6210\u3002\\n\\nAzure k8s?\\n\u76f4\u63a5\u5e6b\u4f60\u505a\u597d\u514d\u8cbb\u7684\u63a7\u5236\u5e73\u9762\u4e86\u3002\u4f46\u662f\u8981\u4ed8 VM \u7684\u9322\uff0c\u900f\u904e control plane \u7ba1\u7406 k8s cluster\u3002\\ncontrol plane \u4e0d\u7528\u4ed8\u9322\uff0c\u4f46\u6703\u5403 node \u7684\u8cc7\u6e90\u3002\\n\\n### Azure Container Instances(ACI)\\n\\nACI \u5c31\u662f\u500b\u96f2\u7aef container\uff0c\u62ff\u4f86\u57f7\u884c\u722c\u87f2\u4e4b\u985e\u7684\u7a0b\u5f0f\uff0c\u4ed6\u4e0d\u652f\u63f4\u64f4\u5c55\uff0c\u9644\u8f09\u5e73\u8861\u53ca\u6191\u8b49\u9a57\u8b49\u3002\\n\u57fa\u672c\u4e0a\u5275\u5b8c\uff0cAzure \u6703\u7d66\u4f60\u4e00\u7d44\u7684\u9023\u5165 ip\\n\\n### Azure Container Apps\\n\\n\u76f8\u8f03\u65bc ACI\uff0c\u63d0\u4f9b\u4e86 AutoScale,Https \u5165\u53e3\uff0c\u6191\u8b49\u4ee3\u7ba1\uff0c\u591a container \u5167\u90e8\u7db2\u8def\u6e9d\u901a\u7b49\uff0c\\n[\u8a73\u7d30\u529f\u7528\u9023\u7d50](https://learn.microsoft.com/en-us/azure/container-apps/overview)\\n\\n### MyChoice\\n\\n\u57fa\u672c\u4e0a\uff0c\u53ea\u6709\u4e00\u500b\u4e0d\u9700\u8981\u6548\u80fd\u7684\u670d\u52d9\uff0cAKS \u53ef\u4ee5\u76f4\u63a5\u780d\u6389\u3002\u56e0\u70ba\u662f api server\uff0c\u4e14\u50b3\u7684\u8cc7\u8a0a\u6709\u4e9b\u9700\u8981\u4fdd\u5bc6\u8cc7\u8a0a\uff0c\u6240\u4ee5\u9078\u7528\\nAzure Container Apps\u3002\\n\\n## Deployment\\n\\n### \u6559\u5b78\u7db2\u7ad9\\n\\n[\u5b98\u7db2\u6559\u5b78](https://learn.microsoft.com/en-us/azure/app-service/quickstart-custom-container?pivots=container-linux-vscode&WT.mc_id=UI-AQC&tabs=dotnet)\\n\\n\u57f7\u884c\u7684\u904e\u7a0b\u90fd\u662f\u4f9d\u64da\u6559\u5b78\uff0c\u4f46\u4e4b\u5f8c\u63db\u81ea\u5df1\u7684 Dockerfile \u6709\u9047\u5230\u72c0\u6cc1\uff0c\u6240\u4ee5\u8a18\u9304\u4e00\u4e0b\u9047\u5230\u7684\u554f\u984c\u3002\\n\\n### \u9047\u5230\u7684\u554f\u984c\\n\\n1. Container xxx didn\'t respond to HTTP pings on port: 8000, failing site start. See container logs for debugging.\\n\\n\u7db2\u4e0a\u67e5\u53ef\u80fd\u539f\u56e0\uff1a\\n\\n1. Use the EXPOSE instruction in your Dockerfile to expose port 3000.(not useful, azure will scan internally)\\n2. Use the WEBSITES_PORT app setting with a value of \\"3000\\" to expose that port.\\n\\n\u4ee5\u4e0a\u90fd\u4e0d\u884c\uff31\uff21\uff31\\n\\n\u6700\u5f8c\u767c\u73fe\u662f\u6a5f\u5668\u7684 CPU \u67b6\u69cb\u554f\u984c\uff0c\u56e0\u70ba\u662f m1 \u5e95\u4e0b\u5beb\u7684 code\uff0cdocker \u6703\u7528 arm build \u7248\uff0c\u4f46\u4e00 \ud83e\udd5a \u90e8\u7f72\u74b0\u5883\u662f azure \u7684 x86\uff0c\u5e95\u5c64\u4e0d\u540c\u670d\u52d9\u8d77\u4e0d\u4f86\\n\\n\u89e3\u6c7a\u65b9\u6cd5\uff1a\\n\u5c07\u539f\u672c Dockerfile\\n\\n```\\nFROM  python:3.11\\nWORKDIR /code\\nCOPY ./requirment.txt /code/requirements.txt\\nRUN pip install --no-cache-dir --upgrade -r /code/requirements.txt\\nRUN uname -a > /os.txt\\nCOPY ./sql_app /code/app\\nENV PORT 80\\nEXPOSE 80\\n\\n\\nENTRYPOINT [\\"uvicorn\\", \\"app.maingog:app\\", \\"--host\\", \\"0.0.0.0\\", \\"--port\\", \\"80\\"]\\n```\\n\\n\u4fee\u6539\u6210\\n\\n```\\nFROM --platform=$TARGETPLATFORM  python:3.11\\nWORKDIR /code\\nCOPY ./requirment.txt /code/requirements.txt\\nRUN pip install --no-cache-dir --upgrade -r /code/requirements.txt\\nRUN uname -a > /os.txt\\nCOPY ./sql_app /code/app\\nENV PORT 80\\nEXPOSE 80\\n\\n\\nENTRYPOINT [\\"uvicorn\\", \\"app.maingog:app\\", \\"--host\\", \\"0.0.0.0\\", \\"--port\\", \\"80\\"]\\n\\n```\\n\\n\u7136\u5f8c\u518d\u7528\u4ee5\u4e0b\u6307\u4ee4\u63a8\u5230 azure cotainer registry(\u8acb\u63db\u6210\u81ea\u5df1 acr \u7684\u6a23\u5b50)\\n\\n```\\ndocker buildx build . --platform linux/arm64,linux/amd64 -t fastapiserver.azurecr.io/fordserver/v1.9 --push\\n```\\n\\n\u4e4b\u5f8c\u4f7f\u7528\u9019\u500b image \u6642\uff0cdocker \u5167\u5efa\u5c31\u6703\u5e6b\u4f60\u5224\u65b7\u662f\u54ea\u500b\u7cfb\u7d71\uff0c\u4e26\u8d77\u670d\u52d9\uff01\\n\\n\u81f3\u65bc\uff0cbuildx \u8ddf--use \u8ddf context \u9019\u5e7e\u500b docker \u6307\u4ee4\u4e5f\u662f\u7b2c\u4e00\u6b21\u9047\u5230\uff0c\u5b8c\u5168\u4e0d\u719f\uff0c\u6240\u4ee5\u4e4b\u5f8c\u6703\u518d\u88dc\u4e0a\\n\\n### ACR \u63db git hub container\\n\\n\u56e0\u70ba\u7528 ACR \u8981\u9322\uff0c\u7136\u5f8c free plan \u4e5f\u4e0d\u7d66\u958b private registry\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528 github or gitlab\uff0c\\n\u56e0\u70ba\u6c92\u7279\u5225\u60f3\u7528 private\uff0c\u6240\u4ee5\u5c31\u7528 git hub \u5427\u3002"},{"id":"/2023/03/03/Docusaurus/comment-in-docusaurus","metadata":{"permalink":"/blog/2023/03/03/Docusaurus/comment-in-docusaurus","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-03-Docusaurus/comment-in-docusaurus.md","source":"@site/blog/2023-03-03-Docusaurus/comment-in-docusaurus.md","title":"docusaurus add gitcus comment system but meet giscus.app refused to connect.","description":"how to add comment system to docusaurus and problem giscus.app refused to connect.","date":"2023-03-03T00:00:00.000Z","formattedDate":"March 3, 2023","tags":[{"label":"docusaurus","permalink":"/blog/tags/docusaurus"},{"label":"comment system","permalink":"/blog/tags/comment-system"}],"readingTime":0.435,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"docusaurus add gitcus comment system but meet giscus.app refused to connect.","description":"how to add comment system to docusaurus and problem giscus.app refused to connect.","authors":"suyuying","tags":["docusaurus","comment system"]},"prevItem":{"title":"Introduction and demo Azure container service","permalink":"/blog/2023/03/06/azure/azure-cloud-container"},"nextItem":{"title":"markdown\u8a9e\u6cd5\u7d00\u9304","permalink":"/blog/2023/03/03/Docusaurus/md-form"}},"content":"\u5efa\u7acb\u904e\u7a0b\uff0c\u4ee5\u4e0b\u53ea\u63d0\u4f9b\u7576\u521d\u6642\u4f5c\u53c3\u8003\u7684\u7db2\u5740\uff0c\u4e26\u7d00\u9304\u904e\u7a0b\u9047\u5230\u7684\u554f\u984c\u3002\\n\\n:::info\\n\\n1.  [docs \u52a0 github discussion by giscus](https://dev.to/m19v/how-to-add-giscus-comments-to-docusaurus-439h)\\n\\n:::\\n\\n\x3c!--truncate--\x3e\\n\\n:::info\\n\\n1.  [blog \u52a0 disqus system by disqus](https://madrus4u.com/blog/blog-comments)\\n\\n:::\\n\\n:::danger\\n\\n    When meet giscus.app refused to connect:\\n    this is caused of the reason that setting domain name wrong.\\n    For example:\\n        https://suyuying.github.io./\\n        you will see giscus.app refused to connect.\\n    But if you change url to, than it will fine.\\n        https://suyuying.github.io\\n\\n:::"},{"id":"/2023/03/03/Docusaurus/md-form","metadata":{"permalink":"/blog/2023/03/03/Docusaurus/md-form","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-03-Docusaurus/md-form.md","source":"@site/blog/2023-03-03-Docusaurus/md-form.md","title":"markdown\u8a9e\u6cd5\u7d00\u9304","description":"demo\u5728Docusaurus\u5b98\u7db2\u770b\u5230\u7684md\u683c\u5f0f\u4f7f\u7528\u7bc4\u4f8b\uff0c\u7d66\u4e0d\u719f\u6089md\u8a9e\u6cd5\u7684\u4f7f\u7528\u8005\u67e5\u8a62\u683c\u5f0f\u7528","date":"2023-03-03T00:00:00.000Z","formattedDate":"March 3, 2023","tags":[{"label":"Markdown manual","permalink":"/blog/tags/markdown-manual"}],"readingTime":5.395,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"markdown\u8a9e\u6cd5\u7d00\u9304","description":"demo\u5728Docusaurus\u5b98\u7db2\u770b\u5230\u7684md\u683c\u5f0f\u4f7f\u7528\u7bc4\u4f8b\uff0c\u7d66\u4e0d\u719f\u6089md\u8a9e\u6cd5\u7684\u4f7f\u7528\u8005\u67e5\u8a62\u683c\u5f0f\u7528","authors":"suyuying","tags":["Markdown manual"],"comments":true},"prevItem":{"title":"docusaurus add gitcus comment system but meet giscus.app refused to connect.","permalink":"/blog/2023/03/03/Docusaurus/comment-in-docusaurus"},"nextItem":{"title":"\u5728docusaurus\u4f7f\u7528google font\u7684\u65b9\u6cd5","permalink":"/blog/2023/03/03/Docusaurus/use-google-font"}},"content":"import Tabs from \\"@theme/Tabs\\";\\nimport TabItem from \\"@theme/TabItem\\";\\nimport Highlight from \\"@site/src/components/Highlight\\";\\n\\n```\\n// how to import\\nimport Tabs from \\"@theme/Tabs\\";\\nimport TabItem from \\"@theme/TabItem\\";\\nimport Highlight from \\"@site/src/components/Highlight\\";\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n<Highlight color=\\"#25c2a0\\">Docusaurus green</Highlight> and <Highlight color=\\"#1877F2\\">\\nFacebook blue\\n</Highlight> are my favorite colors.\\n\\n\\n\\nI can write **Markdown** alongside my _JSX_!\\n\\n> Easy to maintain open source documentation websites.\\n>\\n> \u2014 Docusaurus\\n\\n```\\n\u4ee5\u4e0b\u70ba\u4e0a\u8ff0\u7528\u6cd5\u7684\u7a0b\u5f0f\u78bc\u3002\\n<Highlight color=\\"#25c2a0\\">Docusaurus green</Highlight> and <Highlight color=\\"#1877F2\\">\\nFacebook blue\\n</Highlight> are my favorite colors.\\n\\nI can write **Markdown** alongside my _JSX_!\\n\\n> Easy to maintain open source documentation websites.\\n>\\n> \u2014 Docusaurus\\n```\\n\\n### Details element example\\n\\n<details>\\n  <summary>Toggle me!</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n    <details>\\n      <summary>Nested toggle! Some surprise inside...</summary>\\n      <div>\ud83d\ude32\ud83d\ude32\ud83d\ude32\ud83d\ude32\ud83d\ude32</div>\\n    </details>\\n  </div>\\n</details>\\n\\n```\\n<details>\\n  <summary>Toggle me!</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n    <details>\\n      <summary>Nested toggle! Some surprise inside...</summary>\\n      <div>\ud83d\ude32\ud83d\ude32\ud83d\ude32\ud83d\ude32\ud83d\ude32</div>\\n    </details>\\n  </div>\\n</details>\\n```\\n\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./malta_street.jpeg\\").default}\\n      style={{ width: \\"50%\\" }}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n\\n```\\nhow to import img\\n<>\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./malta_street.jpeg\\").default}\\n      style={{ width: \\"50%\\" }}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n```\\n\\n### My Doc Section\\n\\nHello world message with some **bold** text, some _italic_ text, and a [link](https://www.yahoo.com)\\n\\n```\\n//demo bold text ,italic style and superlink\\nHello world message with some **bold** text, some _italic_ text, and a [link](https://www.yahoo.com)\\n```\\n\\n<Tabs>\\n  <TabItem value=\\"apple\\" label=\\"Apple\\" default>\\n    This is an apple \ud83c\udf4e\\n  </TabItem>\\n  <TabItem value=\\"orange\\" label=\\"Orange\\">\\n    This is an orange \ud83c\udf4a\\n  </TabItem>\\n  <TabItem value=\\"banana\\" label=\\"Banana\\">\\n    This is a banana \ud83c\udf4c\\n  </TabItem>\\n</Tabs>\\n\\n\x3c!-- \u4fdd\u5b58\u8cc7\u6599\u5230query string --\x3e\\n\\n<Tabs groupId=\\"current-os\\" queryString>\\n  <TabItem value=\\"android\\" label=\\"Android\\">\\n    Android\\n  </TabItem>\\n  <TabItem value=\\"ios\\" label=\\"iOS\\">\\n    iOS\\n  </TabItem>\\n</Tabs>\\n\\n```\\ndemo tabs and tabs bring query string\\n// here are just tabs\\n<Tabs>\\n  <TabItem value=\\"apple\\" label=\\"Apple\\" default>\\n    This is an apple \ud83c\udf4e\\n  </TabItem>\\n  <TabItem value=\\"orange\\" label=\\"Orange\\">\\n    This is an orange \ud83c\udf4a\\n  </TabItem>\\n  <TabItem value=\\"banana\\" label=\\"Banana\\">\\n    This is a banana \ud83c\udf4c\\n  </TabItem>\\n</Tabs>\\n\\n//here bring query string\\n<Tabs groupId=\\"current-os\\" queryString>\\n  <TabItem value=\\"android\\" label=\\"Android\\">\\n    Android\\n  </TabItem>\\n  <TabItem value=\\"ios\\" label=\\"iOS\\">\\n    iOS\\n  </TabItem>\\n</Tabs>\\n```\\n\\n```jsx title=\\"/src/components/HelloCodeTitle.js\\"\\nfunction HelloCodeTitle(props) {\\n  return <h1>Hello, {props.name}</h1>;\\n}\\n```\\n\\n````\\n```jsx title=\\"/src/components/HelloCodeTitle.js\\"\\nfunction HelloCodeTitle(props) {\\n  return <h1>Hello, {props.name}</h1>;\\n}\\n```\\n````\\n\\n```jsx {1,4-6,11}\\nimport React from \\"react\\";\\n\\nconst MyComponent = (props) => {\\n  if (props.isBar) {\\n    return <div>Bar</div>;\\n  }\\n\\n  return <div>Foo</div>;\\n};\\n\\nexport default MyComponent;\\n```\\n\\n````\\n```jsx {1,4-6,11}\\nimport React from \\"react\\";\\n\\nconst MyComponent = (props) => {\\n  if (props.isBar) {\\n    return <div>Bar</div>;\\n  }\\n\\n  return <div>Foo</div>;\\n};\\n\\nexport default MyComponent;\\n```\\n````\\n\\n```jsx live\\n// need install jsx live\\nfunction Clock(props) {\\n  const [date, setDate] = useState(new Date());\\n  useEffect(() => {\\n    const timerID = setInterval(() => tick(), 1000);\\n\\n    return function cleanup() {\\n      clearInterval(timerID);\\n    };\\n  });\\n\\n  function tick() {\\n    setDate(new Date());\\n  }\\n\\n  return (\\n    <div>\\n      <h2>It is {date.toLocaleTimeString()}.</h2>\\n    </div>\\n  );\\n}\\n```\\n\\n````\\n```jsx live\\n// need install jsx live\\nfunction Clock(props) {\\n  const [date, setDate] = useState(new Date());\\n  useEffect(() => {\\n    const timerID = setInterval(() => tick(), 1000);\\n\\n    return function cleanup() {\\n      clearInterval(timerID);\\n    };\\n  });\\n\\n  function tick() {\\n    setDate(new Date());\\n  }\\n\\n  return (\\n    <div>\\n      <h2>It is {date.toLocaleTimeString()}.</h2>\\n    </div>\\n  );\\n}\\n```\\n````\\n\\n\x3c!-- Prettier changes this --\x3e\\n\\n:::note\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::tip\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::info\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::caution\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::danger\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n```\\n\\n:::note\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::tip\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::info\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::caution\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::danger\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n```\\n\\n[Download this docx using Markdown](./DONe.json)\\n\\n```\\n[Download this docx using Markdown](./DONe.json)\\n```\\n\\n<ul>\\n  {Object.entries(frontMatter).map(([key, value]) => (\\n    <li key={key}>\\n      <b>{key}</b>: {value}\\n    </li>\\n  ))}\\n</ul>\\n\\n```\\n// how to get build in object attributes\\n<ul>\\n  {Object.entries(frontMatter).map(([key, value]) => (\\n    <li key={key}>\\n      <b>{key}</b>: {value}\\n    </li>\\n  ))}\\n</ul>\\n```\\n\\n<>\\n\\n<ol>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex max-h-[24px]  w-full max-w-[24px]  items-center justify-center rounded-full text-base  text-white\\"\\n    >\\n      1\\n    </span>\\n    Lorem ipsum dolor sit amet\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      2\\n    </span>\\n    It is a long established fact reader\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      3\\n    </span>\\n    The point of using Lorem Ipsum\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      4\\n    </span>\\n    There are many variations of passages\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      5\\n    </span>\\n    If you are going to use a of Lorem\\n  </li>\\n</ol>\\n</>\\n\\n```\\n<>\\n\\n<ol>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex max-h-[24px]  w-full max-w-[24px]  items-center justify-center rounded-full text-base  text-white\\"\\n    >\\n      1\\n    </span>\\n    Lorem ipsum dolor sit amet\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      2\\n    </span>\\n    It is a long established fact reader\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      3\\n    </span>\\n    The point of using Lorem Ipsum\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      4\\n    </span>\\n    There are many variations of passages\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      5\\n    </span>\\n    If you are going to use a of Lorem\\n  </li>\\n</ol>\\n</>\\n```\\n\\nactions/checkout@v3 \u53c3\u6578\u7bc7\\n\\n- `ref`\uff1a\u8981\u6aa2\u51fa\u7684\u5206\u652f\u3001\u6a19\u7c64\u6216\u63d0\u4ea4 ID\u3002\\n- `repository`\uff1a\u8981\u6aa2\u51fa\u7684\u5132\u5b58\u5eab\u540d\u7a31\u3002\\n- `submodules`\uff1a\u662f\u5426\u6aa2\u51fa\u5b50\u6a21\u7d44\u3002\\n- `ssh-key`\uff1a\u7528\u65bc\u5f9e\u5132\u5b58\u5eab\u7372\u53d6\u7a0b\u5f0f\u78bc\u7684 SSH \u91d1\u9470\u3002\\n- `persist-credentials`\uff1a\u662f\u5426\u5728\u6301\u4e45\u5316\u5de5\u4f5c\u5340\u6642\u4fdd\u5b58 GITHUB_TOKEN \u548c SSH_AUTH_SOCK \u74b0\u5883\u8b8a\u6578\u3002\\n- `fetch-depth`\uff1a\u8981\u6aa2\u51fa\u7684\u63d0\u4ea4\u6578\u91cf\u3002\\n- `lfs`\uff1a\u662f\u5426\u4e0b\u8f09 Git LFS \u6587\u4ef6\u3002\\n- `clean`\uff1a\u662f\u5426\u5728\u6aa2\u51fa\u524d\u904b\u884c `git clean`\u3002\\n- `workspace`\uff1a\u6aa2\u51fa\u7684\u5132\u5b58\u5eab\u7684\u76ee\u9304\u3002"},{"id":"/2023/03/03/Docusaurus/use-google-font","metadata":{"permalink":"/blog/2023/03/03/Docusaurus/use-google-font","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-03-Docusaurus/use-google-font.md","source":"@site/blog/2023-03-03-Docusaurus/use-google-font.md","title":"\u5728docusaurus\u4f7f\u7528google font\u7684\u65b9\u6cd5","description":"\u6574\u7406\u7db2\u8def\u63d0\u4f9b\u7684\u4f7f\u7528google font\u65b9\u6cd5\uff0c\u6700\u5f8c\u662f\u63a1\u7528\u4e00\u822ccss import\u7684\u65b9\u6cd5","date":"2023-03-03T00:00:00.000Z","formattedDate":"March 3, 2023","tags":[{"label":"css","permalink":"/blog/tags/css"},{"label":"google font","permalink":"/blog/tags/google-font"}],"readingTime":1.885,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"\u5728docusaurus\u4f7f\u7528google font\u7684\u65b9\u6cd5","description":"\u6574\u7406\u7db2\u8def\u63d0\u4f9b\u7684\u4f7f\u7528google font\u65b9\u6cd5\uff0c\u6700\u5f8c\u662f\u63a1\u7528\u4e00\u822ccss import\u7684\u65b9\u6cd5","authors":"suyuying","tags":["css","google font"]},"prevItem":{"title":"markdown\u8a9e\u6cd5\u7d00\u9304","permalink":"/blog/2023/03/03/Docusaurus/md-form"},"nextItem":{"title":"\u5c07\u9060\u7aef\u5206\u679d\u9000\u7248\u65b9\u6cd5","permalink":"/blog/2023/03/02/git/reset-git-origin-branch"}},"content":"## \u4e00\u3001\u4e00\u822c css import\\n\\n### 1.\u5728 html head import\\n\\n```\\n\\n<head>\\n<link rel=\\"stylesheet\\" href=\\"https://fonts.googleapis.com/css?family=Sofia\\">\\n<style>\\nbody {\\n  font-family: \\"Sofia\\", sans-serif;\\n}\\n</style>\\n</head>\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n### 2.\u5728 css import\\n\\n```jsx title=\\"scr/css/custom.css\\"\\n@import url(\\"https://fonts.googleapis.com/css2?family=Caveat:wght@500&display=swap\\");\\n// css\u9078\u64c7\u5668\u9078\u4f7f\u7528\u7bc4\u570d\\n  nav .navbar__items {\\n    font-size: 30px;\\n    font-family: Caveat;\\n  }\\n\\n//\u5982\u679c\u591a\u500bfont import\\n@import url(\\"https://fonts.googleapis.com/css2?family=Caveat:wght@500&display=swap\\");\\n@import url(\\"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap\\");\\n\\n// css \u9078\u64c7\u6a19\u793a\u7528\u9017\u865f\u5206\u9694\\nhtml {\\n  font-family: Noto Sans TC, sans-serif;\\n}\\n```\\n\\n## \u4e8c\u3001\u5728 docusaurus \u4f7f\u7528\\n\\n### 1.\u5728 html head import\\n\\n\u9019\u500b\u65b9\u6cd5\u76f8\u7576\u65bc\u4e00\u822c css \u4f7f\u7528\u5728 head \u6253 link\uff0c\u53ea\u662f\u5beb\u5728\u8a2d\u5b9a\u6a94\u5167\uff0c\u6703\u65bc<highlight color=\\"#1877F2\\">\u7de8\u8b6f\u5f8c</highlight>\u7522\u751f\u5728 index.html \u7684 head \u88e1\u9762\\n\\n```\\n<link rel=\\"stylesheet\\" href=\\"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&amp;display=swap\\">\\n```\\n\\n```jsx title=\\"docusaurus.config.js\\"\\n        theme: {\\n          customCss: require.resolve(\\"./src/css/custom.css\\"),\\n        },\\n      },\\n    ],\\n  ],\\n  stylesheets: [\\n    {\\n      rel: \\"preconnect\\",\\n      href: \\"https://fonts.googleapis.com\\",\\n    },\\n    {\\n      rel: \\"preconnect\\",\\n      href: \\"https://fonts.gstatic.com\\",\\n      crossorigin: \\"anonymous\\",\\n    },\\n    {\\n      rel: \\"stylesheet\\",\\n      href: \\"https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap\\",\\n    },\\n  ],\\n```\\n\\n### 2.\u5728 css import\\n\\n\u505a\u6cd5\u540c\u4e00\u822c css import\\n\\n```jsx title=\\"scr/css/custom.css\\"\\n@import url(\\"https://fonts.googleapis.com/css2?family=Caveat:wght@500&display=swap\\");\\n// css\u9078\u64c7\u5668\u9078\u4f7f\u7528\u7bc4\u570d\\n  nav .navbar__items {\\n    font-size: 30px;\\n    font-family: Caveat;\\n  }\\n\\n//\u5982\u679c\u591a\u500bfont import\\n@import url(\\"https://fonts.googleapis.com/css2?family=Caveat:wght@500&display=swap\\");\\n@import url(\\"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap\\");\\n\\n// css \u9078\u64c7\u6a19\u793a\u7528\u9017\u865f\u5206\u9694\\nhtml {\\n  font-family: Noto Sans TC, sans-serif;\\n}\\n```\\n\\n## \u4e09\u3001\u6bd4\u8f03\u5169\u7a2e\u65b9\u6cd5\u5dee\u7570\\n\\n<>\\n\\n<p>\u4e00\u822ccss import</p>\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./incss.png\\").default}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n<>\\n\\n<p>link import</p>\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./inlink1.png\\").default}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n\\n:::tip\\n\\n\u5beb\u6cd5\u4e0a\u4f86\u8aaa\uff0c\u76f4\u63a5\u5728 custom css import \u6bd4\u8f03\u65b9\u4fbf\u7684\uff0c\u50b3\u9001\u7684\u5927\u5c0f\u8ddf\u6642\u9593\u4e5f\u662f\u6c92\u5565\u5dee\uff0c\\n\u6240\u4ee5\u76ee\u524d\u90fd\u7528 css import \u7684\u65b9\u6cd5\u3002\u6709\u5beb\u932f\u9ebb\u7169\u6307\u6b63\uff5e\\n\\n:::\\n\\n## \u56db\u3001 \u53c3\u8003\u8cc7\u6599\\n\\n:::info\\n\\n\u53c3\u8003\u8cc7\u6599\uff1a\\n\\n1.[\u4ee5\u6b63\u78ba\u7684\u59ff\u52e2\u4f7f\u7528 Google Fonts](https://ouch1978.github.io/docs/docusaurus/customization/use-google-fonts-with-correct-way)\\n\\n2.[\u80cc\u666f\u5716\u6848\u53ca\u5b57\u9ad4\u8a2d\u5b9a](https://from8to8.com/diary/lastestposts-font/)\\n\\n3.[How to customize the styling of the Docusaurus Classic Theme](https://theochu.com/docusaurus/styling/#custom-fonts)\\n:::"},{"id":"/2023/03/02/git/reset-git-origin-branch","metadata":{"permalink":"/blog/2023/03/02/git/reset-git-origin-branch","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/2023-03-02-git/reset-git-origin-branch.md","source":"@site/blog/2023-03-02-git/reset-git-origin-branch.md","title":"\u5c07\u9060\u7aef\u5206\u679d\u9000\u7248\u65b9\u6cd5","description":"\u5728local\u7aef\u767c\u73febuild\u5b8c\u6771\u897ffail\uff0c\u4f46\u662f\u5df2\u7d93\u63a8\u5230main branch\u4e86\uff0c\u6240\u4ee5\u57f7\u884c\u9060\u7aefregistry\u9000\u7248","date":"2023-03-02T00:00:00.000Z","formattedDate":"March 2, 2023","tags":[{"label":"git","permalink":"/blog/tags/git"}],"readingTime":0.64,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"\u5c07\u9060\u7aef\u5206\u679d\u9000\u7248\u65b9\u6cd5","description":"\u5728local\u7aef\u767c\u73febuild\u5b8c\u6771\u897ffail\uff0c\u4f46\u662f\u5df2\u7d93\u63a8\u5230main branch\u4e86\uff0c\u6240\u4ee5\u57f7\u884c\u9060\u7aefregistry\u9000\u7248","authors":"suyuying","tags":["git"]},"prevItem":{"title":"\u5728docusaurus\u4f7f\u7528google font\u7684\u65b9\u6cd5","permalink":"/blog/2023/03/03/Docusaurus/use-google-font"}},"content":"\u9700\u8981\u4f7f\u7528 git push --force,\u57fa\u672c\u4e0a main branch \u90fd\u6703\u662f\u4fdd\u8b77\u7684\uff0c\\n\u4e5f\u53ef\u4ee5\u8003\u616e\u7528 pull request \u5148\u9032\u884c\u6e2c\u8a66(\u4e0d\u80fd\u81ea\u5df1\u767c pull request \u81ea\u5df1\u5be9)\uff0c\u904e\u4e86\u518d merge\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n```\\ngit checkout master\\ngit reset --hard e3f1e37\\ngit push --force origin master\\n# Then to prove it (it won\'t print any diff)\\ngit diff master..origin/master\\n```\\n\\n```\\npull request\\nsettings -> branches->Branch protection rules\\n// if you just want to try merger just choose\\nRequire status checks to pass before merging\\n// if you choose Require a pull request before merging\\n// will get error Pull request authors cannot approve their own pull requests!\\n\\n```\\n\\n[\u53c3\u8003\u7db2\u5740](https://stackoverflow.com/questions/17667023/git-how-to-reset-origin-master-to-a-commit)"}]}')}}]);