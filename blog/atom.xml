<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://suyuying.github.io/blog</id>
    <title>Zaxro Blog Blog</title>
    <updated>2023-04-24T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://suyuying.github.io/blog"/>
    <subtitle>Zaxro Blog Blog</subtitle>
    <icon>https://suyuying.github.io/img/githubLogoV1.svg</icon>
    <entry>
        <title type="html"><![CDATA[use git submodule in gitlab CI to do ssl-check]]></title>
        <id>https://suyuying.github.io/blog/2023/04/24/gitlab-action/use-git-submodule-in-gitlab-ci</id>
        <link href="https://suyuying.github.io/blog/2023/04/24/gitlab-action/use-git-submodule-in-gitlab-ci"/>
        <updated>2023-04-24T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[提供檢查證書到期的程式,以及相關gitlab CI設定.在自己另外寫檢查證書到期的程式時,就想辦法去改善這個可讀性的問題,因此發現 git submodule 是一個不錯的處理方式.過程想法如下1. 透過 gitlab CI,在檢測程式的 repo,透過 git submodule 抓取主 repo 的域名檔案,並用程式檢查.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-git-submodule">what is git submodule<a href="#what-is-git-submodule" class="hash-link" aria-label="Direct link to what is git submodule" title="Direct link to what is git submodule">​</a></h2><p>將一個 Git 存儲庫作為另一個存儲庫的子模組進行管理。也就是說可以在一個 git repo 底下,同時管理多個 git repo,可以在主代碼庫中輕鬆地管理和更新子模組. 詳細的介紹可以看- <a href="https://blog.kennycoder.io/2020/06/14/Git-submodule-%E4%BD%BF%E7%94%A8%E6%95%99%E5%AD%B8/" target="_blank" rel="noopener noreferrer">Git - submodule 使用教學</a> ！</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="when-to-use">when to use<a href="#when-to-use" class="hash-link" aria-label="Direct link to when to use" title="Direct link to when to use">​</a></h3><p>我在工作上遇到的情況是有一個日常維護的主 repo,其中有一隻管理域名的檔案需要程式定期去 review 看域名跟憑證多久到期.目前方法是透過建立一個 git repo 內含有檢查域名的程式,建立 build image 的 CI,每當程市有改動會把程式打包做成 image.然後在主 repo 那邊則會拉取該 image 去做域名的檢查.過程如下:</p><ol><li>子 repo 更新程式並 CI 建立 image</li><li>使用步驟 1 建立的新 image,於主 repo 透過 CI 定時使用最新的 image 執行程式檢查.</li></ol><p>這個方式沒啥問題,只是對於一些新人或初次看到這個架構的人而言,會覺得串這兩層很複雜.</p><p>所以後來我在自己另外寫檢查證書到期的程式時,就想辦法去改善這個可讀性的問題,因此發現 git submodule 是一個不錯的處理方式.
過程想法如下</p><ol><li>透過 CI,在檢測程式的 repo,透過 git submodule 抓取主 repo 的域名檔案,並用程式檢查.</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="steps">steps<a href="#steps" class="hash-link" aria-label="Direct link to steps" title="Direct link to steps">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1-在程式-repo-先-git-submodule-抓-主檔案-repo">1. 在程式 repo 先 git submodule 抓 主檔案 repo<a href="#1-在程式-repo-先-git-submodule-抓-主檔案-repo" class="hash-link" aria-label="Direct link to 1. 在程式 repo 先 git submodule 抓 主檔案 repo" title="Direct link to 1. 在程式 repo 先 git submodule 抓 主檔案 repo">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">#git submodule add &lt;remote repository&gt; &lt;local path&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git submodule add git@gitlab.dongg.com:it/office_sop.git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2-修改gitmodules改用相對位置">2. 修改.gitmodules,改用相對位置<a href="#2-修改gitmodules改用相對位置" class="hash-link" aria-label="Direct link to 2. 修改.gitmodules,改用相對位置" title="Direct link to 2. 修改.gitmodules,改用相對位置">​</a></h3><p>不改會報錯 Docker: error cannot run ssh: No such file or directory,因為用相對位置,這邊也提供我 repo 網址方便比對.網址: <a href="mailto:git@gitlab.dongg.com" target="_blank" rel="noopener noreferrer">git@gitlab.dongg.com</a>:ford/domanininfocheck.git</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.gitmodules"</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">submodule </span><span class="token string" style="color:#e3116c">"office_sop"</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    path </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> office_sop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token punctuation" style="color:#393A34">.</span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">it</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">office_sop</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">git</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="3-建立-ci">3. 建立 CI<a href="#3-建立-ci" class="hash-link" aria-label="Direct link to 3. 建立 CI" title="Direct link to 3. 建立 CI">​</a></h3><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.gitlab-ci.yml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">stages</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">variables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token constant" style="color:#36acaa">TZ</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Asia</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">Taipei</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">runCodeToTg</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">stage</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">image</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> python</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">3.9</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">slim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">variables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">GIT_SUBMODULE_FORCE_HTTPS</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"true"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">GIT_SUBMODULE_UPDATE_FLAGS</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">remote</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">GIT_SUBMODULE_STRATEGY</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> recursive</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">GIT_SUBMODULE_DEPTH</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">only</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> schedules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> web</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">tags</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> pip install </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">no</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">cache</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">dir </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">r </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">requirement</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">txt</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> python3 main</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">py</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> ls office_sop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> cd office_sop</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 這是我程式段執行錯誤會報錯的log</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">透過artifacts可以拿到資料</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">artifacts</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">paths</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> domain</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">err</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">log</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>這裡面最重要的是這四個變數</p><ul><li>GIT_SUBMODULE_FORCE_HTTPS: "true" ,將子模組的 URL 強制設置為 HTTPS</li><li>GIT_SUBMODULE_UPDATE_FLAGS: --remote,使用遠程跟踪分支更新子模組。這將會拉取遠程存儲庫中子模組的最新版本,不加這段你會發現你拉到的都是當初 git submodule add 的 commit 號</li><li>GIT_SUBMODULE_STRATEGY: recursive,當更新子模組時，使用遞歸策略，即遞歸地更新所有子模組的子模組。</li><li>GIT_SUBMODULE_DEPTH: 1,限制子模組更新的深度。</li></ul><p>主要是注意 <span style="background-color:#25c2a0;border-radius:20px;color:#fff;padding:6px;cursor:pointer">GIT_SUBMODULE_UPDATE_FLAGS</span> 最好要設定,不加這段你會發現你拉到的都是當初 git commit 號.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="4git-pushdone">4.git push,DONe.<a href="#4git-pushdone" class="hash-link" aria-label="Direct link to 4.git push,DONe." title="Direct link to 4.git push,DONe.">​</a></h3><h2 class="anchor anchorWithStickyNavbar_LWe7" id="檢查證書到期主程式碼">檢查證書到期主程式碼<a href="#檢查證書到期主程式碼" class="hash-link" aria-label="Direct link to 檢查證書到期主程式碼" title="Direct link to 檢查證書到期主程式碼">​</a></h2><p>檢測證書到期的程式碼,參考自<a href="https://gist.github.com/gdamjan/55a8b9eec6cf7b771f92021d93b87b2c" target="_blank" rel="noopener noreferrer">gdamjan</a></p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>檢測證書到期的程式碼</summary><div><div class="collapsibleContent_i85q"><div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">main.py</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> utf</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">8</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">*</span><span class="token operator" style="color:#393A34">-</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># requires a recent enough python </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> idna support </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> socket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># pyopenssl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> cryptography and idna</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">requests</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> loguru </span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">logger</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> datetime </span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">datetime</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> datetime </span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">timedelta</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token maybe-class-name">OpenSSL</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">SSL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> cryptography </span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">x509</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> cryptography</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">oid</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token maybe-class-name">NameOID</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> idna</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> concurrent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">futures</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> socket </span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports">socket</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> collections </span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> namedtuple</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> re</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> sys</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 主程式是執行get_certificate 取得domain相關資訊，之後把資訊印出（串print_basic_info）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># </span><span class="token function" style="color:#d73a49">print_basic_info會去執行get_alt_names</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">SAN</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'*.don99.com'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'don87.com'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 執行get_common_name 取得 commonName</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">don99</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 執行get_issuer取得憑證發行商</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 憑證有關資訊的取得，都是透過get_certificate使用idna socket </span><span class="token constant" style="color:#36acaa">SSL</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># （這邊</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain">跟區域變數命名是採用 _區隔，全癒採用駝峰，然後</span><span class="token keyword" style="color:#00009f">function</span><span class="token plain">的params被帶入時，前面</span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain">有對到</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 已知報錯，如果沒有二級域名 ex</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">don3nm</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token plain"> 會報錯 idna</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">core</span><span class="token punctuation" style="color:#393A34">.</span><span class="token known-class-name class-name">IDNAError</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Empty</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Label</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">idna編碼錯誤）</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果網址沒有dns record，socket連接會報錯 socket</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">gaierror</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token maybe-class-name">Errno</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">8</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> nodename nor servname provided</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> or not known</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 做named tuple</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token maybe-class-name">HostInfo</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">namedtuple</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">field_names</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'cert hostname peername'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> typename</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'HostInfo'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">verify_cert</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cert</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hostname</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # verify notAfter</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">notBefore</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">CA</span><span class="token plain"> trusted</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> servername</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">sni</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">hostname</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">has_expired</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # service_identity</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">pyopenssl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">verify_hostname</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">client_ssl</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hostname</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # issuer</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">get_certificate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> port</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hostname_idna </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> idna</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">encode</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sock </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">socket</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">connect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> port</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        peername </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">getpeername</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctx </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">SSL</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">Context</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">SSL</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">SSLv23_METHOD</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">  # most compatible</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">check_hostname</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token maybe-class-name">False</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ctx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">verify_mode</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">SSL</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">VERIFY_NONE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sock_ssl </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">SSL</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">Connection</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ctx</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sock</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sock_ssl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">set_connect_state</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sock_ssl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">set_tlsext_host_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostname_idna</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sock_ssl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">do_handshake</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cert </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> sock_ssl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get_peer_certificate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        crypto_cert </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">to_cryptography</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sock_ssl</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        sock</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">HostInfo</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cert</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">crypto_cert</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> peername</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">peername</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> hostname</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    except </span><span class="token maybe-class-name">Exception</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">err</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">telegram_bot_sendtext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token string" style="color:#e3116c">"{hostname} wrong with the form or DNS Record, go cheeck"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 用dict也可以，不過named tuple可以讓固定資料（你的key早固定了）存取的場景下，讓code更易讀</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">get_alt_names</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cert</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        ext </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">extensions</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get_extension_for_class</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">SubjectAlternativeName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> ext</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get_values_for_type</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">DNSName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    except x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ExtensionNotFound</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">e</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">get_common_name</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cert</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        names </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">subject</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get_attributes_for_oid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">NameOID</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">COMMON_NAME</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token function maybe-class-name" style="color:#d73a49">NameAttribute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oid</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token function maybe-class-name" style="color:#d73a49">ObjectIdentifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oid</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2.5</span><span class="token number" style="color:#36acaa">.4</span><span class="token number" style="color:#36acaa">.3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">commonName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'ls.don3bn.com'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> names</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    except x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ExtensionNotFound</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">e</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">get_issuer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">cert</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        names </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">issuer</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">get_attributes_for_oid</span><span class="token punctuation" style="color:#393A34">(</span><span class="token maybe-class-name">NameOID</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">COMMON_NAME</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token function maybe-class-name" style="color:#d73a49">NameAttribute</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oid</span><span class="token operator" style="color:#393A34">=</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token function maybe-class-name" style="color:#d73a49">ObjectIdentifier</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">oid</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">2.5</span><span class="token number" style="color:#36acaa">.4</span><span class="token number" style="color:#36acaa">.3</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">commonName</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> value</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'R3'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> names</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">value</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    except x509</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ExtensionNotFound</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">e</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token keyword control-flow" style="color:#00009f">catch</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">print_basic_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostinfo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    vaild_days </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> hostinfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cert</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">not_valid_after</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> datetime</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">today</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">vaild_days</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> vaild_days </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">timedelta</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">days</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> and vaild_days </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">timedelta</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">days</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">10</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token string" style="color:#e3116c">"{hostinfo.hostname} Need check"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token string" style="color:#e3116c">"{hostinfo.hostname} Need check, left {vaild_days}"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        hostname</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">hostinfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">hostname</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        peername</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">hostinfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">peername</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token constant" style="color:#36acaa">SAN</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">get_alt_names</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostinfo</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">cert</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        # f</span><span class="token string" style="color:#e3116c">"{hostinfo.hostname} Need check, left {vaild_days}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        s</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">f</span><span class="token string" style="color:#e3116c">"» {hostname} « … {peername} SAN: {SAN} {hostinfo.hostname} Need check, left {vaild_days}"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">telegram_bot_sendtext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">s</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">check_it_out</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> port</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    hostinfo </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_certificate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostname</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> port</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">print_basic_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostinfo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">only_level</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">level</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    def </span><span class="token function" style="color:#d73a49">is_level</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">record</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> record</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">'level'</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> level</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> is_level</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">open_domain_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"./office_sop/domains-info.md"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"r"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> encoding</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"utf-8"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">f</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            domain_info </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">readlines</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> domain_info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    except </span><span class="token maybe-class-name">Exception</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">e</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token maybe-class-name">None</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def </span><span class="token function" style="color:#d73a49">telegram_bot_sendtext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">bot_message</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bot_token </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'secret'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    bot_chatid </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'secret'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apiURL </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> f</span><span class="token string" style="color:#e3116c">'https://api.telegram.org/bot{bot_token}/sendMessage'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        response </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> requests</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">post</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">apiURL</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> json</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">{</span><span class="token string-property property" style="color:#36acaa">'chat_id'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> bot_chatid</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">'text'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> bot_message</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">timeout</span><span class="token operator" style="color:#393A34">=</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">61</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">61</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        time</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">sleep</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    except </span><span class="token maybe-class-name">Exception</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">e</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">e</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> response</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">json</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> __name__ </span><span class="token operator" style="color:#393A34">==</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'__main__'</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'domain.err.log'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> level</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'ERROR'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filter</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">only_level</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'ERROR'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> compression</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"gz"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rotation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"500MB"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">add</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'domain.out.log'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> level</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'INFO'</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> filter</span><span class="token operator" style="color:#393A34">=</span><span class="token function" style="color:#d73a49">only_level</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'INFO'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> compression</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"gz"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> rotation</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"500MB"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    patten </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">compile</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">r</span><span class="token string" style="color:#e3116c">"((?=[a-z0-9-]{1,63}\.)[a-z0-9]+(-[a-z0-9]+)*\.)+[a-z]{2,63}"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> flags</span><span class="token operator" style="color:#393A34">=</span><span class="token plain">re</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">M</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    domain_info_lines </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">open_domain_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">try</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">telegram_bot_sendtext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"check domain_info start"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'"check domain_info start"'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> each_line </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">domain_info_lines</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            # 每行以</span><span class="token operator" style="color:#393A34">|</span><span class="token plain">區分，又做成list</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token literal-property property" style="color:#36acaa">word_seperate_list</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> list </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> each_line</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'|'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            # 因為會有很多空行會只有一個元素\n，要篩出表格理論上元素要有</span><span class="token number" style="color:#36acaa">4</span><span class="token plain">個以上</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">len</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">word_seperate_list</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4</span><span class="token plain"> and patten</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">search</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">word_seperate_list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                domain </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> word_seperate_list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">2</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                # </span><span class="token function" style="color:#d73a49">如果available是空的就跳過，這邊用strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> 是因為有\t在不會是False</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> not word_seperate_list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword control-flow" style="color:#00009f">continue</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token constant" style="color:#36acaa">HOSTS</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">f</span><span class="token string" style="color:#e3116c">"{c.strip()}.{domain}"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">443</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> c </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> word_seperate_list</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">3</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">split</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">','</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> c</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">strip</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token function" style="color:#d73a49">print</span><span class="token punctuation" style="color:#393A34">(</span><span class="token constant" style="color:#36acaa">HOSTS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                # concurrent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">futures</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">ThreadPoolExecutor</span><span class="token plain"> 是python 多執行序實作，會用worker數量產生Executor</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> concurrent</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">futures</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access maybe-class-name" style="color:#d73a49">ThreadPoolExecutor</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">max_workers</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">4</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">e</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    # </span><span class="token maybe-class-name">Executors</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">的相關方法，map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">func</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">*</span><span class="token plain">iterables</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">，執行可迭代物件 ex list tuple named tuple</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    # 其實就是把可迭代物件的元素一個個拆開喂給Executor，提升程式執行速度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> hostinfo </span><span class="token keyword" style="color:#00009f">in</span><span class="token plain"> e</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">lambda x</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">get_certificate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> x</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">HOSTS</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token function" style="color:#d73a49">print_basic_info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">hostinfo</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">telegram_bot_sendtext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"check domain_info DONe"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">info</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'check domain_info DONe'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    except </span><span class="token maybe-class-name">Exception</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">err</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">exception</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">err</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">telegram_bot_sendtext</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">'there are something unexcept wrong, go cheeck error logs'</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資料:</p><ul><li><a href="https://gist.github.com/gdamjan/55a8b9eec6cf7b771f92021d93b87b2c" target="_blank" rel="noopener noreferrer">gdamjan ssl-check.py</a></li><li><a href="https://blog.kennycoder.io/2020/06/14/Git-submodule-%E4%BD%BF%E7%94%A8%E6%95%99%E5%AD%B8/" target="_blank" rel="noopener noreferrer">Git - submodule 使用教學</a></li></ul></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="gitlab CI/CD" term="gitlab CI/CD"/>
        <category label="CICD" term="CICD"/>
        <category label="git submodule" term="git submodule"/>
        <category label="ssl-check" term="ssl-check"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Quick sort algorithm in Python]]></title>
        <id>https://suyuying.github.io/blog/2023/04/23/Python/algorithm/Quick-sort</id>
        <link href="https://suyuying.github.io/blog/2023/04/23/Python/algorithm/Quick-sort"/>
        <updated>2023-04-23T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[這個程式碼主要拿來排序序列,目前理解就是序列 ex.[1, 2, 4, 6, 6, 7] 會被先進行二分(mid=n//2),並取[:mid]跟[mid:]做處理,而首先,[:mid]遞迴多次這個過程,直到拆解到無法拆解,所以可以想見這時候拆成很多個小 list,之後他會使用 merge 一層層往上組,直到[:mid]排序完成.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="code">code<a href="#code" class="hash-link" aria-label="Direct link to code" title="Direct link to code">​</a></h2><p>平常寫 code 時候,不會去想序列排列底層的事情,因緣際會下,就學一學吧,以下 code 是跟 AI 學習的,能用 python 這樣在同一個 function 內執行同一個 function,這個事情是真的沒想過,另外整個程式執行過程,他執行的順序,也是很大學習重點!</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">## 快速排列演算法練習</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import logging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 設定 logger 物件的名稱、等級、訊息格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logger = logging.getLogger(__name__)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logger.setLevel(logging.DEBUG)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">formatter = logging.Formatter('%(asctime)s - %(name)s - %(levelname)s - %(message)s')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 設定輸出到控制台的 handler</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console_handler = logging.StreamHandler()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console_handler.setLevel(logging.INFO)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">console_handler.setFormatter(formatter)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">logger.addHandler(console_handler)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#二分法往下排序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def merge_sort(arr):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    logger.info(f"此次處理陣列為{arr}")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    n = len(arr)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if n == 1:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return arr, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        mid = n // 2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger.info("left 解析開始")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        left, inv_left = merge_sort(arr[:mid])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger.info(f"{left}{inv_left}左邊結果")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger.info("right 解析開始")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        right, inv_right = merge_sort(arr[mid:])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger.info(f"{arr[mid:]}切割右側,合併,反轉{inv_right}次右邊結果{right}")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger.info(f"{left} {right} 左右合併開始")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        merged, inv_merge = merge(left, right)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        logger.info(f"合併完成,{left}{right}合成{merged}經過 {inv_merge}次反轉合併,中間經過{inv_left + inv_right}次反轉")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return merged, (inv_left + inv_right + inv_merge)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 左右合併底層</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def merge(left, right):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    i, j, inversions = 0, 0, 0</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    merged = []</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    while i &lt; len(left) and j &lt; len(right):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if left[i] &lt;= right[j]:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            merged.append(left[i])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            i += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            merged.append(right[j])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            j += 1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            inversions += len(left) - i</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    merged += left[i:]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    merged += right[j:]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return merged, inversions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def solution(A):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    merged, inversions = merge_sort(A)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if inversions &gt; 1000000000:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return -1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return merged</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(solution([1, 4,6,6,7,2]))</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="result">result<a href="#result" class="hash-link" aria-label="Direct link to result" title="Direct link to result">​</a></h2><p>運算結果</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,067 - __main__ - INFO - 此次處理陣列為[1, 4, 6, 6, 7, 2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - left 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 此次處理陣列為[1, 4, 6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - left 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 此次處理陣列為[1]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - [1]0左邊結果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - right 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 此次處理陣列為[4, 6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - left 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 此次處理陣列為[4]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - [4]0左邊結果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - right 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 此次處理陣列為[6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - [6]切割右側,合併,反轉0次右邊結果[6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - [4] [6] 左右合併開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 合併完成,[4][6]合成[4, 6]經過 0次反轉合併,中間經過0次反轉</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - [4, 6]切割右側,合併,反轉0次右邊結果[4, 6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - [1] [4, 6] 左右合併開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 合併完成,[1][4, 6]合成[1, 4, 6]經過 0次反轉合併,中間經過0次反轉</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - [1, 4, 6]0左邊結果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - right 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 此次處理陣列為[6, 7, 2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - left 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 此次處理陣列為[6]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - [6]0左邊結果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - right 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 此次處理陣列為[7, 2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - left 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - 此次處理陣列為[7]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - [7]0左邊結果</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,068 - __main__ - INFO - right 解析開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - 此次處理陣列為[2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - [2]切割右側,合併,反轉0次右邊結果[2]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - [7] [2] 左右合併開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - 合併完成,[7][2]合成[2, 7]經過 1次反轉合併,中間經過0次反轉</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - [7, 2]切割右側,合併,反轉1次右邊結果[2, 7]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - [6] [2, 7] 左右合併開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - 合併完成,[6][2, 7]合成[2, 6, 7]經過 1次反轉合併,中間經過1次反轉</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - [6, 7, 2]切割右側,合併,反轉2次右邊結果[2, 6, 7]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - [1, 4, 6] [2, 6, 7] 左右合併開始</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2023-04-23 10:31:15,069 - __main__ - INFO - 合併完成,[1, 4, 6][2, 6, 7]合成[1, 2, 4, 6, 6, 7]經過 2次反轉合併,中間經過2次反轉</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[1, 2, 4, 6, 6, 7]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="understanding">understanding<a href="#understanding" class="hash-link" aria-label="Direct link to understanding" title="Direct link to understanding">​</a></h2><p>這個程式碼主要拿來排序序列,目前理解就是序列 ex.<!-- -->[1, 2, 4, 6, 6, 7]<!-- --> 會被先進行二分(mid=n//2),並取<!-- -->[:mid]<!-- -->跟<!-- -->[mid:]<!-- -->做處理,而首先,<!-- -->[:mid]<!-- -->遞迴多次這個過程,直到拆解到無法拆解,所以可以想見這時候拆成很多個小 list,之後他會使用 merge 一層層往上組,直到<!-- -->[:mid]<!-- -->排序完成.</p><p>merge 過程,是要數字由小到大.所以它使用兩個指針 i 和 j 分別遍歷左右兩個子數組。如果左子數組的當前元素小於或等於右子數組的當前元素，它就將左子數組的當前元素添加到新數組中，並將指針 i 向右移動一位；否則，它將右子數組的當前元素添加到新數組中，並將指針 j 向右移動一位，並且將逆序對的計數增加左子數組中剩餘元素的數量。最終，它將剩餘的元素添加到新數組中。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><a href="https://www.hackerearth.com/practice/algorithms/sorting/merge-sort/visualize/" target="_blank" rel="noopener noreferrer">hackerearth algorithm</a></p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="Python" term="Python"/>
        <category label="algorithm" term="algorithm"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[introduction of pandas]]></title>
        <id>https://suyuying.github.io/blog/2023/04/18/Data Analysis/pandas/intro-of-pandas</id>
        <link href="https://suyuying.github.io/blog/2023/04/18/Data Analysis/pandas/intro-of-pandas"/>
        <updated>2023-04-18T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[處理資料很常會用到datetime,這邊紀錄一下使用上面會用過的方法,之後等資料齊全再彙整.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-introduction">basic introduction<a href="#basic-introduction" class="hash-link" aria-label="Direct link to basic introduction" title="Direct link to basic introduction">​</a></h2><p>對資料進行分析,基本上過程大致如以下</p><ol><li>資料收集</li><li>使用工具分析資料</li><li>可視化分析(作圖)</li><li>建模</li><li>解釋結果</li></ol><p>網路上<span style="background-color:#25c2a0;border-radius:20px;color:#fff;padding:6px;cursor:pointer">資料收集</span>方式有很多,從簡便到麻煩依序大致如以下,如果遇到需要取資料時,可以條列式的篩選找到合適方法.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">API &lt; 開發者工具的xhr/fetch解析 &lt; bs4解析html中css跟tag &lt; selenium解析html跟點擊</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>基本上當然是先從簡單開始 try,假設今天已經取到所需的資料了,它可能是 csv,Json 等格式,接著<span style="background-color:#25c2a0;border-radius:20px;color:#fff;padding:6px;cursor:pointer">分析資料</span>步驟就會是<span style="background-color:#25c2a0;border-radius:20px;color:#fff;padding:6px;cursor:pointer">pandas</span>上場的時候.</p><p>分析資料:常見流程有 數據準備、選取、過濾、聚合、分組、排序、合併、填充缺失值,另外因為他的資料結構也有跟 python 的繪圖工具做整合,也可以搭配使用,常用的繪圖工具如以下.</p><ul><li>Plotly 和 Bokeh 是基於 JavaScript 的交互式圖表，也支援其他語言 ex.Python,可以創建互動性更強的圖表，如滑塊、下拉選單等。</li><li>Altair 是基於 Vega-Lite 的 Python 套件，支持將數據轉換為交互式圖表,優點是語法較簡單。</li><li>Seaborn 則是一個統計圖表套件，專注於統計繪圖，方便使用者進行常見的數據分析和繪圖操作。</li><li>Matplotlib 是 Python 最早期的繪圖套件之一，功能強大，可以繪製各種圖表，包括條形圖、直方圖、散點圖等等,基本上 Seaborn 是建立在 Matplotlib 之上。</li><li>Pyecharts 則是中國的一個開源圖表庫，提供了各種各樣的圖表，能夠繪製地圖、關係圖、熱力圖等多種圖表。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="數據準備">數據準備<a href="#數據準備" class="hash-link" aria-label="Direct link to 數據準備" title="Direct link to 數據準備">​</a></h3><p>以下數據是改過後的數據,會作為後面 demo 過程範例,基本上你想得到的數據格式 pandas 都支援了,md 檔,csv,dict,json...</p><p>pandas 主要數據結構有</p><ul><li><p>Series：一維數據結構，類似於帶有標籤的一維數組，可以容納不同類型的數據。</p></li><li><p>DataFrame：二維數據結構，類似於一個二維數組或一個關聯數據庫表，每列可以有不同的數據類型。</p></li><li><p>Panel：三維數據結構，類似於一個由 DataFrame 對象組成的字典，可以用來表示由多個 DataFrame 對象組成的數據集。</p></li></ul><p>最常會使用到的就是 DataFrame.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="python-物件轉-pandas-dataframe">Python 物件轉 pandas dataframe<a href="#python-物件轉-pandas-dataframe" class="hash-link" aria-label="Direct link to Python 物件轉 pandas dataframe" title="Direct link to Python 物件轉 pandas dataframe">​</a></h4><p>以下是把資料存成 dict in list 的型態</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[{'name': 'TM-Zx-1040', 'filePath': '/AppliZxations/iMyFone LoZxkWiper.app/Zxontents/MaZxOS/fixiOSLib/FixOS', 'start_time': '2023-03-29 14:25:05', 'open_id': 'H-GOGO-20230329-00001'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-04-18 02:38:40', 'open_id': 'H-GOGO-20230418-00001'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-04-13 21:51:19', 'open_id': 'H-GOGO-20230413-00029'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-04-10 22:13:29', 'open_id': 'H-GOGO-20230410-00053'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-04-05 18:47:26', 'open_id': 'H-GOGO-20230405-00001'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-04-03 21:04:38', 'open_id': 'H-GOGO-20230403-00002'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-04-03 04:51:22', 'open_id': 'H-GOGO-20230403-00001'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-04-01 22:42:13', 'open_id': 'H-GOGO-20230402-00002'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZx.exe', 'start_time': '2023-04-01 23:58:44', 'open_id': 'H-GOGO-20230402-00001'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-03-30 20:11:05', 'open_id': 'H-GOGO-20230330-00001'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-03-29 21:15:40', 'open_id': 'H-GOGO-20230329-00002'}, {'name': 'XD-Zx-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Program Files (x86)\\IObit\\AdvanZxed SystemZxare\\ASZxServiZxe.exe', 'start_time': '2023-03-28 22:28:29', 'open_id': 'H-GOGO-20230328-00001'}, {'name': 'XD-SAS-1045', 'filePath': '\\DeviZxe\\HarddiskVolume5\\Users\\miriam.lin\\AppData\\Roaming\\InsLogiZxZxfg\\PS\\PSDD\\9487.exe', 'start_time': '2023-04-17 18:04:27', 'open_id': 'H-GOGO-20230417-00027'}, {'name': 'XD-SAS-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Users\\DON\\Desktop\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe', 'start_time': '2023-04-18 11:17:21', 'open_id': 'H-GOGO-20230418-00004'}, {'name': 'XD-SAS-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Users\\DON\\Desktop\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe', 'start_time': '2023-04-18 11:17:23', 'open_id': 'H-GOGO-20230418-00003'}, {'name': 'XD-SAS-1073', 'filePath': '\\DeviZxe\\HarddiskVolume3\\Users\\DON\\Desktop\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe', 'start_time': '2023-04-18 11:17:01', 'open_id': nan}]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>把 dict in list 轉成 dataframe,dict 的 key 會對應到欄位名稱，value 對應欄位資料內容</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df=pd.DataFrame(json_data)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           name                                           filePath           start_time                open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0    TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  2023-03-29 14:25:05  H-GOGO-20230329-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-18 02:38:40  H-GOGO-20230418-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-13 21:51:19  H-GOGO-20230413-00029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-10 22:13:29  H-GOGO-20230410-00053</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">......</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="csv-轉-pandas-dataframe">CSV 轉 pandas dataframe<a href="#csv-轉-pandas-dataframe" class="hash-link" aria-label="Direct link to CSV 轉 pandas dataframe" title="Direct link to CSV 轉 pandas dataframe">​</a></h4><p>以下是 CSV 格式</p><div class="language-javascript codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">xxx.csv</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-javascript codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">filePath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">start_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">TM</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1040</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">AppliZxations</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">iMyFone </span><span class="token maybe-class-name">LoZxkWiper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">app</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">Zxontents</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">MaZxOS</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">fixiOSLib</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">FixOS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">25</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">05</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230329</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">02</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">38</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230418</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">51</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230413</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00029</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">13</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230410</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00053</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">05</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">47</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230405</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">38</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230403</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">51</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230403</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">01</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">42</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230402</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">01</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">58</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">44</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230402</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">30</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">05</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230330</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">15</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230329</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">28</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230328</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">SAS</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1045</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume5</span><span class="token plain">\</span><span class="token maybe-class-name">Users</span><span class="token plain">\miriam</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">lin</span><span class="token plain">\</span><span class="token maybe-class-name">AppData</span><span class="token plain">\</span><span class="token maybe-class-name">Roaming</span><span class="token plain">\</span><span class="token maybe-class-name">InsLogiZxZxfg</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">PS</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">PSDD</span><span class="token plain">\</span><span class="token number" style="color:#36acaa">9487</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">27</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230417</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00027</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">SAS</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Users</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">DON</span><span class="token plain">\</span><span class="token maybe-class-name">Desktop</span><span class="token plain">\</span><span class="token maybe-class-name">NaviZxat</span><span class="token plain"> </span><span class="token maybe-class-name">Keygen</span><span class="token plain"> </span><span class="token maybe-class-name">PatZxh</span><span class="token plain"> v5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">6.0</span><span class="token plain"> </span><span class="token maybe-class-name">DFoX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">17</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230418</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00004</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">SAS</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Users</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">DON</span><span class="token plain">\</span><span class="token maybe-class-name">Desktop</span><span class="token plain">\</span><span class="token maybe-class-name">NaviZxat</span><span class="token plain"> </span><span class="token maybe-class-name">Keygen</span><span class="token plain"> </span><span class="token maybe-class-name">PatZxh</span><span class="token plain"> v5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">6.0</span><span class="token plain"> </span><span class="token maybe-class-name">DFoX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">17</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">23</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230418</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00003</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">SAS</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Users</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">DON</span><span class="token plain">\</span><span class="token maybe-class-name">Desktop</span><span class="token plain">\</span><span class="token maybe-class-name">NaviZxat</span><span class="token plain"> </span><span class="token maybe-class-name">Keygen</span><span class="token plain"> </span><span class="token maybe-class-name">PatZxh</span><span class="token plain"> v5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">6.0</span><span class="token plain"> </span><span class="token maybe-class-name">DFoX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">17</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>把 csv 讀成 dataframe</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df = pd.read_csv('XXX.csv')</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>有了 df 以後可以用基本的屬性去了解他的 index,column name, 表總長度等</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 確認 DataFrame 的 index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.index) #RangeIndex(start=0, stop=16, step=1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 確認 DataFrame 的欄位名稱</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.columns) #Index(['name', 'filePath', 'start_time', 'open_id'], dtype='object')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 確認 DataFrame 的總長度</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(len(df)) #16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#讀前十行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.head(10))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#列出各欄位型態</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.dtypes)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name          object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filePath      object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start_time    object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">open_id       object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtype: object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.shape) #(16, 4) 顯示 (16, 4) 表示 df 有 16 列(row) 和 4 行(column)。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#括每個 column 的名稱、非空值的數量、數值型別、以及佔用的記憶體大小等等。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.info())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class 'pandas.core.frame.DataFrame'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RangeIndex: 16 entries, 0 to 15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Data columns (total 4 columns):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> #   Column      Non-Null Count  Dtype</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">---  ------      --------------  -----</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 0   name        16 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 1   filePath    16 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 2   start_time  16 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> 3   open_id     15 non-null     object</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">dtypes: object(4)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">memory usage: 640.0+ bytes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 欄位的總數、平均值、標準差、最小值、25% 分位數、50% 分位數、75% 分位數、最大值等資</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.describe())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">              name                                           filePath           start_time                open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">count           16                                                 16                   16                     15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">unique           4                                                  5                   16                     15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">top     XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-03-29 14:25:05  H-GOGO-20230329-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">freq            11                                                 10                    1                      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="小結">小結<a href="#小結" class="hash-link" aria-label="Direct link to 小結" title="Direct link to 小結">​</a></h4><p>常用的是 df.shape,df.index,df.dtypes,df.info(),df.columns,還有 len(df)等,去描述 df 的欄位的型態.</p><p><code>df.shape</code>: 返回 DataFrame 的行數和列數，以元組形式返回 (rows, columns)。</p><p><code>df.index</code>: 返回 DataFrame 的索引 (Index)。</p><p><code>df.columns</code>: 返回 DataFrame 的列名。</p><p><code>df.dtypes</code>: 返回 DataFrame 每個列的數據類型。</p><p><code>df.info()</code>: 返回 DataFrame 的簡要摘要，包括每個列的名稱、非空值的數量、每個列的數據類型、索引的數量、記憶體使用量等等。</p><p><code>len(df)</code>: 返回 DataFrame 的行數。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="選取">選取<a href="#選取" class="hash-link" aria-label="Direct link to 選取" title="Direct link to 選取">​</a></h3><ul><li>使用隱性索引來選取各行資料</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 列出0~10行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> print(df[0:11])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>iloc 切片 :iloc 是使用隱性索引來選取資料，東西在 [] 裡面，索引值 0 是行，索引值 1 是列。 可以使用 : 選取一定範圍的列或行。</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  df.iloc[1:4,0:3]: 選取 1~3 行,0~2 列</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df.iloc[[0, 1]]：使用隱式索引選取第 0 和第 1 行。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df.iloc[[0, 2], [1, 3]]：使用隱式索引選取第 0 和第 2 行以及第 1 和第 3 列。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df.iloc[:,0:7]：選取所有行的前 7 列。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df.iloc[10:30,2:3]=None：將第 10 到第 29 行的第 2 列值設為 None。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df.iloc[10:30,:]=None: 第 10 ~29 行 所有列換成 None</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  df.iloc[10:30,:-2]=None: 第 10 ~29 行 除了倒數兩列之外的列換成 None</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>loc 遮罩:可以用切片或者布林向量選值,這邊 index 是顯示索引,一定要有對應的 index 名稱. 有用範圍就用切片:,用切片不用中括號.</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">print(df.loc[[1, 3], ["name", "start_time"]]) # 取出 index 為 1, 3 的 name 和 start_time 兩個 column</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.loc[1:3, ["name", "start_time"]]) # 取出 index 為 1, 2, 3 的 name 和 start_time 兩個 column</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.loc[1:3, "name":"start_time"]) # 取出 index 為 1, 2, 3 的 name 到 start_time 三個 column</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>倒放 df.T</li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">print(df.T)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                                                           0   ...                                                 15</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name                                               TM-Zx-1040  ...                                        XD-SAS-1073</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filePath    /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  ...  \DeviZxe\HarddiskVolume3\Users\DON\Desktop\Nav...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start_time                                2023-03-29 14:25:05  ...                                2023-04-18 11:17:01</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">open_id                                 H-GOGO-20230329-00001  ...                                                NaN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.T.index) #Index(['name', 'filePath', 'start_time', 'open_id'], dtype='object')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li>直接拿某欄位值 at[],使用 label (index &amp; column name) 取值, .iat[]. (.at<!-- -->['a','b']<!-- --> 索引為 a 列名為 b)， df.iat<!-- -->[3, 2]<!-- --> 只能用隱性索引 (integer) 取值,這邊是取第 4 行第 3 列(2023-04-10 22:13:29).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="過濾">過濾<a href="#過濾" class="hash-link" aria-label="Direct link to 過濾" title="Direct link to 過濾">​</a></h3><p>過濾出 name 欄位字有 XD-Zx 字樣者
使用 query 方式找：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df.query("name.str.contains('XD-Zx')")</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>使用 bool 布林選擇的方式：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df[df['name'].str.contains('XD-Zx')]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="分組聚合">分組聚合<a href="#分組聚合" class="hash-link" aria-label="Direct link to 分組聚合" title="Direct link to 分組聚合">​</a></h3><p>在 Pandas 中，聚合指的是將資料集按照某些條件分組，然後對分組後的資料集進行計算的過程。常見的聚合函數有：sum（求和）、mean（求平均）、median（求中位數）、min（求最小值）、max（求最大值）等等。</p><p>Pandas 中聚合的方法主要有兩種：groupby 和 pivot_table。</p><p>groupby 方法將資料集按照某些欄位進行分組，然後對分組後的資料進行聚合操作。例如，將資料集按照某一欄位進行分組，然後計算每個分組的平均值。</p><p><a href="https://zhuanlan.zhihu.com/p/101284491" target="_blank" rel="noopener noreferrer">參考這篇文章</a>對於 groupby 的講解,groupby 其實就是對資料進行分組,例如途中 company 有多個 C、Ａ、Ｂ,這些行都會被聚集在一起,後續可以用 agg 或 transform 聚合操作,也可以透過 apply 使用自訂意函式處理資料.</p><div style="display:flex;justify-content:center"><img loading="lazy" src="https://pic2.zhimg.com/80/v2-c619d636a34458a51b375b0ad2cbf7c5_1440w.webp" alt="malta_street png" class="img_CujE"></div><p>lab 1.使用 groupby 然後把重複的 name,filePath 併成一個,然後把 path 跟 name 輸出(答案很多,這邊寫幾個)</p><p>法ㄧ、透過以<!-- -->['name', 'filePath']<!-- -->分組,使用 agg 把欄位壓成一個（不壓會只有記憶體位置）,然後把<!-- -->['name', 'filePath']<!-- -->拿會去當欄位</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">group_df=df.groupby(['name', 'filePath']).agg({'start_time': 'count'}).reset_index()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(group_df)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name                                           filePath  start_time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0   TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...           1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1  XD-SAS-1045  \DeviZxe\HarddiskVolume5\Users\miriam.lin\AppD...           1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2  XD-SAS-1073  \DeviZxe\HarddiskVolume3\Users\DON\Desktop\Nav...           3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3   XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...           1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4   XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...          10</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 打印表中每行資訊</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">for index, row in group_df.iterrows():</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(type(row)) #&lt;class 'pandas.core.series.Series'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(row['filePath'],row['name'])</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class 'pandas.core.series.Series'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/AppliZxations/iMyFone LoZxkWiper.app/Zxontents/MaZxOS/fixiOSLib/FixOS TM-Zx-1040</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class 'pandas.core.series.Series'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\DeviZxe\HarddiskVolume5\Users\miriam.lin\AppData\Roaming\InsLogiZxZxfg\PS\PSDD\9487.exe XD-SAS-1045</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class 'pandas.core.series.Series'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\DeviZxe\HarddiskVolume3\Users\DON\Desktop\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe XD-SAS-1073</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class 'pandas.core.series.Series'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\DeviZxe\HarddiskVolume3\Program Files (x86)\IObit\AdvanZxed SystemZxare\ASZx.exe XD-Zx-1073</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;class 'pandas.core.series.Series'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">\DeviZxe\HarddiskVolume3\Program Files (x86)\IObit\AdvanZxed SystemZxare\ASZxServiZxe.exe XD-Zx-1073</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>or</p><p>法二、這段程式碼會先用 groupby 方法按照 'name' 列進行分組，然後對 'filePath' 列進行聚合操作，使用 lambda 函數來將相同的 filePath 合併成一個字符串，並將字符串中的重複值去除。最後用 sort_index() 方法對結果進行排序，按照 'name' 列的字母順序排序。
接下來的 for 循環，對 df_join 中的每一行進行迭代，其中 index 是當前行的索引值，row 是當前行的 Series 對象。在循環體中，先打印出 index，然後打印出 row，發現 row 是一個 Series 對象，包含了當前行的所有列。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df_join=df.groupby('name').agg({'filePath': lambda x: '\n '.join(set(x))}).sort_index()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_join.to_csv("test.csv")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>結果</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name,filePath</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TM-Zx-1040,/AppliZxations/iMyFone LoZxkWiper.app/Zxontents/MaZxOS/fixiOSLib/FixOS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XD-SAS-1045,\DeviZxe\HarddiskVolume5\Users\miriam.lin\AppData\Roaming\InsLogiZxZxfg\PS\PSDD\9487.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XD-SAS-1073,\DeviZxe\HarddiskVolume3\Users\DON\Desktop\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XD-Zx-1073,"\DeviZxe\HarddiskVolume3\Program Files (x86)\IObit\AdvanZxed SystemZxare\ASZxServiZxe.exe</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"> \DeviZxe\HarddiskVolume3\Program Files (x86)\IObit\AdvanZxed SystemZxare\ASZx.exe"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>pivot_table 方法將資料集按照某些欄位進行分類，並根據另一欄位的值來計算匯總資料。例如，按照某一欄位進行分類，然後計算每組的平均值。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="排序">排序<a href="#排序" class="hash-link" aria-label="Direct link to 排序" title="Direct link to 排序">​</a></h3><p>主要有 sort_index 跟 sort_values,將表進行排序
sort_values: 根據數據值對 DataFrame 或 Series 進行排序,預設是升序(也就是 ascending=True),將數值由低到高排列,常用參數 ascending,inplace. inplace=True 時會修改原本 df 並 return None.
sort_index: 根據索引對 DataFrame 或 Series 進行排序</p><p>sort_values:</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">print(df.sort_values(by="start_time").head(10))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name                                           filePath           start_time                open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">11  XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-03-28 22:28:29  H-GOGO-20230328-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0   TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  2023-03-29 14:25:05  H-GOGO-20230329-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10  XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-03-29 21:15:40  H-GOGO-20230329-00002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9   XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-03-30 20:11:05  H-GOGO-20230330-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">......</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>sort_index: 先使用 inplace=True,很明顯可以看到 index 因為 sort_values 關係所以排序改了,變成 11,0,10,9 等. 這邊可以透過 sort_index 對此從排</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 用sort_values並帶參數inplace=True改排序</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df.sort_values(by="start_time",inplace=True)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           name                                           filePath           start_time                open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">11   XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-03-28 22:28:29  H-GOGO-20230328-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0    TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  2023-03-29 14:25:05  H-GOGO-20230329-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">10   XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-03-29 21:15:40  H-GOGO-20230329-00002</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">9    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-03-30 20:11:05  H-GOGO-20230330-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">....</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 變回來</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.sort_index())</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           name                                           filePath           start_time                open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0    TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  2023-03-29 14:25:05  H-GOGO-20230329-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-18 02:38:40  H-GOGO-20230418-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-13 21:51:19  H-GOGO-20230413-00029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-10 22:13:29  H-GOGO-20230410-00053</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-05 18:47:26  H-GOGO-20230405-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">......</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果要換列的順序可以用 reindex</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df_new.reindex(columns=['name', 'filePath', 'start_time'])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="合併">合併<a href="#合併" class="hash-link" aria-label="Direct link to 合併" title="Direct link to 合併">​</a></h3><p>如果今天有幾筆新資料進來混在舊資料中,要將新舊資料比對多了哪些資料,可以使用 merge,並檢視集合狀態,這邊舊資料如同上面提供的,新資料 csv 檔如以下</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">'test_new_data.csv'</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">filePath</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">start_time</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">TM</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1040</span><span class="token punctuation" style="color:#393A34">,</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">AppliZxations</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">iMyFone </span><span class="token maybe-class-name">LoZxkWiper</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">app</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">Zxontents</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">MaZxOS</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">fixiOSLib</span><span class="token operator" style="color:#393A34">/</span><span class="token maybe-class-name">FixOS</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">14</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">25</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">05</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230329</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">02</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">38</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230418</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">51</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">19</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230413</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00029</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">10</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">13</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230410</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00053</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">05</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">47</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">26</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230405</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">38</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230403</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">51</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">22</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230403</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">01</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">42</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">13</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230402</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZx</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">01</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">23</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">58</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">44</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230402</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">30</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">20</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">05</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230330</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">29</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">21</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">15</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">40</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230329</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00002</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">03</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">28</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">28</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">29</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230328</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00001</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">SAS</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1045</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume5</span><span class="token plain">\</span><span class="token maybe-class-name">Users</span><span class="token plain">\miriam</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">lin</span><span class="token plain">\</span><span class="token maybe-class-name">AppData</span><span class="token plain">\</span><span class="token maybe-class-name">Roaming</span><span class="token plain">\</span><span class="token maybe-class-name">InsLogiZxZxfg</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">PS</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">PSDD</span><span class="token plain">\</span><span class="token number" style="color:#36acaa">9487</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">17</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">27</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230417</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00027</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">SAS</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Users</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">DON</span><span class="token plain">\</span><span class="token maybe-class-name">Desktop</span><span class="token plain">\</span><span class="token maybe-class-name">NaviZxat</span><span class="token plain"> </span><span class="token maybe-class-name">Keygen</span><span class="token plain"> </span><span class="token maybe-class-name">PatZxh</span><span class="token plain"> v5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">6.0</span><span class="token plain"> </span><span class="token maybe-class-name">DFoX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">17</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">21</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230418</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00004</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">SAS</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Users</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">DON</span><span class="token plain">\</span><span class="token maybe-class-name">Desktop</span><span class="token plain">\</span><span class="token maybe-class-name">NaviZxat</span><span class="token plain"> </span><span class="token maybe-class-name">Keygen</span><span class="token plain"> </span><span class="token maybe-class-name">PatZxh</span><span class="token plain"> v5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">6.0</span><span class="token plain"> </span><span class="token maybe-class-name">DFoX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">17</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">23</span><span class="token punctuation" style="color:#393A34">,</span><span class="token constant" style="color:#36acaa">H</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">GOGO</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">20230418</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">00003</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token constant" style="color:#36acaa">SAS</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Users</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">DON</span><span class="token plain">\</span><span class="token maybe-class-name">Desktop</span><span class="token plain">\</span><span class="token maybe-class-name">NaviZxat</span><span class="token plain"> </span><span class="token maybe-class-name">Keygen</span><span class="token plain"> </span><span class="token maybe-class-name">PatZxh</span><span class="token plain"> v5</span><span class="token punctuation" style="color:#393A34">.</span><span class="token number" style="color:#36acaa">6.0</span><span class="token plain"> </span><span class="token maybe-class-name">DFoX</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">17</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">01</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">ZxW</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">Device</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume4</span><span class="token plain">\</span><span class="token maybe-class-name">ProgramData</span><span class="token plain">\</span><span class="token maybe-class-name">Anaaatikk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dll</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">16</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">35</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">36</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1023</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">Device</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume4</span><span class="token plain">\</span><span class="token maybe-class-name">Config</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access maybe-class-name">Msi</span><span class="token plain">\fat</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">rbf</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">12</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">09</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">06</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">Device</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume4</span><span class="token plain">\</span><span class="token maybe-class-name">ProgramData</span><span class="token plain">\</span><span class="token maybe-class-name">Antikk</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">dll</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">13</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">11</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">22</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">52</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">DeviZxe</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume3</span><span class="token plain">\</span><span class="token maybe-class-name">Program</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Files</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">x86</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain">\</span><span class="token maybe-class-name">IObit</span><span class="token plain">\</span><span class="token maybe-class-name">AdvanZxed</span><span class="token plain"> </span><span class="token maybe-class-name">SystemZxare</span><span class="token plain">\</span><span class="token maybe-class-name">ASZxServiZxe</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">18</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">22</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">38</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">40</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">XD</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Zx</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">1073</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">\</span><span class="token maybe-class-name">Device</span><span class="token plain">\</span><span class="token maybe-class-name">HarddiskVolume6</span><span class="token plain">\</span><span class="token constant" style="color:#36acaa">SSTR</span><span class="token plain">\</span><span class="token maybe-class-name">MInst</span><span class="token plain">\</span><span class="token maybe-class-name">Portable</span><span class="token plain">\</span><span class="token maybe-class-name">Wisdfsnlocker_All</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">exe</span><span class="token punctuation" style="color:#393A34">,</span><span class="token number" style="color:#36acaa">2023</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">04</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">07</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">19</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">56</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">02</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>merge</p><p>要確認有哪些資料可以用 merge 去看,需指定用哪欄做合併的 key,用參數 how 可以指定關聯方式.index=True 會多出<!-- -->_<!-- -->merge 欄位標出只有右或做或 both 都有.</p><ul><li><p>Inner Join（內部關聯）：只保留兩個表中共有的行。只有在兩個表都有匹配的行時，才會將它們聯合在一起。</p></li><li><p>Left Join（左外關聯）：保留左邊（第一個）表的所有行，如果右邊表中有匹配的行，就將其加入到左邊表中，否則用 NULL 值填充。</p></li><li><p>Right Join（右外關聯）：保留右邊（第二個）表的所有行，如果左邊表中有匹配的行，就將其加入到右邊表中，否則用 NULL 值填充。</p></li><li><p>Outer Join（全外關聯）：保留兩個表中所有的行，如果兩個表中有匹配的行，就將它們聯合在一起，否則用 NULL 值填充。</p></li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df = pd.read_csv('old_data.csv')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_new=pd.read_csv('test_new_data.csv')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 四種合併方式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 留left合併欄位的key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_merged_left = pd.merge(df, df_new, on='start_time', how='left', indicator=True,suffixes=('_old', '_new'))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(len(df_merged_left))#16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 留rithg合併欄位的key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_merged_right = pd.merge(df, df_new, on='start_time', how='right', indicator=True,suffixes=('_old', '_new'))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(len(df_merged_right)) #21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 留兩邊都有的key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_merged_inner = pd.merge(df, df_new, on='start_time', how='inner', indicator=True,suffixes=('_old', '_new'))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(len(df_merged_inner)) #16</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 包含兩邊所有合併欄位key</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df_merged_outer = pd.merge(df, df_new, on='start_time', how='outer', indicator=True,suffixes=('_old', '_new'))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(len(df_merged_outer))# 21</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df_merged_outer.columns)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Index(['name_old', 'filePath_old', 'start_time', 'open_id_old', 'name_new',</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">       'filePath_new', 'open_id_new', '_merge'],</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      dtype='object')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>接著用前面講到的 query 或 布林 去取得<!-- -->_<!-- -->merge 欄位值是 right_only 者.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># query版</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df_merged_outer.query('_merge=="right_only"'))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># bool版</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df_merged_outer[df_merged_outer['_merge'] == "right_only"])</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="填充缺失值">填充缺失值<a href="#填充缺失值" class="hash-link" aria-label="Direct link to 填充缺失值" title="Direct link to 填充缺失值">​</a></h3><p>把 nan 換成 0
df.fillna(0, inplace=True)</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="小結-1">小結<a href="#小結-1" class="hash-link" aria-label="Direct link to 小結" title="Direct link to 小結">​</a></h4><p>以上是一些工作上遇到的資料分析過程,以及常用到的 function,整個流程還有很多 function 可以使用,基本上已經多到只有你沒想到的部分.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="數據處理三大利器-mapapplyapplymap">數據處理三大利器 map、apply、applymap<a href="#數據處理三大利器-mapapplyapplymap" class="hash-link" aria-label="Direct link to 數據處理三大利器 map、apply、applymap" title="Direct link to 數據處理三大利器 map、apply、applymap">​</a></h2><p><a href="https://zhuanlan.zhihu.com/p/100064394" target="_blank" rel="noopener noreferrer">參考這邊做的整理</a>,不過軟體也會改程式碼,未來有改變之類再來改囉！
apply 函數通常用於對 DataFrame or Series 進行操作,接受一個函數作為參數,並將該函數應用於 某行或某列.
map 函數通常用於對 Pandas Series 中的每個元素進行操作,接受一個 function 作為參數(該 function 不能帶其他 arguments),並將該函數應用於 Series 中的每個元素,不能帶
applymap:待補</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="series-map--apply">Series: map &amp; apply<a href="#series-map--apply" class="hash-link" aria-label="Direct link to Series: map &amp; apply" title="Direct link to Series: map &amp; apply">​</a></h3><p>lab1.XD-Zx-1073 離職,請把他 name 換成已離職.</p><p>法ㄧ.Series 下處理,用 map (用 apply 相同結果)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df=pd.read_csv('test_new_data.csv')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">byebye=["XD-Zx-1073"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def change_name_to_resign(x):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if x in byebye:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return 'resign'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        return x</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df['name']=df['name'].map(change_name_to_resign)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           name                                           filePath           start_time                open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0    TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  2023-03-29 14:25:05  H-GOGO-20230329-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1        resign  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-18 02:38:40  H-GOGO-20230418-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2        resign  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-13 21:51:19  H-GOGO-20230413-00029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3        resign  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-10 22:13:29  H-GOGO-20230410-00053</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>lab2.Series 下處理,XD-Zx-1073 離職,請把他 name 加上 resign,限定用參數帶入字串(map 跟 apply 差別最大在 apply 可以帶入其他參數)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df['name']=df['name'].apply(change_name_to_resign,value="GGG")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                name                                           filePath           start_time                open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0         TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  2023-03-29 14:25:05  H-GOGO-20230329-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1   XD-Zx-1073resign  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-18 02:38:40  H-GOGO-20230418-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2   XD-Zx-1073resign  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-13 21:51:19  H-GOGO-20230413-00029</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="dataframe-apply--applymap">DataFrame: apply &amp; applymap<a href="#dataframe-apply--applymap" class="hash-link" aria-label="Direct link to DataFrame: apply &amp; applymap" title="Direct link to DataFrame: apply &amp; applymap">​</a></h3><p>lab3.DataFrame 處理,產生新欄位 job_status
ps.在 dataframe 裡面 axis 代表軸.</p><p>axis=0：表示沿着行的方向进行操作，例如 drop 方法刪除行時就是沿着行方向進行刪除。
其實他做的事情就是把每列取出以 series 方式取出!處理的數據是 Series</p><div style="display:flex;justify-content:center"><img loading="lazy" src="https://pic3.zhimg.com/80/v2-3e7aa714ac4478c6b4b7da0b4dd3746e_1440w.webp" alt="axis=1 png" class="img_CujE"></div><p>axis=1：表示沿着列的方向进行操作，例如 drop 方法刪除列時就是沿着列方向進行刪除。
其實他做的事情就是把某行的欄位都轉成 series,欄位索引變成 index,再做處理!處理的數據是 Series.
像這樣</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name          TM-Zx-1040</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">filePath      /AppliZxations/iMyFone</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">start_time    2023-03-29 14:25:05</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">open_id       H-GOGO-20230329-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="display:flex;justify-content:center"><img loading="lazy" src="https://pic4.zhimg.com/80/v2-98f8b09e26abe17e850ed125950fecdf_1440w.webp" alt="axis=1 png" class="img_CujE"></div><p><a href="https://zhuanlan.zhihu.com/p/100064394" target="_blank" rel="noopener noreferrer">詳細可以看這篇</a>,對 axis 講的很多,</p><p>接到前面的 lab3.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df=pd.read_csv('test_new_data.csv')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">byebye=["XD-Zx-1073"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">def change_name_to_resign(series,value):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if series['name'] in byebye:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        job_status=series['name']+value</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    else:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        job_status="work"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return job_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">df['job_status']=df.apply(change_name_to_resign,value="byebye",axis=1)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">           name                                           filePath           start_time                open_id        job_status</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0    TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  2023-03-29 14:25:05  H-GOGO-20230329-00001              work</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-18 02:38:40  H-GOGO-20230418-00001  XD-Zx-1073byebye</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2    XD-Zx-1073  \DeviZxe\HarddiskVolume3\Program Files (x86)\I...  2023-04-13 21:51:19  H-GOGO-20230413-00029  XD-Zx-1073byebye</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="小結-2">小結<a href="#小結-2" class="hash-link" aria-label="Direct link to 小結" title="Direct link to 小結">​</a></h3><ul><li>apply 可以用於 Series, DataFrame</li><li>map 可以用於 Series</li><li>applymap 用於 DataFrame</li></ul><h2 class="anchor anchorWithStickyNavbar_LWe7" id="groupby-中的數據處理">groupby 中的數據處理<a href="#groupby-中的數據處理" class="hash-link" aria-label="Direct link to groupby 中的數據處理" title="Direct link to groupby 中的數據處理">​</a></h2><p><a href="https://zhuanlan.zhihu.com/p/101284491" target="_blank" rel="noopener noreferrer">資料來源參考這篇</a>,主要使用 function 有 agg, transform, apply</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="agg">agg<a href="#agg" class="hash-link" aria-label="Direct link to agg" title="Direct link to agg">​</a></h3><p>agg 我自己理解是他會把你取數據的那列資料,裡面的每一欄放在一起作成 list 當作一個變數再去處理(這是比喻,他 type 不是 list),可以配合聚合操作可以用来求和、均值、最大值、最小值等來操作數據</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">print(df.groupby('name', as_index=False).agg({'filePath': lambda x: x}))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name                                           filePath</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0   TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1  XD-SAS-1045  \DeviZxe\HarddiskVolume5\Users\miriam.lin\AppD...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2  XD-SAS-1073  [\DeviZxe\HarddiskVolume3\Users\DON\Desktop\Na...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">...</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## 計數</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.groupby('name', as_index=False).agg({'filePath': lambda x: len(x)}))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name  filePath</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0   TM-Zx-1040         1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1  XD-SAS-1045         1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2  XD-SAS-1073         3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3   XD-Zx-1023         1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4   XD-Zx-1073        14</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5  XD-ZxW-1073         1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">## set去掉重複項後計數</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.groupby('name', as_index=False).agg({'filePath': lambda x: len(set(x))}))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          name  filePath</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0   TM-Zx-1040         1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">1  XD-SAS-1045         1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2  XD-SAS-1073         1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">3   XD-Zx-1023         1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4   XD-Zx-1073         4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">5  XD-ZxW-1073         1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="apply">apply<a href="#apply" class="hash-link" aria-label="Direct link to apply" title="Direct link to apply">​</a></h3><p>兩者的區別在於，對於 groupby 後的 apply，以分組後的子 DataFrame 作為參數傳入指定函數的，基本操作單位是 DataFrame，而之前介紹的 apply 的基本操作單位是 Series。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">df=pd.read_csv('test_new_data.csv')</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(df.groupby('name').apply(lambda x: x.sort_values(by='start_time', ascending=False)))</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                         start_time                open_id</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">TM-Zx-1040  0   2023-03-29 14:25:05  H-GOGO-20230329-00001</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XD-SAS-1045 12  2023-04-17 18:04:27  H-GOGO-20230417-00027</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XD-SAS-1073 14  2023-04-18 11:17:23  H-GOGO-20230418-00003</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            13  2023-04-18 11:17:21  H-GOGO-20230418-00004</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            15  2023-04-18 11:17:01                    NaN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XD-Zx-1023  17  2023-04-13 12:09:06                    NaN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">XD-Zx-1073  19  2023-04-18 22:38:40                    NaN</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">......</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="transform">transform<a href="#transform" class="hash-link" aria-label="Direct link to transform" title="Direct link to transform">​</a></h3><p>適合拿來做新一列.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="結論">結論<a href="#結論" class="hash-link" aria-label="Direct link to 結論" title="Direct link to 結論">​</a></h2><p>還有很多要學,不過涵蓋以前紀錄的大部分東西了,先用這篇當還以前的債吧～</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="Python" term="Python"/>
        <category label="pandas" term="pandas"/>
        <category label="data analysis" term="data analysis"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Python datetime guide]]></title>
        <id>https://suyuying.github.io/blog/2023/04/17/Python/datetime/datetime-guide</id>
        <link href="https://suyuying.github.io/blog/2023/04/17/Python/datetime/datetime-guide"/>
        <updated>2023-04-17T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[處理資料很常會用到datetime,這邊紀錄一下使用上面會用過的方法,之後等資料齊全再彙整.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="常見-datetime-應用">常見 datetime 應用<a href="#常見-datetime-應用" class="hash-link" aria-label="Direct link to 常見 datetime 應用" title="Direct link to 常見 datetime 應用">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="日期介於幾天之間">日期介於幾天之間<a href="#日期介於幾天之間" class="hash-link" aria-label="Direct link to 日期介於幾天之間" title="Direct link to 日期介於幾天之間">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="範例一日期介於昨日到七天前">範例一.日期介於昨日到七天前<a href="#範例一日期介於昨日到七天前" class="hash-link" aria-label="Direct link to 範例一.日期介於昨日到七天前" title="Direct link to 範例一.日期介於昨日到七天前">​</a></h4><p>資料<code>ticket_detail['result']['close_time']</code>他的字串值是<code>2023-04-17 02:36:55</code>這類,是否屆於昨日到七天前,是就 print yes</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">format=datetime.now() #&lt;class 'datetime.datetime'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">today = datetime.now().date() #&lt;class 'datetime.date'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yesterday = today - timedelta(days=1) #&lt;class 'datetime.date'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">seven_days_ago = today - timedelta(days=7) #&lt;class 'datetime.date'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">date_format = "%Y-%m-%d %H:%M:%S" #把字串為2023-04-17 02:36:55依據格式換成datetime.datetime物件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 使用datetime.strptime方法把字串依據格式換成 datetime.datetime物件,使用date方法變成datetime.date物件進行比較</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if seven_days_ago&lt;= datetime.strptime("2023-04-17 02:36:55",date_format).date() &lt;= yesterday:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print("yes")</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><ul><li><p>datetime.strptime 是把字串換成 datetime.datetime 物件</p></li><li><p>datetime.strftime()是把 datetime.datetime 物件換成格式化字串</p><p><a href="https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior" target="_blank" rel="noopener noreferrer">官方 strftime() and strptime() 格式轉換</a></p></li></ul></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="範例二timedelta-物件運用憑證是否在今天到-30-天之間到期">範例二:timedelta 物件運用,憑證是否在今天到 30 天之間到期<a href="#範例二timedelta-物件運用憑證是否在今天到-30-天之間到期" class="hash-link" aria-label="Direct link to 範例二:timedelta 物件運用,憑證是否在今天到 30 天之間到期" title="Direct link to 範例二:timedelta 物件運用,憑證是否在今天到 30 天之間到期">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 將到期日期字串轉換為 datetime 格式</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vaild_date = datetime.strptime("2023-04-17 02:36:55", date_format)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 取得當前時間</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">now_time = datetime.now() #2023-04-17 20:33:01.577635</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 計算到期日期與當前時間的時間差,注意這邊是timedelta物件囉！</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vaild_days = vaild_date - now_time</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 印出時間差和時間差的資料型態</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(vaild_days) #-1 day, 6:11:15.206948</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(type(vaild_days)) #&lt;class 'datetime.timedelta'&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 判斷時間差是否在 當下到 30 天之間到期</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if vaild_days &gt; timedelta(days=0) and vaild_days &lt; timedelta(days=30):</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print(vaild_days)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    print("ok")</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>注意～</p><p>以上面為例,到期時間為"2023-04-17 02:36:55",當下時間為 2023-04-17 20:25:39.793060,這種情況下很明顯到期時間是小於當下時間的,相減結果會是-1 day, 6:03:53.422373.</p><p>由此可知,只要前時間小於後時間,剪出來的 day 都會是負數,也就是你的憑證到期了！</p></div></div><p>另外,如果是 datetime.date 之類物件減去 timedelta 物件,是不會變成 timedelta 物件！</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vaild_date=datetime.strptime("2023-04-17 02:36:55",date_format).date()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(type(vaild_date-timedelta(days=1))) # &lt;class 'datetime.date'&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果是 datetime.date 之類物件減去 datetime.date 物件,是會變成 timedelta 物件的！</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">vaild_date=datetime.strptime("2023-04-17 02:36:55",date_format).date()</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">print(type(datetime.now().date()-vaild_date)) #&lt;class 'datetime.timedelta'&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>但如果是 datetime.datetime 之類物件減去 datetime.date 物件會報錯
<code>TypeError: unsupported operand type(s) for -: 'datetime.date' and 'datetime.datetime'
</code></p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>datetime.datetime 同類別可以相減</p><p>datetime.date 同類別可以相減</p><p>datetime.datetime 之類減去 datetime.date 會報錯</p><p>datetime.datetime 跟 datetime.date 都可以減去 timedelta</p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="Python" term="Python"/>
        <category label="datetime" term="datetime"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[linux disk management command used commonly]]></title>
        <id>https://suyuying.github.io/blog/2023/04/11/linux-server/linux-disk-management</id>
        <link href="https://suyuying.github.io/blog/2023/04/11/linux-server/linux-disk-management"/>
        <updated>2023-04-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[在管理上會去檢視硬碟使用量,資料夾資料大小,如果掛硬碟跟卸下硬碟也會有專用 command,雖然各家申請硬碟方式不一樣,但是 linux command 是可以共用的！]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="disk-management-command">disk management command<a href="#disk-management-command" class="hash-link" aria-label="Direct link to disk management command" title="Direct link to disk management command">​</a></h2><p>在管理上會去檢視硬碟使用量,資料夾資料大小,如果掛硬碟跟卸下硬碟也會有專用 command</p><p><code>df -h</code>: 列出所有已掛載的硬盤的分區信息以及剩餘空間大小,結果長這樣</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Filesystem      Size  Used Avail Use% Mounted on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">devtmpfs        7.6G     0  7.6G   0% /dev</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmpfs           7.7G     0  7.7G   0% /dev/shm</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmpfs           7.7G  801M  6.9G  11% /run</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmpfs           7.7G     0  7.7G   0% /sys/fs/cgroup</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/nvme0n1p1  100G  6.0G   95G   6% /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">/dev/nvme1n1    300G  7.1G  293G   3% /var/gogo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">tmpfs           1.6G     0  1.6G   0% /run/user/1000</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>du -sh *</code>: 列出當前目錄下所有文件和子目錄的大小</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[root@72slaves ~]# du -sh *</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">0   123</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4.0K    123.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">4.0K    anaconda-ks.cfg</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">60K app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">156K    async-fastapi-mongo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">2.8M    cf-workers-status-page-v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">36K docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">......</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>lsblk -f</code>:檢視是否有任何磁碟區已在啟動時映射，但尚未格式化和掛載。 以下是一般都有掛載時.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">NAME            FSTYPE      LABEL           UUID                                   MOUNTPOINT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">sr0             iso9660     CentOS 7 x86_64 2020-04-22-00-54-00-00</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">vda</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─vda1          xfs                         68c17843-072c-45ce-b3ea-c48a6eb5317c   /boot</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─vda2          LVM2_member                 4GHWpr-dPQk-Dn22-Uhou-uxN4-4ZbT-r9OY0H</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├─centos-root xfs                         ff74c584-efb1-40b3-b607-c0f0b5d37fa1   /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ├─centos-swap swap                        8d866b90-7445-4ee7-ae20-f3742e5971ec   [SWAP]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  └─centos-home xfs                         0119a471-e11b-4803-9c19-42e637ed372a   /home</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>如果您要掛載的磁碟區已有資料 (例如，從快照建立的磁碟區)，請不要使用此命令。</p><p><code>mkfs -t xfs /dev/urdisk</code>:格式化硬碟並指定檔案系統.</p></div></div><p><code>mkdir -p /data</code>:先建立好/data 資料夾</p><p><code>mount /dev/urdisk /data</code>:把硬碟掛載到/data 資料夾(請先建立好/data 資料夾)</p><p><code>umount /data</code>:由/data 卸載硬碟</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-mount-disk-in-aws">how to mount disk in aws<a href="#how-to-mount-disk-in-aws" class="hash-link" aria-label="Direct link to how to mount disk in aws" title="Direct link to how to mount disk in aws">​</a></h3><p>以 aws 為例,要申請硬碟並在 instance 上用機器掛載</p><ol><li>開啟 AWS EC2 控制台</li><li>選擇要掛載硬碟的實例，並在左側選單點擊「Volumes」</li><li>在「Volumes」頁面點擊「Create Volume」</li><li>設定硬碟大小、AZ、類型等資訊，並點擊「Create Volume」</li><li>等待硬碟創建完成</li><li>在「Volumes」頁面勾選剛剛創建的硬碟，點擊「Actions」，選擇「Attach Volume」</li><li>在「Attach Volume」彈出框中選擇要掛載硬碟的 EC2 實例，以及設定掛載路徑和裝置名稱</li><li>點擊「Attach」</li><li>登入 EC2 實例，執行指令 lsblk -f 確認硬碟是否掛載成功,去找那個沒有 FSTYPE 的 NAME,EX:</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">NAME        FSTYPE  LABEL   UUID                        MOUNTPOINT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nvme1n1         xfs     7f939f28-6dcc-4315-8c42-6806080b94dd</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nvme0n1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">├─nvme0n1p1 xfs     /   90e29211-2de8-4967-b0fb-16f51a6e464c            /</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">└─nvme0n1p128</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">nvme2n1</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="10"><li>如果硬碟還沒有格式化，執行指令 sudo mkfs -t xfs /dev/xvdf 格式化硬碟（假設硬碟裝置名稱是 /dev/xvdf）</li><li>建立要掛載硬碟的目錄，例如 sudo mkdir /data</li><li>將硬碟掛載到目錄上，例如 sudo mount /dev/xvdf /data</li><li>確認掛載成功，執行指令 df -h 查看硬碟使用情況</li><li>用 lsblk -f 去看 UUID</li><li>若要在每次系統開機時掛載連接的 EBS 磁碟區,先用 lsblk -f 看 UUID,並 vim /etc/fstab 加入以下(UUID 換成自己的).</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">UUID=aebf131c-6957-451e-8d34-ec978d9581ae  /data  xfs  defaults  0  2</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>在以上範例中，將 UUID aebf131c-6957-451e-8d34-ec978d9581ae 的裝置掛載至掛載點 /data，並使用 xfs 檔案系統.</p><p>第四欄是檔案系統參數,可以上網查個選項！</p><p>第五欄是 dump,dump 會根據這個設定決定是否需要備份，一般為 0, 即不備份；1 為每日備份；2 為隔日備份,dump 僅支援 EXT 家族，若使用 xfs 檔案系統，則不用考慮 dump 項目。因此直接輸入 0 即可。</p><p>第六欄： fsck ，早期開機的流程中，會有一段時間去檢驗本機的檔案系統，看看檔案系統是否完整 (clean)。 不過這個方式使用的主要是透過 fsck 去做的，我們現在用的 xfs 檔案系統就沒有辦法適用，因為 xfs 會自己進行檢驗，不需要額外進行這個動作！所以直接填 0 就好了。(以上四五六項內容參考自<a href="https://linux.vbird.org/linux_basic_train/centos7/unit06.php#6.2" target="_blank" rel="noopener noreferrer">鳥哥</a>)</p></div></div><ol start="16"><li>檢查是否有掛載成功</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># Verify mount disk successfully</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">umount /data</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mount -a</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="how-to-umount-disk-in-aws">how to umount disk in aws<a href="#how-to-umount-disk-in-aws" class="hash-link" aria-label="Direct link to how to umount disk in aws" title="Direct link to how to umount disk in aws">​</a></h3><ol start="0"><li>先做好備份，如果做錯了，該怎麼還原要先想好</li><li>檢查該 300G 是否有被啟動的服務使用到 指令 ex.<code>lsof /dev/vda1</code></li><li>停掉相關有使用的服務</li><li>將該 300G 的硬碟 umount 掉 ex.<code>umount /data</code></li><li>檢查/etc/fstab 上有無設定掛載那 300G 硬碟</li><li>將/etc/fstab 有設定的那 300G 註解掉</li><li>下 mount -a 檢查有沒有確實拿掉，這樣在下次重開機就不會在吃到的</li><li>從 AWS 上直接把那顆硬碟做刪除</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brief-summary">Brief summary<a href="#brief-summary" class="hash-link" aria-label="Direct link to Brief summary" title="Direct link to Brief summary">​</a></h3><p>各家申請硬碟方式不一樣,但是 linux command 是可以共用的！</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="linux" term="linux"/>
        <category label="disk command" term="disk command"/>
        <category label="aws" term="aws"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[difference between read_repository and read_registry in gitlab]]></title>
        <id>https://suyuying.github.io/blog/2023/04/07/gitlab-action/difference-between-read-repository-and-read-registry</id>
        <link href="https://suyuying.github.io/blog/2023/04/07/gitlab-action/difference-between-read-repository-and-read-registry"/>
        <updated>2023-04-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[在gitlab裡,read_repository 主要是讓你只能抓 image 下來,read_repository 則是可以檢查 repo 裡面所有分支,commit 等,並可以 clone repository,但不能 push!]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="gitlab-權限管理">gitlab 權限管理<a href="#gitlab-權限管理" class="hash-link" aria-label="Direct link to gitlab 權限管理" title="Direct link to gitlab 權限管理">​</a></h2><p>gitlab 有一堆權限管理東東,<a href="https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html#personal-access-token-scopes" target="_blank" rel="noopener noreferrer">詳情</a>,透過適當的設計來安全權限給予.</p><p>這邊說一下之前遇到的問題,read_repository and read_registry 差別在哪裡!官方解釋對個別解釋如下:</p><p><code>read_registry</code>-Grants read-only (pull) access to a Container Registry images if a project is private and authorization is required. Available only when the Container Registry is enabled.</p><p><code>read_repository</code>-Grants read-only access to repositories on private projects using Git-over-HTTP or the Repository Files API.</p><p>小結:read_registry 主要是讓你只能抓 image 下來,read_repository 則是可以檢查 repo 裡面所有分支,commit 等,並可以 clone repository,但不能 push!</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="gitlab CI/CD" term="gitlab CI/CD"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[CI:gitlab basic intro about  CI/CD, build image and push to git-lab container]]></title>
        <id>https://suyuying.github.io/blog/2023/04/06/gitlab-action/gitlab-basic-intro-dind-build-image</id>
        <link href="https://suyuying.github.io/blog/2023/04/06/gitlab-action/gitlab-basic-intro-dind-build-image"/>
        <updated>2023-04-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[介紹官網資料,並提供gitlab ci使用範例,補充alpine/git:latest要用script要用到的entrypoint[""]]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-tutorial">basic tutorial<a href="#basic-tutorial" class="hash-link" aria-label="Direct link to basic tutorial" title="Direct link to basic tutorial">​</a></h2><p><a href="https://docs.gitlab.com/ee/ci/#concepts" target="_blank" rel="noopener noreferrer">以下出自官網</a>. 主要介紹幾個大方向.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="concepts">Concepts<a href="#concepts" class="hash-link" aria-label="Direct link to Concepts" title="Direct link to Concepts">​</a></h3><ul><li>Pipelines: CI/CD 透過 pipeline 建立。</li><li>CI/CD variables: 有 GitLab <a href="https://docs.gitlab.com/ee/ci/variables/predefined_variables.html" target="_blank" rel="noopener noreferrer">預設變數</a>（可以在 script 用 export 取得）、自定義環境變數和<a href="https://docs.gitlab.com/ee/ci/secure_files/" target="_blank" rel="noopener noreferrer">secure files</a>。</li><li>Environments: 要把應用部署在不同環境要使用。</li><li>Job artifacts: 程式過程中執行的產物（例如 xxx.csv）檔案的輸出以及其他 job 使用等。</li><li>Cache dependencies: 使用 cache 關鍵字可以幫助減少 pipeline 的運行時間，提高 CI/CD 效率。通過緩存依賴項，可以避免在每次運行 pipeline 時都從頭開始安裝相同的依賴項。</li><li>GitLab Runner: 設定執行這個 pipeline 的計算機。</li><li>Pipeline efficiency: 在 pipeline 過程中也會遇到一些煩人的問題，例如運行了一分鐘才失敗，需要多次查看等。如何提高效率呢？可以使用緩存、縮減要拉的映像檔大小、使用規則以及 <code>only</code>/<code>except</code> 關鍵字來控制作業在何時和何處運行。</li><li>Test cases: 在測試平台上建立測試情境。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="configuration">Configuration<a href="#configuration" class="hash-link" aria-label="Direct link to Configuration" title="Direct link to Configuration">​</a></h3><p>可以設定的內容.</p><ul><li>Schedule pipelines: 排程</li><li>Custom path for .gitlab-ci.yml: 客製化路徑</li><li>Git submodules for CI/CD: 如果你要用其他 repo 資料可以用這個</li><li>SSH keys for CI/CD: 如果你要在目標 server 上面部署程式，在使用 gitlab runner 是 docker containers 情況下，需要建立 SSH 公私鑰，以便 container 透過 ssh 連線並部署。</li><li>Pipeline triggers: 需要用 webhook 方式呼喚 pipline 時使用</li><li>Merge request pipelines: 如果是要在發出 merge 請求時跑的 pipline 要另外設定</li><li>Integrate with Kubernetes clusters：連 k8s 要用的設定</li><li>Optimize GitLab and GitLab Runner for large repositories: 優化 pipline 原則</li><li>.gitlab-ci.yml full reference：.gitlab-ci.yml 裡面有一大堆可以用的<a href="https://docs.gitlab.com/ee/ci/yaml/index.html" target="_blank" rel="noopener noreferrer">設定關鍵字</a></li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gitlab-ciyml-配置参数">.gitlab-ci.yml 配置参数<a href="#gitlab-ciyml-配置参数" class="hash-link" aria-label="Direct link to .gitlab-ci.yml 配置参数" title="Direct link to .gitlab-ci.yml 配置参数">​</a></h3><p><a href="https://docs.gitlab.com/ee/ci/yaml/index.html#stages" target="_blank" rel="noopener noreferrer">stages</a>- 默認有 build、test、deploy 三階端,如果有工作未標記 stage 則使用 test，相同 stage 並行運行，默認上一個 stage 完成才會接下一個 stage，且前一階段 stage 的失敗的話，下一階段不會執行，且標記該 commit 是 failed.</p><p><code>stage</code>- 描述 stages 中定義的 stage，依序執行，同 stage 會併發執行.</p><p><code>only</code>- 確定了哪些分支或標籤(branches and tags)的工作會運行</p><p><code>except</code>- 確定了哪些分支或標籤(branches and tags)的工作不會運行</p><p><code>only</code> <code>except</code>-可以同時定義，有衝突以 only 為主，支援正則，有以下 key word 可以使用</p><table><thead><tr><th>Value</th><th>Description</th></tr></thead><tbody><tr><td>api</td><td>For pipelines triggered by the pipelines API.</td></tr><tr><td>branches</td><td>When the Git reference for a pipeline is a branch.</td></tr><tr><td>chat</td><td>For pipelines created by using a GitLab ChatOps command.</td></tr><tr><td>external</td><td>When you use CI services other than GitLab.</td></tr><tr><td>external_pull_requests</td><td>When an external pull request on GitHub is created or updated (See Pipelines for external pull requests).</td></tr><tr><td>merge_requests</td><td>For pipelines created when a merge request is created or updated. Enables merge request pipelines, merged results pipelines, and merge trains.</td></tr><tr><td>pipelines</td><td>For multi-project pipelines created by using the API with CI_JOB_TOKEN, or the trigger keyword.</td></tr><tr><td>pushes</td><td>For pipelines triggered by a git push event, including for branches and tags.</td></tr><tr><td>schedules</td><td>For scheduled pipelines.</td></tr><tr><td>tags</td><td>When the Git reference for a pipeline is a tag.</td></tr><tr><td>triggers</td><td>For pipelines created by using a trigger token.</td></tr><tr><td>web</td><td>For pipelines created by selecting Run pipeline in the GitLab UI, from the project’s CI/CD &gt; Pipelines section.</td></tr></tbody></table><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">正則範例</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">job</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # use regexp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">only</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> </span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token regex regex-source language-regex" style="color:#36acaa">^issue-.*$</span><span class="token regex regex-delimiter" style="color:#36acaa">/</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # use special keyword</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">except</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> branches</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>when</code>-當作業 fail 或故障時運行
<code>environment</code>- 用於將您的應用程序部署到特定的環境中。透過執行腳本等功能達成</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">deploy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  stage: deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  script:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - deploy_to_production.sh</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: production</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    url: https://example.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  only:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - master</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>artifacts</code>- 指定將哪些文件附加到作業中
<code>dependencies</code> - 傳遞產生的 artifacts</p><p>以上是一些常用的 key word.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="gitlab-ci-working-directory">gitlab CI working directory<a href="#gitlab-ci-working-directory" class="hash-link" aria-label="Direct link to gitlab CI working directory" title="Direct link to gitlab CI working directory">​</a></h3><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>一般預設工作目錄都是在/builds 資料夾底下，他會把你 git repo 的東西 clone 到每個 img 的 build 資料夾裡面,所以工作目錄基本上在/builds/$CI_PROJECT_NAMESPACE/$CI_PROJECT_NAME 裡面,用說的很難懂,改用舉例吧:
如果 namespace 是 it, repo 名稱也會是 nginx-log-session-clear,所以工作目錄會在/builds/it/nginx-log-session-clear 底下,也就是 CI_PROJECT_DIR='/builds/it/nginx-log-session-clear',內容會是你的 git repo 內容.</p><p>也可以在 script 裡面用 export 求證歐</p>  <div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/CI_DIR_GITLAB-ae0a7748ab3aae1ea30acbd327d5fef5.png" alt="CI_WORK_DIR_GITLAB.png" class="img_CujE"></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-example">basic example<a href="#basic-example" class="hash-link" aria-label="Direct link to basic example" title="Direct link to basic example">​</a></h2><p>以下是範例應用,CI 建立 image 並推倒 container registry</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.gitlab-ci.yml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">variables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">IMAGE_NAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> vmnotconnect</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY_IMAGE</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">$</span><span class="token constant" style="color:#36acaa">IMAGE_NAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">$</span><span class="token constant" style="color:#36acaa">CI_COMMIT_SHORT_SHA</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 構建 moni</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">img</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 定義 job 所在的階段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">stage</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 定義 job 所使用的 </span><span class="token maybe-class-name">Docker</span><span class="token plain"> 鏡像</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">image</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> docker</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">dind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 定義 </span><span class="token maybe-class-name">Runner</span><span class="token plain"> 標籤</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">沒有對應到runner tag會報錯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">tags</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 在執行 job 之前要執行的命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">before_script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 使用內建變數登入 </span><span class="token maybe-class-name">GitLab</span><span class="token plain"> 容器倉庫</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain">拿到最外層會因為沒有docker 指令而報錯</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker login </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">u $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY_USER</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY_PASSWORD</span><span class="token plain"> $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 定義 job 的實際執行內容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 使用 </span><span class="token maybe-class-name">Docker</span><span class="token plain"> 構建您的應用程序，並將其命名為 $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker build </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">t $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 將 </span><span class="token maybe-class-name">Docker</span><span class="token plain"> 鏡像推送到 </span><span class="token maybe-class-name">GitLab</span><span class="token plain"> 的容器倉庫</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker push $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 刪除本地機器上的 </span><span class="token maybe-class-name">Docker</span><span class="token plain"> 鏡像</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker rmi $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # 定義不執行該 job 的情況</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">except</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # 不在預定的任務和標籤提交時執行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> schedules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以下是範例應用,把程式執行後產生的檔案，以執行當下時間打 tag 並推倒 git repo</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">stages:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - runCode  # 運行代碼的階段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - addFinalCsvToGit  # 將結果提交到 Git 階段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 定義運行作業前要運行的任何腳本</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">before_script:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  - export COMMIT_TIME=$(date  +'%Y-%-m-%-d-%H-%M')  # 建立環境變數以定義git提交的時間</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 定義一個作業，它在 `runCode` 階段運行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runCodeToTg:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  stage: runCode  # 設定作業所處的階段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image:  # 設定作業使用的 Docker 映像檔</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: python:3.11-slim</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  only:  # 設定作業在哪些情況下運行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    changes:  # 只有當指定目錄中的文件發生變化時才運行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - nginx-log/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # except:  # 如果希望排除某些情況下不運行，可以使用 except 字段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #   - schedules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #   - tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tags:  # 使用 Docker 標籤限制作業在哪些 Runner 上運行,沒有對應的runner就不會執行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  script:  # 定義作業所需運行的命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - pip install --no-cache-dir -r ./requirment.txt  # 安裝依賴庫</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - python3 main.py  # 執行代碼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ls  # 查看當前目錄</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - pwd  # 查看當前工作目錄</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  artifacts:  # 定義作業要保存的產物</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    paths:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - history/  # 保存 history 目錄</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 定義一個作業，它在 `addFinalCsvToGit` 階段運行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">addGitFile:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  stage: addFinalCsvToGit  # 設定作業所處的階段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  image:  # 設定作業使用的 Docker 映像檔</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: alpine/git:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    entrypoint: [""]  # 設定image run 起來執行的程式碼</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  only:  # 設定作業在哪些情況下運行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    changes:  # 只有當指定目錄中的文件發生變化時才運行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - nginx-log/*</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # except:  # 如果希望排除某些情況下不運行，可以使用 except 字段</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #   - schedules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  #   - tags</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  tags:  # 使用 Docker 標籤限制作業在哪些 Runner 上運行</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  script:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - ls  # 列出當前目錄的內容</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - export  # 查看所有的環境變量</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - pwd  # 查看當前工作目錄的路徑</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - git config --global user.name "ford"  # 設置 Git 全局用戶名</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - git config --global user.email "ford"  # 設置 Git 全局用戶郵箱</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - git add .  # 添加當前目錄中的所有更改到 Git 倉庫</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - git commit -m 'test' || echo "No changes, nothing to commit!"  # 提交更改</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - git tag $COMMIT_TIME  # 為提交打標籤</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - git push https://${ciname}:${cicode}@gitlab.go2cloudten.com/it/nginx-log-session-clear.git $COMMIT_TIME  # 推送更改到 Git 倉庫</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - echo 'add file done'  # 顯示任務執行完成的消息</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 從runCodeToTg那邊取得history資料夾到當下git 目錄</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  dependencies:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - runCodeToTg</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>補充:</p><ol><li><p>entrypoint: <!-- -->[""]<!-- --> 這是個神奇的 issue 設定 image run 起來後面要執行 script 要這樣加,不這樣加會遇到報錯 git: 'sh' is not a git command. See 'git --help',相關<a href="https://gitlab.com/gitlab-org/gitlab-runner/-/issues/4027" target="_blank" rel="noopener noreferrer">issue</a></p></li><li><p>repo 通常指 Git 版本控制系統中的存儲庫,registry 是一個存儲 image 的地方,兩者有差別歐,不過這也看各家定義,
在 docker 裡 registry 會包含多個 repo,而 repo 會有不同版本的 image.</p></li></ol><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資料</p><ul><li><a href="https://docs.gitlab.com/ee/ci/yaml/index.html" target="_blank" rel="noopener noreferrer">官網首頁</a></li><li><a href="https://docs.gitlab.com/ee/ci/examples/" target="_blank" rel="noopener noreferrer">官網 pipline demo</a></li><li><a href="https://meigit.readthedocs.io/en/latest/gitlab_ci_.gitlab-ci.yml_detail.html#gitlab-ci-gitlab-ci-yml" target="_blank" rel="noopener noreferrer">GitLab CI 流水线配置文件.gitlab-ci.yml 详解</a></li></ul></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="gitlab CI/CD" term="gitlab CI/CD"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Do Internet gateways and modem need to be used together?]]></title>
        <id>https://suyuying.github.io/blog/2023/03/30/Others/modemVSigw</id>
        <link href="https://suyuying.github.io/blog/2023/03/30/Others/modemVSigw"/>
        <updated>2023-03-30T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[簡言之，如果你家使用撥接或有線電視提供的網路，就會需要數據機，如果你家用光纖、DSL、電纜等，就可以不用轉換訊號，直接透過 Igw 將訊號 routing 到外部網路。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="device-basic-introduction">Device basic introduction<a href="#device-basic-introduction" class="hash-link" aria-label="Direct link to Device basic introduction" title="Direct link to Device basic introduction">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="internet-gateway">internet gateway<a href="#internet-gateway" class="hash-link" aria-label="Direct link to internet gateway" title="Direct link to internet gateway">​</a></h3><p>互聯網閘道器（Internet Gateway）是一種網路設備，用於連接位於本地網路（例如公司或家庭網路）內的設備與互聯網間的通訊，扮演網路中介，將本地網路封包轉到外網，再把外網封包轉回本地網路，所以需要有 router 功能</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="modem">Modem<a href="#modem" class="hash-link" aria-label="Direct link to Modem" title="Direct link to Modem">​</a></h3><p>數據機(Moden)，主要功用是將數字訊號轉換成模擬訊號。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="數字訊號">數字訊號<a href="#數字訊號" class="hash-link" aria-label="Direct link to 數字訊號" title="Direct link to 數字訊號">​</a></h4><p>數字信號是一種離散的信號，它由一系列離散的數字或二進制碼表示。這些二進制碼只能取 0 或 1 的值。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="模擬訊號">模擬訊號<a href="#模擬訊號" class="hash-link" aria-label="Direct link to 模擬訊號" title="Direct link to 模擬訊號">​</a></h4><p>模擬信號是一種連續的信號，它是由一個連續的波形表示的。模擬信號可以取無限個值，因為它們是基於物理量（如電壓、電流、聲音波形等）的連續變化。模擬信號常用於聲音和視頻等模擬設備中，如收音機、電視和手機等</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="do-internet-gateway-and-modem-need-to-be-used-together">Do Internet gateway and modem need to be used together?<a href="#do-internet-gateway-and-modem-need-to-be-used-together" class="hash-link" aria-label="Direct link to Do Internet gateway and modem need to be used together?" title="Direct link to Do Internet gateway and modem need to be used together?">​</a></h2><p>不一定，這依據情形而定。以下情形會需要一起用：</p><ol><li>撥號網路: 需要將計算機的數字訊號轉成模擬訊號，並透過電話線傳遞訊號到互聯網。</li><li>電視網路: 同上，一些有線電視網路提供的網路服務一樣要先做訊號轉換，再透過有線電視網路傳輸。</li></ol><p>簡言之，如果你家使用撥接或有線電視提供的網路，就會需要數據機</p><p>如果你家用光纖、DSL、電纜等，就可以不用轉換訊號，直接透過 Igw 將數字訊號 routing 到外部網路。</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="curl" term="curl"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[aws book study note]]></title>
        <id>https://suyuying.github.io/blog/2023/3/29/Aws/aws-book-study-note</id>
        <link href="https://suyuying.github.io/blog/2023/3/29/Aws/aws-book-study-note"/>
        <updated>2023-03-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[記錄筆記,Region aws 基礎設施的一個單位，每個區域都是獨立數據中心群集，由多個 Availability Zone 組成，所以像新加坡區，aws 目前就 3 個可用區域。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="名詞解釋">名詞解釋<a href="#名詞解釋" class="hash-link" aria-label="Direct link to 名詞解釋" title="Direct link to 名詞解釋">​</a></h2><p>IAAS: 雲端業者提供硬體設施、網路。不包含作業系統(Linux or Windows),中介軟體(MySql,Pika)，以及應用程式。</p><p>PAAS: 雲端業者提供硬體設施、網路、作業系統、中介軟體，因次伺服器故障跟備份資料庫等工作可以由雲端業者負責。</p><p>SAAS: 雲端業者提供硬體設施、網路、作業系統、中介軟體、應用程式。Gmail 就屬這類型.</p><p>Region: aws 基礎設施的一個單位，每個區域都是獨立數據中心群集，由多個 Availability Zone 組成，所以像新加坡區，aws 目前就 3 個可用區域。</p><p>Availability Zone: 具有獨立的電源、網絡和冷卻系統，以及與其他可用區域之間高帶寬、低延遲的網絡連接。每個可用區域都是一個獨立的數據中心群集，具有高度的冗餘性和可靠性，並且可以通過低延遲的連接實現可用區域之間的容錯和負載平衡。</p><p>VPC(Virtual Private Cloud): VPC 只能限在單個 region 內，但可以跨同一格 region 內的多個 Availability Zone</p><p>Network Access Control List(NACL):子網路層級的安全性管理，主要用於管理 OSI 模型中的 3、4 層，也就是可以管理連入 IP 跟 Port 號限制以及協議限制。舉例: 可以只讓自己家 ip 66.66.66.66 進來，允許所有 port，但禁止 Ping(ICMP 協議)。</p><p>Security Group: EC2 實例層級的安全性管理，您可以定義允許通過群組的網路流量，例如 TCP 或 UDP 連線。當使用安全群組和 NACL 時，安全群組的流量規則優先於 NACL 的規則。</p><p>IGW: 互聯網閘道器，主要用於外網跟內網的訊號路由。</p><p>Metadata: 執行個體中繼資料，可以用來管理執行個體，包含主機名稱跟 IP 等</p><p>Placement Group: 一群 EC2 的啟動策略，分為叢集、分區、分散</p><p>Serverless 應用程式: 開發人員開發程式後，都會遇到要開多少規格的問題，在 Serverless 解決方案下，雲端廠商提供設定自動擴展或者提高性能等服務，適合突發性高附載的服務，如:售票系統.Serverless 背後使用的是 lambda 服務。</p><p>機器學習: 需要高性能電腦進行資料訓練，建模，並部署應用程式.</p><p>IoT:利用感測器等小型設備建立物聯網系統</p><p>Data Lake House: 為滿足各種資料分析需求的分析選擇.</p><p>AWS Resources: 指用 AWS 各服務所建立而成的實體(instance)</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="iam">IAM<a href="#iam" class="hash-link" aria-label="Direct link to IAM" title="Direct link to IAM">​</a></h2><p>IAM 全名是「Identity and Access Management」，為 AWS 身份和訪問管理服務。</p><p>透過法條規範身份。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">法條-&gt;身份</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="法條policy">法條(policy)<a href="#法條policy" class="hash-link" aria-label="Direct link to 法條(policy)" title="Direct link to 法條(policy)">​</a></h3><p>法條建立規則簡稱 EPCAR</p><p>Effect + Principal + Condition + Action + Resource</p><p>允許/拒絕 + 主體(IAM user,or <!-- -->*<!-- --> ...) + 啥條件(ip or MFA...) + 執行動作 + 對哪項資源(s3,rds...)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="身份">身份<a href="#身份" class="hash-link" aria-label="Direct link to 身份" title="Direct link to 身份">​</a></h3><p>主要有兩類</p><ol><li>授權 policy 的 group，依附在 group 底下有長期憑證的 IAM user。</li><li>使用短期 credential 的 IAM role，外部系統帳號（Federating Exist User. 例如: github action,google 登入)等，公司本地帳號，其他 aws 帳號，aws 資源間溝通，都可以透過連結的本 aws 帳號 IAM role 做資源操作。</li></ol><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>外部使用者跟本地 sso 驗證過程</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">客戶端應用程式:A-&gt; 你的Identity Provider(ldP)主機 ex google,github等-&gt; google,github等的LDAP database 驗證 -&gt; 回傳SAML驗證給客戶端A-&gt;A呼叫AWS STS(Security Token Service)驗證-&gt;AWS 回應暫時憑證-&gt;客戶端A透過憑證取到aws資源</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iam-權限確認流程">IAM 權限確認流程<a href="#iam-權限確認流程" class="hash-link" aria-label="Direct link to IAM 權限確認流程" title="Direct link to IAM 權限確認流程">​</a></h3><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">基本aws確認權限流程</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">使用者</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">AWS</span><span class="token plain">辨認身份</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">確認權限</span><span class="token operator" style="color:#393A34">-</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain">授權操作</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iam-權限管理">IAM 權限管理<a href="#iam-權限管理" class="hash-link" aria-label="Direct link to IAM 權限管理" title="Direct link to IAM 權限管理">​</a></h3><p>root 權限過大問題，透過設定不同權限帳號切割，在 aws 就是透過多個用戶群組切分權限，跟 linux 管理類似。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="vpc">VPC<a href="#vpc" class="hash-link" aria-label="Direct link to VPC" title="Direct link to VPC">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="aws-網路環境組成">aws 網路環境組成<a href="#aws-網路環境組成" class="hash-link" aria-label="Direct link to aws 網路環境組成" title="Direct link to aws 網路環境組成">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">封包-&gt;IGW-&gt;Route Table -&gt;Network Access Control Lists(NACL)-&gt;Public Subnet-&gt;Security group -&gt; Instance</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="nacl-vs-security-group">NACL vs Security group<a href="#nacl-vs-security-group" class="hash-link" aria-label="Direct link to NACL vs Security group" title="Direct link to NACL vs Security group">​</a></h3><p>這兩者都是控制網路流量，那差別又為何呢?</p><ul><li>NACL 是在子網路級別運作, Security group 是在 instance 級別</li><li>NACL 是無狀態的(stateless),不跟蹤狀態,也就是要規定 7.7.7.7 能進來也能出去,才會放行跟 7.7.7.7 的流量. Security group 是有狀態的(stateful),這代表會自動允許出站或入站的返回流量,舉例來說:如果對外可以連接 7.7.7.7:80,那 7.7.7.7 回來的流量也會自動允許,但注意,7.7.7.7 不會自己進來.</li><li>NACL 有允許和拒絕規則,Security group 只有允許規則 。</li><li>NACL 只能引用 IP 地址或 CIDR 塊,Security group 可以在其規則中引用其他安全組。</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="vpc-服務對接方式">VPC 服務對接方式<a href="#vpc-服務對接方式" class="hash-link" aria-label="Direct link to VPC 服務對接方式" title="Direct link to VPC 服務對接方式">​</a></h3><ol><li>NAT Gateway 讓私有網路連外</li><li>以內網方式操作資源-VPC Endpoint</li><li>VPC 串接 VPC</li><li>VPC 串本地-VPN Connection</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ec2">EC2<a href="#ec2" class="hash-link" aria-label="Direct link to EC2" title="Direct link to EC2">​</a></h2><p>相關服務順序跟地端對照:</p><p>軟體市場-&gt; 作業系統-&gt;硬體規格-&gt;軟體安裝，程式部署-&gt;硬碟擴充-&gt;標記資產-&gt;建立防火牆-&gt; 連線</p><p>AMI Marketplace-&gt;AMI-&gt;Instance-&gt;Userdata-&gt;EBS-&gt;Tag-&gt;Security Group-&gt;KeyPair</p><p>用 AMI 建立主機，用 Userdata 部署，EBS 擴充硬碟，Tag 方便管理機器，可以用來看成本跟權限，Security Group 限制連入 IP 跟 prot，KeyPair 連入機器。</p><p>Amazon Machine Image:AMI,虛擬映像檔，屬於 Region 級別，不能跨 Region，也就是香港區不能拿日本的 AMI 建立機器。</p><p>所以如果要跨區使用 AMI，就跟 Immutable 原則有關，必須先把舊的 AMI 複製到其他區，並在其他 Region 起機器，也就是 AMI-&gt;snapshot-&gt;複製 AMI-&gt;起機器。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="instance-分類">instance 分類<a href="#instance-分類" class="hash-link" aria-label="Direct link to instance 分類" title="Direct link to instance 分類">​</a></h3><p>以 t2.micro 為例，t 應用場景，2 虛擬化技術版本，micro 機器規格</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="硬碟">硬碟<a href="#硬碟" class="hash-link" aria-label="Direct link to 硬碟" title="Direct link to 硬碟">​</a></h2><p>兩大方案分為 1. EBS Volume 2.Instance Store</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="ebs-volume">EBS Volume<a href="#ebs-volume" class="hash-link" aria-label="Direct link to EBS Volume" title="Direct link to EBS Volume">​</a></h3><p>EBS Volume 跟 EC2 是不同伺服器，機器跟硬碟兩者透過網路相連，
EBS Volume 在機器關機後資料不會消失。 所以要長期保存的資料要用 EBS 保存。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="instance-store">Instance Store<a href="#instance-store" class="hash-link" aria-label="Direct link to Instance Store" title="Direct link to Instance Store">​</a></h3><p>Instance Store 跟 EC2 在同一台 server 上。
Instance Store 關機後資料會消失。重新開機資料不會消失。所以只適合放緩衝跟暫時性資料。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="snapshot">Snapshot<a href="#snapshot" class="hash-link" aria-label="Direct link to Snapshot" title="Direct link to Snapshot">​</a></h2><p>AWS 快照服務有多種,以下列出常用的:</p><ol><li>EBS 快照: 對 EBS 硬碟的快照</li><li>RDS 快照: RDS 資料庫快照</li><li>EC2 映像: 對機器當下狀態的快照，要注意當會生出一個 EBS 快照跟一個 AMIs</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="elastic-network-interface-網路卡">Elastic Network Interface 網路卡<a href="#elastic-network-interface-網路卡" class="hash-link" aria-label="Direct link to Elastic Network Interface 網路卡" title="Direct link to Elastic Network Interface 網路卡">​</a></h2><p>EC2 透過 Elastic Network Interface(ENI)連接網路，要固定使用的 IP 要綁定 Elastic IP,綁定後開關機不會改變對外 IP.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ssh-keypair">SSH KeyPair<a href="#ssh-keypair" class="hash-link" aria-label="Direct link to SSH KeyPair" title="Direct link to SSH KeyPair">​</a></h2><p>透過把某台 server 的公鑰放入 EC2，用 ssh 方式進入 EC2</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="s3">S3<a href="#s3" class="hash-link" aria-label="Direct link to S3" title="Direct link to S3">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="核心組成">核心組成<a href="#核心組成" class="hash-link" aria-label="Direct link to 核心組成" title="Direct link to 核心組成">​</a></h3><p>Bucket and Object,你的資料就是 Object，會被放在 Bucket 內保存，每個物件都有 https 連結，但沒特別設定權限會遇到 Access denied.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="存取權限控管">存取權限控管<a href="#存取權限控管" class="hash-link" aria-label="Direct link to 存取權限控管" title="Direct link to 存取權限控管">​</a></h3><p>權限控管管理機制主要有三種:</p><ol><li>Block Public Access:這個算是防呆機制，就很簡單的直接決定檔案是否公開</li><li>Access Control List: 分為對 Bucket 跟 Object 的 ACL,可以設定讀取，寫入，列舉，權限擁有者等。</li><li>Bucket Policy: 要做最精細設定要透過 Bucket Policy 去用 json 格式做規範，可以規範的東西有存取權限(IAM user or Role)，路徑，條件(日期 ip bucket 名稱)</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="存取監控紀錄">存取監控紀錄<a href="#存取監控紀錄" class="hash-link" aria-label="Direct link to 存取監控紀錄" title="Direct link to 存取監控紀錄">​</a></h3><p>對 Bucket 跟 Object 都有監控紀錄</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="access-point-policy">Access Point Policy<a href="#access-point-policy" class="hash-link" aria-label="Direct link to Access Point Policy" title="Direct link to Access Point Policy">​</a></h3><p>Access Point 可以匡列 Bucket 中一系列 object，針對這些 Object 設計新的一套 Access Point Policy.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="rds">RDS<a href="#rds" class="hash-link" aria-label="Direct link to RDS" title="Direct link to RDS">​</a></h2><p>Amazon Relational Database Service (RDS)是一項托管關聯式數據庫服務.
在使用 RDS 時，會自動開機器來完成任務，有開機器就要探討是在哪個網段開機器，因此要先設定 subnet group,RDS 會在 group 內挑選合適的 subnet 放置機器</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="與自建資料庫差別">與自建資料庫差別<a href="#與自建資料庫差別" class="hash-link" aria-label="Direct link to 與自建資料庫差別" title="Direct link to 與自建資料庫差別">​</a></h3><p>在 EC2 建立資料庫需要管理 VM ，且可以連入機器做參數調整.</p><p>而 RDS 主要協助</p><ol><li>資料備援: 資料遺失可以有效回復</li><li>系統高可用性: 故障轉移和擴展等功能</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rds-性能調校">RDS 性能調校<a href="#rds-性能調校" class="hash-link" aria-label="Direct link to RDS 性能調校" title="Direct link to RDS 性能調校">​</a></h3><p>AWS 提供 Parameter Group 功能，讓資料庫所使用的參數能匯入,硬體部分可以將 EBS Volume 改成 Provision iops 類型的 EBS Volume.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="rds-高可用與備援">RDS 高可用與備援<a href="#rds-高可用與備援" class="hash-link" aria-label="Direct link to RDS 高可用與備援" title="Direct link to RDS 高可用與備援">​</a></h3><h4 class="anchor anchorWithStickyNavbar_LWe7" id="備援">備援<a href="#備援" class="hash-link" aria-label="Direct link to 備援" title="Direct link to 備援">​</a></h4><p>可以對資料庫(一般用主庫)做 snapshot,又分為自己手動備份跟 aws 定期備份，差別在未來刪除資料庫時，aws 定期備份會被刪到剩最終備份，而用戶手動備份不會被 AWS 刪除。</p><p>另外，儲存體磁碟區快照在單一 AZ 中建立會導致 I/O 短暫停用！異地同步備份 I/O 不會受此 I/O 影響，因為是在待命狀態下進行備份。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="高可用">高可用<a href="#高可用" class="hash-link" aria-label="Direct link to 高可用" title="Direct link to 高可用">​</a></h4><p>為紓緩主資料庫流量，RDS 提供唯獨副本服務，把主庫資料異步複製到另外一個 AZ 的 ReadOnly DB(Read Replica) 單純用來查詢。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Read Replica 跟 slave DB 相似，差別在前者可以做到跨 Region ，且可以轉成 standalone DB instance.</p></div></div><p>另外，為避免主庫失效，也可以使用 Multi-AZ 服務啟用備用資料庫(Standby)，平時主庫資料會同步複製到 standby，唯獨副本跟快照備份工作都交給 Standby，當主庫不小心掛了就會切換用備用資料庫。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="route-53">Route 53<a href="#route-53" class="hash-link" aria-label="Direct link to Route 53" title="Direct link to Route 53">​</a></h2><p>主要是 DNS Registry 中建立並管理 DNS Record, 常用的 Record 形式有 A,CName,另外 aws 還有提供 alias record(底層依舊是 A record). 並選擇路由政策,最常用間的會是 simple routing policy,有特殊需求會依據地理位置,效能(延遲最少,故障轉移),伺服器客製.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="alias-record">alias record<a href="#alias-record" class="hash-link" aria-label="Direct link to alias record" title="Direct link to alias record">​</a></h3><p>要把 dns record 接上某個 aws 資源,例如 alb,可以使用以下方式</p><ol><li>自己公司域名 CNAME 到 aws 資源產生的隨機域名,該筆隨機域名在 aws 那邊會被 A record 到 ELB ip.</li><li>A record 在 Alias 情況下連接到 aws 資源</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="cloudwatch">CloudWatch<a href="#cloudwatch" class="hash-link" aria-label="Direct link to CloudWatch" title="Direct link to CloudWatch">​</a></h2><p>監控 aws 服務資源的 log,硬體服務他可以直接收集,</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="AWS" term="AWS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Zabbix Sender monitor key word in log, and show data in grafana]]></title>
        <id>https://suyuying.github.io/blog/2023/03/29/Zabbix/zabbix-monitor-log</id>
        <link href="https://suyuying.github.io/blog/2023/03/29/Zabbix/zabbix-monitor-log"/>
        <updated>2023-03-29T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[定時抓取某log file其中的特定關鍵字，用zabbix-sender傳送資訊給zabbix server，並把資料設定報警到telegram，資訊會用grafana的log顯示。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前提">前提<a href="#前提" class="hash-link" aria-label="Direct link to 前提" title="Direct link to 前提">​</a></h2><p>這邊假設已經設定好 host，且 zabbix 有接上 grafana 情況後，繼續往下描述.</p><p>目的: 定時抓取某 log file 其中的特定關鍵字，用 zabbix-sender 傳送資訊給 zabbix server，並把資料設定報警到 telegram，資訊會用 grafana 的 log 顯示。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step1-設定-item">step1. 設定 item<a href="#step1-設定-item" class="hash-link" aria-label="Direct link to step1. 設定 item" title="Direct link to step1. 設定 item">​</a></h3><p>正常 zabbix 設定機器流程：</p><p>建立 Hosts groups-&gt; 建立 Templates-&gt;往 Template 內設定要監控的 item-&gt;再把 templates 連結到 Hosts Groups 上面-&gt;最後把主機也就是 Host 添加到指定的 Host groups 上面。</p><p>這邊因為特別需求關係(只有這一台機器需要），因此直接在該 Host 上面設定 item.</p><p>選 Hosts</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-side-bar-9ca4a1f3116d447b5a09cc577b209704.png" style="max-height:300px" alt="zabbix-side-bar" class="img_CujE"></div><p>因為是用 zabbix-sender 所以這邊 type 用 zabbix trapper，要注意機器上面都用 Key 跟 zabbix server 溝通，Name 是該 Item 的名字，兩個設定常常會搞混。</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-traper-56b38395d4722bd7c7303d094a64a3e4.png" style="max-height:300px" alt="zabbix-side-bar" class="img_CujE"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step2-安裝-zabbix-sender-並傳資料">step2. 安裝 zabbix-sender 並傳資料<a href="#step2-安裝-zabbix-sender-並傳資料" class="hash-link" aria-label="Direct link to step2. 安裝 zabbix-sender 並傳資料" title="Direct link to step2. 安裝 zabbix-sender 並傳資料">​</a></h3><p>機器上腳本設定 zabbix_sender 傳送資料，用 key 跟 output 做傳送</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 安裝zabbix-sender</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">yum install zabbix-sender</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 傳資訊給zabbix server</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">zabbix_sender -z 10.121.0.9  -s yourHostName -k test -o "$(cat /tmp/Lost_connection_to_db_server_${range2}_${range1}.log)"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>確認 zabbix 是否有收到資料</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-get-last-data-4f5035c4cd89c0a5bd7642c9c12dd638.png" style="max-height:300px" alt="zabbix-side-bar" class="img_CujE"></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step3-設定-grafana-抓取資料">step3. 設定 grafana 抓取資料<a href="#step3-設定-grafana-抓取資料" class="hash-link" aria-label="Direct link to step3. 設定 grafana 抓取資料" title="Direct link to step3. 設定 grafana 抓取資料">​</a></h3><p>確認有收到資料後，在 grafana 新建 panel</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/grafana-add-new-panel-bb60eccf47e80c7f2c2cbb02942536af.png" style="max-height:300px" alt="zabbix-side-bar" class="img_CujE"></div><p>設定資料原，注意這邊的 Query Mode 是設定 Text，有很多種型態，選錯會找不到資料</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/grafana-set-data-source-861012de7e8c4fbf707311228a71155d.png" style="max-height:300px" alt="zabbix-side-bar" class="img_CujE"></div><p>Grafana 模式記得要選 log，也可以使用其他模式玩玩看，因為這邊沒啥雷，就不特別截圖說明</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="optionalstep4-zabbix-告警-tg">(optional)step4. zabbix 告警 tg<a href="#optionalstep4-zabbix-告警-tg" class="hash-link" aria-label="Direct link to (optional)step4. zabbix 告警 tg" title="Direct link to (optional)step4. zabbix 告警 tg">​</a></h3><p>先設定 Trigger，Problem expression 也就是當傳送資訊符合設定的條件就會引發告警，Recovery experssion 也就是當資訊符合哪些條件就會解除告警。</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-sender-b-log-12674fa7728409ba93f08ce3b314e90f.png" alt="zabbix-side-bar" class="img_CujE"></div><p>確定完的確會告警跟回復後，就可以設定 TG 告警。先去 Administration-&gt;Media type 複製 Telegram 那格。</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-clone-telegrana-2ff897d7d94a2c5fea128dda989a63dd.png" alt="zabbix-side-bar" class="img_CujE"></div><p>在 Token 位置加入你 TG Token</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-add-token-5636eb87fb7a7f27bdfe474efe54f31e.png" alt="zabbix-side-bar" class="img_CujE"></div><p>建立新 User Group</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-add-zabbix-group-27771fa730ca2f4fdd2f0095b5303ff0.png" style="max-height:300px" alt="zabbix-side-bar" class="img_CujE"></div><p>設定該 User Group 對哪些 Host Group 有監控權限。</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-group-permission-fd95dfc4b5d7cc63e18161e07d5aa0da.png" style="max-height:300px" alt="zabbix-side-bar" class="img_CujE"></div><p>建立 User，並把該 User 加到 Group 內部，並設定當哪些狀態發生就往 TG 送資料</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-user-media-7b08a9012605c23fa5347612a4d86c60.png" style="max-height:300px" alt="zabbix-side-bar" class="img_CujE"></div><p>以上都 OK，可以會到前面 media type 那邊測試是否可以傳資料到ＴＧ</p><p>如果要將 Trigger 的資料送到 TG，一定要設定 Actions，這邊是一個坑，前面設定完了但都沒有送到 TG，結果發現這格沒有設定ＺＺＺ</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/zabbix-trigger-actions-to-tg-25d1c6bc96907c6f46a5c985f47f6ce3.png" style="max-height:300px" alt="zabbix-side-bar" class="img_CujE"></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="Zabbix" term="Zabbix"/>
        <category label="Grafana" term="Grafana"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[aws iam setting introduction]]></title>
        <id>https://suyuying.github.io/blog/2023/03/25/Aws/aws-iam-setting</id>
        <link href="https://suyuying.github.io/blog/2023/03/25/Aws/aws-iam-setting"/>
        <updated>2023-03-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[官方建議大多情況都會適用 IAM role，使用 IMA role 的優點是他是使用暫時性憑證(可設定到期時間)，而 IAM 使用者用的都是長期的 aws_secret_access_key(因此官方會建議定時換，不過一般來說沒人那麼勤勞 ZZZ)。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-aws-iam">what is aws IAM<a href="#what-is-aws-iam" class="hash-link" aria-label="Direct link to what is aws IAM" title="Direct link to what is aws IAM">​</a></h2><p><a href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/service_code_examples.html" target="_blank" rel="noopener noreferrer">什麼是 IAM</a> aws 官網的資訊一般都寫得滿棒的，本文出處主要是參考官網資訊做整理，因為管理上經驗只限於自己的環境用的 s3,CI 等等，所以打算趁這個機會檢視之前設定的 iAM 有沒有問題，當然，我相信這只是過程，隨著看過的資訊跟事情越多，會得到不同或者多個答案，總之，就先從這一步開始吧！</p><p>AWS Identity and Access Management (IAM) 用途：安全地控制對 Amazon Web Services (AWS) 和帳戶資源的存取。使用 IAM 為使用者和角色等身分提供您的帳戶中資源的存取權。</p><p>以下是 IAM 安全架構參考網路資源，主要組成如圖</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/iam-structure-66a78d44c84c4325ae24c3a93b04d714.png" alt="malta_street png" class="img_CujE"></div><div class="text-center"><a href="https://hackmd.io/@study-group-aws-book/HkhQ2BlRP" target="_blank" rel="noopener noreferrer">本圖參考讀書會-大話AWS雲端結構</a></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="typical-composition">typical composition<a href="#typical-composition" class="hash-link" aria-label="Direct link to typical composition" title="Direct link to typical composition">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Policy -&gt; IAM identities(IAM group or Role)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="policy">Policy<a href="#policy" class="hash-link" aria-label="Direct link to Policy" title="Direct link to Policy">​</a></h3><p>格式: 祈使＋主詞(<a href="#iam-identities">IAM identities</a>)＋條件＋動詞(optional)＋資源受詞 (對應：允許 Don 奧丁破關一百次時 吃 麥當勞)</p><p>對應 Aws Json(把上面舉例更換而已)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Effect : "允許"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Principal: "Don"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Condition:"奧丁破關一百次時"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Action: "吃"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resource :"麥當勞"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>正式版 Aws Json</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "Version": "2012-10-17",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "Statement": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Sid": "PublicReadGetObject",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Effect": "Allow",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Principal": "*",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Action": "s3:GetObject",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Resource": "arn:aws:s3:::myresume-for-zaxx/*"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iam-identities">IAM identities<a href="#iam-identities" class="hash-link" aria-label="Direct link to IAM identities" title="Direct link to IAM identities">​</a></h3><p>共有根使用者、IAM 使用者、IAM 使用者群組、IAM 角色、暫時性憑證</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="根使用者">根使用者<a href="#根使用者" class="hash-link" aria-label="Direct link to 根使用者" title="Direct link to 根使用者">​</a></h4><p>Root 可以存取所有 aws 資源,且權限最高,aws 建議日常工作事項都用一般使用者,除非是以下工作:</p><ul><li>管理一般使用者權限</li><li>停用 AWS 帳戶</li><li>帳戶花費管理</li></ul><p>更多資料可以看<a href="https://docs.aws.amazon.com/accounts/latest/reference/root-user-tasks.html" target="_blank" rel="noopener noreferrer">官網這篇</a></p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="iam-使用者">IAM 使用者<a href="#iam-使用者" class="hash-link" aria-label="Direct link to IAM 使用者" title="Direct link to IAM 使用者">​</a></h4><p>具備單一人員或應用程式的特定許可，AWS 建議人員金鑰長期憑證者要定期更換，而相比長期憑證更建議用暫時性憑證.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="iam-使用者群組">IAM 使用者群組<a href="#iam-使用者群組" class="hash-link" aria-label="Direct link to IAM 使用者群組" title="Direct link to IAM 使用者群組">​</a></h4><p>使用者集合的身份，透過 IAM 使用者群組管理 IAM 使用者</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="iam-角色">IAM 角色<a href="#iam-角色" class="hash-link" aria-label="Direct link to IAM 角色" title="Direct link to IAM 角色">​</a></h4><p>它類似 IAM 使用者，但不與特定的人員相關聯。角色的目的是讓需要它的任何人可代入，理解上就像是個具有權限的有時效性 token，可以給 code 或使用者或資源使用。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="暫時性憑證">暫時性憑證<a href="#暫時性憑證" class="hash-link" aria-label="Direct link to 暫時性憑證" title="Direct link to 暫時性憑證">​</a></h4><p><a href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/best-practices.html" target="_blank" rel="noopener noreferrer">最佳實務</a>它類似 IAM 使用者，但不與特定的人員相關聯</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="何時使用-iam-identity-center-使用者">何時使用 IAM Identity Center 使用者？<a href="#何時使用-iam-identity-center-使用者" class="hash-link" aria-label="Direct link to 何時使用 IAM Identity Center 使用者？" title="Direct link to 何時使用 IAM Identity Center 使用者？">​</a></h4><p><a href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id.html#id_temp-creds" target="_blank" rel="noopener noreferrer">官方回覆</a></p><p>看起來是可以透過單一登入，去取得在所有帳戶中所授的權限</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="何時建立-iam-使用者-而不是角色">何時建立 IAM 使用者 (而不是角色)<a href="#何時建立-iam-使用者-而不是角色" class="hash-link" aria-label="Direct link to 何時建立 IAM 使用者 (而不是角色)" title="Direct link to 何時建立 IAM 使用者 (而不是角色)">​</a></h4><p>建議您僅將 IAM 使用者用於聯合身分使用者不支援的使用案例。聯合身分使用者(federating exist user)是透過外部資源去連 AWS 上時，透過 IAM role 分配資源取得權限，配合跟 ldP(external identity provider)ex.FB,google 驗證，讓使用者可以取的短期憑證。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="何時建立-iam-角色-而不是使用者">何時建立 IAM 角色 (而不是使用者)<a href="#何時建立-iam-角色-而不是使用者" class="hash-link" aria-label="Direct link to 何時建立 IAM 角色 (而不是使用者)" title="Direct link to 何時建立 IAM 角色 (而不是使用者)">​</a></h4><p>程式端向 aws 資源請求、aws 服務間串接、以及公司的 single sign on(系統有採用 SAML 2.0 或建立並使用自訂代理伺服器，將使用者身分從企業轉換為提供暫時 AWS 安全憑證的 IAM 角色)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brief-summary">Brief summary<a href="#brief-summary" class="hash-link" aria-label="Direct link to Brief summary" title="Direct link to Brief summary">​</a></h3><p>官方建議大多情況都會適用 IAM role，使用 IMA role 的優點是他是使用暫時性憑證(可設定到期時間)，而 IAM 使用者用的都是長期的 aws_secret_access_key(因此官方會建議定時換，不過一般來說沒人那麼勤勞 ZZZ)。</p><p>官網提工暫時性憑證的優點</p><ol><li><p>不必隨應用程式散發或內嵌長期 AWS 安全憑證:舉例來說，公司有個腳本拿來是拿來更新前端資源的，如果使用 IAM 使用者，那他的私 key 就會跟著這隻腳本到處跑，但用 role 的話不用。</p></li><li><p>可以提供 AWS 資源存取給使用者，而不必為其定義 AWS 身分。暫時憑證是<a href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id_roles.html" target="_blank" rel="noopener noreferrer">角色和聯合身分</a>的基礎。</p></li><li><p>暫時性安全憑證的存留期有限，因此當不再需要時，您不需要輪換它們或明確予以撤銷</p></li></ol><p>不過每個公司都有各自文化。習慣之後再去看自己公司那套的優缺點～</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="aws-iam-setting-guide">aws iam setting guide<a href="#aws-iam-setting-guide" class="hash-link" aria-label="Direct link to aws iam setting guide" title="Direct link to aws iam setting guide">​</a></h2><p>因為 root 權限強大,所以基本上會給予一些限制(設定建議).流程為以下:</p><ul><li>刪除 Root 存取金鑰</li><li>Root 啟用 MFA 驗證</li></ul><p>在設定完 root 的基本安全設定後,接著就是要建立日常的 IAM 使用者.流程為以下:</p><ul><li>建立個別 IAM 使用者</li><li>建立群組,並連結 Policies 設定以其使用者</li><li>套用 IAM 密碼政策</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="刪除-root-存取金鑰">刪除 Root 存取金鑰<a href="#刪除-root-存取金鑰" class="hash-link" aria-label="Direct link to 刪除 Root 存取金鑰" title="Direct link to 刪除 Root 存取金鑰">​</a></h3><p>因為 root 權限太高,不建議用 root 身份的金鑰(access key)在程式中存取 aws 資源,為避免意外,會執行 root 的 access key 刪除(一般預設不會產生,除非先前有操作產生 access key).</p><p>步驟:</p><p>click 右上角帳號欄-&gt;security credentials-&gt;下滑到 Access key 處-&gt;停用-&gt;刪除-&gt;done</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="啟用-mfa-驗證">啟用 MFA 驗證<a href="#啟用-mfa-驗證" class="hash-link" aria-label="Direct link to 啟用 MFA 驗證" title="Direct link to 啟用 MFA 驗證">​</a></h3><p>預設下,root 登入都用 email 跟 password,因為這些東西都有可能不小心洩漏(習慣用同一組密碼),aws 透過 MFA 提升安全性,驗證方式這邊提供常用的虛擬 MFA 驗證(Authenticator app).</p><p>步驟:</p><p>先安裝 MFA 驗證 APP-&gt;click 右上角帳號欄-&gt;安全憑證 security credentials-&gt;啟用 MFA(assign MFA device)-&gt;Authenticator app -&gt; show QR code 讓 app 掃描 or 填入 MFA codes -&gt;done</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="建立個別-iam-使用者">建立個別 IAM 使用者<a href="#建立個別-iam-使用者" class="hash-link" aria-label="Direct link to 建立個別 IAM 使用者" title="Direct link to 建立個別 IAM 使用者">​</a></h3><p>root 權限太高,建議日常操作都用符合相應權限的 IAM 使用者去處理.</p><p>步驟:
IAM -&gt; Access management-&gt;使用者(users)-&gt;create user-&gt; click Provide user access to the AWS Management Console -&gt; click i want to create an IAM user -&gt; click Autogenerated password -&gt; click Users must create a new password at next sign-in (recommended)</p><p>這邊是 demo 建立一個可以進入 aws console 的使用者,一般而言 aws 建議用 Identity Center 去管理使用者,不過小公司或個人使用就先 i want to create an IAM user 就好,優點是你想要建立能給程式用的 access key 可以直接建立.這邊操作為先建立使用者,之後再連結群組跟政策. ps.要建立 access key 請另外點到 Users 裡面的 security credentials 建立 Access keys.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="建立群組並連結-policies-設定">建立群組,並連結 Policies 設定<a href="#建立群組並連結-policies-設定" class="hash-link" aria-label="Direct link to 建立群組,並連結 Policies 設定" title="Direct link to 建立群組,並連結 Policies 設定">​</a></h3><p>這邊設定基本上就是建立群組,並連結自己建立的 policy(依據 EPCAR 原則) 或 aws 內建的 policy</p><p>步驟:</p><p>IAM -&gt; Access management -&gt; User groups</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="套用-iam-密碼政策">套用 IAM 密碼政策<a href="#套用-iam-密碼政策" class="hash-link" aria-label="Direct link to 套用 IAM 密碼政策" title="Direct link to 套用 IAM 密碼政策">​</a></h3><p>基本上每間公司都會有自己的密碼政策,在 IAM 裡面當然也有！</p><p>步驟:</p><p>IAM -&gt;Access management-&gt; Account settings -&gt; Password policy -&gt; Edit -&gt;Custom</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="AWS" term="AWS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[How to let google find my website?]]></title>
        <id>https://suyuying.github.io/blog/2023/03/20/SEO/google-register</id>
        <link href="https://suyuying.github.io/blog/2023/03/20/SEO/google-register"/>
        <updated>2023-03-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[register my website to google]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="記錄一下整個-google-註冊自己網站過程">記錄一下整個 google 註冊自己網站過程<a href="#記錄一下整個-google-註冊自己網站過程" class="hash-link" aria-label="Direct link to 記錄一下整個 google 註冊自己網站過程" title="Direct link to 記錄一下整個 google 註冊自己網站過程">​</a></h2><ol><li>主要參考這篇 <a href="https://web-design.vip/google-web-submit.html" target="_blank" rel="noopener noreferrer">https://web-design.vip/google-web-submit.html</a> ， 他會提供你三個讓 google 爬蟲找到你最快得方式。</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="讓你的網站加入搜尋功能">讓你的網站加入搜尋功能<a href="#讓你的網站加入搜尋功能" class="hash-link" aria-label="Direct link to 讓你的網站加入搜尋功能" title="Direct link to 讓你的網站加入搜尋功能">​</a></h2><ol><li><a href="https://docusaurus.io/docs/next/search" target="_blank" rel="noopener noreferrer">Using Algolia DocSearch</a>申請 Algolia 審查</li><li></li></ol>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="google" term="google"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[docker gitlab runner error during connect Post "http://docker:2375/v1.24/auth" dial tcp lookup docker on 1.1.1.1:53 no such host]]></title>
        <id>https://suyuying.github.io/blog/2023/03/16/Docker/docker-gitlab-error-connect-docker</id>
        <link href="https://suyuying.github.io/blog/2023/03/16/Docker/docker-gitlab-error-connect-docker"/>
        <updated>2023-03-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[執行這個修改，volumes 改為 ["/var/run/docker.sock:/var/run/docker.sock", "/cache"]，讓 Runner Executor 使用主機外部的 Docker Engine。所以推測，這可能是 gitlab runner 跟 gitlab server 上面驗證的機制，如果沒有這樣加，dind 就找不到 gitlab server 的驗證那關，所以就會失敗]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="遇到問題的情境">遇到問題的情境<a href="#遇到問題的情境" class="hash-link" aria-label="Direct link to 遇到問題的情境" title="Direct link to 遇到問題的情境">​</a></h2><p>CICD 步驟裡面，每當開發人員把 code 寫完之後，會進行測試並把 code build 成 image 後推到 image registry
，之後到環境執行 deploy。</p><p>在 gitlab 裡面會用 gitlab runner，並在.gitlab-ci.yml 設計促發的情境下，執行.gitlab-ci.yml 內容，要在 gitlab runner 內 build image 通常會用到 docker:dind，它是具有 docker 引擎的 container！一般的 image 內通常都不會去安裝 docker 引擎，這段有點難懂，但你可以想想有 nginx,mysql 等等的 image，基本上只會有自己預設功能，不需要 docker 引擎，對於 docker 而言，裡面要可以用 docker 指令的， docker:dind 是一個選項。</p><p>在 build 版執行的 yml 如下。
主要功能就是登入在 gitlab 上面的公司的 image registry,之後在 gitlab runner 執行 build image 並推到 gitlab image registry.</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.gitlab-ci.yml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">stages</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">variables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">IMAGE_NAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> hahaha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY_IMAGE</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">$</span><span class="token constant" style="color:#36acaa">IMAGE_NAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">$</span><span class="token constant" style="color:#36acaa">CI_COMMIT_SHORT_SHA</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># </span><span class="token maybe-class-name">Build</span><span class="token plain"> moni</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">moni</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">stage</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">image</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> docker</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">dind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">tags</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">before_script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker login </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">u $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY_USER</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY_PASSWORD</span><span class="token plain"> $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker build </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">t $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker push $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker rmi $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">except</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> schedules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Dockerfile</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">FROM</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">node</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">COPY</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">node </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">WORKDIR</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">RUN</span><span class="token plain"> npm install</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">npm install gulp </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">g</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">gulp build</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">EXPOSE</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">CMD</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"npm"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"run"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"start"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>執行過程到這一步<code>- docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY</code>遇到報錯，
<code>error during connect: Post "http://docker:2375/v1.24/auth": dial tcp: lookup docker on 1.1.1.1:53: no such host</code>。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="解法">解法:<a href="#解法" class="hash-link" aria-label="Direct link to 解法:" title="Direct link to 解法:">​</a></h3><p>在你掛到 gitlab runner 中 /etc/gitlab-runner 裡面的 config.toml，請先用 docker inspect 觀察 volume 掛載位置，如果你是用官網 local volume 掛載方法，那就是在 VM 上去 vim /srv/gitlab-runner/config/config.toml，去修改
<code>volumes = ["/cache"]</code> 變成
<code>volumes = ["/var/run/docker.sock:/var/run/docker.sock","/cache"]</code>。</p><p>並執行<code>docker restart gitlab-runner</code>!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="可能原因">可能原因：<a href="#可能原因" class="hash-link" aria-label="Direct link to 可能原因：" title="Direct link to 可能原因：">​</a></h3><p>執行這個修改，volumes 改為 <!-- -->["/var/run/docker.sock:/var/run/docker.sock", "/cache"]<!-- -->，讓 Runner Executor 使用主機外部的 Docker Engine。</p><p>所以推測，這可能是 gitlab runner 跟 gitlab server 上面驗證的機制，如果沒有這樣加，dind 就找不到 gitlab server 的驗證那關，所以就會失敗</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docker" term="docker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[environment variable and  secrets variable config in github]]></title>
        <id>https://suyuying.github.io/blog/2023/03/16/github-action/githubaction-env-secrets-variablr-config</id>
        <link href="https://suyuying.github.io/blog/2023/03/16/github-action/githubaction-env-secrets-variablr-config"/>
        <updated>2023-03-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[使用 CI 跟寫程式都會遇到要從 env 拿取變數值的時候，在 github 管理方式如下，主要判斷是這個變數是否要給多個 workflow 使用。如果您不確定，也可以從存儲庫密鑰開始為所有東西創建密鑰。如果之後有引入需要不同密鑰的不同環境，例如 prod,dev,test 等，則可以將存儲庫密鑰移動到特定環境。然後在特定環境用特定變數值。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="workflow-區分-env-設定模式">workflow 區分 env 設定模式<a href="#workflow-區分-env-設定模式" class="hash-link" aria-label="Direct link to workflow 區分 env 設定模式" title="Direct link to workflow 區分 env 設定模式">​</a></h2><p>使用 CI 跟寫程式都會遇到要從 env 拿取變數值的時候，在 github 管理方式如下，主要判斷是這個變數是否要給多個 workflow 使用。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="單-workflow-使用">單 workflow 使用<a href="#單-workflow-使用" class="hash-link" aria-label="Direct link to 單 workflow 使用" title="Direct link to 單 workflow 使用">​</a></h3><p>非密碼類型，在 workflow 中定義 env 即可。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name: Greeting on variable day</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  workflow_dispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DAY_OF_WEEK: Monday</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  greeting_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: "Say Hello Mona it's Monday"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "$Greeting $First_Name. Today is $DAY_OF_WEEK!"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          First_Name: Mona</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>不同層次的環境變數可以繼承並覆蓋較高層次的環境變數。例如，如果您在頂級工作流程文件中設置了一個環境變數，並且在作業中使用相同的變數名稱定義了另一個值，那麼在該作業中使用的值將覆蓋頂級值。</p><p>密碼類型，就需要用到會跨多個 workflow 的 secrets 去管理。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="多-workflow-使用">多 workflow 使用<a href="#多-workflow-使用" class="hash-link" aria-label="Direct link to 多 workflow 使用" title="Direct link to 多 workflow 使用">​</a></h3><p>需在 github UI 設定變數。這些變數可以跨多個工作流程使用。
位置</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/github-env-repo-variable-18c0308cd7664714c41cd456ccba373e.png" alt="github-env-repo-variable.png" class="img_CujE"></div><p>主要三層級:</p><ol><li><p>組織</p></li><li><p>存儲庫</p></li><li><p>環境</p><p>上面圖有 repo 跟 env 的，使用順序部分：Environment &gt; Repository &gt; Organization。
如果有相同變數，優先用 Environment , than Repository, than：Organization。</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用情境">使用情境<a href="#使用情境" class="hash-link" aria-label="Direct link to 使用情境" title="Direct link to 使用情境">​</a></h2><p>這邊提供參考</p><p>如果您不確定，也可以從存儲庫密鑰開始為所有東西創建密鑰。如果之後有引入需要不同密鑰的不同環境，例如 prod,dev,test 等，則可以將存儲庫密鑰移動到特定環境。然後在特定環境用特定變數值。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用方法">使用方法<a href="#使用方法" class="hash-link" aria-label="Direct link to 使用方法" title="Direct link to 使用方法">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="設定在-sercrets">設定在 sercrets<a href="#設定在-sercrets" class="hash-link" aria-label="Direct link to 設定在 sercrets" title="Direct link to 設定在 sercrets">​</a></h3><p>要用要這樣用<code>${{ secrets.YOURKEY }}</code>
為啥格式長這樣要看<a href="https://docs.github.com/en/actions/learn-github-actions/contexts#secrets-context" target="_blank" rel="noopener noreferrer">secrets 上下文</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="設定在-variables">設定在 variables<a href="#設定在-variables" class="hash-link" aria-label="Direct link to 設定在 variables" title="Direct link to 設定在 variables">​</a></h3><p>要用要這樣用<code>${{ vars.YOURKEY }}</code>
為啥格式長這樣要看<a href="https://docs.github.com/en/actions/learn-github-actions/contexts#vars-context" target="_blank" rel="noopener noreferrer">vars 上下文</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="設定在-workflow-裡的-env">設定在 workflow 裡的 env<a href="#設定在-workflow-裡的-env" class="hash-link" aria-label="Direct link to 設定在 workflow 裡的 env" title="Direct link to 設定在 workflow 裡的 env">​</a></h3><p>如果是在機器底下，可以用<code>$KEY</code>(linux).</p><p>設定在機器外面(job 以上層級)要用<a href="https://docs.github.com/en/actions/learn-github-actions/contexts#env-context" target="_blank" rel="noopener noreferrer">env 上下文</a>，<code>${{ env.mascot }}</code></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><a href="https://docs.github.com/en/actions/learn-github-actions/variables" target="_blank" rel="noopener noreferrer">參考的官網資料-variables 管理</a></p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[A small issue with curl related to using different versions of curl between IDE and local terminal]]></title>
        <id>https://suyuying.github.io/blog/2023/03/16/linux-server/little-curl-problem</id>
        <link href="https://suyuying.github.io/blog/2023/03/16/linux-server/little-curl-problem"/>
        <updated>2023-03-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[前陣子因為需要檢查域名設定，測試過程中發現在 pycharm 運行 curl 指令，運行結果跟 iterm2 的運行結果不同，以下是 demo 指令，最後使用which curl發現兩邊curl有差別，進一步檢查發現兩者檔案 size 也有差，使用的相關套件也有差。心得：基本上連自己電腦環境都可能用髒了，之後排查類似的bug順序會先檢查彼此使用指令的版本，確認沒差太多，在開始往其他方向排查。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="同-pc-的-curl-結果不同">同 pc 的 curl 結果不同<a href="#同-pc-的-curl-結果不同" class="hash-link" aria-label="Direct link to 同 pc 的 curl 結果不同" title="Direct link to 同 pc 的 curl 結果不同">​</a></h2><p>前陣子因為需要檢查域名設定，測試過程中發現在 pycharm 運行 curl 指令，運行結果跟 iterm2 的運行結果不同，以下是 demo 指令</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -XPOST 'https://www.boce.com/apiHtml/login' \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -A "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36" \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H 'Content-Type: application/json' \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d '{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "email_or_phone":"thisIsSecret",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "password":"thisIsSecret"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="curl-指令基本介紹">curl 指令基本介紹<a href="#curl-指令基本介紹" class="hash-link" aria-label="Direct link to curl 指令基本介紹" title="Direct link to curl 指令基本介紹">​</a></h2><p>Curl 是一種在命令列介面下使用的開放原始碼檔案傳輸工具，常用於 HTTP、HTTPS、FTP 等協定的傳輸
因為<code>curl</code>選項太多，可以用<code>curl --help all</code>看所有選項，
常用選項有以下</p><ol><li>-H 帶 header</li><li>-A 帶 useragent</li><li>-i 看回應 header(可以拿來查回應 token)</li><li>-d 使用 post 方法要帶入 data</li><li>-X 使用的方法 ex. POST PUT DELETE GET</li><li>-c cookie 相關操作
以下為例，登入網站並把回應 cookie 存在 cookie.txt</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -c cookie.txt -XPOST 'https://www.boce.com/apiHtml/login' \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -A "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36" \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H 'Content-Type: application/json' \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d '{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "email_or_phone":"thisIsSecret",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "password":"thisIsSecret"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>後續可以用<code>curl -b cookie.txt</code>在請求時把 cookie 帶入到 request 中</p><ol start="7"><li>-v 詳細模式</li><li><code>-o file名稱 網址</code> 下載圖片使用，檔名自己命名 Write to file instead of stdout</li><li><code>-O 網址</code> 下載資料使用，檔名同遠端網址檔名 Write output to a file named as the remote file</li><li>-L 跟隨 301 302 跳轉</li><li>Basic Authentication，可以攜帶 --user username:password 來通過驗證。</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step1-問題排查-curl--v-看過程">step1. 問題排查 curl -v 看過程<a href="#step1-問題排查-curl--v-看過程" class="hash-link" aria-label="Direct link to step1. 問題排查 curl -v 看過程" title="Direct link to step1. 問題排查 curl -v 看過程">​</a></h3><p>比較後發現，ide 跟 terminal 帶的 header 跟 useragent 這些都有帶，問題不在這邊。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step2-檢查使用的-curl-是否有差">step2. 檢查使用的 curl 是否有差<a href="#step2-檢查使用的-curl-是否有差" class="hash-link" aria-label="Direct link to step2. 檢查使用的 curl 是否有差" title="Direct link to step2. 檢查使用的 curl 是否有差">​</a></h3><p>檢查<code>which crul</code>輸出</p><p>ide: /usr/bin/curl (curl 7.79.1 (x86_64-apple-darwin21.0) libcurl/7.79.1 (SecureTransport) LibreSSL/3.3.6 zlib/1.2.11 nghttp2/1.45.1
Release-Date: 2021-09-22)</p><p>terminal: /Users/ford/opt/anaconda3/bin/curl (curl 7.82.0 (x86_64-apple-darwin13.4.0) libcurl/7.82.0 OpenSSL/1.1.1n zlib/1.2.12 libssh2/1.10.0 nghttp2/1.46.0
Release-Date: 2022-03-05)</p><p>發現有差別，進一步檢查發現兩者檔案 size 也有差，使用的相關套件也有差。</p><p>解法： 直接指定 curl 位置,/usr/bin/curl 。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="心得">心得<a href="#心得" class="hash-link" aria-label="Direct link to 心得" title="Direct link to 心得">​</a></h2><p>基本上連自己電腦環境都可能用髒了，之後排查類似的 bug 順序會先檢查彼此使用指令的版本，確認沒差太多，在開始往其他方向排查。</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="curl" term="curl"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[s3 set iam permissions for Github Actions to achieve CIBuild an AWS s3 static website]]></title>
        <id>https://suyuying.github.io/blog/2023/03/15/Aws/s3-setting-for-ci</id>
        <link href="https://suyuying.github.io/blog/2023/03/15/Aws/s3-setting-for-ci"/>
        <updated>2023-03-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[建立aws靜態網站接上cloudfront，最後設定 github action 在 code 更新以後會把 build 好的資料由 build 資料夾底下東西發到 S3.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="s3-靜態網站設定">S3 靜態網站設定<a href="#s3-靜態網站設定" class="hash-link" aria-label="Direct link to S3 靜態網站設定" title="Direct link to S3 靜態網站設定">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>如果有打算限制能近來的域名，就請不要用靜態網站，就用預設的 RestApi 模式，接 cloudfront 透過 header 去限定。</p></div></div><p><a href="https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/HostingWebsiteOnS3Setup.html" target="_blank" rel="noopener noreferrer">官網教學很詳細！</a>
要在 Amazon S3 上設定靜態網站，如果是使用 UI 的話，請按照以下步驟進行操作：</p><ol><li>UI: 建立新的 S3 Bucket 或選擇一個現有的 Bucket。(Cli:<code>aws s3 mb s3://me-profile --profile ford --region us-west-1</code> 在 us-west-1 建立 s3 bucket,bucket 名稱是 me-profile,使用的 user 是 ford)</li><li>UI:在 Bucket 屬性中啟用靜態網站主機。</li><li>UI:指定要使用的索引文件(index.html)和錯誤文件。(Cli:<code>aws s3 website s3://bucket-name --index-document index.html --error-document error.html</code>)</li><li>UI :將必要的文件添加到 Bucket 中。(可以用 也可以用 cli
Cli:<code>aws s3 sync ./dist/ s3://fordserver-front --delete --profile ford</code>)</li><li>UI :配置 Bucket 策略以允許公開訪問文件，預設會全擋。</li><li>UI :新增儲存貯體政策，將儲存貯體內容設為可供大眾讀取，把這個 json 複製貼上</li></ol><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Version"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"2012-10-17"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Statement"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Sid"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"PublicReadGetObject"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Effect"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Allow"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Principal"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"*"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Action"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:GetObject"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Resource"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"arn:aws:s3:::Bucket-Name/*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Resource 更新為您的儲存貯體名稱!</p><ol start="7"><li>(可選)如果要配置自己買的域名， 把 cname 設置以指向 S3 網站端點。</li></ol><p>按照這些步驟，您可以使用 Amazon S3 建立簡單且具成本效益的靜態網站。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="接-clourfront">接 clourfront<a href="#接-clourfront" class="hash-link" aria-label="Direct link to 接 clourfront" title="Direct link to 接 clourfront">​</a></h2><p>建立一個靜態網站之後，去建立 cloudfront，把流量導到 s3。</p><p>以下是建立 CloudFront 分發的步驟：</p><ol><li>登入 AWS Management Console 並前往 CloudFront 控制台頁面。</li><li>點擊「建立 distribution」按鈕。</li><li>在「建立 distribution」頁面中，您可以從下拉式清單選擇「Web」或「RTMP」分發的類型。</li><li>對於 Web 分發，在 Origin 欄位中，從下拉式清單選擇您的 S3 桶的 REST API 端點或輸入您的 S3 桶的網站端點。<a href="https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/WebsiteEndpoints.html#WebsiteRestEndpointDiff" target="_blank" rel="noopener noreferrer">網站端點和 REST API 端點之間的主要差異</a></li><li>在預設快取行為中，為 Viewer 協議原則選擇 HTTP 和 HTTPS 或重新導向 HTTP 到 HTTPS。
注意：選擇僅使用 HTTPS 會封鎖所有 HTTP 請求。</li><li>如果您沒有使用 CloudFront 的替代域名 (CNAME)，則選擇「建立分發」以完成流程。如果您正在使用 CNAME，則在創建分發之前請按照以下額外步驟進行操作：<ul><li>對於替代域名 (CNAME)，請選擇「新增項目」，然後輸入您的替代域名。</li><li>對於自訂 SSL 憑證，從下拉式清單中選擇涵蓋您的 CNAME 的自訂 SSL 憑證，以將其指派給分發。(這裡可以用 aws 的自簽憑證會很方便!)</li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-provide-ci-access-to-write-to-s3-resources">lab: Provide CI access to write to S3 resources<a href="#lab-provide-ci-access-to-write-to-s3-resources" class="hash-link" aria-label="Direct link to lab: Provide CI access to write to S3 resources" title="Direct link to lab: Provide CI access to write to S3 resources">​</a></h2><p>目標: 設定 github action 在 code 更新以後會把 build 好的資料由 build 資料夾底下東西發到 S3.</p><p>名詞定義：</p><p>STS: AWS Security Token Service API,提供信任的使用者暫時安全憑證，控制對於 AWS 資源的存取。</p><p>OIDC: OpenID Connect,Google 或 Salesforce。如果想要在 OIDC 相容的 IdP 和您的 AWS 帳戶 之間建立信任，請使用 IAM OIDC 身分提供者。</p><p>IdP: Identity Provider 身分識別資訊提供者</p><p>SAML: Security Assertion Markup Language（安全斷言標記式語言）的縮寫，是指在身分識別資訊提供者（IdP）與服務提供者（Service Provider，SP）之間傳送驗證以及授權資料的一種公開標準。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lab-1用-iam-role-配合-odic-執行-ci">lab 1.用 IAM role 配合 ODIC 執行 CI<a href="#lab-1用-iam-role-配合-odic-執行-ci" class="hash-link" aria-label="Direct link to lab 1.用 IAM role 配合 ODIC 執行 CI" title="Direct link to lab 1.用 IAM role 配合 ODIC 執行 CI">​</a></h3><p>這邊示範用 ODIC，讓 aws 認可的 IdP 作身份驗證並連線到 AWS 存取並更新 S3.</p><p>在建立 IAM OIDC 身分提供者之後，必須建立一個或多個 IAM 角色。角色是 AWS 中的一個身分，並不擁有自己的憑證 (與 IAM 使用者不同)。在此情況中，角色以動態指派給聯合身分使用者，而該使用者由您組織的身分提供者 (IdP) 進行驗證。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">順序:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">建立Identity Providers-&gt;建立角色-&gt;自訂信任政策-&gt;連結許可政策-&gt;複製建立的角色ARN-&gt;設定github CI/CD的secret-&gt;建立yml檔</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="建立-identity-providers">建立 Identity Providers<a href="#建立-identity-providers" class="hash-link" aria-label="Direct link to 建立 Identity Providers" title="Direct link to 建立 Identity Providers">​</a></h4><ol><li>AWS console 查詢 IAM，左方 nav 欄位選供應商類型後, 選 OpenID Connect.</li><li>供應商 URL, 輸入 <a href="https://token.actions.githubusercontent.com" target="_blank" rel="noopener noreferrer">https://token.actions.githubusercontent.com</a></li><li>按"取得指紋"</li><li>對象, 輸入 sts.amazonaws.com
以上建立之後，arn:aws:iam::930209118237:oidc-provider/token.actions.githubusercontent.com</li><li>把 ARN 複製準備建立 role.</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="建立角色">建立角色<a href="#建立角色" class="hash-link" aria-label="Direct link to 建立角色" title="Direct link to 建立角色">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">自訂信任政策-&gt;連結許可</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>授權 聯合使用者主體，給 github repo 是 USERNAME/YOUR_REPO 的 pull or main 可以用此角色，以下記得替換成你的 repo 名稱歐！</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">信任政策(關係)</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Version"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"2012-10-17"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Statement"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Effect"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Allow"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Principal"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">"Federated"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"arn:aws:iam::9302XXX18237:oidc-provider/token.actions.githubusercontent.com"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Action"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sts:AssumeRoleWithWebIdentity"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Condition"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">"StringEquals"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string-property property" style="color:#36acaa">"token.actions.githubusercontent.com:sub"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">"repo:USERNAME/YOUR_REPO:pull_request"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">"repo:USERNAME/YOUR_REPO:ref:refs/heads/main"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string-property property" style="color:#36acaa">"token.actions.githubusercontent.com:aud"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sts.amazonaws.com"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>因為 S3 許可設定真的太多了，這邊主要就勾選 list 跟幾個會用到的 delete/get/put object，許可設定參考<a href="https://docs.github.com/zh/enterprise-server@3.8/admin/github-actions/enabling-github-actions-for-github-enterprise-server/enabling-github-actions-with-amazon-s3-storage#%E4%BD%BF%E7%94%A8%E8%AE%BF%E9%97%AE%E5%AF%86%E9%92%A5%E9%80%9A%E8%BF%87-amazon-s3-%E5%AD%98%E5%82%A8%E5%90%AF%E7%94%A8-github-actions" target="_blank" rel="noopener noreferrer">官網這篇</a>。在看許可過程中有看到 AWS cloudtrail 提供的 IAM 紀錄解析，幫你分析之前的操作並用最小權限去設定(這個情境官網有舉例: 開發時可能會把權限全開，但實際上 PROD 環境就要限制權限，可以透過 cloudtrail 去分析之前所有對 S3 操作有用到的權限，並設定之)，但因為還沒實作，所以就先這樣。</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">許可政策for S3 CI/CD</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Version"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"2012-10-17"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Statement"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Sid"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"VisualEditor0"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Effect"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Allow"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Action"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:PutObject"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:GetObject"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:ListBucketMultipartUploads"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:ListMultipartUploadParts"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:AbortMultipartUpload"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:DeleteObject"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:ListBucket"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Resource"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>github 設定檔，以下會執行 build，驗證 aws,把編譯後資料推到 s3。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>permissions 一定要設定成 write，這樣設定是要設寫入權限才能請求 OpenID Connect JWT 令牌。沒設定就會跑出以下報錯
Error: Credentials could not be loaded, please check your action inputs: Could not load credentials from any providers</p></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.github/workflows/deploy.yml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">on</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">push</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">branches</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # </span><span class="token maybe-class-name">Review</span><span class="token plain"> gh actions docs </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> you want to further define triggers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> paths</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">docs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">en</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">using</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">workflows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">workflow</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">syntax</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">github</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions#on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">permissions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  id</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">token</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">jobs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">deploy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">on</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">steps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">setup</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">cache</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Install</span><span class="token plain"> dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn install </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">frozen</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">lockfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Build</span><span class="token plain"> website</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Configure</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">AWS</span><span class="token plain"> </span><span class="token maybe-class-name">Credentials</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> aws</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">configure</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">aws</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">credentials@v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          aws</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">region</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ap</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          role</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">to</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">assume</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">PROD_DEPLOY_ROLE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          role</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">session</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">OIDCSession</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token constant" style="color:#36acaa">S3</span><span class="token plain"> bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> aws s3 sync </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">build</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> s3</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yours3 </span><span class="token operator" style="color:#393A34">--</span><span class="token keyword" style="color:#00009f">delete</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資訊</p><ol><li><p><a href="https://docs.github.com/zh/enterprise-server@3.8/admin/github-actions/enabling-github-actions-for-github-enterprise-server/enabling-github-actions-with-amazon-s3-storage" target="_blank" rel="noopener noreferrer">Enabling GitHub Actions with Amazon S3 storage</a></p></li><li><p><a href="https://www.eliasbrange.dev/posts/secure-aws-deploys-from-github-actions-with-oidc/#2-add-github-as-an-identity-provider" target="_blank" rel="noopener noreferrer">Secure AWS deploys from GitHub Actions with OIDC</a></p></li></ol></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="AWS" term="AWS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[CI:use github action to build image and push to git hub container registry]]></title>
        <id>https://suyuying.github.io/blog/2023/03/11/github-action/githib-action-CI-to-github-container</id>
        <link href="https://suyuying.github.io/blog/2023/03/11/github-action/githib-action-CI-to-github-container"/>
        <updated>2023-03-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[use CI in github action ,and variable in environments to build image and push to registry. github action 入門攻略，CI 推image到github]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-code-registry">Build code registry<a href="#build-code-registry" class="hash-link" aria-label="Direct link to Build code registry" title="Direct link to Build code registry">​</a></h2><p>把 code 推到 github 教學很多，可以 google 一下，不過要注意的是現在推 code 都要先在官網申請 token，新手很容易卡在這。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ways-to-build-image-and-push">ways to build image and push<a href="#ways-to-build-image-and-push" class="hash-link" aria-label="Direct link to ways to build image and push" title="Direct link to ways to build image and push">​</a></h2><p>執行 CI 前，要確認有 Dockerfile 並且在地端可以 docker run 服務起來，CI 過程會用該 Dokcerfile 產生 image。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="way1-build-image-and-push-from-local-side-by-docker-commanduse-ci-after-to-renew">way1. build image and push from local side by docker command,use CI after to renew<a href="#way1-build-image-and-push-from-local-side-by-docker-commanduse-ci-after-to-renew" class="hash-link" aria-label="Direct link to way1. build image and push from local side by docker command,use CI after to renew" title="Direct link to way1. build image and push from local side by docker command,use CI after to renew">​</a></h3><ol><li><p>在地端 build 完，然後推到 github container registry(需要用 github ui 建立 token,並給 token)
，然後把 token 存到 txt 檔</p></li><li><p>用 token 登入 github</p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat token.txt | docker login ghcr.io -u suyuying --password-stdin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>-u</code> 換成自己的 username</p><p><code>token.txt</code>把 token 放在裡面</p><ol start="3"><li>推 image 到 github container registry DONe</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx build --platform=linux/arm64,linux/amd64 --push -t ghcr.io/suyuying/fastapi-backend:1.0 .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>這個方法當下沒啥問題，會成功建立，如果以上方法要接ＣＩ，還有 step 4.
image，但之後接 CI 的時候會
遇到權限問題，貌似用 token 建立以後，你 CI 裡面使用 registry 的 <code>password: ${{ secrets.GITHUB_TOKEN }} </code> 的 token 會失效，<a href="https://github.com/orgs/community/discussions/26274" target="_blank" rel="noopener noreferrer">原本 issue 位置</a></p><p>4.請前往 $yourOrganization → Packages → $yourPackage → Package settings（右側/底部），並配置“管理操作訪問"部分以允許有問題的 git 存儲庫對此包 code 存儲庫有 write 權限</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="way2-use-ci-to-create-and-push-image-first-and-afterwards">way2. use CI to create and push image first, and afterwards<a href="#way2-use-ci-to-create-and-push-image-first-and-afterwards" class="hash-link" aria-label="Direct link to way2. use CI to create and push image first, and afterwards" title="Direct link to way2. use CI to create and push image first, and afterwards">​</a></h3><p>1.在.github/workflows 資料夾建立 xxx.yml 檔案，內容</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># This workflow uses actions that are not certified by GitHub.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># They are provided by a third-party and are governed by</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># separate terms of service, privacy policy, and support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># documentation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># GitHub recommends pinning actions to a commit SHA.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To get a newer version, you will need to update the SHA.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You can also reference a tag or branch, but the action may change without warning.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Create and publish a Docker image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    branches: ['main']</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build-and-push-image:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 這個是之後示範import config environment variable ,optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment: prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    permissions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      contents: read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      packages: write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 這個是建立這份文件的env變數</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Checkout repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Log in to the Container registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          registry: ghcr.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ github.actor }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.GITHUB_TOKEN }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //這邊的secrets要用Actions secrets and variables設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: mr-smithers-excellent/docker-build-push@v6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 這邊格式就記下來，因為他官網寫的也不清不楚的，這樣會做出ghcr.io/suyuying/fastapi-backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          image: fastapi-backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          registry: ghcr.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ secrets.GHCR_USERNAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.GHCR_TOKEN }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>放變數值到 github repo 上<div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/repo-secrect-3a35354eeda7b4df693c52a9e9e8e79a.png" style="width:100%" alt="malta_street png" class="img_CujE"></div></li></ol><p>GHCR_USERNAME="yourUserName"</p><p>GHCR_TOKEN="classic token 產出的 token"</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>可以用 Environment secrets 或 Repository secrets
對 workflow 而言他們都會放在 secrets 這個物件裡面，
使用方式向是
<code>${{ secrets.GHCR_TOKEN }}</code></p></div></div><ol start="3"><li>因爲條件設定 push main，所以確認好 main branch 直接推就會發現有新作 image 了</li></ol><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG">  <div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/vars-env-7f80c95e8356a4877a06290e615ef468.png" style="width:100%" alt="malta_street png" class="img_CujE"></div><p>如果要使用上面再 environment 環境變數取值，要使用這種格式
<code>${{ vars.READ_MY_NAME }}</code> 去取值</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><ol><li><p>github action 提供了一大堆 context，<a href="https://docs.github.com/en/actions/learn-github-actions/contexts#vars-context" target="_blank" rel="noopener noreferrer">參考資料</a> ，不知道為啥網路講到這個資源很少</p></li><li><p>官網教學 CI build image 推到 container registry 使用的是另一個 action，兩個都用過，都可以用。
<a href="https://docs.github.com/en/actions/publishing-packages/publishing-docker-images#publishing-images-to-github-packages" target="_blank" rel="noopener noreferrer">參考 actions</a></p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># This workflow uses actions that are not certified by GitHub.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># They are provided by a third-party and are governed by</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># separate terms of service, privacy policy, and support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># documentation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># GitHub recommends pinning actions to a commit SHA.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To get a newer version, you will need to update the SHA.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You can also reference a tag or branch, but the action may change without warning.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Publish Docker image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  release:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    types: [published]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push_to_registries:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: Push Docker image to multiple registries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    permissions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      packages: write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      contents: read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Check out the repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Log in to Docker Hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ secrets.DOCKER_USERNAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.DOCKER_PASSWORD }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Log in to the Container registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          registry: ghcr.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ github.actor }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.GITHUB_TOKEN }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Extract metadata (tags, labels) for Docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id: meta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/metadata-action@98669ae865ea3cffbcbaa878cf57c20bbf1c6c38</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          images: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            my-docker-hub-namespace/my-docker-hub-repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ghcr.io/${{ github.repository }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Build and push Docker images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/build-push-action@ad44023a93711e3deb337508980b4b5e9bcdc5dc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          context: .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          push: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tags: ${{ steps.meta.outputs.tags }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          labels: ${{ steps.meta.outputs.labels }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[demo basic  github action]]></title>
        <id>https://suyuying.github.io/blog/2023/03/11/github-action/github-action-demo</id>
        <link href="https://suyuying.github.io/blog/2023/03/11/github-action/github-action-demo"/>
        <updated>2023-03-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[GitHub Action 是 continuous integration and continuous delivery (CI/CD)平台，除了一般的 build test deploy 他另外有給專案管理的各種小功能，例如給 pull request 打標籤。提供免費的 runner 幫你執行任務，也接受self-hosted runner。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="基本介紹">基本介紹<a href="#基本介紹" class="hash-link" aria-label="Direct link to 基本介紹" title="Direct link to 基本介紹">​</a></h2><p>GitHub Action 是 continuous integration and continuous delivery (CI/CD)平台，
除了一般的 build test deploy 他另外有給專案管理的各種小功能，例如給 pull request 打標籤。
提供免費的 runner 幫你執行任務，也接受 self-hosted runner。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="github-actions-基本元素">GitHub Actions 基本元素<a href="#github-actions-基本元素" class="hash-link" aria-label="Direct link to GitHub Actions 基本元素" title="Direct link to GitHub Actions 基本元素">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workflow-&gt; Event -&gt; Job-&gt; Steps</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="workflow">Workflow<a href="#workflow" class="hash-link" aria-label="Direct link to Workflow" title="Direct link to Workflow">​</a></h3><p>一個 repository 可以有多個 workflow,每個 workflow 做的事定義在 yml，且規定在.github/workflows 底下，workflow 包含一次要運行的整個過程，可以用手動觸發或者 yml 檔內制定條件觸發。
舉例：可以用一條 workflow 做 build and test,另一個 workflow 做 deploy</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="events">Events<a href="#events" class="hash-link" aria-label="Direct link to Events" title="Direct link to Events">​</a></h3><p>觸發 Workflow 的事件稱為 Events。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jobs">Jobs<a href="#jobs" class="hash-link" aria-label="Direct link to Jobs" title="Direct link to Jobs">​</a></h3><p>由多個 steps 組成，每個 step 可以是一個 shell script 或者 action，step 會依序在同一個 runner 執行，並可以共享 data，
舉例來說，build 完後的檔案，可以傳給下一個 test step 測試 build 結果。</p><p>一個 workflow 可以有多個 job,job 間彼此預設是平行執行，也可以設定 dependencies 等待另一個 job，
舉例來說，一包 code 裡面要 build 多個檔案，每個 build 過程可以是一個 job 彼此平行，等到都 build 結束，在執行統一到 packaging 工作。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="actions">Actions<a href="#actions" class="hash-link" aria-label="Direct link to Actions" title="Direct link to Actions">​</a></h3><p>動作是執行複雜但經常重複任務， GitHub Action 平台提供自定義應用程序的上傳，簡單說就是把某些會重複出現的 step 做成 module 並使用，因為這格原因，所以也可以引用別人寫好得，或自建得，就像是寫程式用的 package 一樣。</p><p><a href="https://github.com/marketplace?category=chat&amp;type=actions&amp;query=" target="_blank" rel="noopener noreferrer">官方的 action 庫</a></p><p><a href="https://docs.github.com/zh/actions/creating-actions/about-custom-actions" target="_blank" rel="noopener noreferrer">如何建立自己的 github action 的 actions</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="runners">Runners<a href="#runners" class="hash-link" aria-label="Direct link to Runners" title="Direct link to Runners">​</a></h3><p>執行 workflow 的機器。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="demo">Demo<a href="#demo" class="hash-link" aria-label="Direct link to Demo" title="Direct link to Demo">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="demo-github-actions">demo github actions<a href="#demo-github-actions" class="hash-link" aria-label="Direct link to demo github actions" title="Direct link to demo github actions">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name: learn-github-actions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run-name: ${{ github.actor }} is learning GitHub Actions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on: [push]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  check-bats-version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/setup-node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node-version: '14'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - run: npm install -g bats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - run: bats -v</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>name</code>: All wolkflows 隨便挑一個點進去看到到 workflow 名字，工作流程的名稱 learn-github-actions</p><p><code>run-name</code>: github 點進去 Actions 裡面看到 All wolkflows 眾多的名稱，為工作流程運行時的名稱，${{ github.actor }} 內建變數。</p><p><code>on</code>:此 workflow 的觸發條件，設定 push 是推送或者發 pull request 就會觸發，進階版請洽官網提供的
<a href="https://docs.github.com/zh/actions/using-workflows/workflow-syntax-for-github-actions#onpushpull_requestpull_request_targetpathspaths-ignore" target="_blank" rel="noopener noreferrer">更精細設定</a></p><p><code>jobs</code>:組合多個 work or action，目前有一格作業叫做 check-bats-version 的 work</p><p><code>check-bats-version</code>: 一個名爲 check-bats-version 的作業，子鍵定義作業屬性，可以換成其他符合該 work 工作的名字，命名風格是-相連</p><p><code>runs-on</code>: 使用 github 託管的 runner，作業運行的操作系統，爲 ubuntu-latest。</p><p><code>steps</code>: 定義作業執行步驟，可以包含多個 指令、shell script、action（一堆指令組合的 module）</p><p><code>uses</code>: 運作某客製化 action，action 就是個指令集合</p><ul><li><code>actions/checkout@v3</code>：使用 v3 版本的 <code>actions/checkout</code> Action，從代碼庫中檢出代碼。</li><li><code>actions/setup-node@v3</code>：使用 v3 版本的 <code>actions/setup-node</code> Action，安裝 Node.js 環境。
with: 帶參數到 action 裡面</li></ul><p><code>run</code>: 在 runner 上運行的指令</p><ul><li><code>run: npm install -g bats</code>：運行命令 <code>npm install -g bats</code>，安裝 Bats 測試框架。</li><li><code>run: bats -v</code>：運行命令 <code>bats -v</code>，顯示 Bats 的版本號。</li></ul><p><code>name</code>: 定義該 run 的名字，不定義就只用 Run + 後面執行 run 得指令</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="補充-actions-寫法">補充 actions 寫法<a href="#補充-actions-寫法" class="hash-link" aria-label="Direct link to 補充 actions 寫法" title="Direct link to 補充 actions 寫法">​</a></h3><p>actions/checkout@v3 是 GitHub Action 中一個常用的 action，用於將程式碼倉庫的程式碼檢出到工作區。v3 是這個 action 的版本號。這個 action 的代碼倉庫中，有一個 action.yml 文件，定義了這個 action 的輸入和輸出參數。具體如下：</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">actions/checkout@v3</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Checkout'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Checkout a Git repository'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">inputs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">ref</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'The branch, tag or SHA to checkout'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">repository</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'The name of the repository to checkout'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">repository</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">submodules</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Whether to checkout submodules'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'false'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ssh</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">key</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'SSH key used for fetching the repository. The key should have access to the repository or be able to authenticate for the repository URL.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  persist</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">credentials</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Whether to persist GITHUB_TOKEN and SSH_AUTH_SOCK environment variables when persisting the workspace'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'true'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fetch</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">depth</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Depth of commits to fetch. Defaults to all commits.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'0'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">lfs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Whether to download Git LFS files'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'false'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">clean</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Whether to run 'git clean' before checkout"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'false'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">workspace</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Directory to which checkout the repository'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">outputs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'The path of the checked-out repository'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> steps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">checkout</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">outputs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">runs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">using</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'composite'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">steps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Checkout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">shell</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> echo </span><span class="token string" style="color:#e3116c">"Error: No checkout implementation found."</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>這個文件中，定義了這個 action 的輸入參數包括 ref、repository、submodules、ssh-key、persist-credentials、fetch-depth、lfs、clean 和 workspace。
GitHub Action <code>actions/checkout@v3</code> 下面是它的輸入參數定義：</p><span style="background-color:#25c2a0;border-radius:20px;color:#fff;padding:6px;cursor:pointer">actions/checkout@v3 參數篇</span><ul><li><code>ref</code>：要檢出的分支、標籤或提交 ID。</li><li><code>repository</code>：要檢出的儲存庫名稱。</li><li><code>submodules</code>：是否檢出子模組。</li><li><code>ssh-key</code>：用於從儲存庫獲取程式碼的 SSH 金鑰。</li><li><code>persist-credentials</code>：是否在持久化工作區時保存 GITHUB_TOKEN 和 SSH_AUTH_SOCK 環境變數。</li><li><code>fetch-depth</code>：要檢出的提交數量。</li><li><code>lfs</code>：是否下載 Git LFS 文件。</li><li><code>clean</code>：是否在檢出前運行 <code>git clean</code>。</li><li><code>workspace</code>：檢出的儲存庫的目錄。</li></ul><p>其中，ref 是必需的參數，其他參數均為可選參數。</p><p>輸出參數只有一個，即 path，表示程式碼倉庫的路徑。</p><p>最後，這個 action 在運行時，會執行一個名爲 Checkout 的子步驟，該子步驟會調用不同平臺的命令行工具，將程式碼倉庫檢出到指定的工作區。</p><span style="background-color:#1877F2;border-radius:20px;color:#fff;padding:6px;cursor:pointer"> actions/setup-node@v3 參數篇</span><ul><li><code>node-version</code>：要安裝的 Node.js 版本，默認是最新的穩定版。</li><li><code>registry-url</code>：Node.js 的包管理器使用的預設倉庫地址，默認是 npm 的官方地址。</li><li><code>scope</code>：Node.js 的包管理器使用的預設作用域，默認是空。</li><li><code>token</code>：用於訪問私有項目的 GitHub 權杖，默認是空。</li><li><code>always-auth</code>：是否總是使用授權信息訪問項目，默認是 false。</li><li><code>check-latest</code>：是否檢查是否安裝了最新的版本，默認是 false。</li><li><code>debug</code>：是否啓用 Debug 模式，默認是 false。</li></ul><p>總的來說，actions/setup-node@v3 可以方便地安裝 Node.js 環境，並支持許多自定義參數，用戶可以根據自己的需要進行配置。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>在 github action 要帶入參數到 actions 裡面請使用 with</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/setup-node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node-version: '14'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>1.<a href="https://medium.com/starbugs/%E5%AF%A6%E4%BD%9C%E9%96%8B%E6%BA%90%E5%B0%8F%E5%B7%A5%E5%85%B7-%E8%88%87-github-actions-%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%9B%B8%E9%81%87-3dd2d70eeb" target="_blank" rel="noopener noreferrer">實作開源小工具，與 Github Actions 的第一次相遇！</a></p><ol start="2"><li><a href="https://docs.github.com/en/actions/quickstart" target="_blank" rel="noopener noreferrer">github action quick start 官網</a>
:::</li></ol></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[.env file management  in github action]]></title>
        <id>https://suyuying.github.io/blog/2023/03/11/github-action/github-action-env-file</id>
        <link href="https://suyuying.github.io/blog/2023/03/11/github-action/github-action-env-file"/>
        <updated>2023-03-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[因為是使用.env file管理環境變數，所以推到github上一定會排除.env，然後再試CICD時候就想說為啥本地build的image跑起來沒問題，一到CI build出來的image就掛了，試了半天才想到是.evn沒給。這邊會demo如何在github action使用.env資料。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="env-傳入方法">.env 傳入方法<a href="#env-傳入方法" class="hash-link" aria-label="Direct link to .env 傳入方法" title="Direct link to .env 傳入方法">​</a></h2><p><a href="https://stackoverflow.com/questions/60176044/how-do-i-use-an-env-file-with-github-actions" target="_blank" rel="noopener noreferrer">參考自這篇 stack overflow</a></p><p>兩種方式，這依據你的.env 裡面到底有多少個變數。但共同點都是在 github worlflow 過程使用 secrets 上下文，例如${{ secrets.XXX }}，去把存放在 github registry 裡面的環境變數，存放到指定位置的.env 檔。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="single-vaiable">single vaiable<a href="#single-vaiable" class="hash-link" aria-label="Direct link to single vaiable" title="Direct link to single vaiable">​</a></h3><p>如果只有一個變數，就把該變數放到 github registry 裡面，取上下文來用就好</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    - name: 'Create env file'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        touch .env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo API_ENDPOINT="https://xxx.execute-api.us-west-2.amazonaws.com" &gt;&gt; .env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo API_KEY=${{ secrets.API_KEY }} &gt;&gt; .env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cat .env</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="better-method-for-multiple-variables">Better method for multiple variables<a href="#better-method-for-multiple-variables" class="hash-link" aria-label="Direct link to Better method for multiple variables" title="Direct link to Better method for multiple variables">​</a></h3><p>如果有很多個變數在.env 檔，就把.env 檔整份 copy 到 github registry 裡面</p><p>例如：</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.env</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">ALGORITHM</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"HS256"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">ACCESS_TOKEN_EXPIRE_MINUTES</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 對password加鹽的物件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sql連線網址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">SQLALCHEMY_DATABASE_URL</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"sqlite:///./sql_app.db"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">TOKENURL</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"token"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">ARTICLE_CATEGORY</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'[\"PythonBasic\",\"Fastapi\",\"DataScience\",\"PythonModule\",\"LinuxShellScript\",\"JavaScriptBasic\",\"React\"]'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>就把他整份裡面的值 copy 到 config 裡面就好，假設 key 叫做 ENV_FILE，然後 yml 檔這樣寫</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">     - name: 'Create env file'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          echo "${{ secrets.ENV_FILE }}" &gt; .env</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>他就會把你所有 value 送到.env 檔了。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>記錄一下我遇到的狀況，因為這個真的卡頗久，也試不出來一個方法，所以就先記錄吧，也歡迎提供解答
python dotenv 在.env 檔裡面寫入 list ，要用以下方法表述
ARTICLE_CATEGORY='<!-- -->["PythonBasic","Fastapi","DataScience","PythonModule","LinuxShellScript","JavaScriptBasic","React"]<!-- -->'，配合 <code>json.loads(os.environ.get('ARTICLE_CATEGORY'))</code>去拿資料。</p><p>但是在使用 action 遇到一個問題，<code>echo ${{ secrets.ENV_FILE }} &gt; .env</code> 會輸入空值進去，<code>echo "${{ secrets.ENV_FILE }}" &gt; .env</code> 這樣才會有值，但問題在使用""包住會把 ARTICLE_CATEGORY='<!-- -->["PythonBasic","Fastapi","DataScience","PythonModule","LinuxShellScript","JavaScriptBasic","React"]<!-- -->'轉成
<code>ARTICLE_CATEGORY='[PythonBasic,Fastapi,DataScience,PythonModule,LinuxShellScript,JavaScriptBasic,React]'
</code> 這個格式在讀 json.loads(os.environ.get('ARTICLE_CATEGORY'))就會遇到問題，會報 error 因為這個格式他不行。</p><p>目前在處理 list 部分，都先用<code>ARTICLE_CATEGORY='[\"PythonBasic\",\"Fastapi\",\"DataScience\",\"PythonModule\",\"LinuxShellScript\",\"JavaScriptBasic\",\"React\"]'</code> 送資料。然後用<code>json.loads(os.environ.get('ARTICLE_CATEGORY'))</code>去拿資料</p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
        <category label=".env" term=".env"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[docker create context and docker context command]]></title>
        <id>https://suyuying.github.io/blog/2023/03/10/Docker/docker-create-context</id>
        <link href="https://suyuying.github.io/blog/2023/03/10/Docker/docker-create-context"/>
        <updated>2023-03-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[docker 支援多個不同remote docker deamon管理,`docker create context` 是用來建立一個新的 context，以指向一個 remote Docker daemon，用於管理 Docker 主機和 Docker registry 的機制。]]></summary>
        <content type="html"><![CDATA[<p><code>docker create context</code> 是用來建立一個新的 context，以指向一個 remote Docker daemon，用於管理 Docker 主機和 Docker registry 的機制。</p><p>可以使用 <code>docker context use</code> 指令來切換 context，切換完成後即可使用 docker 指令操作 remote Docker daemon。如果使用雲端 container，例如 azure web container service，就可以用這個指令去管理雲端 container。包含新建 刪除都可以使用，所以不要太開心一次起一大堆雲端 container 這樣會被 charging 到爆。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>如果有用到 docker buildx 可能會把 docker context 跟 docker buildx create --name 搞混，
兩個是不同的.</p></div></div><p>以下是 <code>docker create context</code> 指令的教學：</p><p>使用 <code>docker create context</code> 指令可以建立一個新的 context，用來指向一個 remote Docker daemon。以下是指令的詳細說明：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker context create CONTEXT_NAME --docker "host=REMOTE_DOCKER_HOST" --description "CONTEXT_DESCRIPTION"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>CONTEXT_NAME</code>: 指定新建立的 context 的名稱。</li><li><code>REMOTE_DOCKER_HOST</code>: 指定 remote Docker daemon 的位置，可以是一個 IP 或是一個 domain name。</li><li><code>CONTEXT_DESCRIPTION</code>: 可以加入對 context 的描述，方便管理。</li></ul><p>例如，以下指令建立一個名為 <code>mycontext</code> 的 context，指向一個 remote Docker daemon，並加入描述：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker context create mycontext --docker "host=myremotehost:2376" --description "My remote Docker daemon"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>建立完成後，可以使用 <code>docker context use</code> 指令來切換 context：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker context use mycontext</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docker" term="docker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[docker manage logs in Docker to prevent service failure caused by excessively large container logs]]></title>
        <id>https://suyuying.github.io/blog/2023/03/10/Docker/docker-management</id>
        <link href="https://suyuying.github.io/blog/2023/03/10/Docker/docker-management"/>
        <updated>2023-03-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[當遇到container log太大 造成服務掛掉的排查方向，以及如何避免。因為 docker 運行過程本身 log 也會佔用硬碟資源，為了不讓這個 log 過度膨脹，可以用以下方式限制]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volume-of-docker">volume of docker<a href="#volume-of-docker" class="hash-link" aria-label="Direct link to volume of docker" title="Direct link to volume of docker">​</a></h2><p>以前都在弄自己的小專案，只要東西跑得起來就好，沒想過會遇過因為硬碟吃滿導致 container 服務掛掉的問題。</p><p>docker 掛載 volume 會有三種方式，綁定掛載（Bind Mount），命名卷（Named Volume），匿名卷（Anonymous Volume），前兩種在 container 被刪除時不會被刪，會永久保存，docker 內沒被掛載或使用 Anonymous Volume 則都會被刪除。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>docker logs 資料包含哪些？
Docker 會捕捉所有容器的標准輸出（和標准錯誤），並以 JSON 格式將其寫入文件中。 JSON 格式將每行注釋為其源（stdout 或 stderr）和其時間戳。 每個日誌文件僅包含有關一個容器的信息。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="如何減少不必要的硬體佔用">如何減少不必要的硬體佔用<a href="#如何減少不必要的硬體佔用" class="hash-link" aria-label="Direct link to 如何減少不必要的硬體佔用" title="Direct link to 如何減少不必要的硬體佔用">​</a></h3><p>因為 docker 運行過程本身 log 也會佔用硬碟資源，為了不讓這個 log 過度膨脹，可以用以下方式限制</p><ol><li>修改 docker 設定檔</li></ol><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/etc/docker/daemon.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">"log-driver"</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"json-file"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">"log-opts"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string-property property" style="color:#36acaa">"max-size"</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"500m"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">"max-file"</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"3"</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">systemctl daemon-reload</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">systemctl restart docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>修改 docker-compose.yml</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hellow:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    build: .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container_name: mattermost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    logging:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      driver: "json-file"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          max-size: "100m"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          max-file: "10"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>並使用以下指令重啟，一般 restart 不會吃新 config</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose -f docker-compose.yml up -d --force-recreate mm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>下這個指令前務必想好是否重要資訊有用 Bind Mount or Named Volume 掛載出來！</p></div></div><ol start="3"><li>docker 指令</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d --log-opt max-size=1g nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://docs.docker.com/config/containers/logging/json-file/" target="_blank" rel="noopener noreferrer">官網 log 管理</a>，管理 docker log 方式很多，預設都適用 json-file，設定可已透過修改/etc/docker/daemon.json 並重啟達成。</p><p>預設是在同一份檔案，無限大小寫入，透過以上方法，可以限定檔案大小跟可產生檔案數量，當 log 容量到達上限時，Docker 程序將停止寫入該日誌文件，並開始使用新名稱啟動新的日誌文件。默認情況下，新日誌文件將具有與舊日誌文件相同的名稱，但會在末尾添加連續號（例如，access.log.1、access.log.2 等）。</p><p>Docker 保留的日誌文件數量由<code>max-file</code>選項決定。默認情況下，Docker 將保留最多 1 個日誌文件(要配置<code>max-size</code>才會生效)。當達到最大日誌文件數量時，Docker 將開始使用新的日誌數據覆蓋最舊的日誌文件。</p><p>（ps:資訊以此<a href="https://docs.docker.com/config/containers/logging/json-file/" target="_blank" rel="noopener noreferrer">連結</a>為準，設定可能會改變的）</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-should-do-when-you-find--or-var-are-full">what should do when you find / or /var are full<a href="#what-should-do-when-you-find--or-var-are-full" class="hash-link" aria-label="Direct link to what should do when you find / or /var are full" title="Direct link to what should do when you find / or /var are full">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>預設 docker 的東西都放在/var/lib/docker 底下</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/var/lib/docker</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">builder  buildkit  containers  image  network  overlay2  plugins  runtimes  swarm  tmp  trust  volumes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以在該資料夾底下用<code>du -sh ./*</code>確認哪個地方吃得異常兇，
並用<code>docker system df</code>看資料佔用，如果不用的 image 很多可以清除</p><p><code>docker image prune --all</code></p><p>他會刪除所有沒有被 container 使用的 image，警示如下：</p><p>WARNING! This will remove all images without at least one container associated to them.</p></div></div><ol><li>如果當初沒有做任何預防，導致/var 真的爆了，可以優先檢查以下幾項</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="檢查-docker-logs-是否佔太兇">檢查 docker logs 是否佔太兇<a href="#檢查-docker-logs-是否佔太兇" class="hash-link" aria-label="Direct link to 檢查 docker logs 是否佔太兇" title="Direct link to 檢查 docker logs 是否佔太兇">​</a></h3><p>其實就是去/var/lib/docker/containers，執行<code>du -sh ./* </code>看哪個 container 佔最多資源，然後去看裡面那隻放 docker logs 的檔名為 container-id-json.log 的檔案是否長太大，確認後可以砍掉。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="檢查-named-volume-中存放資訊">檢查 named volume 中存放資訊<a href="#檢查-named-volume-中存放資訊" class="hash-link" aria-label="Direct link to 檢查 named volume 中存放資訊" title="Direct link to 檢查 named volume 中存放資訊">​</a></h3><p>其實就是去/var/lib/docker/volumes 底下，看有沒有某個 volume 佔太多資源，然後裡面放的東西可能不重要(例如 nginx log)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="檢查-image-跟沒用的-container">檢查 image 跟沒用的 container<a href="#檢查-image-跟沒用的-container" class="hash-link" aria-label="Direct link to 檢查 image 跟沒用的 container" title="Direct link to 檢查 image 跟沒用的 container">​</a></h3><p>image 指令:刪除沒有被活動的 container 使用的 image
<code>docker image prune --all</code></p><p>container 指令：刪除停止的 container
<code>docker container prune</code></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><a href="https://docs.docker.com/config/pruning/" target="_blank" rel="noopener noreferrer">Prune unused Docker objects</a>
<a href="https://blog.csdn.net/fishinhouse/article/details/105310948" target="_blank" rel="noopener noreferrer">限制 Docker 日志大小</a></p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docker" term="docker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[dockermultiplatform build - docker buildx指令]]></title>
        <id>https://suyuying.github.io/blog/2023/03/10/Docker/docker-muiltiplatform</id>
        <link href="https://suyuying.github.io/blog/2023/03/10/Docker/docker-muiltiplatform"/>
        <updated>2023-03-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[docker 支援多平台image的build指令,Docker Buildx 是 Docker 官方提供的一個命令行工具，用於通過 Dockerfile 构建 Docker 映像。它的主要特點是可以跨平臺構建 Docker 映像，並支持多種 CPU 架構（如 x86、ARM、IBM Power 等），是一個用來建立和管理 multi-arch Docker image 的工具。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="基本介紹">基本介紹<a href="#基本介紹" class="hash-link" aria-label="Direct link to 基本介紹" title="Direct link to 基本介紹">​</a></h2><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>如果不支援多平台，就會出現在 arm build，然後在 amd deploy 失敗，上網查不到原因的問題。</p></div></div><p>Docker Buildx 是 Docker 官方提供的一個命令行工具，用於通過 Dockerfile 构建 Docker 映像。它的主要特點是可以跨平臺構建 Docker 映像，並支持多種 CPU 架構（如 x86、ARM、IBM Power 等），是一個用來建立和管理 multi-arch Docker image 的工具。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>docker buildx 的單位是 node，跟 docker context 不同，前者是建立影像的主機，可以使用多個節點來加速 Docker 映像的建立過程，後者則是用來管理 Docker 主機和 Docker registry 的機制，定義了一個或多個 Docker 主機和 Docker registry 的設定。</p></div></div><p>以下是使用 Docker Buildx 構建 Docker 映像的基本步驟：</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-啟用-multi-arch-支援">1. 啟用 multi-arch 支援<a href="#1-啟用-multi-arch-支援" class="hash-link" aria-label="Direct link to 1. 啟用 multi-arch 支援" title="Direct link to 1. 啟用 multi-arch 支援">​</a></h2><p>要使用 <code>docker buildx</code> 建立 multi-arch Docker image，必須先啟用 multi-arch 支援(Docker Desktop 預配置了 binfmt_misc 對其他平台的支持，可以忽略此指令)。可以使用以下指令啟用 multi-arch 支援：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --rm --privileged multiarch/qemu-user-static --reset -p yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-建立-buildernode">2. 建立 builder(node)<a href="#2-建立-buildernode" class="hash-link" aria-label="Direct link to 2. 建立 builder(node)" title="Direct link to 2. 建立 builder(node)">​</a></h2><p>要使用 <code>docker buildx</code> 建立 multi-arch Docker image，必須先建立一個 builder。使用以下指令建立 builder：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx create --name mybuilder</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-設定-builder">3. 設定 builder<a href="#3-設定-builder" class="hash-link" aria-label="Direct link to 3. 設定 builder" title="Direct link to 3. 設定 builder">​</a></h2><p>建立 builder 後，必須將 builder 設定為目前使用的 builder。使用以下指令設定 builder：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx use mybuilder</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-建立-dockerfile">4. 建立 Dockerfile<a href="#4-建立-dockerfile" class="hash-link" aria-label="Direct link to 4. 建立 Dockerfile" title="Direct link to 4. 建立 Dockerfile">​</a></h2><p>接下來，建立一個 Dockerfile，並在其中指定要建立的 Docker image。例如，在 Dockerfile 中可以指定要建立的 image 為 <code>ubuntu:latest</code>，並在其中安裝一些軟體套件：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM --platform=$TARGETPLATFORM ubuntu:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get update &amp;&amp; \\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-get install -y software-properties-common &amp;&amp; \\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    add-apt-repository -y ppa:nginx/stable &amp;&amp; \\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-get update &amp;&amp; \\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-get install -y nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-建立-multi-arch-docker-image">5. 建立 multi-arch Docker image<a href="#5-建立-multi-arch-docker-image" class="hash-link" aria-label="Direct link to 5. 建立 multi-arch Docker image" title="Direct link to 5. 建立 multi-arch Docker image">​</a></h2><p>建立 Dockerfile 後，可以使用以下指令建立 multi-arch Docker image：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx build --platform linux/arm/v7 -t myimage:latest --load .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在上面的命令中，<code>--platform</code> 參數指定了要構建的 CPU 架構，<code>-t</code> 參數指定了映像的標籤，<code>.</code> 表示當前目錄是 Dockerfile 所在的目錄。</p><p>--load 相當於<code>--output=type=docker</code> 沒有指定會出現 warning</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">WARN[0000] No output specified for docker-container driver. Build result will only remain in the build cache. To push result image into registry use --push or to load image into docker use --load</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>--push 遠端 registry 相當於<code>--output=type=registry</code></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><a href="https://github.com/docker/buildx/issues/59" target="_blank" rel="noopener noreferrer">https://github.com/docker/buildx/issues/59</a>
2023/3/9 使用--platform 配合--load，不能支援多平台，一次一個平台，否則會報錯
--push 支援一次多平台 image</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">error: docker exporter does not currently support exporting manifest lists</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><p>建立完成後，可以使用以下指令查看建立的 Docker image：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker images myimage</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>推送 Docker 映像：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker push myimage:latest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以上就是使用 Docker Buildx 構建 Docker 映像的基本步驟。使用 Docker Buildx 可以讓我們更方便地構建跨平臺的 Docker 映像，提高了開發效率。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><code>docker buildx rm docker-test</code> 刪除</p><p><code>docker buildx use docker-test</code>切換</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker-buildx-create---name-my-node-是建立節點嗎">docker buildx create --name my-node 是建立節點嗎？<a href="#docker-buildx-create---name-my-node-是建立節點嗎" class="hash-link" aria-label="Direct link to docker buildx create --name my-node 是建立節點嗎？" title="Direct link to docker buildx create --name my-node 是建立節點嗎？">​</a></h2><p>是的，<code>docker buildx create --name my-node</code> 指令會建立一個名為 <code>my-node</code> 的節點。節點是用來建立 Docker 映像的主機，可以使用多個節點來加速 Docker 映像的建立過程，或者建立不同平台的 Docker 映像。</p><p>建立節點時，可以使用 <code>--driver</code> 選項指定節點的驅動程式，例如 <code>docker-container</code> 或 <code>docker</code>。驅動程式還可以是其他第三方平台，例如 AWS、Azure 或 Google Cloud。</p><p>在建立節點時，可以指定節點的名稱、驅動程式、驅動程式選項、Docker 映像等資訊。例如，以下是建立一個名為 <code>my-node</code> 的節點，使用 Docker 容器作為驅動程式，使用 <code>moby/buildkit:v0.8.1</code> 作為 Docker 映像的示範指令：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx create --name my-node --driver docker-container --driver-opt image=moby/buildkit:v0.8.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>建立節點後，可以使用 <code>docker buildx ls</code> 指令列出所有節點。建立 Docker 映像時，可以使用 <code>--builder</code> 選項指定要使用的節點。例如：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx build --builder my-node --platform linux/amd64 -t myimage:latest .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以使用名為 my-node 的節點建立 Docker 映像，並指定要建立的平台為 linux/amd64。</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docker" term="docker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[learn github action from github docs]]></title>
        <id>https://suyuying.github.io/blog/2023/03/10/github-action/githubaction-learing</id>
        <link href="https://suyuying.github.io/blog/2023/03/10/github-action/githubaction-learing"/>
        <updated>2023-03-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[github action在設計上提供許多表示式，跟內建函示，上下文，這邊將整理官網教學知識，以及使用心得。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="#前言" class="hash-link" aria-label="Direct link to 前言" title="Direct link to 前言">​</a></h2><p>一開始是跳著學，直接 google 怎麼用 github action 做到 CI 建立 image 並推到 github container，不過這關過完後，在 deploy 到 azure web container 就卡關了，這邊貼卡關的<a href="https://docs.github.com/en/actions/deployment/deploying-to-your-cloud-provider/deploying-to-azure/deploying-docker-to-azure-app-service" target="_blank" rel="noopener noreferrer">部分</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  deploy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    needs: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: 'production'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      url: ${{ steps.deploy-to-webapp.outputs.webapp-url }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Lowercase the repo name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "REPO=${GITHUB_REPOSITORY,,}" &gt;&gt;${GITHUB_ENV}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Deploy to Azure Web App</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id: deploy-to-webapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: azure/webapps-deploy@0b651ed7546ecfc75024011f76944cb9b381ef1e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          app-name: ${{ env.AZURE_WEBAPP_NAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          images: 'ghcr.io/${{ env.REPO }}:${{ github.sha }}'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果沒看過官網教學，看到<code>${{ steps.deploy-to-webapp.outputs.webapp-url }}</code> <code>${{ env.AZURE_WEBAPP_NAME }}</code> <code>${{ github.sha }}</code> <code>${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}</code>
這些東西自然會傻住，然後回去 google，會發現官網給了一大堆 context 介紹，簡言之，還是腳踏實地來
<a href="https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions" target="_blank" rel="noopener noreferrer">Understanding GitHub Actions</a>吧！</p><p>下面資訊再回來看，<code>${{ steps.deploy-to-webapp.outputs.webapp-url }}</code> 這段意思會 refer 到 id: deploy-to-webapp 的這個 step，至於 webapp-url 是啥？這是 action 的 azure/webapps-deploy 的 output。
至於 output 跟 input 是啥，這會留到之後了解 actions 時在來了解～
${GITHUB_REPOSITORY} 是內建變數，${{ github.sha }}是 github 上下文的內建變數，${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}使用設定在 configuration 的值，使用的是 sercrets 上下文。</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Create and publish a Docker image to github container registry and deploy to azure web container</summary><div><div class="collapsibleContent_i85q"><a href="https://docs.github.com/en/actions/deployment/deploying-to-your-cloud-provider/deploying-to-azure/deploying-docker-to-azure-app-service" target="_blank" rel="noopener noreferrer">github : Deploying Docker to Azure App Service</a><div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Create and publish a Docker image to github container registry and deploy to azure web container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AZURE_WEBAPP_NAME: ford-amd   # set this to your application's name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    branches: ['main']</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">permissions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  contents: 'read'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  packages: 'write'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    permissions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      contents: read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      packages: write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Checkout repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: 'Create env file'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          touch sql_app/.env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          echo "${{ secrets.ENV_FILE }}" &gt; sql_app/.env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Set up QEMU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/setup-qemu-action@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Set up Docker Buildx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/setup-buildx-action@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Log in to the Container registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          registry: ghcr.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ github.actor }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.GITHUB_TOKEN }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Lowercase the repo name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "REPO=${GITHUB_REPOSITORY,,}" &gt;&gt;${GITHUB_ENV}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Build and push container image to registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/build-push-action@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          push: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          context: .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          platforms: linux/amd64,linux/arm64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tags: ghcr.io/${{ env.REPO }}:${{ github.sha }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          file: ./Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  deploy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    needs: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      url: ${{ steps.deploy-to-webapp.outputs.webapp-url }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Lowercase the repo name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "REPO=${GITHUB_REPOSITORY,,}" &gt;&gt;${GITHUB_ENV}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Deploy to Azure Web App</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id: deploy-to-webapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: azure/webapps-deploy@0b651ed7546ecfc75024011f76944cb9b381ef1e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          app-name: ${{ env.AZURE_WEBAPP_NAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          images: 'ghcr.io/${{ env.REPO }}:${{ github.sha }}'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details><h2 class="anchor anchorWithStickyNavbar_LWe7" id="基本功">基本功<a href="#基本功" class="hash-link" aria-label="Direct link to 基本功" title="Direct link to 基本功">​</a></h2><p>回顧一下 github action basic demo，github action 是由 git 根目錄同層的
.github/workflows 中的 xxxx.yml 組成，workflow 的結構通常是</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Event 觸發 -&gt; Job -&gt; steps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Event: 描述觸發該 pipline 條件</p><p>Job: 定義 runner, 環境變數後，在這個條件下執行多個 step ，舉例： 編譯檔案 可以當一個 job，單元測試也可以當一個 job。 要注意的是，job 間是平行執行，所以要在單元測試過關在執行編譯的話，要額外寫 depends。job 間可以透過 artifacts 把 job 產出檔案，傳給別的 job 用。</p><p>steps: 定義多個指令，也可以使用別人提供的套件 actions，也可以是某隻 shell script</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="expressions">Expressions<a href="#expressions" class="hash-link" aria-label="Direct link to Expressions" title="Direct link to Expressions">​</a></h3><p>如果你有一個 job 要執行，但想設定執行前提是某個環境參數 為 true，要怎麼執行？
這邊有幾個觀念</p><ol><li>環境參數:</li></ol><p>在 github action 所有系統內建變數，環境變數，加密的變數，設定在 configuration 的變數這些東西都被當作<span style="background-color:blue;border-radius:20px;color:#fff;padding:6px;cursor:pointer">Contexts</span> 管理。</p><ol start="2"><li>表達式</li></ol><p>結構都長這樣<code>${{ &lt;expression&gt; }}</code>,</p><p>支援的數據類型 <code>boolen</code> <code>null</code> <code>number</code> <code>string</code>，寫法如下</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myNull: ${{ null }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myBoolean: ${{ false }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myIntegerNumber: ${{ 711 }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myFloatNumber: ${{ -9.2 }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myHexNumber: ${{ 0xff }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myExponentialNumber: ${{ -2.99e-2 }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myString: Mona the Octocat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myStringInBraces: ${{ 'It''s open source!' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>運算子如下</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">( ) Logical grouping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ ] Index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">. Property de-reference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! Not</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Less than</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;= Less than or equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;     Greater than</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; = Greater than or equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; == Equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; != Not equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; &amp;&amp; And</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; || Or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>if 判斷寫法</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prod-check:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if: ${{ github.ref == 'refs/heads/main' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>此外 github action 也提供很多內建 function，例如：</p><p><code>contains( search, item )</code> ，如果 search 含有 item，這個函數將返回 true。如果 search 是數組中。如果 item 是一個 search 的元素，這個函數將返回 true，如果項目是搜索的子字符串。這個函數不區分大小寫。它將值轉換為字符串進行比較。</p><p>contains('Hello world', 'llo') returns true.</p><p>contains(github.event.issue.labels.<!-- -->*<!-- -->.name, 'bug') returns true if the issue related to the event has a label "bug".</p><p>還有很多內建方法，可以<a href="https://docs.github.com/en/actions/learn-github-actions/expressions" target="_blank" rel="noopener noreferrer">參考官網</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="contexts">Contexts<a href="#contexts" class="hash-link" aria-label="Direct link to Contexts" title="Direct link to Contexts">​</a></h3><p>你運行的 workflow 中的資訊，可以透過 Contexts 取的，每個 Context 都是一個物件，它帶有的屬性可以是 strings 或 物件。</p><p>要使用 contexts 需要按照這個格式<code>${{ &lt;context&gt; }}</code></p><p>Context 種類超多，這邊會大致講他的作用</p><p><code>github</code>- 當前 workflow 的 branch,觸發模式，repo 名字，owner 名字等等。</p><p><code>env</code> - 在 workflow or job or steps 裡面設定得環境變數</p><p><code>vars</code> - 在 repo 或 組織 或 environment 階段，設定在 Variable 的 key value(就是 setting 的 variable 相關東西)</p><p><code>job</code> - 跟現在正在 run 的 job 有關事項，例如現在跑的 runner 的 id,跑成功或失敗。</p><p><code>jobs</code> - 僅在可重用工作流中可用，並且只能用於設置可重用工作流的輸出。</p><p><code>steps</code> - 定義 steps 階段輸出的成品，以及此 steps 運作結果（成功 失敗 取消 跳過）</p><p><code>runner</code> - Information about the runner that is running the current job</p><p><code>sercets</code> - 在 repo 或 組織 或 environment 階段設定在 secrect 的 key value</p><p><code>strategy</code> - 策略，主要用於在 matrix 矩陣情況環境下的 job 狀態描述</p><p><code>matrix</code> - 矩陣輸入，如果你的 job 裡面的測試系統要測試你的 code 在 mac 跟 windows 執行都沒問題，爾且也要確保在 node 14 跟 node16 運行都正常。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Test matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on: push</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ${{ matrix.os }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    strategy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      matrix:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        os: [ubuntu-latest, windows-latest]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        node: [14, 16]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/setup-node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node-version: ${{ matrix.node }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Install dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: npm ci</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Run tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: npm test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>needs</code>- 當前作業的依賴項，要用 id 指定</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>needs demo</summary><div><div class="collapsibleContent_i85q"><div><div>This is the detailed content</div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Build and deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on: push</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    outputs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      build_id: ${{ steps.build_step.outputs.build_id }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id: build_step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ./build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          echo "build_id=$BUILD_ID" &gt;&gt; $GITHUB_OUTPUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  deploy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    needs: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - run: ./deploy --build ${{ needs.build.outputs.build_id }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  debug:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    needs: [build, deploy]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if: ${{ failure() }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - run: ./debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details><p><code>inputs</code>- 看不懂，之後有用到再補</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="variables">Variables<a href="#variables" class="hash-link" aria-label="Direct link to Variables" title="Direct link to Variables">​</a></h3><p>基本上是 Contexts 的延伸，變量以是否跨 workflow 做區分。</p><ol><li>沒有跨 workflow 的 Variable 定義方法，在 workflow,job,step 定義 key value</li></ol><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>demo</summary><div><div class="collapsibleContent_i85q"><div><div>This is the detailed content</div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name: Greeting on variable day</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  workflow_dispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DAY_OF_WEEK: Monday</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  greeting_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: "Say Hello Mona it's Monday"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "$Greeting $First_Name. Today is $DAY_OF_WEEK!"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          First_Name: Mona</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details><p>run: env：您可以通過在步驟中使用然後檢查步驟的輸出來列出可用於工作流步驟的整組環境變量。</p><ol start="2"><li>跨 workflow 的 variable 定義方法</li></ol><p>在上下文中自動可用 vars，使用方式${{ vars.ＸＸＸＸ }}，有多種定義方式
存儲庫、環境創建配置變量、組織創建配置變量</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>demo</summary><div><div class="collapsibleContent_i85q"><div><div>This is the detailed content</div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  workflow_dispatch:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  # Setting an environment variable with the value of a configuration variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  env_var: ${{ vars.ENV_CONTEXT_VAR }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  display-variables:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: ${{ vars.JOB_NAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # You can use configuration variables with the `vars` context for dynamic jobs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if: ${{ vars.USE_VARIABLES == 'true' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ${{ vars.RUNNER }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment: ${{ vars.ENVIRONMENT_STAGE }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: Use variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo "repository variable : ${{ vars.REPOSITORY_VAR }}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo "organization variable : ${{ vars.ORGANIZATION_VAR }}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo "overridden variable : ${{ vars.OVERRIDE_VAR }}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo "variable from shell environment : $env_var"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: ${{ vars.HELLO_WORLD_STEP }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if: ${{ vars.HELLO_WORLD_ENABLED == 'true' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      uses: actions/hello-world-javascript-action@main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        who-to-greet: ${{ vars.GREET_NAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>在 github action 使用變量時，要考慮這個變量執行時是否在 runner 內執行！</p><p>在 runner 內執行預設是可以用$Greeting(linux) or $env:NAME(windows)去取得變量，</p><p>在 runner 外執行的例子，要使用<code>${{ env.DAY_OF_WEEK == 'Monday' }}</code>這樣的表達式，使用情境例如要先判斷 workflow 環境變量，再決定是否跑這個 step 的過程。
範例：</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>demo</summary><div><div class="collapsibleContent_i85q"><div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DAY_OF_WEEK: Monday</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  greeting_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: "Say Hello Mona it's Monday"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if: ${{ env.DAY_OF_WEEK == 'Monday' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "$Greeting $First_Name. Today is $DAY_OF_WEEK!"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          First_Name: Mona</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>  </div></div></div></details></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-environment-variables">Default environment variables<a href="#default-environment-variables" class="hash-link" aria-label="Direct link to Default environment variables" title="Direct link to Default environment variables">​</a></h3><p>The default environment variables that GitHub sets are available to every step in a workflow.
<a href="https://docs.github.com/en/actions/learn-github-actions/variables#default-environment-variables" target="_blank" rel="noopener noreferrer">內建環境變量</a></p><p>因為很多，所以挑幾個記錄一下</p><ol><li><p>GITHUB_SHA - The commit SHA that triggered the workflow.</p></li><li><p>RUNNER_ARCH - 底層架構，The architecture of the runner executing the job. Possible values are X86, X64, ARM, or ARM64.</p></li><li><p>GITHUB_REPOSITORY_OWNER - The repository owner's name. For example, octocat.</p></li><li><p>GITHUB_REF_TYPE- The type of ref that triggered the workflow run. Valid values are branch or tag.</p></li><li><p>GITHUB_REF- The fully-formed ref of the branch or tag that triggered the workflow run.</p></li><li><p>GITHUB_JOB - The job_id of the current job. For example, greeting_job.
以下 job_id 分別為 My first job 、My second job</p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  my_first_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: My first job</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  my_second_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: My second job</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li><p>GITHUB_EVENT_NAME- The name of the event that triggered the workflow. For example, workflow_dispatch.</p></li><li><p>GITHUB_ACTOR - The name of the person or app that initiated the workflow. For example, octocat.</p></li><li><p>GITHUB_ACTION_REPOSITORY - For a step executing an action, this is the owner and repository name of the action. For example, actions/checkout.</p></li><li><p>GITHUB_ACTION - 當前運行的操作的名稱，或 id 步驟的名稱,id 是 A unique identifier for the step. You can use the id to reference the step in contexts.</p></li><li><p>GITHUB_REPOSITORY - The owner and repository name. For example, octocat/Hello-World.</p></li></ol><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><a href="https://docs.github.com/en/actions/learn-github-actions/contexts#matrix-context" target="_blank" rel="noopener noreferrer">參考的管網資料-contexts</a>
<a href="https://docs.github.com/en/actions/learn-github-actions/expressions" target="_blank" rel="noopener noreferrer">參考的管網資料-expression</a></p><p><a href="https://docs.github.com/en/actions/learn-github-actions/variables" target="_blank" rel="noopener noreferrer">參考的管網資料-variables</a></p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[linux command(sed grep awk)]]></title>
        <id>https://suyuying.github.io/blog/2023/03/08/linux-server/linux-command-repratice</id>
        <link href="https://suyuying.github.io/blog/2023/03/08/linux-server/linux-command-repratice"/>
        <updated>2023-03-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[從有關鍵字為 QOO 那一行到以}為開頭的那一行(^代表正則開頭字元),sed -n "/QOO/,/^}/p" common.js.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sed">sed<a href="#sed" class="hash-link" aria-label="Direct link to sed" title="Direct link to sed">​</a></h2><p>一般打印
印 5~7 行 其他行數 silence</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat -n xxxx.md | sed -n '5,7p'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>把 whois 檢查 domain 中的 Registry Expiry Date 的前面的空格去掉,以下意思是把 0 個以上的 space 去掉</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sed 's/\s\{0,\}Registry Expiry Date: //'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>印出指定字樣範圍
從有關鍵字為 QOO 那一行到以}為開頭的那一行(^代表正則開頭字元)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sed -n "/QOO/,/^}/p" common.js</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>印出指定時間範圍 log,注意開關範圍沒東西會變全抓.</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sed -n "/2023-04-20 05:10/,/2023-04-20 05:21/p" chanxxxe*out* &gt; /tmp/lyapi.log</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="grep">grep<a href="#grep" class="hash-link" aria-label="Direct link to grep" title="Direct link to grep">​</a></h2><p>sort 排列
uniq 去掉重複，要計數可以用 uniq -c</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grep -r "bin" * | grep -Eo "code\":[0-9]{0,}" |sort | uniq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="grep--r-vs-grep--r">grep -r vs grep -R<a href="#grep--r-vs-grep--r" class="hash-link" aria-label="Direct link to grep -r vs grep -R" title="Direct link to grep -r vs grep -R">​</a></h3><p>先說結論: 兩者差別在-R 可以抓到軟連結資料連結到的物理檔案，而-r 不行，所以-R 功能比較強大。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="軟連結soft-link-vs-硬連結hard-link">軟連結(soft link) vs 硬連結(hard link)<a href="#軟連結soft-link-vs-硬連結hard-link" class="hash-link" aria-label="Direct link to 軟連結(soft link) vs 硬連結(hard link)" title="Direct link to 軟連結(soft link) vs 硬連結(hard link)">​</a></h4><p>硬連結建立方式<code>ln file.txt hardlink.txt</code> 軟連結建立方式<code>ln -s file.txt softlink.txt</code>,硬連結產生的 inode 數字會與 file.txt 相同，軟連結則會產生一個新的 inode.在使用上原始檔案 file.txt 被移除時,hardlink.txt 依舊可以顯示 file.txt 內容，而 softlink.txt 會失效，除非移除所有 hardlink.txt 才會移除掉原本的物理檔案.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="inode">inode<a href="#inode" class="hash-link" aria-label="Direct link to inode" title="Direct link to inode">​</a></h4><p>inode 是 Unix 風格的檔案系統中的一種資料結構,會連結到檔案系統物件,每個 inode 儲存了物件資料的屬性和磁碟區塊位置,例如元資料、擁有者、權限、大小等.inode 號碼是檔案系統內 inode 的唯一識別碼.</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="awk">awk<a href="#awk" class="hash-link" aria-label="Direct link to awk" title="Direct link to awk">​</a></h2>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="linux" term="linux"/>
        <category label="sed" term="sed"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[DNS Poisoning vs Domain Hijacking,Brief summary]]></title>
        <id>https://suyuying.github.io/blog/2023/03/07/linux-server/dns-pollution-hijack</id>
        <link href="https://suyuying.github.io/blog/2023/03/07/linux-server/dns-pollution-hijack"/>
        <updated>2023-03-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[record what is Domain Hijacking and DNS Poisoning, and the difference between them,小結：劫持是官方被駭或故意改的（大陸常發生），污染是路由到dns server過程某台路由器被駭。]]></summary>
        <content type="html"><![CDATA[<ol><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex max-h-[24px] w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">1</span>劫持：dns server 管理端或者你的域名解析商把你的 url 對應 ip 換成其他 ip 或 url</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">2</span>污染：dns serer 的某個節點catch 被駭然後改掉，把這個 url 換成其他 ip 或 url</li></ol><p>小結：劫持是官方被駭或故意改的（大陸常發生），污染是路由到dns server過程某台路由器被駭。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資料:</p><ol><li><a href="https://heimdalsecurity.com/blog/domain-hijacking-vs-dns-poisoning-do-you-know-the-difference/#:~:text=1.,and%20changes%20its%20DNS%20settings." target="_blank" rel="noopener noreferrer">Domain Hijacking vs DNS Poisoning: Do You Know the Difference</a></li><li><a href="https://www.williamlong.info/archives/3356.html" target="_blank" rel="noopener noreferrer">DNS 劫持和 DNS 污染的区别</a></li></ol></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="dns" term="dns"/>
        <category label="Domain Hijacking" term="Domain Hijacking"/>
        <category label="DNS Poisoning" term="DNS Poisoning"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Azure cloud container service Introduction and demo]]></title>
        <id>https://suyuying.github.io/blog/2023/03/06/Azure/azure-cloud-container</id>
        <link href="https://suyuying.github.io/blog/2023/03/06/Azure/azure-cloud-container"/>
        <updated>2023-03-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[介紹azure雲端container資源時，並分析如何選擇服務，最後提供自己使用上遇到的問題及解法]]></summary>
        <content type="html"><![CDATA[<div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>如果提供的資訊有錯，請用 comment 系統告知～</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-demand">Basic demand<a href="#basic-demand" class="hash-link" aria-label="Direct link to Basic demand" title="Direct link to Basic demand">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>需求： 1.免費的 server 跟 db，單純掛流量很小，沒有運算密集跟吃記憶體的程式。 2.使用 CICD 配合 container 部署 簡化布版流程</p></div></div><p>server 部分免費滿多的，但都 12 個月試用居多，最後就先挑了 azure，之後會補上 gcp 、 AWS。</p><p>ps: <a href="https://render.com/" target="_blank" rel="noopener noreferrer">render</a> 後來同事推薦，這個是免費的，之後補 CICD 部署到這裡的方法！</p><p>db 基本上就沒有了，免費的有 heroku clear db 不過他只有 5MB 可以用...... 所以目前還是乖乖用 squlite 吧</p><p>資料收集:</p><p>1.三家知名的雲服務廠商都有提供免費額度，這邊提供 azure 方面資訊
<a href="https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree</a></p><p>2.因為目的只是要單獨要做 api server，所以在 web app, VM,container-based app 之間做選擇。
因為無其他用途，所以不考慮 VM，而又要用到 container 所以最後挑 Deploy and run a container-based app 裡面
提供的三種服務 Azure Kubernetes Service(AKS)、Azure Container Instances(ACI)、Azure Container Apps
再做選擇。</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/azure-quick-start-e82cb82b227ff159f96c5f11c0d3e660.png" alt="azure-quick-start.png" class="img_CujE"></div><p>Azure 官網也有提供一個<a href="https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree" target="_blank" rel="noopener noreferrer">判斷樹</a></p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/compute-choices-c86c9b2e0c2dd50fc83964f23d8a3901.png" alt="azure-quick-start.png" class="img_CujE"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-container-service">Azure container service<a href="#azure-container-service" class="hash-link" aria-label="Direct link to Azure container service" title="Direct link to Azure container service">​</a></h2><p>基本上 Azure 雲服務，跟 container 有關的就是 Azure Container Instances,Azure Kubernetes Service,
Azure Container Apps</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-kubernetes-serviceaks">Azure Kubernetes Service(AKS)<a href="#azure-kubernetes-serviceaks" class="hash-link" aria-label="Direct link to Azure Kubernetes Service(AKS)" title="Direct link to Azure Kubernetes Service(AKS)">​</a></h3><p>AKS 基本上就是跟 azure 租多台 VM(看你的 node 樹），然後使用 mastet node 管理 node cluster，做到提高 HA，也達到提高機器效能使用率</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>以小型的後端程式為例，整套需要 mysql,redis,api 服務，後台統計服務 為背景</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="k8s-元件說明">K8s 元件說明<a href="#k8s-元件說明" class="hash-link" aria-label="Direct link to K8s 元件說明" title="Direct link to K8s 元件說明">​</a></h4><p>Container、Pod、Node。</p><p>what is container?
通常一個功能一個 container（當然你要全硬塞同個也可以，不過不建議），如果你不用 cloud db，那麼以上面 info 的背景情況，會有 4 個 container。</p><p>What is pod in Kubernetes?
是 k8s 最小執行單位，舉例來說，你的整套服務共四個 container 下來算是一個 pod。</p><p>what is node in Kubernetes? 一個 node 代表一台 VM
由 Worker Node 跟 Control Plane 組成。
Worker Node(部署 pod 的 vm，內部還可細分為 kubelet、kube-proxy 及 Container Runtime 3 個元件。)
Control Plane 負責各個 Worker Node 的管理</p><p>what is Kubernetes cluster?
因為高可用性跟擴展會有多個 node，所以就有了 cluster。
由 control panels 跟 nodes 組成。</p><p>Azure k8s?
直接幫你做好免費的控制平面了。但是要付 VM 的錢，透過 control plane 管理 k8s cluster。
control plane 不用付錢，但會吃 node 的資源。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-container-instancesaci">Azure Container Instances(ACI)<a href="#azure-container-instancesaci" class="hash-link" aria-label="Direct link to Azure Container Instances(ACI)" title="Direct link to Azure Container Instances(ACI)">​</a></h3><p>ACI 就是個雲端 container，拿來執行爬蟲之類的程式，他不支援擴展，附載平衡及憑證驗證。
基本上創完，Azure 會給你一組的連入 ip</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-container-apps">Azure Container Apps<a href="#azure-container-apps" class="hash-link" aria-label="Direct link to Azure Container Apps" title="Direct link to Azure Container Apps">​</a></h3><p>相較於 ACI，提供了 AutoScale,Https 入口，憑證代管，多 container 內部網路溝通等，
<a href="https://learn.microsoft.com/en-us/azure/container-apps/overview" target="_blank" rel="noopener noreferrer">詳細功用連結</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mychoice">MyChoice<a href="#mychoice" class="hash-link" aria-label="Direct link to MyChoice" title="Direct link to MyChoice">​</a></h3><p>基本上，只有一個不需要效能的服務，AKS 可以直接砍掉。因為是 api server，且傳的資訊有些需要保密資訊，所以選用
Azure Container Apps。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deployment">Deployment<a href="#deployment" class="hash-link" aria-label="Direct link to Deployment" title="Direct link to Deployment">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="教學網站">教學網站<a href="#教學網站" class="hash-link" aria-label="Direct link to 教學網站" title="Direct link to 教學網站">​</a></h3><p><a href="https://learn.microsoft.com/en-us/azure/app-service/quickstart-custom-container?pivots=container-linux-vscode&amp;WT.mc_id=UI-AQC&amp;tabs=dotnet" target="_blank" rel="noopener noreferrer">官網教學</a></p><p>執行的過程都是依據教學，但之後換自己的 Dockerfile 有遇到狀況，所以記錄一下遇到的問題。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="遇到的問題">遇到的問題<a href="#遇到的問題" class="hash-link" aria-label="Direct link to 遇到的問題" title="Direct link to 遇到的問題">​</a></h3><ol><li>Container xxx didn't respond to HTTP pings on port: 8000, failing site start. See container logs for debugging.</li></ol><p>網上查可能原因：</p><ol><li>Use the EXPOSE instruction in your Dockerfile to expose port 3000.(not useful, azure will scan internally)</li><li>Use the WEBSITES_PORT app setting with a value of "3000" to expose that port.</li></ol><p>以上都不行ＱＡＱ</p><p>最後發現是機器的 CPU 架構問題，因為是 m1 底下寫的 code，docker 會用 arm build 版，但一 🥚 部署環境是 azure 的 x86，底層不同服務起不來</p><p>解決方法：
將原本 Dockerfile</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM  python:3.11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./requirment.txt /code/requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN uname -a &gt; /os.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./sql_app /code/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV PORT 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT ["uvicorn", "app.maingog:app", "--host", "0.0.0.0", "--port", "80"]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>修改成</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM --platform=$TARGETPLATFORM  python:3.11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./requirment.txt /code/requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN uname -a &gt; /os.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./sql_app /code/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV PORT 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT ["uvicorn", "app.maingog:app", "--host", "0.0.0.0", "--port", "80"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然後再用以下指令推到 azure cotainer registry(請換成自己 acr 的樣子)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx build . --platform linux/arm64,linux/amd64 -t fastapiserver.azurecr.io/fordserver/v1.9 --push</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>之後使用這個 image 時，docker 內建就會幫你判斷是哪個系統，並起服務！</p><p>至於，buildx 跟--use 跟 context 這幾個 docker 指令也是第一次遇到，完全不熟，所以之後會再補上</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="acr-換-git-hub-container">ACR 換 git hub container<a href="#acr-換-git-hub-container" class="hash-link" aria-label="Direct link to ACR 換 git hub container" title="Direct link to ACR 換 git hub container">​</a></h3><p>因為用 ACR 要錢，然後 free plan 也不給開 private registry，所以可以用 github or gitlab，
因為沒特別想用 private，所以就用 git hub 吧。</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="cloud" term="cloud"/>
        <category label="Azure" term="Azure"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[gitcus comment system add to docusaurus but meet giscus.app refused to connect.]]></title>
        <id>https://suyuying.github.io/blog/2023/03/03/Docusaurus/gitcus-comment-in-docusaurus</id>
        <link href="https://suyuying.github.io/blog/2023/03/03/Docusaurus/gitcus-comment-in-docusaurus"/>
        <updated>2023-03-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[how to add comment system to docusaurus and problem giscus.app refused to connect.]]></summary>
        <content type="html"><![CDATA[<p>建立過程，以下只提供當初時作參考的網址，並紀錄過程遇到的問題。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><ol><li><a href="https://dev.to/m19v/how-to-add-giscus-comments-to-docusaurus-439h" target="_blank" rel="noopener noreferrer">docs 加 github discussion by giscus</a></li></ol></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><ol><li><a href="https://madrus4u.com/blog/blog-comments" target="_blank" rel="noopener noreferrer">blog 加 disqus system by disqus</a></li></ol></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">When meet giscus.app refused to connect:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">this is caused of the reason that setting domain name wrong.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">For example:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    https://suyuying.github.io./</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    you will see giscus.app refused to connect.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">But if you change url to, than it will fine.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    https://suyuying.github.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docusaurus" term="docusaurus"/>
        <category label="comment system" term="comment system"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Markdown syntax reference]]></title>
        <id>https://suyuying.github.io/blog/2023/03/03/Docusaurus/md-form</id>
        <link href="https://suyuying.github.io/blog/2023/03/03/Docusaurus/md-form"/>
        <updated>2023-03-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[demo在Docusaurus官網看到的md格式使用範例，給不熟悉md語法的使用者查詢格式用]]></summary>
        <content type="html"><![CDATA[<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// how to import</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import Tabs from "@theme/Tabs";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import TabItem from "@theme/TabItem";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import Highlight from "@site/src/components/Highlight";</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><span style="background-color:#25c2a0;border-radius:20px;color:#fff;padding:6px;cursor:pointer">Docusaurus green</span> and <span style="background-color:#1877F2;border-radius:20px;color:#fff;padding:6px;cursor:pointer">Facebook blue</span> are my favorite colors.<p>I can write <strong>Markdown</strong> alongside my <em>JSX</em>!</p><blockquote><p>Easy to maintain open source documentation websites.</p><p>— Docusaurus</p></blockquote><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">以下為上述用法的程式碼。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Highlight color="#25c2a0"&gt;Docusaurus green&lt;/Highlight&gt; and &lt;Highlight color="#1877F2"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Facebook blue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/Highlight&gt; are my favorite colors.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I can write **Markdown** alongside my _JSX_!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Easy to maintain open source documentation websites.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; — Docusaurus</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="details-element-example">Details element example<a href="#details-element-example" class="hash-link" aria-label="Direct link to Details element example" title="Direct link to Details element example">​</a></h3><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Toggle me!</summary><div><div class="collapsibleContent_i85q"><div><div>This is the detailed content</div><br><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Nested toggle! Some surprise inside...</summary><div><div class="collapsibleContent_i85q"><div>😲😲😲😲😲</div></div></div></details></div></div></div></details><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;details&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;summary&gt;Toggle me!&lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;div&gt;This is the detailed content&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;br /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;details&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;summary&gt;Nested toggle! Some surprise inside...&lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;div&gt;😲😲😲😲😲&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/details&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/details&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/malta_street-e4f6aff8d369f995fe829a9c92330f9d.jpeg" style="width:50%" alt="malta_street png" class="img_CujE"></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">how to import img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;div style={{ display: "flex", justifyContent: "center" }}&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      src={require("./malta_street.jpeg").default}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      style={{ width: "50%" }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      alt="malta_street png"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="my-doc-section">My Doc Section<a href="#my-doc-section" class="hash-link" aria-label="Direct link to My Doc Section" title="Direct link to My Doc Section">​</a></h3><p>Hello world message with some <strong>bold</strong> text, some <em>italic</em> text, and a <a href="https://www.yahoo.com" target="_blank" rel="noopener noreferrer">link</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//demo bold text ,italic style and superlink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello world message with some **bold** text, some _italic_ text, and a [link](https://www.yahoo.com)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Apple</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Orange</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Banana</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6">This is an apple 🍎</div><div role="tabpanel" class="tabItem_Ymn6" hidden="">This is an orange 🍊</div><div role="tabpanel" class="tabItem_Ymn6" hidden="">This is a banana 🍌</div></div></div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Android</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">iOS</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6">Android</div><div role="tabpanel" class="tabItem_Ymn6" hidden="">iOS</div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">demo tabs and tabs bring query string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// here are just tabs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Tabs&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="apple" label="Apple" default&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    This is an apple 🍎</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="orange" label="Orange"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    This is an orange 🍊</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="banana" label="Banana"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    This is a banana 🍌</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/Tabs&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//here bring query string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Tabs groupId="current-os" queryString&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="android" label="Android"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Android</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="ios" label="iOS"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    iOS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/Tabs&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/src/components/HelloCodeTitle.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">HelloCodeTitle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">Hello, </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">props</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">```jsx title="/src/components/HelloCodeTitle.js"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function HelloCodeTitle(props) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return &lt;h1&gt;Hello, {props.name}&lt;/h1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"react"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">MyComponent</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">isBar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">Bar</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">Foo</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token maybe-class-name">MyComponent</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">```jsx {1,4-6,11}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import React from "react";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const MyComponent = (props) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (props.isBar) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return &lt;div&gt;Bar&lt;/div&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return &lt;div&gt;Foo&lt;/div&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export default MyComponent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="playgroundContainer_X_Ta"><div class="playgroundHeader_dyrN">Live Editor</div><div class="playgroundEditor_Q6Y7" style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace;color:#393A34;background-color:#f6f8fa"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" data-gramm="false">// need install jsx live
function Clock(props) {
  const [date, setDate] = useState(new Date());
  useEffect(() =&gt; {
    const timerID = setInterval(() =&gt; tick(), 1000);

    return function cleanup() {
      clearInterval(timerID);
    };
  });

  function tick() {
    setDate(new Date());
  }

  return (
    &lt;div&gt;
      &lt;h2&gt;It is {date.toLocaleTimeString()}.&lt;/h2&gt;
    &lt;/div&gt;
  );
}</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// need install jsx live</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Clock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setDate</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> timerID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cleanup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">clearInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timerID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setDate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h2</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">It is </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">date</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toLocaleTimeString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text">.</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h2</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></pre><style>
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div><div class="playgroundHeader_dyrN">Result</div><div class="playgroundPreview_DzOI"><div>Loading...</div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">```jsx live</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// need install jsx live</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function Clock(props) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const [date, setDate] = useState(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  useEffect(() =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const timerID = setInterval(() =&gt; tick(), 1000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return function cleanup() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      clearInterval(timerID);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function tick() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    setDate(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;h2&gt;It is {date.toLocaleTimeString()}.&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::note</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::tip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::caution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::danger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a target="_blank" href="/assets/files/DONe-5d595c68c8a1502cdcc9a36280bcc412.json">Download this docx using Markdown</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Download this docx using Markdown](./DONe.json)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><b>title</b>: <!-- -->Markdown syntax reference</li><li><b>description</b>: <!-- -->demo在Docusaurus官網看到的md格式使用範例，給不熟悉md語法的使用者查詢格式用</li><li><b>authors</b>: <!-- -->suyuying</li><li><b>image</b>: <!-- -->https://github.com/suyuying.png</li><li><b>tags</b>: <!-- -->docusaurus<!-- -->Markdown manual</li><li><b>comments</b>: </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// how to get build in object attributes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;ul&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {Object.entries(frontMatter).map(([key, value]) =&gt; (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;li key={key}&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;b&gt;{key}&lt;/b&gt;: {value}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ))}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/ul&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex max-h-[24px] w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">1</span>Lorem ipsum dolor sit amet</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">2</span>It is a long established fact reader</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">3</span>The point of using Lorem Ipsum</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">4</span>There are many variations of passages</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">5</span>If you are going to use a of Lorem</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;ol&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex max-h-[24px]  w-full max-w-[24px]  items-center justify-center rounded-full text-base  text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Lorem ipsum dolor sit amet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    It is a long established fact reader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    The point of using Lorem Ipsum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    There are many variations of passages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If you are going to use a of Lorem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/ol&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>actions/checkout@v3 參數篇</p><ul><li><code>ref</code>：要檢出的分支、標籤或提交 ID。</li><li><code>repository</code>：要檢出的儲存庫名稱。</li><li><code>submodules</code>：是否檢出子模組。</li><li><code>ssh-key</code>：用於從儲存庫獲取程式碼的 SSH 金鑰。</li><li><code>persist-credentials</code>：是否在持久化工作區時保存 GITHUB_TOKEN 和 SSH_AUTH_SOCK 環境變數。</li><li><code>fetch-depth</code>：要檢出的提交數量。</li><li><code>lfs</code>：是否下載 Git LFS 文件。</li><li><code>clean</code>：是否在檢出前運行 <code>git clean</code>。</li><li><code>workspace</code>：檢出的儲存庫的目錄。</li></ul><kbd>F1</kbd> <kbd>F2</kbd> <kbd>F3</kbd> <kbd>F4</kbd><kbd>Ctrl</kbd> + <kbd>C</kbd><kbd>🡄</kbd> <kbd>🡆</kbd> <kbd>🡅</kbd> <kbd>🡇</kbd><kbd>PrtScn</kbd> <kbd>Tab ↹</kbd><kbd>Enter</kbd><kbd>⊞ Win</kbd><kbd>😆</kbd><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;F1&lt;/kbd&gt; &lt;kbd&gt;F2&lt;/kbd&gt; &lt;kbd&gt;F3&lt;/kbd&gt; &lt;kbd&gt;F4&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;Ctrl&lt;/kbd&gt; + &lt;kbd&gt;C&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;🡄&lt;/kbd&gt; &lt;kbd&gt;🡆&lt;/kbd&gt; &lt;kbd&gt;🡅&lt;/kbd&gt; &lt;kbd&gt;🡇&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;PrtScn&lt;/kbd&gt; &lt;kbd&gt;Tab ↹&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;Enter&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;⊞ Win&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;😆&lt;/kbd&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>並設定</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">src/css/custom.css</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kbd </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">margin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 0px </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">2em</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">padding</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1em </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">6em</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  border</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">radius</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 3px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">border</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 1px solid #ccc</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">color</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rgb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Arial Black"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Impact</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">display</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> inline</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">block</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  box</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shadow</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 1px 0px </span><span class="token function" style="color:#d73a49">rgba</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 2px #fff inset</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  background</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">color</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rgb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">247</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">247</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">247</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">moz</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">box</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shadow</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 1px 0px </span><span class="token function" style="color:#d73a49">rgba</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 2px #fff inset</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">webkit</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">box</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shadow</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 1px 0px </span><span class="token function" style="color:#d73a49">rgba</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 2px #fff inset</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">moz</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">border</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">radius</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 3px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">webkit</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">border</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">radius</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 3px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docusaurus" term="docusaurus"/>
        <category label="Markdown manual" term="Markdown manual"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Use Google Fonts in Docusaurus]]></title>
        <id>https://suyuying.github.io/blog/2023/03/03/Docusaurus/use-google-font</id>
        <link href="https://suyuying.github.io/blog/2023/03/03/Docusaurus/use-google-font"/>
        <updated>2023-03-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[整理網路提供的使用google font方法，最後是採用一般css import的方法,寫法上來說，直接在 custom css import 比較方便的,傳送的大小跟時間也是沒啥差,所以目前都用 css import 的方法,有寫錯麻煩指正]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一一般-css-import">一、一般 css import<a href="#一一般-css-import" class="hash-link" aria-label="Direct link to 一、一般 css import" title="Direct link to 一、一般 css import">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1在-html-head-import">1.在 html head import<a href="#1在-html-head-import" class="hash-link" aria-label="Direct link to 1.在 html head import" title="Direct link to 1.在 html head import">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sofia"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">body {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  font-family: "Sofia", sans-serif;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/head&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2在-css-import">2.在 css import<a href="#2在-css-import" class="hash-link" aria-label="Direct link to 2.在 css import" title="Direct link to 2.在 css import">​</a></h3><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">scr/css/custom.css</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Caveat:wght@500&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// css選擇器選使用範圍</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nav </span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">navbar__items</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 30px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Caveat</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//如果多個font import</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Caveat:wght@500&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// css 選擇標示用逗號分隔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">html </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Noto</span><span class="token plain"> </span><span class="token maybe-class-name">Sans</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">TC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sans</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">serif</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="二在-docusaurus-使用">二、在 docusaurus 使用<a href="#二在-docusaurus-使用" class="hash-link" aria-label="Direct link to 二、在 docusaurus 使用" title="Direct link to 二、在 docusaurus 使用">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1在-html-head-import-1">1.在 html head import<a href="#1在-html-head-import-1" class="hash-link" aria-label="Direct link to 1.在 html head import" title="Direct link to 1.在 html head import">​</a></h3><p>這個方法相當於一般 css 使用在 head 打 link，只是寫在設定檔內，會於<span style="background-color:#1877F2;border-radius:20px;color:#fff;padding:6px;cursor:pointer">編譯後</span>產生在 index.html 的 head 裡面</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&amp;amp;display=swap"&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">docusaurus.config.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">theme</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">customCss</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> require</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"./src/css/custom.css"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">stylesheets</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">rel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"preconnect"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">href</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">rel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"preconnect"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">href</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"https://fonts.gstatic.com"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">crossorigin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"anonymous"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">rel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"stylesheet"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">href</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2在-css-import-1">2.在 css import<a href="#2在-css-import-1" class="hash-link" aria-label="Direct link to 2.在 css import" title="Direct link to 2.在 css import">​</a></h3><p>做法同一般 css import</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">scr/css/custom.css</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Caveat:wght@500&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// css選擇器選使用範圍</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nav </span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">navbar__items</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 30px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Caveat</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//如果多個font import</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Caveat:wght@500&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// css 選擇標示用逗號分隔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">html </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Noto</span><span class="token plain"> </span><span class="token maybe-class-name">Sans</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">TC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sans</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">serif</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三比較兩種方法差異">三、比較兩種方法差異<a href="#三比較兩種方法差異" class="hash-link" aria-label="Direct link to 三、比較兩種方法差異" title="Direct link to 三、比較兩種方法差異">​</a></h2><p>一般css import</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/incss-9ed31de818e42e0d6f354a136c0b9bfb.png" alt="malta_street png" class="img_CujE"></div><p>link import</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/inlink1-528d5e3e355506d35b176fb8bf4cf495.png" alt="malta_street png" class="img_CujE"></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>寫法上來說，直接在 custom css import 比較方便的，傳送的大小跟時間也是沒啥差，
所以目前都用 css import 的方法。有寫錯麻煩指正～</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四-參考資料">四、 參考資料<a href="#四-參考資料" class="hash-link" aria-label="Direct link to 四、 參考資料" title="Direct link to 四、 參考資料">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資料：</p><p>1.<a href="https://ouch1978.github.io/docs/docusaurus/customization/use-google-fonts-with-correct-way" target="_blank" rel="noopener noreferrer">以正確的姿勢使用 Google Fonts</a></p><p>2.<a href="https://from8to8.com/diary/lastestposts-font/" target="_blank" rel="noopener noreferrer">背景圖案及字體設定</a></p><p>3.<a href="https://theochu.com/docusaurus/styling/#custom-fonts" target="_blank" rel="noopener noreferrer">How to customize the styling of the Docusaurus Classic Theme</a></p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docusaurus" term="docusaurus"/>
        <category label="css" term="css"/>
        <category label="google font" term="google font"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[reset git remote origin branch]]></title>
        <id>https://suyuying.github.io/blog/2023/03/02/Git/reset-git-origin-branch</id>
        <link href="https://suyuying.github.io/blog/2023/03/02/Git/reset-git-origin-branch"/>
        <updated>2023-03-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[在local端發現build完東西fail，但是已經推到main branch了，所以執行遠端registry退版，需要使用 git push --force,基本上 main branch 都會是保護的，也可以考慮用 pull request 先進行測試(不能自己發 pull request 自己審)，過了再 merge。]]></summary>
        <content type="html"><![CDATA[<p>需要使用 git push --force,基本上 main branch 都會是保護的，
也可以考慮用 pull request 先進行測試(不能自己發 pull request 自己審)，過了再 merge。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git checkout master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git reset --hard e3f1e37</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push --force origin master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Then to prove it (it won't print any diff)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git diff master..origin/master</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pull request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">settings -&gt; branches-&gt;Branch protection rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// if you just want to try merger just choose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Require status checks to pass before merging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// if you choose Require a pull request before merging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// will get error Pull request authors cannot approve their own pull requests!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://stackoverflow.com/questions/17667023/git-how-to-reset-origin-master-to-a-commit" target="_blank" rel="noopener noreferrer">參考網址</a></p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="git" term="git"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[use react to build your own static website by github page]]></title>
        <id>https://suyuying.github.io/blog/2023/03/02/github-action/git-hub-page-deploy-from-vite</id>
        <link href="https://suyuying.github.io/blog/2023/03/02/github-action/git-hub-page-deploy-from-vite"/>
        <updated>2023-03-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[記錄一下github page配合git hub action的部署react vite過程，並提供github multiple repo管理辦法，主要步驟1.建立一個repo名為your_github_username.github.io 2.建立gh-pages分枝3.地端建立CI yml檔 4.設定github page使用branch gh-pages 5.推地端資料到main branch 6.CI會幫你執行build並把資源放到gh-pages branch ,Done]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step1-建立-repo">step1. 建立 repo<a href="#step1-建立-repo" class="hash-link" aria-label="Direct link to step1. 建立 repo" title="Direct link to step1. 建立 repo">​</a></h2><p>創建 repo 資料，網路上很多，可以 google 一下，說一下我遇到的問題是我有兩個 github repo，在 mac m1 電腦上推第二個 repo 會一直報 403 錯誤，解法
參考 <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-your-personal-account/managing-multiple-accounts" target="_blank" rel="noopener noreferrer">官網：管理多個帳戶</a></p><p>::: tip
但是！我後來切回原本那個 repo 他又開始 403 報錯了，而且同樣方式再操作也失敗，之後嘗試用 ssh 方式，就沒遇到上述問題，所以建議用 ssh 來推 code 吧！
:::</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git config --get credential.helper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果輸出為osxkeychain，則您使用的是 macOS 鑰匙串。要清除憑據，請輸入以下命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#清除憑據</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git credential-osxkeychain erase https://github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 將 Git 配置為緩存您克隆存儲庫的每個本地目錄的憑據</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config --global credential.useHttpPath true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>創立 repo 名稱這邊就講比較簡單做法，不加路由的版本，repo 名稱是
username.github.io (把 username 換成你的 git 註冊名字)</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/git-repo-git-page-82b098f93b830fa79a07aab4bf912077.png" alt="git-repo name set yourusername.github.io" class="img_CujE"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step2在你的-github-repo-建立-gh-pages-分枝">step2.在你的 github repo 建立 gh-pages 分枝<a href="#step2在你的-github-repo-建立-gh-pages-分枝" class="hash-link" aria-label="Direct link to step2.在你的 github repo 建立 gh-pages 分枝" title="Direct link to step2.在你的 github repo 建立 gh-pages 分枝">​</a></h2><p>這個就在 github 上建立該分枝就好，裡面檔案預設會 copy main 分枝，這沒關係。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step3地端-yml-檔">step3.地端 yml 檔<a href="#step3地端-yml-檔" class="hash-link" aria-label="Direct link to step3.地端 yml 檔" title="Direct link to step3.地端 yml 檔">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 在git 根目錄</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ./github/workflows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>複製以下這段到名為 deploy.yml 的檔案，注意的是因為我是用 vite，然後管理包用 yarn，vite build 的資料夾放在 dist 底下，如果你是用一般建立 react 包的方法，會在 build。</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">./github/workflows/deploy.yml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">on</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">push</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">branches</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # </span><span class="token maybe-class-name">Review</span><span class="token plain"> gh actions docs </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> you want to further define triggers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> paths</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">docs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">en</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">using</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">workflows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">workflow</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">syntax</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">github</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions#on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">permissions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">contents</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pull</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">requests</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">jobs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">deploy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">on</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">steps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">setup</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">cache</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Install</span><span class="token plain"> dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn install </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">frozen</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">lockfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Build</span><span class="token plain"> website</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # </span><span class="token maybe-class-name">Popular</span><span class="token plain"> action to deploy to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # </span><span class="token maybe-class-name">Docs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">peaceiris</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gh</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pages#</span><span class="token operator" style="color:#393A34">%</span><span class="token constant" style="color:#36acaa">EF</span><span class="token operator" style="color:#393A34">%</span><span class="token constant" style="color:#36acaa">B8</span><span class="token operator" style="color:#393A34">%</span><span class="token plain">8F</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">docusaurus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> peaceiris</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gh</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pages@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">github_token</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">GITHUB_TOKEN</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token maybe-class-name">Build</span><span class="token plain"> output to publish to the </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">gh-pages</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">branch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">          # 這裡要改成你的build出來的資料夾！！</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">publish_dir</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">dist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token maybe-class-name">The</span><span class="token plain"> following lines assign commit authorship to the official</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token constant" style="color:#36acaa">GH</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Actions</span><span class="token plain"> bot </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> deploys to </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">gh-pages</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">branch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkout</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">issues</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">13</span><span class="token plain">#issuecomment</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">724415212</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token maybe-class-name">The</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">GH</span><span class="token plain"> actions bot is used by </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> you didn't specify the two fields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token maybe-class-name">You</span><span class="token plain"> can swap them out </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> your own user credentials</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">user_name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> github</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">bot</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">user_email</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">41898282</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">github</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">bot</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">@users</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">noreply</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step4設定預設分枝為-gh-pages">step4.設定預設分枝為 gh-pages<a href="#step4設定預設分枝為-gh-pages" class="hash-link" aria-label="Direct link to step4.設定預設分枝為 gh-pages" title="Direct link to step4.設定預設分枝為 gh-pages">​</a></h2><p>這布很重要，因為我每次設定都忘記要設定這個！ 忘記的話，最後連線到網站都會 F12 報錯
Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of "text/jsx". Strict MIME type checking is enforced for module scripts per HTML spec.</p><p>!!!很重要!!! 不然網站會是白的ＱＡＱ</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/gh-pages-01429e5af8a40496cac863a258a1b422.png" alt="how to set default branck of gh-pages" class="img_CujE"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step5-推檔案到-github-main-branch">step5. 推檔案到 github main branch<a href="#step5-推檔案到-github-main-branch" class="hash-link" aria-label="Direct link to step5. 推檔案到 github main branch" title="Direct link to step5. 推檔案到 github main branch">​</a></h2><p>就 <code>git push</code> ，然後你可以到 action 那邊確認是否 CI 成功，成功的話請到 gh-pages 確認資料夾結構是你 build 完資料夾的長相，當然，地端請確認 build 完資料，是可以成功提供服務的！</p><p>成功畫面要長這樣</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/github-ci-success-fe00ac4263bfc9497ce5880bd3c95187.png" alt="picture of the success result of ci" class="img_CujE"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="done">DONE<a href="#done" class="hash-link" aria-label="Direct link to DONE" title="Direct link to DONE">​</a></h2><p>請連線 <a href="https://yourusername.github.io/" target="_blank" rel="noopener noreferrer">https://yourusername.github.io/</a> 做確認</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資料</p><ol><li><p><a href="https://vitejs.dev/guide/static-deploy.html#github-pages" target="_blank" rel="noopener noreferrer">Vite Official Documentation</a></p></li><li><p><a href="https://www.youtube.com/watch?v=yo2bMGnIKE8" target="_blank" rel="noopener noreferrer">Youtube Video - How to deploy Vite App on GitHub Pages</a></p></li><li><p><a href="https://docusaurus.io/docs/deployment#deploying-to-github-pages" target="_blank" rel="noopener noreferrer">Deployment Docusaurus</a></p></li></ol></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="git" term="git"/>
    </entry>
</feed>