"use strict";(self.webpackChunkwebsitev_1=self.webpackChunkwebsitev_1||[]).push([[7014],{3905:(e,t,a)=>{a.d(t,{Zo:()=>p,kt:()=>b});var n=a(67294);function r(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function o(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function i(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?o(Object(a),!0).forEach((function(t){r(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):o(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function l(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var s=n.createContext({}),u=function(e){var t=n.useContext(s),a=t;return e&&(a="function"==typeof e?e(t):i(i({},t),e)),a},p=function(e){var t=u(e.components);return n.createElement(s.Provider,{value:t},e.children)},m="mdxType",c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,r=e.mdxType,o=e.originalType,s=e.parentName,p=l(e,["components","mdxType","originalType","parentName"]),m=u(a),d=r,b=m["".concat(s,".").concat(d)]||m[d]||c[d]||o;return a?n.createElement(b,i(i({ref:t},p),{},{components:a})):n.createElement(b,i({ref:t},p))}));function b(e,t){var a=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var o=a.length,i=new Array(o);i[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[m]="string"==typeof e?e:r,i[1]=l;for(var u=2;u<o;u++)i[u]=a[u];return n.createElement.apply(null,i)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},82549:(e,t,a)=>{a.r(t),a.d(t,{assets:()=>s,contentTitle:()=>i,default:()=>c,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var n=a(87462),r=(a(67294),a(3905));const o={title:"kibana\u5efa\u7f6e,\u4ee5\u53ca\u57fa\u790e\u4ecb\u7d39",description:"kibana\u5efa\u7f6e\u4ee5\u53ca\u4ed6\u600e\u9ebc\u914d\u5408prometheus\u7522\u751f\u5716\u8868\u4e26\u7528variable\u5206\u985e\u4e3b\u6a5f,",authors:"suyuying",image:"https://github.com/suyuying.png",tags:["Prometheus","Grafana"]},i=void 0,l={permalink:"/blog/2023/07/26/Prometheus/kibana",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Prometheus/2023-07-26-kibana.md",source:"@site/blog/Prometheus/2023-07-26-kibana.md",title:"kibana\u5efa\u7f6e,\u4ee5\u53ca\u57fa\u790e\u4ecb\u7d39",description:"kibana\u5efa\u7f6e\u4ee5\u53ca\u4ed6\u600e\u9ebc\u914d\u5408prometheus\u7522\u751f\u5716\u8868\u4e26\u7528variable\u5206\u985e\u4e3b\u6a5f,",date:"2023-07-26T00:00:00.000Z",formattedDate:"July 26, 2023",tags:[{label:"Prometheus",permalink:"/blog/tags/prometheus"},{label:"Grafana",permalink:"/blog/tags/grafana"}],readingTime:2.32,hasTruncateMarker:!0,authors:[{name:"zaxro",title:"When you\u2019re green, you grow. When you\u2019re ripe, you rot",url:"https://github.com/suyuying",imageURL:"https://github.com/suyuying.png",key:"suyuying"}],frontMatter:{title:"kibana\u5efa\u7f6e,\u4ee5\u53ca\u57fa\u790e\u4ecb\u7d39",description:"kibana\u5efa\u7f6e\u4ee5\u53ca\u4ed6\u600e\u9ebc\u914d\u5408prometheus\u7522\u751f\u5716\u8868\u4e26\u7528variable\u5206\u985e\u4e3b\u6a5f,",authors:"suyuying",image:"https://github.com/suyuying.png",tags:["Prometheus","Grafana"]},prevItem:{title:"set the priority order of the network services through linux cmd",permalink:"/blog/2023/07/31/Others/set-the-priority-order-of-network-through-cmd-in-linux"},nextItem:{title:"basic introudction of osi 7 layer  and their use",permalink:"/blog/2023/07/24/Others/osi-seven-layer"}},s={authorsImageUrls:[void 0]},u=[{value:"kibana",id:"kibana",level:2},{value:"\u8b8a\u6578\u8a2d\u5b9a",id:"\u8b8a\u6578\u8a2d\u5b9a",level:3},{value:"dashboard\u4f9d\u64da\u8b8a\u6578\u6293\u53d6\u4e3b\u6a5f",id:"dashboard\u4f9d\u64da\u8b8a\u6578\u6293\u53d6\u4e3b\u6a5f",level:3}],p={toc:u},m="wrapper";function c(e){let{components:t,...o}=e;return(0,r.kt)(m,(0,n.Z)({},p,o,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("h2",{id:"kibana"},"kibana"),(0,r.kt)("p",null,"\u9019\u908a\u7528docker-compose\u8d77\u670d\u52d9,\u4e0d\u904e\u6703\u6709conatiner\u4e00\u500b\u4f7f\u7528\u8005,\u800c\u975e\u9810\u8a2d\u7684root"),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-bash"},"mkdir -p ./data\nchown -R 472:472 ./data\n")),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre",className:"language-yaml"},"version: \"3.3\"\nservices:\n  grafana:\n    image: grafana/grafana-enterprise:9.5.6\n    user: \"472\"\n    container_name: grafana\n    restart: unless-stopped\n    environment:\n     - GF_SERVER_ROOT_URL=http://*.948787.store/\n     - GF_INSTALL_PLUGINS=grafana-clock-panel\n    ports:\n     - '3000:3000'\n    volumes:\n     - '$PWD/data:/var/lib/grafana'\n")),(0,r.kt)("p",null,"\u57fa\u672c\u4e0a,grafana\u53ea\u8981\u8a2d\u5b9a\u8cc7\u6599\u6e90\u53bb\u62c9prometheues,\u7136\u5f8c\u77e5\u9053\u600e\u9ebc\u627e\u9069\u5408\u7684dashboard,\u4ee5\u53ca\u8b8a\u6578\u5982\u4f55\u8a2d\u5b9a\u5c31\u5dee\u4e0d\u591a\uff01"),(0,r.kt)("h3",{id:"\u8b8a\u6578\u8a2d\u5b9a"},"\u8b8a\u6578\u8a2d\u5b9a"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"variable image",src:a(69403).Z,width:"1614",height:"499"})),(0,r.kt)("table",null,(0,r.kt)("thead",{parentName:"table"},(0,r.kt)("tr",{parentName:"thead"},(0,r.kt)("th",{parentName:"tr",align:null},"Variable"),(0,r.kt)("th",{parentName:"tr",align:null},"Definition"))),(0,r.kt)("tbody",{parentName:"table"},(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"origin_prometheus"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},"label_values(origin_prometheus)"))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"job"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'label_values(node_uname_info{origin_prometheus=~"$origin_prometheus"}, job)'))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"hostname"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'label_values(node_uname_info{origin_prometheus=~"$origin_prometheus",job=~"$job"}, nodename)'))),(0,r.kt)("tr",{parentName:"tbody"},(0,r.kt)("td",{parentName:"tr",align:null},"node"),(0,r.kt)("td",{parentName:"tr",align:null},(0,r.kt)("inlineCode",{parentName:"td"},'label_values(node_uname_info{origin_prometheus=~"$origin_prometheus",job=~"$job",nodename=~"$hostname"},instance)'))))),(0,r.kt)("p",null,"...."),(0,r.kt)("p",null,"\u9019\u908a",(0,r.kt)("inlineCode",{parentName:"p"},"label_values(origin_prometheus)"),"\u5c31\u662f\u7528",(0,r.kt)("inlineCode",{parentName:"p"},"origin_prometheus"),"\u53bb\u914d\u5408service-level\u7b49\u7d1a\u7684label\u53bb\u627e"),(0,r.kt)("p",null,(0,r.kt)("img",{alt:"service-level target",src:a(79873).Z,width:"1906",height:"517"}),"\n\u7b2c\u4e8c\u884cjob\u5247\u662f \u591a\u4e86label",(0,r.kt)("inlineCode",{parentName:"p"},"job"),"\u53bb\u5206\u985e\u76ee\u6a19\u4e3b\u6a5f,\u7136\u5f8c\u914d\u5408metric\u53bb\u5206\u985e\u4e3b\u6a5f,.\n",(0,r.kt)("img",{alt:"metric \u5206\u985e",src:a(68911).Z,width:"1885",height:"345"}),"\n\u6700\u5f8c\u7684\u6548\u679c\u5c31\u662f\u5728\u4f60\u7684dashborad\u6703\u53ef\u4ee5\u770b\u5230\u5404\u5206\u985e"),(0,r.kt)("h3",{id:"dashboard\u4f9d\u64da\u8b8a\u6578\u6293\u53d6\u4e3b\u6a5f"},"dashboard\u4f9d\u64da\u8b8a\u6578\u6293\u53d6\u4e3b\u6a5f"),(0,r.kt)("p",null,(0,r.kt)("a",{parentName:"p",href:"https://grafana.com/grafana/dashboards/11074"},"\u9019\u908a\u662f\u4ee5grafana\u6a21\u677f11074\u70ba\u7bc4\u4f8b"),",\u6700\u5f8c\u7684\u6548\u679c\u5c31\u6703\u50cf",(0,r.kt)("img",{alt:"grafan dash board11074",src:a(58605).Z,width:"1150",height:"363"})),(0,r.kt)("pre",null,(0,r.kt)("code",{parentName:"pre"},'label_values(node_uname_info{job=~"$job"}, nodename)  \n')),(0,r.kt)("p",null,"node_uname_info: \u9019\u662f\u4e00\u500bPrometheus\u76e3\u63a7\u7cfb\u7d71\u4e2d\u7684metric\u6307\u6a19\u540d\u7a31\u3002\u5b83\u901a\u5e38\u7528\u4f86\u6536\u96c6\u6709\u95dc\u7bc0\u9ede\uff08\u4e3b\u6a5f\uff09\u7684\u7cfb\u7d71\u8cc7\u8a0a\uff0c\u4f8b\u5982\u64cd\u4f5c\u7cfb\u7d71\u7684\u7248\u672c\u3001\u4e3b\u6a5f\u540d\u7b49\u3002"),(0,r.kt)("p",null,'{job=~"$job"}: \u9019\u662f\u4e00\u500b\u904e\u6ffe\u689d\u4ef6\uff0c\u7528\u65bc\u50c5\u9078\u64c7\u7279\u5b9a\u7684\u76e3\u63a7\u4f5c\u696d\uff08job\uff09\u3002\u5728\u9019\u88e1\uff0c\u60a8\u4f7f\u7528\u4e86\u6b63\u5247\u8868\u9054\u5f0f $job \u4f5c\u70ba\u8b8a\u6578\uff0c\u8a72\u8b8a\u6578\u53ef\u80fd\u4ee3\u8868\u4e0d\u540c\u7684\u4f5c\u696d\u540d\u7a31\u3002'),(0,r.kt)("p",null,"label_values(...): \u9019\u662f\u4e00\u500bPromQL\u51fd\u6578\uff0c\u7528\u65bc\u6aa2\u7d22\u6307\u5b9ametric\u7684\u7279\u5b9a\u6a19\u7c64\uff08label\uff09\u7684\u6240\u6709\u53ef\u80fd\u503c\u3002\u5728\u9019\u500b\u60c5\u5883\u4e0b\uff0c\u60a8\u60f3\u8981\u7372\u53d6\u6240\u6709\u7b26\u5408\u904e\u6ffe\u689d\u4ef6\u7684\u7bc0\u9ede\u540d\u7a31\u3002"),(0,r.kt)("p",null,"nodename: \u9019\u662f\u60a8\u60f3\u8981\u7372\u53d6\u7684\u6a19\u7c64\u540d\u7a31\uff0c\u5b83\u53ef\u80fd\u4ee3\u8868\u6bcf\u500b\u7bc0\u9ede\u7684\u540d\u7a31\u3002"),(0,r.kt)("p",null,"\u7c21\u8a00\u4e4b,\u4ed6\u6703\u63d0\u53d6\u6240\u6709node_umane_info\u9019\u500bmetric,\u904e\u6ffe\u51fa\u542b\u6709job\u9019\u500blabel\u7684\u503c,\u6700\u5f8c\u53d6\u5f97\u8a72metric\u5269\u4e0b\u7b26\u5408\u8005\u7684label\u662fnode_name\u9019\u500b\u7684\u6240\u6709\u7684\u503c\uff01"))}c.isMDXComponent=!0},58605:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-1-7230372ca96d3eb8a6ba0879e99ffed3.png"},69403:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-2-922fce544f072b85968a59bf7c9158a7.png"},79873:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-3-c29f1b2fcf98fa2191d6a021cb529151.png"},68911:(e,t,a)=>{a.d(t,{Z:()=>n});const n=a.p+"assets/images/image-4-d00234b148a39ac070f93a379521c7c1.png"}}]);