"use strict";(self.webpackChunkwebsitev_1=self.webpackChunkwebsitev_1||[]).push([[6131],{3905:(e,t,n)=>{n.d(t,{Zo:()=>c,kt:()=>f});var r=n(7294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=r.createContext({}),u=function(e){var t=r.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},c=function(e){var t=u(e.components);return r.createElement(s.Provider,{value:t},e.children)},p="mdxType",m={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},d=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,o=e.originalType,s=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),p=u(n),d=i,f=p["".concat(s,".").concat(d)]||p[d]||m[d]||o;return n?r.createElement(f,a(a({ref:t},c),{},{components:n})):r.createElement(f,a({ref:t},c))}));function f(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var o=n.length,a=new Array(o);a[0]=d;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l[p]="string"==typeof e?e:i,a[1]=l;for(var u=2;u<o;u++)a[u]=n[u];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}d.displayName="MDXCreateElement"},9468:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>s,contentTitle:()=>a,default:()=>m,frontMatter:()=>o,metadata:()=>l,toc:()=>u});var r=n(7462),i=(n(7294),n(3905));const o={title:"s3 set iam permissions for Github Actions to achieve CIBuild an AWS s3 static website",description:"hh",authors:"suyuying",tags:["AWS"]},a=void 0,l={permalink:"/blog/2023/03/15/Aws/s3-setting-for-ci",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Aws/2023-03-15-s3-setting-for-ci.md",source:"@site/blog/Aws/2023-03-15-s3-setting-for-ci.md",title:"s3 set iam permissions for Github Actions to achieve CIBuild an AWS s3 static website",description:"hh",date:"2023-03-15T00:00:00.000Z",formattedDate:"March 15, 2023",tags:[{label:"AWS",permalink:"/blog/tags/aws"}],readingTime:3.34,hasTruncateMarker:!1,authors:[{name:"zaxro",title:"Life is too short to live someone else's dream",url:"https://github.com/suyuying",imageURL:"https://github.com/suyuying.png",key:"suyuying"}],frontMatter:{title:"s3 set iam permissions for Github Actions to achieve CIBuild an AWS s3 static website",description:"hh",authors:"suyuying",tags:["AWS"]},prevItem:{title:"A small issue with curl related to using different versions of curl between IDE and local terminal",permalink:"/blog/2023/03/16/linux-server/little-curl-problem"},nextItem:{title:"CI:use github action to build image and push to git hub container registry",permalink:"/blog/2023/03/11/github-action/githib-action-CI-to-github-container"}},s={authorsImageUrls:[void 0]},u=[{value:"S3 \u975c\u614b\u7db2\u7ad9\u8a2d\u5b9a",id:"s3-\u975c\u614b\u7db2\u7ad9\u8a2d\u5b9a",level:2},{value:"\u63a5 clourfront",id:"\u63a5-clourfront",level:2},{value:"\u8a2d\u5b9a\u7d66 github action CI \u7684\u6b0a\u9650",id:"\u8a2d\u5b9a\u7d66-github-action-ci-\u7684\u6b0a\u9650",level:2}],c={toc:u},p="wrapper";function m(e){let{components:t,...n}=e;return(0,i.kt)(p,(0,r.Z)({},c,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"s3-\u975c\u614b\u7db2\u7ad9\u8a2d\u5b9a"},"S3 \u975c\u614b\u7db2\u7ad9\u8a2d\u5b9a"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"\u5982\u679c\u6709\u6253\u7b97\u9650\u5236\u80fd\u8fd1\u4f86\u7684\u57df\u540d\uff0c\u5c31\u8acb\u4e0d\u8981\u7528\u975c\u614b\u7db2\u7ad9\uff0c\u5c31\u7528\u9810\u8a2d\u7684 RestApi \u6a21\u5f0f\uff0c\u63a5 cloudfront \u900f\u904e header \u53bb\u9650\u5b9a\u3002")),(0,i.kt)("p",null,(0,i.kt)("a",{parentName:"p",href:"https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/HostingWebsiteOnS3Setup.html"},"\u5b98\u7db2\u6559\u5b78\u5f88\u8a73\u7d30\uff01"),"\n\u8981\u5728 Amazon S3 \u4e0a\u8a2d\u5b9a\u975c\u614b\u7db2\u7ad9\uff0c\u5982\u679c\u662f\u4f7f\u7528 UI \u7684\u8a71\uff0c\u8acb\u6309\u7167\u4ee5\u4e0b\u6b65\u9a5f\u9032\u884c\u64cd\u4f5c\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"UI: \u5efa\u7acb\u65b0\u7684 S3 Bucket \u6216\u9078\u64c7\u4e00\u500b\u73fe\u6709\u7684 Bucket\u3002(Cli:",(0,i.kt)("inlineCode",{parentName:"li"},"aws s3 mb s3://me-profile --profile ford --region us-west-1")," \u5728 us-west-1 \u5efa\u7acb s3 bucket,bucket \u540d\u7a31\u662f me-profile,\u4f7f\u7528\u7684 user \u662f ford)"),(0,i.kt)("li",{parentName:"ol"},"UI:\u5728 Bucket \u5c6c\u6027\u4e2d\u555f\u7528\u975c\u614b\u7db2\u7ad9\u4e3b\u6a5f\u3002"),(0,i.kt)("li",{parentName:"ol"},"UI:\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u7d22\u5f15\u6587\u4ef6(index.html)\u548c\u932f\u8aa4\u6587\u4ef6\u3002(Cli:",(0,i.kt)("inlineCode",{parentName:"li"},"aws s3 website s3://bucket-name --index-document index.html --error-document error.html"),")"),(0,i.kt)("li",{parentName:"ol"},"UI :\u5c07\u5fc5\u8981\u7684\u6587\u4ef6\u6dfb\u52a0\u5230 Bucket \u4e2d\u3002(\u53ef\u4ee5\u7528 \u4e5f\u53ef\u4ee5\u7528 cli\nCli:",(0,i.kt)("inlineCode",{parentName:"li"},"aws s3 sync ./dist/ s3://fordserver-front --delete --profile ford"),")"),(0,i.kt)("li",{parentName:"ol"},"UI :\u914d\u7f6e Bucket \u7b56\u7565\u4ee5\u5141\u8a31\u516c\u958b\u8a2a\u554f\u6587\u4ef6\uff0c\u9810\u8a2d\u6703\u5168\u64cb\u3002"),(0,i.kt)("li",{parentName:"ol"},"UI :\u65b0\u589e\u5132\u5b58\u8caf\u9ad4\u653f\u7b56\uff0c\u5c07\u5132\u5b58\u8caf\u9ad4\u5167\u5bb9\u8a2d\u70ba\u53ef\u4f9b\u5927\u773e\u8b80\u53d6\uff0c\u628a\u9019\u500b json \u8907\u88fd\u8cbc\u4e0a")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre",className:"language-jsx",metastring:"{11-12}","{11-12}":!0},'{\n    "Version": "2012-10-17",\n    "Statement": [\n        {\n            "Sid": "PublicReadGetObject",\n            "Effect": "Allow",\n            "Principal": "*",\n            "Action": [\n                "s3:GetObject"\n            ],\n            "Resource": [\n                "arn:aws:s3:::Bucket-Name/*"\n            ]\n        }\n    ]\n}\n')),(0,i.kt)("p",null,"Resource \u66f4\u65b0\u70ba\u60a8\u7684\u5132\u5b58\u8caf\u9ad4\u540d\u7a31!"),(0,i.kt)("ol",{start:7},(0,i.kt)("li",{parentName:"ol"},"(\u53ef\u9078)\u5982\u679c\u8981\u914d\u7f6e\u81ea\u5df1\u8cb7\u7684\u57df\u540d\uff0c \u628a cname \u8a2d\u7f6e\u4ee5\u6307\u5411 S3 \u7db2\u7ad9\u7aef\u9ede\u3002")),(0,i.kt)("p",null,"\u6309\u7167\u9019\u4e9b\u6b65\u9a5f\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Amazon S3 \u5efa\u7acb\u7c21\u55ae\u4e14\u5177\u6210\u672c\u6548\u76ca\u7684\u975c\u614b\u7db2\u7ad9\u3002"),(0,i.kt)("h2",{id:"\u63a5-clourfront"},"\u63a5 clourfront"),(0,i.kt)("p",null,"\u5efa\u7acb\u4e00\u500b\u975c\u614b\u7db2\u7ad9\u4e4b\u5f8c\uff0c\u53bb\u5efa\u7acb cloudfront\uff0c\u628a\u6d41\u91cf\u5c0e\u5230 s3\u3002"),(0,i.kt)("p",null,"\u4ee5\u4e0b\u662f\u5efa\u7acb CloudFront \u5206\u767c\u7684\u6b65\u9a5f\uff1a"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u767b\u5165 AWS Management Console \u4e26\u524d\u5f80 CloudFront \u63a7\u5236\u53f0\u9801\u9762\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u9ede\u64ca\u300c\u5efa\u7acb distribution\u300d\u6309\u9215\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u5728\u300c\u5efa\u7acb distribution\u300d\u9801\u9762\u4e2d\uff0c\u60a8\u53ef\u4ee5\u5f9e\u4e0b\u62c9\u5f0f\u6e05\u55ae\u9078\u64c7\u300cWeb\u300d\u6216\u300cRTMP\u300d\u5206\u767c\u7684\u985e\u578b\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u5c0d\u65bc Web \u5206\u767c\uff0c\u5728 Origin \u6b04\u4f4d\u4e2d\uff0c\u5f9e\u4e0b\u62c9\u5f0f\u6e05\u55ae\u9078\u64c7\u60a8\u7684 S3 \u6876\u7684 REST API \u7aef\u9ede\u6216\u8f38\u5165\u60a8\u7684 S3 \u6876\u7684\u7db2\u7ad9\u7aef\u9ede\u3002",(0,i.kt)("a",{parentName:"li",href:"https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/WebsiteEndpoints.html#WebsiteRestEndpointDiff"},"\u7db2\u7ad9\u7aef\u9ede\u548c REST API \u7aef\u9ede\u4e4b\u9593\u7684\u4e3b\u8981\u5dee\u7570")),(0,i.kt)("li",{parentName:"ol"},"\u5728\u9810\u8a2d\u5feb\u53d6\u884c\u70ba\u4e2d\uff0c\u70ba Viewer \u5354\u8b70\u539f\u5247\u9078\u64c7 HTTP \u548c HTTPS \u6216\u91cd\u65b0\u5c0e\u5411 HTTP \u5230 HTTPS\u3002\n\u6ce8\u610f\uff1a\u9078\u64c7\u50c5\u4f7f\u7528 HTTPS \u6703\u5c01\u9396\u6240\u6709 HTTP \u8acb\u6c42\u3002"),(0,i.kt)("li",{parentName:"ol"},"\u5982\u679c\u60a8\u6c92\u6709\u4f7f\u7528 CloudFront \u7684\u66ff\u4ee3\u57df\u540d (CNAME)\uff0c\u5247\u9078\u64c7\u300c\u5efa\u7acb\u5206\u767c\u300d\u4ee5\u5b8c\u6210\u6d41\u7a0b\u3002\u5982\u679c\u60a8\u6b63\u5728\u4f7f\u7528 CNAME\uff0c\u5247\u5728\u5275\u5efa\u5206\u767c\u4e4b\u524d\u8acb\u6309\u7167\u4ee5\u4e0b\u984d\u5916\u6b65\u9a5f\u9032\u884c\u64cd\u4f5c\uff1a",(0,i.kt)("ul",{parentName:"li"},(0,i.kt)("li",{parentName:"ul"},"\u5c0d\u65bc\u66ff\u4ee3\u57df\u540d (CNAME)\uff0c\u8acb\u9078\u64c7\u300c\u65b0\u589e\u9805\u76ee\u300d\uff0c\u7136\u5f8c\u8f38\u5165\u60a8\u7684\u66ff\u4ee3\u57df\u540d\u3002"),(0,i.kt)("li",{parentName:"ul"},"\u5c0d\u65bc\u81ea\u8a02 SSL \u6191\u8b49\uff0c\u5f9e\u4e0b\u62c9\u5f0f\u6e05\u55ae\u4e2d\u9078\u64c7\u6db5\u84cb\u60a8\u7684 CNAME \u7684\u81ea\u8a02 SSL \u6191\u8b49\uff0c\u4ee5\u5c07\u5176\u6307\u6d3e\u7d66\u5206\u767c\u3002(\u9019\u88e1\u53ef\u4ee5\u7528 aws \u7684\u81ea\u7c3d\u6191\u8b49\u6703\u5f88\u65b9\u4fbf!)")))),(0,i.kt)("h2",{id:"\u8a2d\u5b9a\u7d66-github-action-ci-\u7684\u6b0a\u9650"},"\u8a2d\u5b9a\u7d66 github action CI \u7684\u6b0a\u9650"))}m.isMDXComponent=!0}}]);