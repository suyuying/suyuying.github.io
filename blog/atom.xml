<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
    <id>https://suyuying.github.io/blog</id>
    <title>Zaxro Blog Blog</title>
    <updated>2023-03-25T00:00:00.000Z</updated>
    <generator>https://github.com/jpmonette/feed</generator>
    <link rel="alternate" href="https://suyuying.github.io/blog"/>
    <subtitle>Zaxro Blog Blog</subtitle>
    <icon>https://suyuying.github.io/img/githubLogoV1.svg</icon>
    <entry>
        <title type="html"><![CDATA[aws iam setting introduction]]></title>
        <id>https://suyuying.github.io/blog/2023/03/25/Aws/aws-iam-setting</id>
        <link href="https://suyuying.github.io/blog/2023/03/25/Aws/aws-iam-setting"/>
        <updated>2023-03-25T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[hh]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-is-aws-iam">what is aws IAM<a href="#what-is-aws-iam" class="hash-link" aria-label="Direct link to what is aws IAM" title="Direct link to what is aws IAM">​</a></h2><p><a href="/blog/2023/03/25/Aws/[https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/service_code_examples.html](https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/service_code_examples.html)">什麼是 IAM</a> aws 官網的資訊一般都寫得滿棒的，本文出處主要是參考官網資訊做整理，因為管理上經驗只限於自己的環境用的 s3,CI 等等，所以打算趁這個機會檢視之前設定的 iAM 有沒有問題，當然，我相信這只是過程，隨著看過的資訊跟事情越多，會得到不同或者多個答案，總之，就先從這一步開始吧！</p><p>AWS Identity and Access Management (IAM) 用途：安全地控制對 Amazon Web Services (AWS) 和帳戶資源的存取。使用 IAM 為使用者和角色等身分提供您的帳戶中資源的存取權。</p><p>以下是 IAM 安全架構參考網路資源，主要組成如圖</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/iam-structure-66a78d44c84c4325ae24c3a93b04d714.png" alt="malta_street png" class="img_CujE"></div><div class="text-center"><a href="https://hackmd.io/@study-group-aws-book/HkhQ2BlRP" target="_blank" rel="noopener noreferrer">本圖參考讀書會-大話AWS雲端結構</a></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="typical-composition">typical composition<a href="#typical-composition" class="hash-link" aria-label="Direct link to typical composition" title="Direct link to typical composition">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Policy -&gt; IAM identities(IAM group or Role)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="policy">Policy<a href="#policy" class="hash-link" aria-label="Direct link to Policy" title="Direct link to Policy">​</a></h3><p>格式: 祈使＋主詞(<a href="#iam-identities">IAM identities</a>)＋條件＋動詞(optional)＋資源受詞 (對應：允許 Don 奧丁破關一百次時 吃 麥當勞)</p><p>對應 Aws Json(把上面舉例更換而已)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Effect : "允許"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Principal: "Don"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Condition:"奧丁破關一百次時"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Action: "吃"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Resource :"麥當勞"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>正式版 Aws Json</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "Version": "2012-10-17",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "Statement": [</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Sid": "PublicReadGetObject",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Effect": "Allow",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Principal": "*",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Action": "s3:GetObject",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            "Resource": "arn:aws:s3:::myresume-for-zaxx/*"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    ]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="iam-identities">IAM identities<a href="#iam-identities" class="hash-link" aria-label="Direct link to IAM identities" title="Direct link to IAM identities">​</a></h3><p>共有根使用者、IAM 使用者、IAM 使用者群組、IAM 角色、暫時性憑證</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="根使用者">根使用者<a href="#根使用者" class="hash-link" aria-label="Direct link to 根使用者" title="Direct link to 根使用者">​</a></h4><h4 class="anchor anchorWithStickyNavbar_LWe7" id="iam-使用者">IAM 使用者<a href="#iam-使用者" class="hash-link" aria-label="Direct link to IAM 使用者" title="Direct link to IAM 使用者">​</a></h4><p>具備單一人員或應用程式的特定許可，AWS 建議人員金鑰長期憑證者要定期更換，而相比長期憑證更建議用暫時性憑證.</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="iam-使用者群組">IAM 使用者群組<a href="#iam-使用者群組" class="hash-link" aria-label="Direct link to IAM 使用者群組" title="Direct link to IAM 使用者群組">​</a></h4><p>使用者集合的身份，透過 IAM 使用者群組管理 IAM 使用者</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="iam-角色">IAM 角色<a href="#iam-角色" class="hash-link" aria-label="Direct link to IAM 角色" title="Direct link to IAM 角色">​</a></h4><p>它類似 IAM 使用者，但不與特定的人員相關聯。角色的目的是讓需要它的任何人可代入，理解上就像是個具有權限的有時效性 token，可以給 code 或使用者或資源使用。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="暫時性憑證">暫時性憑證<a href="#暫時性憑證" class="hash-link" aria-label="Direct link to 暫時性憑證" title="Direct link to 暫時性憑證">​</a></h4><p><a href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/best-practices.html" target="_blank" rel="noopener noreferrer">最佳實務</a>它類似 IAM 使用者，但不與特定的人員相關聯</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="何時使用-iam-identity-center-使用者">何時使用 IAM Identity Center 使用者？<a href="#何時使用-iam-identity-center-使用者" class="hash-link" aria-label="Direct link to 何時使用 IAM Identity Center 使用者？" title="Direct link to 何時使用 IAM Identity Center 使用者？">​</a></h4><p><a href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id.html#id_temp-creds" target="_blank" rel="noopener noreferrer">官方回覆</a></p><p>看起來是可以透過單一登入，去取得在所有帳戶中所授的權限</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="何時建立-iam-使用者-而不是角色">何時建立 IAM 使用者 (而不是角色)<a href="#何時建立-iam-使用者-而不是角色" class="hash-link" aria-label="Direct link to 何時建立 IAM 使用者 (而不是角色)" title="Direct link to 何時建立 IAM 使用者 (而不是角色)">​</a></h4><p>建議您僅將 IAM 使用者用於聯合身分使用者不支援的使用案例。聯合身分使用者(federating exist user)是透過外部資源去連 AWS 上時，透過 IAM role 分配資源取得權限，配合跟 ldP(external identity provider)ex.FB,google 驗證，讓使用者可以取的短期憑證。</p><h4 class="anchor anchorWithStickyNavbar_LWe7" id="何時建立-iam-角色-而不是使用者">何時建立 IAM 角色 (而不是使用者)<a href="#何時建立-iam-角色-而不是使用者" class="hash-link" aria-label="Direct link to 何時建立 IAM 角色 (而不是使用者)" title="Direct link to 何時建立 IAM 角色 (而不是使用者)">​</a></h4><p>程式端向 aws 資源請求、aws 服務間串接、以及公司的 single sign on(系統有採用 SAML 2.0 或建立並使用自訂代理伺服器，將使用者身分從企業轉換為提供暫時 AWS 安全憑證的 IAM 角色)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="brief-summary">Brief summary<a href="#brief-summary" class="hash-link" aria-label="Direct link to Brief summary" title="Direct link to Brief summary">​</a></h3><p>官方建議大多情況都會適用 IAM role，使用 IMA role 的優點是他是使用暫時性憑證(可設定到期時間)，而 IAM 使用者用的都是長期的 aws_secret_access_key(因此官方會建議定時換，不過一般來說沒人那麼勤勞 ZZZ)。</p><p>官網提工暫時性憑證的優點</p><ol><li><p>不必隨應用程式散發或內嵌長期 AWS 安全憑證:舉例來說，公司有個腳本拿來是拿來更新前端資源的，如果使用 IAM 使用者，那他的私 key 就會跟著這隻腳本到處跑，但用 role 的話不用。</p></li><li><p>可以提供 AWS 資源存取給使用者，而不必為其定義 AWS 身分。暫時憑證是<a href="https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id_roles.html" target="_blank" rel="noopener noreferrer">角色和聯合身分</a>的基礎。</p></li><li><p>暫時性安全憑證的存留期有限，因此當不再需要時，您不需要輪換它們或明確予以撤銷</p></li></ol><p>不過每個公司都有各自文化。習慣之後再去看自己公司那套的優缺點～</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="lab-provide-ci-access-to-write-to-s3-resources">lab: Provide CI access to write to S3 resources<a href="#lab-provide-ci-access-to-write-to-s3-resources" class="hash-link" aria-label="Direct link to lab: Provide CI access to write to S3 resources" title="Direct link to lab: Provide CI access to write to S3 resources">​</a></h2><p>目標: 設定 github action 在 code 更新以後會把 build 好的資料由 build 資料夾底下東西發到 S3.</p><p>名詞定義：</p><p>STS: AWS Security Token Service API,提供信任的使用者暫時安全憑證，控制對於 AWS 資源的存取。</p><p>OIDC: OpenID Connect,Google 或 Salesforce。如果想要在 OIDC 相容的 IdP 和您的 AWS 帳戶 之間建立信任，請使用 IAM OIDC 身分提供者。</p><p>IdP: Identity Provider 身分識別資訊提供者</p><p>SAML: Security Assertion Markup Language（安全斷言標記式語言）的縮寫，是指在身分識別資訊提供者（IdP）與服務提供者（Service Provider，SP）之間傳送驗證以及授權資料的一種公開標準。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="lab-1用-iam-role-配合-odic-執行-ci">lab 1.用 IAM role 配合 ODIC 執行 CI<a href="#lab-1用-iam-role-配合-odic-執行-ci" class="hash-link" aria-label="Direct link to lab 1.用 IAM role 配合 ODIC 執行 CI" title="Direct link to lab 1.用 IAM role 配合 ODIC 執行 CI">​</a></h3><p>這邊示範用 ODIC，讓 aws 認可的 IdP 作身份驗證並連線到 AWS 存取並更新 S3.</p><p>在建立 IAM OIDC 身分提供者之後，必須建立一個或多個 IAM 角色。角色是 AWS 中的一個身分，並不擁有自己的憑證 (與 IAM 使用者不同)。在此情況中，角色以動態指派給聯合身分使用者，而該使用者由您組織的身分提供者 (IdP) 進行驗證。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">順序:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">建立Identity Providers-&gt;建立角色-&gt;自訂信任政策-&gt;連結許可政策-&gt;複製建立的角色ARN-&gt;設定github CI/CD的secret-&gt;建立yml檔</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="建立-identity-providers">建立 Identity Providers<a href="#建立-identity-providers" class="hash-link" aria-label="Direct link to 建立 Identity Providers" title="Direct link to 建立 Identity Providers">​</a></h4><ol><li>AWS console 查詢 IAM，左方 nav 欄位選供應商類型後, 選 OpenID Connect.</li><li>供應商 URL, 輸入 <a href="https://token.actions.githubusercontent.com" target="_blank" rel="noopener noreferrer">https://token.actions.githubusercontent.com</a></li><li>按"取得指紋"</li><li>對象, 輸入 sts.amazonaws.com
以上建立之後，arn:aws:iam::930209118237:oidc-provider/token.actions.githubusercontent.com</li><li>把 ARN 複製準備建立 role.</li></ol><h4 class="anchor anchorWithStickyNavbar_LWe7" id="建立角色">建立角色<a href="#建立角色" class="hash-link" aria-label="Direct link to 建立角色" title="Direct link to 建立角色">​</a></h4><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">自訂信任政策-&gt;連結許可</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>授權 聯合使用者主體，給 github repo 是 USERNAME/YOUR_REPO 的 pull or main 可以用此角色，以下記得替換成你的 repo 名稱歐！</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">信任政策(關係)</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Version"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"2012-10-17"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Statement"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Effect"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Allow"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Principal"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">"Federated"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"arn:aws:iam::9302XXX18237:oidc-provider/token.actions.githubusercontent.com"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Action"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sts:AssumeRoleWithWebIdentity"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Condition"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string-property property" style="color:#36acaa">"StringEquals"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string-property property" style="color:#36acaa">"token.actions.githubusercontent.com:sub"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">"repo:USERNAME/YOUR_REPO:pull_request"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                        </span><span class="token string" style="color:#e3116c">"repo:USERNAME/YOUR_REPO:ref:refs/heads/main"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token string-property property" style="color:#36acaa">"token.actions.githubusercontent.com:aud"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"sts.amazonaws.com"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>因為 S3 許可設定真的太多了，這邊主要就勾選 list 跟幾個會用到的 delete/get/put object，許可設定參考<a href="https://docs.github.com/zh/enterprise-server@3.8/admin/github-actions/enabling-github-actions-for-github-enterprise-server/enabling-github-actions-with-amazon-s3-storage#%E4%BD%BF%E7%94%A8%E8%AE%BF%E9%97%AE%E5%AF%86%E9%92%A5%E9%80%9A%E8%BF%87-amazon-s3-%E5%AD%98%E5%82%A8%E5%90%AF%E7%94%A8-github-actions" target="_blank" rel="noopener noreferrer">官網這篇</a>。在看許可過程中有看到 AWS cloudtrail 提供的 IAM 紀錄解析，幫你分析之前的操作並用最小權限去設定(這個情境官網有舉例: 開發時可能會把權限全開，但實際上 PROD 環境就要限制權限，可以透過 cloudtrail 去分析之前所有對 S3 操作有用到的權限，並設定之)，但因為還沒實作，所以就先這樣。</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">許可政策for S3 CI/CD</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Version"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"2012-10-17"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Statement"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Sid"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"VisualEditor0"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Effect"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Allow"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Action"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:PutObject"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:GetObject"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:ListBucketMultipartUploads"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:ListMultipartUploadParts"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:AbortMultipartUpload"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:DeleteObject"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:ListBucket"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Resource"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>github 設定檔，以下會執行 build，驗證 aws,把編譯後資料推到 s3。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>permissions 一定要設定成 write，這樣設定是要設寫入權限才能請求 OpenID Connect JWT 令牌。沒設定就會跑出以下報錯
Error: Credentials could not be loaded, please check your action inputs: Could not load credentials from any providers</p></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.github/workflows/deploy.yml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">on</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">push</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">branches</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # </span><span class="token maybe-class-name">Review</span><span class="token plain"> gh actions docs </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> you want to further define triggers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> paths</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">docs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">en</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">using</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">workflows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">workflow</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">syntax</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">github</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions#on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">permissions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  id</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">token</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">jobs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">deploy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">on</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">steps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">setup</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">cache</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Install</span><span class="token plain"> dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn install </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">frozen</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">lockfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Build</span><span class="token plain"> website</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Configure</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">AWS</span><span class="token plain"> </span><span class="token maybe-class-name">Credentials</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> aws</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">configure</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">aws</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">credentials@v1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          aws</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">region</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ap</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">northeast</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">3</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          role</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">to</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">assume</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">PROD_DEPLOY_ROLE</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          role</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">session</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">OIDCSession</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token constant" style="color:#36acaa">S3</span><span class="token plain"> bucket</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> aws s3 sync </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">build</span><span class="token operator" style="color:#393A34">/</span><span class="token plain"> s3</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">yours3 </span><span class="token operator" style="color:#393A34">--</span><span class="token keyword" style="color:#00009f">delete</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資訊</p><ol><li><p><a href="https://docs.github.com/zh/enterprise-server@3.8/admin/github-actions/enabling-github-actions-for-github-enterprise-server/enabling-github-actions-with-amazon-s3-storage" target="_blank" rel="noopener noreferrer">Enabling GitHub Actions with Amazon S3 storage</a></p></li><li><p><a href="https://www.eliasbrange.dev/posts/secure-aws-deploys-from-github-actions-with-oidc/#2-add-github-as-an-identity-provider" target="_blank" rel="noopener noreferrer">Secure AWS deploys from GitHub Actions with OIDC</a></p></li></ol></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="AWS" term="AWS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[How to let google find my website?]]></title>
        <id>https://suyuying.github.io/blog/2023/03/20/SEO/google-register</id>
        <link href="https://suyuying.github.io/blog/2023/03/20/SEO/google-register"/>
        <updated>2023-03-20T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[register my website to google]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="記錄一下整個-google-註冊自己網站過程">記錄一下整個 google 註冊自己網站過程<a href="#記錄一下整個-google-註冊自己網站過程" class="hash-link" aria-label="Direct link to 記錄一下整個 google 註冊自己網站過程" title="Direct link to 記錄一下整個 google 註冊自己網站過程">​</a></h2><ol><li>主要參考這篇 <a href="https://web-design.vip/google-web-submit.html" target="_blank" rel="noopener noreferrer">https://web-design.vip/google-web-submit.html</a> ， 他會提供你三個讓 google 爬蟲找到你最快得方式。</li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="讓你的網站加入搜尋功能">讓你的網站加入搜尋功能<a href="#讓你的網站加入搜尋功能" class="hash-link" aria-label="Direct link to 讓你的網站加入搜尋功能" title="Direct link to 讓你的網站加入搜尋功能">​</a></h2><ol><li><a href="https://docusaurus.io/docs/next/search" target="_blank" rel="noopener noreferrer">Using Algolia DocSearch</a>申請 Algolia 審查</li><li></li></ol>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="google" term="google"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[docker gitlab runner error during connect Post "http://docker:2375/v1.24/auth" dial tcp lookup docker on 1.1.1.1:53 no such host]]></title>
        <id>https://suyuying.github.io/blog/2023/03/16/Docker/docker-gitlab-error-connect-docker</id>
        <link href="https://suyuying.github.io/blog/2023/03/16/Docker/docker-gitlab-error-connect-docker"/>
        <updated>2023-03-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[執行這個修改，volumes 改為 ["/var/run/docker.sock:/var/run/docker.sock", "/cache"]，讓 Runner Executor 使用主機外部的 Docker Engine。所以推測，這可能是 gitlab runner 跟 gitlab server 上面驗證的機制，如果沒有這樣加，dind 就找不到 gitlab server 的驗證那關，所以就會失敗]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="遇到問題的情境">遇到問題的情境<a href="#遇到問題的情境" class="hash-link" aria-label="Direct link to 遇到問題的情境" title="Direct link to 遇到問題的情境">​</a></h2><p>CICD 步驟裡面，每當開發人員把 code 寫完之後，會進行測試並把 code build 成 image 後推到 image registry
，之後到環境執行 deploy。</p><p>在 gitlab 裡面會用 gitlab runner，並在.gitlab-ci.yml 設計促發的情境下，執行.gitlab-ci.yml 內容，要在 gitlab runner 內 build image 通常會用到 docker:dind，它是具有 docker 引擎的 container！一般的 image 內通常都不會去安裝 docker 引擎，這段有點難懂，但你可以想想有 nginx,mysql 等等的 image，基本上只會有自己預設功能，不需要 docker 引擎，對於 docker 而言，裡面要可以用 docker 指令的， docker:dind 是一個選項。</p><p>在 build 版執行的 yml 如下。
主要功能就是登入在 gitlab 上面的公司的 image registry,之後在 gitlab runner 執行 build image 並推到 gitlab image registry.</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.gitlab-ci.yml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">stages</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">variables</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">IMAGE_NAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> hahaha</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY_IMAGE</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">$</span><span class="token constant" style="color:#36acaa">IMAGE_NAME</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">$</span><span class="token constant" style="color:#36acaa">CI_COMMIT_SHORT_SHA</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># </span><span class="token maybe-class-name">Build</span><span class="token plain"> moni</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">build</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">moni</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">stage</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">image</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> docker</span><span class="token operator" style="color:#393A34">:</span><span class="token plain">dind</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">tags</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">before_script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker login </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">u $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY_USER</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">p $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY_PASSWORD</span><span class="token plain"> $</span><span class="token constant" style="color:#36acaa">CI_REGISTRY</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">script</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker build </span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">t $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker push $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> docker rmi $</span><span class="token constant" style="color:#36acaa">CI_IMAGE</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">except</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> schedules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">Dockerfile</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">FROM</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">node</span><span class="token operator" style="color:#393A34">:</span><span class="token number" style="color:#36acaa">16</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">COPY</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">node </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">WORKDIR</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">/</span><span class="token plain">node</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">RUN</span><span class="token plain"> npm install</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">npm install gulp </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">g</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain">gulp build</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">EXPOSE</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">4000</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">CMD</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"npm"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"run"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"start"</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>執行過程到這一步<code>- docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY</code>遇到報錯，
<code>error during connect: Post "http://docker:2375/v1.24/auth": dial tcp: lookup docker on 1.1.1.1:53: no such host</code>。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="解法">解法:<a href="#解法" class="hash-link" aria-label="Direct link to 解法:" title="Direct link to 解法:">​</a></h3><p>在你掛到 gitlab runner 中 /etc/gitlab-runner 裡面的 config.toml，請先用 docker inspect 觀察 volume 掛載位置，如果你是用官網 local volume 掛載方法，那就是在 VM 上去 vim /srv/gitlab-runner/config/config.toml，去修改
<code>volumes = ["/cache"]</code> 變成
<code>volumes = ["/var/run/docker.sock:/var/run/docker.sock","/cache"]</code>。</p><p>並執行<code>docker restart gitlab-runner</code>!</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="可能原因">可能原因：<a href="#可能原因" class="hash-link" aria-label="Direct link to 可能原因：" title="Direct link to 可能原因：">​</a></h3><p>執行這個修改，volumes 改為 <!-- -->["/var/run/docker.sock:/var/run/docker.sock", "/cache"]<!-- -->，讓 Runner Executor 使用主機外部的 Docker Engine。</p><p>所以推測，這可能是 gitlab runner 跟 gitlab server 上面驗證的機制，如果沒有這樣加，dind 就找不到 gitlab server 的驗證那關，所以就會失敗</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docker" term="docker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[environment variable and  secrets variable config in github]]></title>
        <id>https://suyuying.github.io/blog/2023/03/16/github-action/githubaction-env-secrets-variablr-config</id>
        <link href="https://suyuying.github.io/blog/2023/03/16/github-action/githubaction-env-secrets-variablr-config"/>
        <updated>2023-03-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[使用 CI 跟寫程式都會遇到要從 env 拿取變數值的時候，在 github 管理方式如下，主要判斷是這個變數是否要給多個 workflow 使用。如果您不確定，也可以從存儲庫密鑰開始為所有東西創建密鑰。如果之後有引入需要不同密鑰的不同環境，例如 prod,dev,test 等，則可以將存儲庫密鑰移動到特定環境。然後在特定環境用特定變數值。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="workflow-區分-env-設定模式">workflow 區分 env 設定模式<a href="#workflow-區分-env-設定模式" class="hash-link" aria-label="Direct link to workflow 區分 env 設定模式" title="Direct link to workflow 區分 env 設定模式">​</a></h2><p>使用 CI 跟寫程式都會遇到要從 env 拿取變數值的時候，在 github 管理方式如下，主要判斷是這個變數是否要給多個 workflow 使用。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="單-workflow-使用">單 workflow 使用<a href="#單-workflow-使用" class="hash-link" aria-label="Direct link to 單 workflow 使用" title="Direct link to 單 workflow 使用">​</a></h3><p>非密碼類型，在 workflow 中定義 env 即可。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name: Greeting on variable day</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  workflow_dispatch</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DAY_OF_WEEK: Monday</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  greeting_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: "Say Hello Mona it's Monday"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "$Greeting $First_Name. Today is $DAY_OF_WEEK!"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          First_Name: Mona</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>不同層次的環境變數可以繼承並覆蓋較高層次的環境變數。例如，如果您在頂級工作流程文件中設置了一個環境變數，並且在作業中使用相同的變數名稱定義了另一個值，那麼在該作業中使用的值將覆蓋頂級值。</p><p>密碼類型，就需要用到會跨多個 workflow 的 secrets 去管理。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="多-workflow-使用">多 workflow 使用<a href="#多-workflow-使用" class="hash-link" aria-label="Direct link to 多 workflow 使用" title="Direct link to 多 workflow 使用">​</a></h3><p>需在 github UI 設定變數。這些變數可以跨多個工作流程使用。
位置</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/github-env-repo-variable-18c0308cd7664714c41cd456ccba373e.png" alt="github-env-repo-variable.png" class="img_CujE"></div><p>主要三層級:</p><ol><li><p>組織</p></li><li><p>存儲庫</p></li><li><p>環境</p><p>上面圖有 repo 跟 env 的，使用順序部分：Environment &gt; Repository &gt; Organization。
如果有相同變數，優先用 Environment , than Repository, than：Organization。</p></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用情境">使用情境<a href="#使用情境" class="hash-link" aria-label="Direct link to 使用情境" title="Direct link to 使用情境">​</a></h2><p>這邊提供參考</p><p>如果您不確定，也可以從存儲庫密鑰開始為所有東西創建密鑰。如果之後有引入需要不同密鑰的不同環境，例如 prod,dev,test 等，則可以將存儲庫密鑰移動到特定環境。然後在特定環境用特定變數值。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="使用方法">使用方法<a href="#使用方法" class="hash-link" aria-label="Direct link to 使用方法" title="Direct link to 使用方法">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="設定在-sercrets">設定在 sercrets<a href="#設定在-sercrets" class="hash-link" aria-label="Direct link to 設定在 sercrets" title="Direct link to 設定在 sercrets">​</a></h3><p>要用要這樣用<code>${{ secrets.YOURKEY }}</code>
為啥格式長這樣要看<a href="https://docs.github.com/en/actions/learn-github-actions/contexts#secrets-context" target="_blank" rel="noopener noreferrer">secrets 上下文</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="設定在-variables">設定在 variables<a href="#設定在-variables" class="hash-link" aria-label="Direct link to 設定在 variables" title="Direct link to 設定在 variables">​</a></h3><p>要用要這樣用<code>${{ vars.YOURKEY }}</code>
為啥格式長這樣要看<a href="https://docs.github.com/en/actions/learn-github-actions/contexts#vars-context" target="_blank" rel="noopener noreferrer">vars 上下文</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="設定在-workflow-裡的-env">設定在 workflow 裡的 env<a href="#設定在-workflow-裡的-env" class="hash-link" aria-label="Direct link to 設定在 workflow 裡的 env" title="Direct link to 設定在 workflow 裡的 env">​</a></h3><p>如果是在機器底下，可以用<code>$KEY</code>(linux).</p><p>設定在機器外面(job 以上層級)要用<a href="https://docs.github.com/en/actions/learn-github-actions/contexts#env-context" target="_blank" rel="noopener noreferrer">env 上下文</a>，<code>${{ env.mascot }}</code></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><a href="https://docs.github.com/en/actions/learn-github-actions/variables" target="_blank" rel="noopener noreferrer">參考的官網資料-variables 管理</a></p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[A small issue with curl related to using different versions of curl between IDE and local terminal]]></title>
        <id>https://suyuying.github.io/blog/2023/03/16/linux-server/little-curl-problem</id>
        <link href="https://suyuying.github.io/blog/2023/03/16/linux-server/little-curl-problem"/>
        <updated>2023-03-16T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[前陣子因為需要檢查域名設定，測試過程中發現在 pycharm 運行 curl 指令，運行結果跟 iterm2 的運行結果不同，以下是 demo 指令，最後使用which curl發現兩邊curl有差別，進一步檢查發現兩者檔案 size 也有差，使用的相關套件也有差。心得：基本上連自己電腦環境都可能用髒了，之後排查類似的bug順序會先檢查彼此使用指令的版本，確認沒差太多，在開始往其他方向排查。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="同-pc-的-curl-結果不同">同 pc 的 curl 結果不同<a href="#同-pc-的-curl-結果不同" class="hash-link" aria-label="Direct link to 同 pc 的 curl 結果不同" title="Direct link to 同 pc 的 curl 結果不同">​</a></h2><p>前陣子因為需要檢查域名設定，測試過程中發現在 pycharm 運行 curl 指令，運行結果跟 iterm2 的運行結果不同，以下是 demo 指令</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -XPOST 'https://www.boce.com/apiHtml/login' \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -A "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36" \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H 'Content-Type: application/json' \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d '{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "email_or_phone":"thisIsSecret",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "password":"thisIsSecret"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="curl-指令基本介紹">curl 指令基本介紹<a href="#curl-指令基本介紹" class="hash-link" aria-label="Direct link to curl 指令基本介紹" title="Direct link to curl 指令基本介紹">​</a></h2><p>Curl 是一種在命令列介面下使用的開放原始碼檔案傳輸工具，常用於 HTTP、HTTPS、FTP 等協定的傳輸
因為<code>curl</code>選項太多，可以用<code>curl --help all</code>看所有選項，
常用選項有以下</p><ol><li>-H 帶 header</li><li>-A 帶 useragent</li><li>-i 看回應 header(可以拿來查回應 token)</li><li>-d 使用 post 方法要帶入 data</li><li>-X 使用的方法 ex. POST PUT DELETE GET</li><li>-c cookie 相關操作
以下為例，登入網站並把回應 cookie 存在 cookie.txt</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">curl -c cookie.txt -XPOST 'https://www.boce.com/apiHtml/login' \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -A "Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36" \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -H 'Content-Type: application/json' \</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  -d '{</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "email_or_phone":"thisIsSecret",</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    "password":"thisIsSecret"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>後續可以用<code>curl -b cookie.txt</code>在請求時把 cookie 帶入到 request 中</p><ol start="7"><li>-v 詳細模式</li><li><code>-o file名稱 網址</code> 下載圖片使用，檔名自己命名 Write to file instead of stdout</li><li><code>-O 網址</code> 下載資料使用，檔名同遠端網址檔名 Write output to a file named as the remote file</li><li>-L 跟隨 301 302 跳轉</li><li>Basic Authentication，可以攜帶 --user username:password 來通過驗證。</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step1-問題排查-curl--v-看過程">step1. 問題排查 curl -v 看過程<a href="#step1-問題排查-curl--v-看過程" class="hash-link" aria-label="Direct link to step1. 問題排查 curl -v 看過程" title="Direct link to step1. 問題排查 curl -v 看過程">​</a></h3><p>比較後發現，ide 跟 terminal 帶的 header 跟 useragent 這些都有帶，問題不在這邊。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="step2-檢查使用的-curl-是否有差">step2. 檢查使用的 curl 是否有差<a href="#step2-檢查使用的-curl-是否有差" class="hash-link" aria-label="Direct link to step2. 檢查使用的 curl 是否有差" title="Direct link to step2. 檢查使用的 curl 是否有差">​</a></h3><p>檢查<code>which crul</code>輸出</p><p>ide: /usr/bin/curl (curl 7.79.1 (x86_64-apple-darwin21.0) libcurl/7.79.1 (SecureTransport) LibreSSL/3.3.6 zlib/1.2.11 nghttp2/1.45.1
Release-Date: 2021-09-22)</p><p>terminal: /Users/ford/opt/anaconda3/bin/curl (curl 7.82.0 (x86_64-apple-darwin13.4.0) libcurl/7.82.0 OpenSSL/1.1.1n zlib/1.2.12 libssh2/1.10.0 nghttp2/1.46.0
Release-Date: 2022-03-05)</p><p>發現有差別，進一步檢查發現兩者檔案 size 也有差，使用的相關套件也有差。</p><p>解法： 直接指定 curl 位置,/usr/bin/curl 。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="心得">心得<a href="#心得" class="hash-link" aria-label="Direct link to 心得" title="Direct link to 心得">​</a></h2><p>基本上連自己電腦環境都可能用髒了，之後排查類似的 bug 順序會先檢查彼此使用指令的版本，確認沒差太多，在開始往其他方向排查。</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="curl" term="curl"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[s3 set iam permissions for Github Actions to achieve CIBuild an AWS s3 static website]]></title>
        <id>https://suyuying.github.io/blog/2023/03/15/Aws/s3-setting-for-ci</id>
        <link href="https://suyuying.github.io/blog/2023/03/15/Aws/s3-setting-for-ci"/>
        <updated>2023-03-15T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[hh]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="s3-靜態網站設定">S3 靜態網站設定<a href="#s3-靜態網站設定" class="hash-link" aria-label="Direct link to S3 靜態網站設定" title="Direct link to S3 靜態網站設定">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>如果有打算限制能近來的域名，就請不要用靜態網站，就用預設的 RestApi 模式，接 cloudfront 透過 header 去限定。</p></div></div><p><a href="https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/HostingWebsiteOnS3Setup.html" target="_blank" rel="noopener noreferrer">官網教學很詳細！</a>
要在 Amazon S3 上設定靜態網站，如果是使用 UI 的話，請按照以下步驟進行操作：</p><ol><li>UI: 建立新的 S3 Bucket 或選擇一個現有的 Bucket。(Cli:<code>aws s3 mb s3://me-profile --profile ford --region us-west-1</code> 在 us-west-1 建立 s3 bucket,bucket 名稱是 me-profile,使用的 user 是 ford)</li><li>UI:在 Bucket 屬性中啟用靜態網站主機。</li><li>UI:指定要使用的索引文件(index.html)和錯誤文件。(Cli:<code>aws s3 website s3://bucket-name --index-document index.html --error-document error.html</code>)</li><li>UI :將必要的文件添加到 Bucket 中。(可以用 也可以用 cli
Cli:<code>aws s3 sync ./dist/ s3://fordserver-front --delete --profile ford</code>)</li><li>UI :配置 Bucket 策略以允許公開訪問文件，預設會全擋。</li><li>UI :新增儲存貯體政策，將儲存貯體內容設為可供大眾讀取，把這個 json 複製貼上</li></ol><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Version"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"2012-10-17"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token string-property property" style="color:#36acaa">"Statement"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Sid"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"PublicReadGetObject"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Effect"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Allow"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Principal"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"*"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Action"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"s3:GetObject"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">            </span><span class="token string-property property" style="color:#36acaa">"Resource"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">                </span><span class="token string" style="color:#e3116c">"arn:aws:s3:::Bucket-Name/*"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Resource 更新為您的儲存貯體名稱!</p><ol start="7"><li>(可選)如果要配置自己買的域名， 把 cname 設置以指向 S3 網站端點。</li></ol><p>按照這些步驟，您可以使用 Amazon S3 建立簡單且具成本效益的靜態網站。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="接-clourfront">接 clourfront<a href="#接-clourfront" class="hash-link" aria-label="Direct link to 接 clourfront" title="Direct link to 接 clourfront">​</a></h2><p>建立一個靜態網站之後，去建立 cloudfront，把流量導到 s3。</p><p>以下是建立 CloudFront 分發的步驟：</p><ol><li>登入 AWS Management Console 並前往 CloudFront 控制台頁面。</li><li>點擊「建立 distribution」按鈕。</li><li>在「建立 distribution」頁面中，您可以從下拉式清單選擇「Web」或「RTMP」分發的類型。</li><li>對於 Web 分發，在 Origin 欄位中，從下拉式清單選擇您的 S3 桶的 REST API 端點或輸入您的 S3 桶的網站端點。<a href="https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/WebsiteEndpoints.html#WebsiteRestEndpointDiff" target="_blank" rel="noopener noreferrer">網站端點和 REST API 端點之間的主要差異</a></li><li>在預設快取行為中，為 Viewer 協議原則選擇 HTTP 和 HTTPS 或重新導向 HTTP 到 HTTPS。
注意：選擇僅使用 HTTPS 會封鎖所有 HTTP 請求。</li><li>如果您沒有使用 CloudFront 的替代域名 (CNAME)，則選擇「建立分發」以完成流程。如果您正在使用 CNAME，則在創建分發之前請按照以下額外步驟進行操作：<ul><li>對於替代域名 (CNAME)，請選擇「新增項目」，然後輸入您的替代域名。</li><li>對於自訂 SSL 憑證，從下拉式清單中選擇涵蓋您的 CNAME 的自訂 SSL 憑證，以將其指派給分發。(這裡可以用 aws 的自簽憑證會很方便!)</li></ul></li></ol><h2 class="anchor anchorWithStickyNavbar_LWe7" id="設定給-github-action-ci-的權限">設定給 github action CI 的權限<a href="#設定給-github-action-ci-的權限" class="hash-link" aria-label="Direct link to 設定給 github action CI 的權限" title="Direct link to 設定給 github action CI 的權限">​</a></h2>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="AWS" term="AWS"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[CI:use github action to build image and push to git hub container registry]]></title>
        <id>https://suyuying.github.io/blog/2023/03/11/github-action/githib-action-CI-to-github-container</id>
        <link href="https://suyuying.github.io/blog/2023/03/11/github-action/githib-action-CI-to-github-container"/>
        <updated>2023-03-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[use CI in github action ,and variable in environments to build image and push to registry. github action 入門攻略，CI 推image到github]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="build-code-registry">Build code registry<a href="#build-code-registry" class="hash-link" aria-label="Direct link to Build code registry" title="Direct link to Build code registry">​</a></h2><p>把 code 推到 github 教學很多，可以 google 一下，不過要注意的是現在推 code 都要先在官網申請 token，新手很容易卡在這。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="ways-to-build-image-and-push">ways to build image and push<a href="#ways-to-build-image-and-push" class="hash-link" aria-label="Direct link to ways to build image and push" title="Direct link to ways to build image and push">​</a></h2><p>執行 CI 前，要確認有 Dockerfile 並且在地端可以 docker run 服務起來，CI 過程會用該 Dokcerfile 產生 image。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="way1-build-image-and-push-from-local-side-by-docker-commanduse-ci-after-to-renew">way1. build image and push from local side by docker command,use CI after to renew<a href="#way1-build-image-and-push-from-local-side-by-docker-commanduse-ci-after-to-renew" class="hash-link" aria-label="Direct link to way1. build image and push from local side by docker command,use CI after to renew" title="Direct link to way1. build image and push from local side by docker command,use CI after to renew">​</a></h3><ol><li><p>在地端 build 完，然後推到 github container registry(需要用 github ui 建立 token,並給 token)
，然後把 token 存到 txt 檔</p></li><li><p>用 token 登入 github</p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat token.txt | docker login ghcr.io -u suyuying --password-stdin</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>-u</code> 換成自己的 username</p><p><code>token.txt</code>把 token 放在裡面</p><ol start="3"><li>推 image 到 github container registry DONe</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx build --platform=linux/arm64,linux/amd64 --push -t ghcr.io/suyuying/fastapi-backend:1.0 .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>這個方法當下沒啥問題，會成功建立，如果以上方法要接ＣＩ，還有 step 4.
image，但之後接 CI 的時候會
遇到權限問題，貌似用 token 建立以後，你 CI 裡面使用 registry 的 <code>password: ${{ secrets.GITHUB_TOKEN }} </code> 的 token 會失效，<a href="https://github.com/orgs/community/discussions/26274" target="_blank" rel="noopener noreferrer">原本 issue 位置</a></p><p>4.請前往 $yourOrganization → Packages → $yourPackage → Package settings（右側/底部），並配置“管理操作訪問"部分以允許有問題的 git 存儲庫對此包 code 存儲庫有 write 權限</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="way2-use-ci-to-create-and-push-image-first-and-afterwards">way2. use CI to create and push image first, and afterwards<a href="#way2-use-ci-to-create-and-push-image-first-and-afterwards" class="hash-link" aria-label="Direct link to way2. use CI to create and push image first, and afterwards" title="Direct link to way2. use CI to create and push image first, and afterwards">​</a></h3><p>1.在.github/workflows 資料夾建立 xxx.yml 檔案，內容</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># This workflow uses actions that are not certified by GitHub.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># They are provided by a third-party and are governed by</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># separate terms of service, privacy policy, and support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># documentation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># GitHub recommends pinning actions to a commit SHA.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To get a newer version, you will need to update the SHA.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You can also reference a tag or branch, but the action may change without warning.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Create and publish a Docker image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    branches: ['main']</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build-and-push-image:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  // 這個是之後示範import config environment variable ,optional</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment: prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    permissions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      contents: read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      packages: write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 這個是建立這份文件的env變數</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Checkout repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Log in to the Container registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          registry: ghcr.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ github.actor }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.GITHUB_TOKEN }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    //這邊的secrets要用Actions secrets and variables設定</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: mr-smithers-excellent/docker-build-push@v6</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    // 這邊格式就記下來，因為他官網寫的也不清不楚的，這樣會做出ghcr.io/suyuying/fastapi-backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          image: fastapi-backend</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          registry: ghcr.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ secrets.GHCR_USERNAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.GHCR_TOKEN }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>放變數值到 github repo 上<div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/repo-secrect-3a35354eeda7b4df693c52a9e9e8e79a.png" style="width:100%" alt="malta_street png" class="img_CujE"></div></li></ol><p>GHCR_USERNAME="yourUserName"</p><p>GHCR_TOKEN="classic token 產出的 token"</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>可以用 Environment secrets 或 Repository secrets
對 workflow 而言他們都會放在 secrets 這個物件裡面，
使用方式向是
<code>${{ secrets.GHCR_TOKEN }}</code></p></div></div><ol start="3"><li>因爲條件設定 push main，所以確認好 main branch 直接推就會發現有新作 image 了</li></ol><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG">  <div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/vars-env-7f80c95e8356a4877a06290e615ef468.png" style="width:100%" alt="malta_street png" class="img_CujE"></div><p>如果要使用上面再 environment 環境變數取值，要使用這種格式
<code>${{ vars.READ_MY_NAME }}</code> 去取值</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><ol><li><p>github action 提供了一大堆 context，<a href="https://docs.github.com/en/actions/learn-github-actions/contexts#vars-context" target="_blank" rel="noopener noreferrer">參考資料</a> ，不知道為啥網路講到這個資源很少</p></li><li><p>官網教學 CI build image 推到 container registry 使用的是另一個 action，兩個都用過，都可以用。
<a href="https://docs.github.com/en/actions/publishing-packages/publishing-docker-images#publishing-images-to-github-packages" target="_blank" rel="noopener noreferrer">參考 actions</a></p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># This workflow uses actions that are not certified by GitHub.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># They are provided by a third-party and are governed by</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># separate terms of service, privacy policy, and support</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># documentation.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># GitHub recommends pinning actions to a commit SHA.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># To get a newer version, you will need to update the SHA.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># You can also reference a tag or branch, but the action may change without warning.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Publish Docker image</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  release:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    types: [published]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push_to_registries:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    name: Push Docker image to multiple registries</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    permissions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      packages: write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      contents: read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Check out the repo</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Log in to Docker Hub</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ secrets.DOCKER_USERNAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.DOCKER_PASSWORD }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Log in to the Container registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          registry: ghcr.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ github.actor }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.GITHUB_TOKEN }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Extract metadata (tags, labels) for Docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id: meta</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/metadata-action@98669ae865ea3cffbcbaa878cf57c20bbf1c6c38</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          images: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            my-docker-hub-namespace/my-docker-hub-repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            ghcr.io/${{ github.repository }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Build and push Docker images</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/build-push-action@ad44023a93711e3deb337508980b4b5e9bcdc5dc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          context: .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          push: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tags: ${{ steps.meta.outputs.tags }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          labels: ${{ steps.meta.outputs.labels }}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[demo basic  github action]]></title>
        <id>https://suyuying.github.io/blog/2023/03/11/github-action/github-action-demo</id>
        <link href="https://suyuying.github.io/blog/2023/03/11/github-action/github-action-demo"/>
        <updated>2023-03-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[GitHub Action 是 continuous integration and continuous delivery (CI/CD)平台，除了一般的 build test deploy 他另外有給專案管理的各種小功能，例如給 pull request 打標籤。提供免費的 runner 幫你執行任務，也接受self-hosted runner。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="基本介紹">基本介紹<a href="#基本介紹" class="hash-link" aria-label="Direct link to 基本介紹" title="Direct link to 基本介紹">​</a></h2><p>GitHub Action 是 continuous integration and continuous delivery (CI/CD)平台，
除了一般的 build test deploy 他另外有給專案管理的各種小功能，例如給 pull request 打標籤。
提供免費的 runner 幫你執行任務，也接受 self-hosted runner。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="github-actions-基本元素">GitHub Actions 基本元素<a href="#github-actions-基本元素" class="hash-link" aria-label="Direct link to GitHub Actions 基本元素" title="Direct link to GitHub Actions 基本元素">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">Workflow-&gt; Event -&gt; Job-&gt; Steps</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="workflow">Workflow<a href="#workflow" class="hash-link" aria-label="Direct link to Workflow" title="Direct link to Workflow">​</a></h3><p>一個 repository 可以有多個 workflow,每個 workflow 做的事定義在 yml，且規定在.github/workflows 底下，workflow 包含一次要運行的整個過程，可以用手動觸發或者 yml 檔內制定條件觸發。
舉例：可以用一條 workflow 做 build and test,另一個 workflow 做 deploy</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="events">Events<a href="#events" class="hash-link" aria-label="Direct link to Events" title="Direct link to Events">​</a></h3><p>觸發 Workflow 的事件稱為 Events。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="jobs">Jobs<a href="#jobs" class="hash-link" aria-label="Direct link to Jobs" title="Direct link to Jobs">​</a></h3><p>由多個 steps 組成，每個 step 可以是一個 shell script 或者 action，step 會依序在同一個 runner 執行，並可以共享 data，
舉例來說，build 完後的檔案，可以傳給下一個 test step 測試 build 結果。</p><p>一個 workflow 可以有多個 job,job 間彼此預設是平行執行，也可以設定 dependencies 等待另一個 job，
舉例來說，一包 code 裡面要 build 多個檔案，每個 build 過程可以是一個 job 彼此平行，等到都 build 結束，在執行統一到 packaging 工作。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="actions">Actions<a href="#actions" class="hash-link" aria-label="Direct link to Actions" title="Direct link to Actions">​</a></h3><p>動作是執行複雜但經常重複任務， GitHub Action 平台提供自定義應用程序的上傳，簡單說就是把某些會重複出現的 step 做成 module 並使用，因為這格原因，所以也可以引用別人寫好得，或自建得，就像是寫程式用的 package 一樣。</p><p><a href="https://github.com/marketplace?category=chat&amp;type=actions&amp;query=" target="_blank" rel="noopener noreferrer">官方的 action 庫</a></p><p><a href="https://docs.github.com/zh/actions/creating-actions/about-custom-actions" target="_blank" rel="noopener noreferrer">如何建立自己的 github action 的 actions</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="runners">Runners<a href="#runners" class="hash-link" aria-label="Direct link to Runners" title="Direct link to Runners">​</a></h3><p>執行 workflow 的機器。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="demo">Demo<a href="#demo" class="hash-link" aria-label="Direct link to Demo" title="Direct link to Demo">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="demo-github-actions">demo github actions<a href="#demo-github-actions" class="hash-link" aria-label="Direct link to demo github actions" title="Direct link to demo github actions">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">name: learn-github-actions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run-name: ${{ github.actor }} is learning GitHub Actions</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on: [push]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  check-bats-version:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/setup-node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node-version: '14'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - run: npm install -g bats</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - run: bats -v</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>name</code>: All wolkflows 隨便挑一個點進去看到到 workflow 名字，工作流程的名稱 learn-github-actions</p><p><code>run-name</code>: github 點進去 Actions 裡面看到 All wolkflows 眾多的名稱，為工作流程運行時的名稱，${{ github.actor }} 內建變數。</p><p><code>on</code>:此 workflow 的觸發條件，設定 push 是推送或者發 pull request 就會觸發，進階版請洽官網提供的
<a href="https://docs.github.com/zh/actions/using-workflows/workflow-syntax-for-github-actions#onpushpull_requestpull_request_targetpathspaths-ignore" target="_blank" rel="noopener noreferrer">更精細設定</a></p><p><code>jobs</code>:組合多個 work or action，目前有一格作業叫做 check-bats-version 的 work</p><p><code>check-bats-version</code>: 一個名爲 check-bats-version 的作業，子鍵定義作業屬性，可以換成其他符合該 work 工作的名字，命名風格是-相連</p><p><code>runs-on</code>: 使用 github 託管的 runner，作業運行的操作系統，爲 ubuntu-latest。</p><p><code>steps</code>: 定義作業執行步驟，可以包含多個 指令、shell script、action（一堆指令組合的 module）</p><p><code>uses</code>: 運作某客製化 action，action 就是個指令集合</p><ul><li><code>actions/checkout@v3</code>：使用 v3 版本的 <code>actions/checkout</code> Action，從代碼庫中檢出代碼。</li><li><code>actions/setup-node@v3</code>：使用 v3 版本的 <code>actions/setup-node</code> Action，安裝 Node.js 環境。
with: 帶參數到 action 裡面</li></ul><p><code>run</code>: 在 runner 上運行的指令</p><ul><li><code>run: npm install -g bats</code>：運行命令 <code>npm install -g bats</code>，安裝 Bats 測試框架。</li><li><code>run: bats -v</code>：運行命令 <code>bats -v</code>，顯示 Bats 的版本號。</li></ul><p><code>name</code>: 定義該 run 的名字，不定義就只用 Run + 後面執行 run 得指令</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="補充-actions-寫法">補充 actions 寫法<a href="#補充-actions-寫法" class="hash-link" aria-label="Direct link to 補充 actions 寫法" title="Direct link to 補充 actions 寫法">​</a></h3><p>actions/checkout@v3 是 GitHub Action 中一個常用的 action，用於將程式碼倉庫的程式碼檢出到工作區。v3 是這個 action 的版本號。這個 action 的代碼倉庫中，有一個 action.yml 文件，定義了這個 action 的輸入和輸出參數。具體如下：</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">actions/checkout@v3</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Checkout'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Checkout a Git repository'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">inputs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">ref</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'The branch, tag or SHA to checkout'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">repository</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'The name of the repository to checkout'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">repository</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">submodules</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Whether to checkout submodules'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'false'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ssh</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">key</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'SSH key used for fetching the repository. The key should have access to the repository or be able to authenticate for the repository URL.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  persist</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">credentials</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Whether to persist GITHUB_TOKEN and SSH_AUTH_SOCK environment variables when persisting the workspace'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'true'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  fetch</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">depth</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Depth of commits to fetch. Defaults to all commits.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'0'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">lfs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Whether to download Git LFS files'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'false'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">clean</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Whether to run 'git clean' before checkout"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'false'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">workspace</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'Directory to which checkout the repository'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">required</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword module" style="color:#00009f">default</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'.'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">outputs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">path</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">description</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'The path of the checked-out repository'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">value</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> steps</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">checkout</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">outputs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">path</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">runs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">using</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">'composite'</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">steps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Checkout</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">shell</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> bash</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> echo </span><span class="token string" style="color:#e3116c">"Error: No checkout implementation found."</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>這個文件中，定義了這個 action 的輸入參數包括 ref、repository、submodules、ssh-key、persist-credentials、fetch-depth、lfs、clean 和 workspace。
GitHub Action <code>actions/checkout@v3</code> 下面是它的輸入參數定義：</p><span style="background-color:#25c2a0;border-radius:20px;color:#fff;padding:6px;cursor:pointer">actions/checkout@v3 參數篇</span><ul><li><code>ref</code>：要檢出的分支、標籤或提交 ID。</li><li><code>repository</code>：要檢出的儲存庫名稱。</li><li><code>submodules</code>：是否檢出子模組。</li><li><code>ssh-key</code>：用於從儲存庫獲取程式碼的 SSH 金鑰。</li><li><code>persist-credentials</code>：是否在持久化工作區時保存 GITHUB_TOKEN 和 SSH_AUTH_SOCK 環境變數。</li><li><code>fetch-depth</code>：要檢出的提交數量。</li><li><code>lfs</code>：是否下載 Git LFS 文件。</li><li><code>clean</code>：是否在檢出前運行 <code>git clean</code>。</li><li><code>workspace</code>：檢出的儲存庫的目錄。</li></ul><p>其中，ref 是必需的參數，其他參數均為可選參數。</p><p>輸出參數只有一個，即 path，表示程式碼倉庫的路徑。</p><p>最後，這個 action 在運行時，會執行一個名爲 Checkout 的子步驟，該子步驟會調用不同平臺的命令行工具，將程式碼倉庫檢出到指定的工作區。</p><span style="background-color:#1877F2;border-radius:20px;color:#fff;padding:6px;cursor:pointer"> actions/setup-node@v3 參數篇</span><ul><li><code>node-version</code>：要安裝的 Node.js 版本，默認是最新的穩定版。</li><li><code>registry-url</code>：Node.js 的包管理器使用的預設倉庫地址，默認是 npm 的官方地址。</li><li><code>scope</code>：Node.js 的包管理器使用的預設作用域，默認是空。</li><li><code>token</code>：用於訪問私有項目的 GitHub 權杖，默認是空。</li><li><code>always-auth</code>：是否總是使用授權信息訪問項目，默認是 false。</li><li><code>check-latest</code>：是否檢查是否安裝了最新的版本，默認是 false。</li><li><code>debug</code>：是否啓用 Debug 模式，默認是 false。</li></ul><p>總的來說，actions/setup-node@v3 可以方便地安裝 Node.js 環境，並支持許多自定義參數，用戶可以根據自己的需要進行配置。</p><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>在 github action 要帶入參數到 actions 裡面請使用 with</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/setup-node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node-version: '14'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>1.<a href="https://medium.com/starbugs/%E5%AF%A6%E4%BD%9C%E9%96%8B%E6%BA%90%E5%B0%8F%E5%B7%A5%E5%85%B7-%E8%88%87-github-actions-%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%9B%B8%E9%81%87-3dd2d70eeb" target="_blank" rel="noopener noreferrer">實作開源小工具，與 Github Actions 的第一次相遇！</a></p><ol start="2"><li><a href="https://docs.github.com/en/actions/quickstart" target="_blank" rel="noopener noreferrer">github action quick start 官網</a>
:::</li></ol></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[env file management env variable in github action]]></title>
        <id>https://suyuying.github.io/blog/2023/03/11/github-action/github-action-env-file</id>
        <link href="https://suyuying.github.io/blog/2023/03/11/github-action/github-action-env-file"/>
        <updated>2023-03-11T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[因為是使用.env file管理環境變數，所以推到github上一定會排除.env，然後再試CICD時候就想說為啥本地build的image跑起來沒問題，一到CI build出來的image就掛了，試了半天才想到是.evn沒給。這邊會demo如何在github action使用.env資料。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="github-環境變數帶入">github 環境變數帶入<a href="#github-環境變數帶入" class="hash-link" aria-label="Direct link to github 環境變數帶入" title="Direct link to github 環境變數帶入">​</a></h2><h2 class="anchor anchorWithStickyNavbar_LWe7" id="env-傳入方法">.env 傳入方法<a href="#env-傳入方法" class="hash-link" aria-label="Direct link to .env 傳入方法" title="Direct link to .env 傳入方法">​</a></h2><p><a href="https://stackoverflow.com/questions/60176044/how-do-i-use-an-env-file-with-github-actions" target="_blank" rel="noopener noreferrer">參考自這篇 stack overflow</a></p><p>兩種方式，這依據你的.env 裡面到底有多少個變數。但共同點都是在 github worlflow 過程使用 secrets 上下文，例如${{ secrets.XXX }}，去把存放在 github registry 裡面的環境變數，存放到指定位置的.env 檔。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="single-vaiable">single vaiable<a href="#single-vaiable" class="hash-link" aria-label="Direct link to single vaiable" title="Direct link to single vaiable">​</a></h3><p>如果只有一個變數，就把該變數放到 github registry 裡面，取上下文來用就好</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">    - name: 'Create env file'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        touch .env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo API_ENDPOINT="https://xxx.execute-api.us-west-2.amazonaws.com" &gt;&gt; .env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        echo API_KEY=${{ secrets.API_KEY }} &gt;&gt; .env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        cat .env</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="better-method-for-multiple-variables">Better method for multiple variables<a href="#better-method-for-multiple-variables" class="hash-link" aria-label="Direct link to Better method for multiple variables" title="Direct link to Better method for multiple variables">​</a></h3><p>如果有很多個變數在.env 檔，就把.env 檔整份 copy 到 github registry 裡面</p><p>例如：</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">.env</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token constant" style="color:#36acaa">ALGORITHM</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"HS256"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">ACCESS_TOKEN_EXPIRE_MINUTES</span><span class="token operator" style="color:#393A34">=</span><span class="token number" style="color:#36acaa">60</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 對password加鹽的物件</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># sql連線網址</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">SQLALCHEMY_DATABASE_URL</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"sqlite:///./sql_app.db"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">TOKENURL</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">"token"</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token constant" style="color:#36acaa">ARTICLE_CATEGORY</span><span class="token operator" style="color:#393A34">=</span><span class="token string" style="color:#e3116c">'[\"PythonBasic\",\"Fastapi\",\"DataScience\",\"PythonModule\",\"LinuxShellScript\",\"JavaScriptBasic\",\"React\"]'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>就把他整份裡面的值 copy 到 config 裡面就好，假設 key 叫做 ENV_FILE，然後 yml 檔這樣寫</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">     - name: 'Create env file'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          echo "${{ secrets.ENV_FILE }}" &gt; .env</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>他就會把你所有 value 送到.env 檔了。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>記錄一下我遇到的狀況，因為這個真的卡頗久，也試不出來一個方法，所以就先記錄吧，也歡迎提供解答
python dotenv 在.env 檔裡面寫入 list ，要用以下方法表述
ARTICLE_CATEGORY='<!-- -->["PythonBasic","Fastapi","DataScience","PythonModule","LinuxShellScript","JavaScriptBasic","React"]<!-- -->'，配合 <code>json.loads(os.environ.get('ARTICLE_CATEGORY'))</code>去拿資料。</p><p>但是在使用 action 遇到一個問題，<code>echo ${{ secrets.ENV_FILE }} &gt; .env</code> 會輸入空值進去，<code>echo "${{ secrets.ENV_FILE }}" &gt; .env</code> 這樣才會有值，但問題在使用""包住會把 ARTICLE_CATEGORY='<!-- -->["PythonBasic","Fastapi","DataScience","PythonModule","LinuxShellScript","JavaScriptBasic","React"]<!-- -->'轉成
<code>ARTICLE_CATEGORY='[PythonBasic,Fastapi,DataScience,PythonModule,LinuxShellScript,JavaScriptBasic,React]'
</code> 這個格式在讀 json.loads(os.environ.get('ARTICLE_CATEGORY'))就會遇到問題，會報 error 因為這個格式他不行。</p><p>目前在處理 list 部分，都先用<code>ARTICLE_CATEGORY='[\"PythonBasic\",\"Fastapi\",\"DataScience\",\"PythonModule\",\"LinuxShellScript\",\"JavaScriptBasic\",\"React\"]'</code> 送資料。然後用<code>json.loads(os.environ.get('ARTICLE_CATEGORY'))</code>去拿資料</p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
        <category label=".env" term=".env"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[docker create context and docker context command]]></title>
        <id>https://suyuying.github.io/blog/2023/03/10/Docker/docker-create-context</id>
        <link href="https://suyuying.github.io/blog/2023/03/10/Docker/docker-create-context"/>
        <updated>2023-03-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[docker 支援多個不同remote docker deamon管理,`docker create context` 是用來建立一個新的 context，以指向一個 remote Docker daemon，用於管理 Docker 主機和 Docker registry 的機制。]]></summary>
        <content type="html"><![CDATA[<p><code>docker create context</code> 是用來建立一個新的 context，以指向一個 remote Docker daemon，用於管理 Docker 主機和 Docker registry 的機制。</p><p>可以使用 <code>docker context use</code> 指令來切換 context，切換完成後即可使用 docker 指令操作 remote Docker daemon。如果使用雲端 container，例如 azure web container service，就可以用這個指令去管理雲端 container。包含新建 刪除都可以使用，所以不要太開心一次起一大堆雲端 container 這樣會被 charging 到爆。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>如果有用到 docker buildx 可能會把 docker context 跟 docker buildx create --name 搞混，
兩個是不同的，<a href="/blog/2023/03/10/Docker/docker-muiltiplatform copy#docker-buildx-create---name-my-node-%E6%98%AF%E5%BB%BA%E7%AB%8B%E7%AF%80%E9%BB%9E%E5%97%8E%5D">可以看這裡</a></p></div></div><p>以下是 <code>docker create context</code> 指令的教學：</p><p>使用 <code>docker create context</code> 指令可以建立一個新的 context，用來指向一個 remote Docker daemon。以下是指令的詳細說明：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker context create CONTEXT_NAME --docker "host=REMOTE_DOCKER_HOST" --description "CONTEXT_DESCRIPTION"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><code>CONTEXT_NAME</code>: 指定新建立的 context 的名稱。</li><li><code>REMOTE_DOCKER_HOST</code>: 指定 remote Docker daemon 的位置，可以是一個 IP 或是一個 domain name。</li><li><code>CONTEXT_DESCRIPTION</code>: 可以加入對 context 的描述，方便管理。</li></ul><p>例如，以下指令建立一個名為 <code>mycontext</code> 的 context，指向一個 remote Docker daemon，並加入描述：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker context create mycontext --docker "host=myremotehost:2376" --description "My remote Docker daemon"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>建立完成後，可以使用 <code>docker context use</code> 指令來切換 context：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker context use mycontext</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docker" term="docker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[docker manage logs in Docker to prevent service failure caused by excessively large container logs]]></title>
        <id>https://suyuying.github.io/blog/2023/03/10/Docker/docker-management</id>
        <link href="https://suyuying.github.io/blog/2023/03/10/Docker/docker-management"/>
        <updated>2023-03-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[當遇到container log太大 造成服務掛掉的排查方向，以及如何避免。因為 docker 運行過程本身 log 也會佔用硬碟資源，為了不讓這個 log 過度膨脹，可以用以下方式限制]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="volume-of-docker">volume of docker<a href="#volume-of-docker" class="hash-link" aria-label="Direct link to volume of docker" title="Direct link to volume of docker">​</a></h2><p>以前都在弄自己的小專案，只要東西跑得起來就好，沒想過會遇過因為硬碟吃滿導致 container 服務掛掉的問題。</p><p>docker 掛載 volume 會有三種方式，綁定掛載（Bind Mount），命名卷（Named Volume），匿名卷（Anonymous Volume），前兩種在 container 被刪除時不會被刪，會永久保存，docker 內沒被掛載或使用 Anonymous Volume 則都會被刪除。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>docker logs 資料包含哪些？
Docker 會捕捉所有容器的標准輸出（和標准錯誤），並以 JSON 格式將其寫入文件中。 JSON 格式將每行注釋為其源（stdout 或 stderr）和其時間戳。 每個日誌文件僅包含有關一個容器的信息。</p></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="如何減少不必要的硬體佔用">如何減少不必要的硬體佔用<a href="#如何減少不必要的硬體佔用" class="hash-link" aria-label="Direct link to 如何減少不必要的硬體佔用" title="Direct link to 如何減少不必要的硬體佔用">​</a></h3><p>因為 docker 運行過程本身 log 也會佔用硬碟資源，為了不讓這個 log 過度膨脹，可以用以下方式限制</p><ol><li>修改 docker 設定檔</li></ol><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/etc/docker/daemon.json</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">"log-driver"</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"json-file"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token string-property property" style="color:#36acaa">"log-opts"</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token string-property property" style="color:#36acaa">"max-size"</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"500m"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string-property property" style="color:#36acaa">"max-file"</span><span class="token operator" style="color:#393A34">:</span><span class="token string" style="color:#e3116c">"3"</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">systemctl daemon-reload</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">systemctl restart docker</span><br></span><span class="token-line" style="color:#393A34"><span class="token template-string string" style="color:#e3116c"></span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="2"><li>修改 docker-compose.yml</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">services:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  hellow:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    build: .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    container_name: mattermost</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    restart: always</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    logging:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      driver: "json-file"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      options:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          max-size: "100m"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          max-file: "10"</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>並使用以下指令重啟，一般 restart 不會吃新 config</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker-compose -f docker-compose.yml up -d --force-recreate mm</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>下這個指令前務必想好是否重要資訊有用 Bind Mount or Named Volume 掛載出來！</p></div></div><ol start="3"><li>docker 指令</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run -d --log-opt max-size=1g nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://docs.docker.com/config/containers/logging/json-file/" target="_blank" rel="noopener noreferrer">官網 log 管理</a>，管理 docker log 方式很多，預設都適用 json-file，設定可已透過修改/etc/docker/daemon.json 並重啟達成。</p><p>預設是在同一份檔案，無限大小寫入，透過以上方法，可以限定檔案大小跟可產生檔案數量，當 log 容量到達上限時，Docker 程序將停止寫入該日誌文件，並開始使用新名稱啟動新的日誌文件。默認情況下，新日誌文件將具有與舊日誌文件相同的名稱，但會在末尾添加連續號（例如，access.log.1、access.log.2 等）。</p><p>Docker 保留的日誌文件數量由<code>max-file</code>選項決定。默認情況下，Docker 將保留最多 1 個日誌文件(要配置<code>max-size</code>才會生效)。當達到最大日誌文件數量時，Docker 將開始使用新的日誌數據覆蓋最舊的日誌文件。</p><p>（ps:資訊以此<a href="https://docs.docker.com/config/containers/logging/json-file/" target="_blank" rel="noopener noreferrer">連結</a>為準，設定可能會改變的）</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="what-should-do-when-you-find--or-var-are-full">what should do when you find / or /var are full<a href="#what-should-do-when-you-find--or-var-are-full" class="hash-link" aria-label="Direct link to what should do when you find / or /var are full" title="Direct link to what should do when you find / or /var are full">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>預設 docker 的東西都放在/var/lib/docker 底下</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/var/lib/docker</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">builder  buildkit  containers  image  network  overlay2  plugins  runtimes  swarm  tmp  trust  volumes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以在該資料夾底下用<code>du -sh ./*</code>確認哪個地方吃得異常兇，
並用<code>docker system df</code>看資料佔用，如果不用的 image 很多可以清除</p><p><code>docker image prune --all</code></p><p>他會刪除所有沒有被 container 使用的 image，警示如下：</p><p>WARNING! This will remove all images without at least one container associated to them.</p></div></div><ol><li>如果當初沒有做任何預防，導致/var 真的爆了，可以優先檢查以下幾項</li></ol><h3 class="anchor anchorWithStickyNavbar_LWe7" id="檢查-docker-logs-是否佔太兇">檢查 docker logs 是否佔太兇<a href="#檢查-docker-logs-是否佔太兇" class="hash-link" aria-label="Direct link to 檢查 docker logs 是否佔太兇" title="Direct link to 檢查 docker logs 是否佔太兇">​</a></h3><p>其實就是去/var/lib/docker/containers，執行<code>du -sh ./* </code>看哪個 container 佔最多資源，然後去看裡面那隻放 docker logs 的檔名為 container-id-json.log 的檔案是否長太大，確認後可以砍掉。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="檢查-named-volume-中存放資訊">檢查 named volume 中存放資訊<a href="#檢查-named-volume-中存放資訊" class="hash-link" aria-label="Direct link to 檢查 named volume 中存放資訊" title="Direct link to 檢查 named volume 中存放資訊">​</a></h3><p>其實就是去/var/lib/docker/volumes 底下，看有沒有某個 volume 佔太多資源，然後裡面放的東西可能不重要(例如 nginx log)</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="檢查-image-跟沒用的-container">檢查 image 跟沒用的 container<a href="#檢查-image-跟沒用的-container" class="hash-link" aria-label="Direct link to 檢查 image 跟沒用的 container" title="Direct link to 檢查 image 跟沒用的 container">​</a></h3><p>image 指令:刪除沒有被活動的 container 使用的 image
<code>docker image prune --all</code></p><p>container 指令：刪除停止的 container
<code>docker container prune</code></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><a href="https://docs.docker.com/config/pruning/" target="_blank" rel="noopener noreferrer">Prune unused Docker objects</a>
<a href="https://blog.csdn.net/fishinhouse/article/details/105310948" target="_blank" rel="noopener noreferrer">限制 Docker 日志大小</a></p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docker" term="docker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[docker multiplatform build - docker buildx指令]]></title>
        <id>https://suyuying.github.io/blog/2023/03/10/Docker/docker-muiltiplatform</id>
        <link href="https://suyuying.github.io/blog/2023/03/10/Docker/docker-muiltiplatform"/>
        <updated>2023-03-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[docker 支援多平台image的build指令,Docker Buildx 是 Docker 官方提供的一個命令行工具，用於通過 Dockerfile 构建 Docker 映像。它的主要特點是可以跨平臺構建 Docker 映像，並支持多種 CPU 架構（如 x86、ARM、IBM Power 等），是一個用來建立和管理 multi-arch Docker image 的工具。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="基本介紹">基本介紹<a href="#基本介紹" class="hash-link" aria-label="Direct link to 基本介紹" title="Direct link to 基本介紹">​</a></h2><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>如果不支援多平台，就會出現在 arm build，然後在 amd deploy 失敗，上網查不到原因的問題。</p></div></div><p>Docker Buildx 是 Docker 官方提供的一個命令行工具，用於通過 Dockerfile 构建 Docker 映像。它的主要特點是可以跨平臺構建 Docker 映像，並支持多種 CPU 架構（如 x86、ARM、IBM Power 等），是一個用來建立和管理 multi-arch Docker image 的工具。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>docker buildx 的單位是 node，跟 docker context 不同，前者是建立影像的主機，可以使用多個節點來加速 Docker 映像的建立過程，後者則是用來管理 Docker 主機和 Docker registry 的機制，定義了一個或多個 Docker 主機和 Docker registry 的設定。</p></div></div><p>以下是使用 Docker Buildx 構建 Docker 映像的基本步驟：</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="1-啟用-multi-arch-支援">1. 啟用 multi-arch 支援<a href="#1-啟用-multi-arch-支援" class="hash-link" aria-label="Direct link to 1. 啟用 multi-arch 支援" title="Direct link to 1. 啟用 multi-arch 支援">​</a></h2><p>要使用 <code>docker buildx</code> 建立 multi-arch Docker image，必須先啟用 multi-arch 支援(Docker Desktop 預配置了 binfmt_misc 對其他平台的支持，可以忽略此指令)。可以使用以下指令啟用 multi-arch 支援：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker run --rm --privileged multiarch/qemu-user-static --reset -p yes</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="2-建立-buildernode">2. 建立 builder(node)<a href="#2-建立-buildernode" class="hash-link" aria-label="Direct link to 2. 建立 builder(node)" title="Direct link to 2. 建立 builder(node)">​</a></h2><p>要使用 <code>docker buildx</code> 建立 multi-arch Docker image，必須先建立一個 builder。使用以下指令建立 builder：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx create --name mybuilder</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="3-設定-builder">3. 設定 builder<a href="#3-設定-builder" class="hash-link" aria-label="Direct link to 3. 設定 builder" title="Direct link to 3. 設定 builder">​</a></h2><p>建立 builder 後，必須將 builder 設定為目前使用的 builder。使用以下指令設定 builder：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx use mybuilder</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="4-建立-dockerfile">4. 建立 Dockerfile<a href="#4-建立-dockerfile" class="hash-link" aria-label="Direct link to 4. 建立 Dockerfile" title="Direct link to 4. 建立 Dockerfile">​</a></h2><p>接下來，建立一個 Dockerfile，並在其中指定要建立的 Docker image。例如，在 Dockerfile 中可以指定要建立的 image 為 <code>ubuntu:latest</code>，並在其中安裝一些軟體套件：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM --platform=$TARGETPLATFORM ubuntu:latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN apt-get update &amp;&amp; \\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-get install -y software-properties-common &amp;&amp; \\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    add-apt-repository -y ppa:nginx/stable &amp;&amp; \\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-get update &amp;&amp; \\</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    apt-get install -y nginx</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="5-建立-multi-arch-docker-image">5. 建立 multi-arch Docker image<a href="#5-建立-multi-arch-docker-image" class="hash-link" aria-label="Direct link to 5. 建立 multi-arch Docker image" title="Direct link to 5. 建立 multi-arch Docker image">​</a></h2><p>建立 Dockerfile 後，可以使用以下指令建立 multi-arch Docker image：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx build --platform linux/arm/v7 -t myimage:latest --load .</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>在上面的命令中，<code>--platform</code> 參數指定了要構建的 CPU 架構，<code>-t</code> 參數指定了映像的標籤，<code>.</code> 表示當前目錄是 Dockerfile 所在的目錄。</p><p>--load 相當於<code>--output=type=docker</code> 沒有指定會出現 warning</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">WARN[0000] No output specified for docker-container driver. Build result will only remain in the build cache. To push result image into registry use --push or to load image into docker use --load</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>--push 遠端 registry 相當於<code>--output=type=registry</code></p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><a href="https://github.com/docker/buildx/issues/59" target="_blank" rel="noopener noreferrer">https://github.com/docker/buildx/issues/59</a>
2023/3/9 使用--platform 配合--load，不能支援多平台，一次一個平台，否則會報錯
--push 支援一次多平台 image</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">error: docker exporter does not currently support exporting manifest lists</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div><p>建立完成後，可以使用以下指令查看建立的 Docker image：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker images myimage</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>推送 Docker 映像：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">$ docker push myimage:latest</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>以上就是使用 Docker Buildx 構建 Docker 映像的基本步驟。使用 Docker Buildx 可以讓我們更方便地構建跨平臺的 Docker 映像，提高了開發效率。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><code>docker buildx rm docker-test</code> 刪除</p><p><code>docker buildx use docker-test</code>切換</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="docker-buildx-create---name-my-node-是建立節點嗎">docker buildx create --name my-node 是建立節點嗎？<a href="#docker-buildx-create---name-my-node-是建立節點嗎" class="hash-link" aria-label="Direct link to docker buildx create --name my-node 是建立節點嗎？" title="Direct link to docker buildx create --name my-node 是建立節點嗎？">​</a></h2><p>是的，<code>docker buildx create --name my-node</code> 指令會建立一個名為 <code>my-node</code> 的節點。節點是用來建立 Docker 映像的主機，可以使用多個節點來加速 Docker 映像的建立過程，或者建立不同平台的 Docker 映像。</p><p>建立節點時，可以使用 <code>--driver</code> 選項指定節點的驅動程式，例如 <code>docker-container</code> 或 <code>docker</code>。驅動程式還可以是其他第三方平台，例如 AWS、Azure 或 Google Cloud。</p><p>在建立節點時，可以指定節點的名稱、驅動程式、驅動程式選項、Docker 映像等資訊。例如，以下是建立一個名為 <code>my-node</code> 的節點，使用 Docker 容器作為驅動程式，使用 <code>moby/buildkit:v0.8.1</code> 作為 Docker 映像的示範指令：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx create --name my-node --driver docker-container --driver-opt image=moby/buildkit:v0.8.1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>建立節點後，可以使用 <code>docker buildx ls</code> 指令列出所有節點。建立 Docker 映像時，可以使用 <code>--builder</code> 選項指定要使用的節點。例如：</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx build --builder my-node --platform linux/amd64 -t myimage:latest .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>可以使用名為 my-node 的節點建立 Docker 映像，並指定要建立的平台為 linux/amd64。</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docker" term="docker"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[learn github action from github docs]]></title>
        <id>https://suyuying.github.io/blog/2023/03/10/github-action/githubaction-learing</id>
        <link href="https://suyuying.github.io/blog/2023/03/10/github-action/githubaction-learing"/>
        <updated>2023-03-10T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[github action在設計上提供許多表示式，跟內建函示，上下文，這邊將整理官網教學知識，以及使用心得。]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="前言">前言<a href="#前言" class="hash-link" aria-label="Direct link to 前言" title="Direct link to 前言">​</a></h2><p>一開始是跳著學，直接 google 怎麼用 github action 做到 CI 建立 image 並推到 github container，不過這關過完後，在 deploy 到 azure web container 就卡關了，這邊貼卡關的<a href="https://docs.github.com/en/actions/deployment/deploying-to-your-cloud-provider/deploying-to-azure/deploying-docker-to-azure-app-service" target="_blank" rel="noopener noreferrer">部分</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">  deploy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    needs: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: 'production'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      url: ${{ steps.deploy-to-webapp.outputs.webapp-url }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Lowercase the repo name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "REPO=${GITHUB_REPOSITORY,,}" &gt;&gt;${GITHUB_ENV}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Deploy to Azure Web App</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id: deploy-to-webapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: azure/webapps-deploy@0b651ed7546ecfc75024011f76944cb9b381ef1e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          app-name: ${{ env.AZURE_WEBAPP_NAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          images: 'ghcr.io/${{ env.REPO }}:${{ github.sha }}'</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>如果沒看過官網教學，看到<code>${{ steps.deploy-to-webapp.outputs.webapp-url }}</code> <code>${{ env.AZURE_WEBAPP_NAME }}</code> <code>${{ github.sha }}</code> <code>${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}</code>
這些東西自然會傻住，然後回去 google，會發現官網給了一大堆 context 介紹，簡言之，還是腳踏實地來
<a href="https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions" target="_blank" rel="noopener noreferrer">Understanding GitHub Actions</a>吧！</p><p>下面資訊再回來看，<code>${{ steps.deploy-to-webapp.outputs.webapp-url }}</code> 這段意思會 refer 到 id: deploy-to-webapp 的這個 step，至於 webapp-url 是啥？這是 action 的 azure/webapps-deploy 的 output。
至於 output 跟 input 是啥，這會留到之後了解 actions 時在來了解～
${GITHUB_REPOSITORY} 是內建變數，${{ github.sha }}是 github 上下文的內建變數，${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}使用設定在 configuration 的值，使用的是 sercrets 上下文。</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary> Create and publish a Docker image to github container registry and deploy to azure web container</summary><div><div class="collapsibleContent_i85q"><a href="https://docs.github.com/en/actions/deployment/deploying-to-your-cloud-provider/deploying-to-azure/deploying-docker-to-azure-app-service" target="_blank" rel="noopener noreferrer">github : Deploying Docker to Azure App Service</a><div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Create and publish a Docker image to github container registry and deploy to azure web container</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  AZURE_WEBAPP_NAME: ford-amd   # set this to your application's name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  push:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    branches: ['main']</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">permissions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  contents: 'read'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  packages: 'write'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    permissions:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      contents: read</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      packages: write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Checkout repository</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: 'Create env file'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          touch sql_app/.env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          echo "${{ secrets.ENV_FILE }}" &gt; sql_app/.env</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Set up QEMU</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/setup-qemu-action@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Set up Docker Buildx</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/setup-buildx-action@v2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Log in to the Container registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          registry: ghcr.io</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          username: ${{ github.actor }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          password: ${{ secrets.GITHUB_TOKEN }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Lowercase the repo name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "REPO=${GITHUB_REPOSITORY,,}" &gt;&gt;${GITHUB_ENV}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Build and push container image to registry</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: docker/build-push-action@v4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          push: true</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          context: .</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          platforms: linux/amd64,linux/arm64</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          tags: ghcr.io/${{ env.REPO }}:${{ github.sha }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          file: ./Dockerfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  deploy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    needs: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    environment:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      name: prod</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      url: ${{ steps.deploy-to-webapp.outputs.webapp-url }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Lowercase the repo name</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "REPO=${GITHUB_REPOSITORY,,}" &gt;&gt;${GITHUB_ENV}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Deploy to Azure Web App</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id: deploy-to-webapp</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        uses: azure/webapps-deploy@0b651ed7546ecfc75024011f76944cb9b381ef1e</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          app-name: ${{ env.AZURE_WEBAPP_NAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          images: 'ghcr.io/${{ env.REPO }}:${{ github.sha }}'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details><h2 class="anchor anchorWithStickyNavbar_LWe7" id="基本功">基本功<a href="#基本功" class="hash-link" aria-label="Direct link to 基本功" title="Direct link to 基本功">​</a></h2><p><a href="/blog/2023/03/10/github-action/1.github-action-demo">回顧一下 github action basic demo</a>，github action 是由 git 根目錄同層的
.github/workflows 中的 xxxx.yml 組成，workflow 的結構通常是</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Event 觸發 -&gt; Job -&gt; steps</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>Event: 描述觸發該 pipline 條件</p><p>Job: 定義 runner, 環境變數後，在這個條件下執行多個 step ，舉例： 編譯檔案 可以當一個 job，單元測試也可以當一個 job。 要注意的是，job 間是平行執行，所以要在單元測試過關在執行編譯的話，要額外寫 depends。job 間可以透過 artifacts 把 job 產出檔案，傳給別的 job 用。</p><p>steps: 定義多個指令，也可以使用別人提供的套件 actions，也可以是某隻 shell script</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="expressions">Expressions<a href="#expressions" class="hash-link" aria-label="Direct link to Expressions" title="Direct link to Expressions">​</a></h3><p>如果你有一個 job 要執行，但想設定執行前提是某個環境參數 為 true，要怎麼執行？
這邊有幾個觀念</p><ol><li>環境參數:</li></ol><p>在 github action 所有系統內建變數，環境變數，加密的變數，設定在 configuration 的變數這些東西都被當作<span style="background-color:blue;border-radius:20px;color:#fff;padding:6px;cursor:pointer">Contexts</span> 管理。</p><ol start="2"><li>表達式</li></ol><p>結構都長這樣<code>${{ &lt;expression&gt; }}</code>,</p><p>支援的數據類型 <code>boolen</code> <code>null</code> <code>number</code> <code>string</code>，寫法如下</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myNull: ${{ null }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myBoolean: ${{ false }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myIntegerNumber: ${{ 711 }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myFloatNumber: ${{ -9.2 }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myHexNumber: ${{ 0xff }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myExponentialNumber: ${{ -2.99e-2 }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myString: Mona the Octocat</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">myStringInBraces: ${{ 'It''s open source!' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>運算子如下</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">( ) Logical grouping</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">[ ] Index</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">. Property de-reference</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">! Not</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt; Less than</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;= Less than or equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;     Greater than</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; = Greater than or equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; == Equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; != Not equal</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; &amp;&amp; And</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; || Or</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>if 判斷寫法</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">prod-check:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if: ${{ github.ref == 'refs/heads/main' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>此外 github action 也提供很多內建 function，例如：</p><p><code>contains( search, item )</code> ，如果 search 含有 item，這個函數將返回 true。如果 search 是數組中。如果 item 是一個 search 的元素，這個函數將返回 true，如果項目是搜索的子字符串。這個函數不區分大小寫。它將值轉換為字符串進行比較。</p><p>contains('Hello world', 'llo') returns true.</p><p>contains(github.event.issue.labels.<!-- -->*<!-- -->.name, 'bug') returns true if the issue related to the event has a label "bug".</p><p>還有很多內建方法，可以<a href="https://docs.github.com/en/actions/learn-github-actions/expressions" target="_blank" rel="noopener noreferrer">參考官網</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="contexts">Contexts<a href="#contexts" class="hash-link" aria-label="Direct link to Contexts" title="Direct link to Contexts">​</a></h3><p>你運行的 workflow 中的資訊，可以透過 Contexts 取的，每個 Context 都是一個物件，它帶有的屬性可以是 strings 或 物件。</p><p>要使用 contexts 需要按照這個格式<code>${{ &lt;context&gt; }}</code></p><p>Context 種類超多，這邊會大致講他的作用</p><p><code>github</code>- 當前 workflow 的 branch,觸發模式，repo 名字，owner 名字等等。</p><p><code>env</code> - 在 workflow or job or steps 裡面設定得環境變數</p><p><code>vars</code> - 在 repo 或 組織 或 environment 階段，設定在 Variable 的 key value(就是 setting 的 variable 相關東西)</p><p><code>job</code> - 跟現在正在 run 的 job 有關事項，例如現在跑的 runner 的 id,跑成功或失敗。</p><p><code>jobs</code> - 僅在可重用工作流中可用，並且只能用於設置可重用工作流的輸出。</p><p><code>steps</code> - 定義 steps 階段輸出的成品，以及此 steps 運作結果（成功 失敗 取消 跳過）</p><p><code>runner</code> - Information about the runner that is running the current job</p><p><code>sercets</code> - 在 repo 或 組織 或 environment 階段設定在 secrect 的 key value</p><p><code>strategy</code> - 策略，主要用於在 matrix 矩陣情況環境下的 job 狀態描述</p><p><code>matrix</code> - 矩陣輸入，如果你的 job 裡面的測試系統要測試你的 code 在 mac 跟 windows 執行都沒問題，爾且也要確保在 node 14 跟 node16 運行都正常。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Test matrix</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on: push</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ${{ matrix.os }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    strategy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      matrix:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        os: [ubuntu-latest, windows-latest]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        node: [14, 16]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/setup-node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node-version: ${{ matrix.node }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Install dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: npm ci</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Run tests</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: npm test</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><code>needs</code>- 當前作業的依賴項，要用 id 指定</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>needs demo</summary><div><div class="collapsibleContent_i85q"><div><div>This is the detailed content</div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: Build and deploy</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on: push</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  build:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    outputs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      build_id: ${{ steps.build_step.outputs.build_id }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: Build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        id: build_step</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          ./build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          echo "build_id=$BUILD_ID" &gt;&gt; $GITHUB_OUTPUT</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  deploy:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    needs: build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - run: ./deploy --build ${{ needs.build.outputs.build_id }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  debug:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    needs: [build, deploy]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    if: ${{ failure() }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - uses: actions/checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - run: ./debug</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details><p><code>inputs</code>- 看不懂，之後有用到再補</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="variables">Variables<a href="#variables" class="hash-link" aria-label="Direct link to Variables" title="Direct link to Variables">​</a></h3><p>基本上是 Contexts 的延伸，變量以是否跨 workflow 做區分。</p><ol><li>沒有跨 workflow 的 Variable 定義方法，在 workflow,job,step 定義 key value</li></ol><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>demo</summary><div><div class="collapsibleContent_i85q"><div><div>This is the detailed content</div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  DAY_OF_WEEK: Monday</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  greeting_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    steps:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      - name: "Say Hello Mona it's Monday"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        if: ${{ env.DAY_OF_WEEK == 'Monday' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "$Greeting $First_Name. Today is $DAY_OF_WEEK!"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          First_Name: Mona</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details><p>run: env：您可以通過在步驟中使用然後檢查步驟的輸出來列出可用於工作流步驟的整組環境變量。</p><ol start="2"><li>跨 workflow 的 variable 定義方法</li></ol><p>在上下文中自動可用 vars，使用方式${{ vars.ＸＸＸＸ }}，有多種定義方式
存儲庫、環境創建配置變量、組織創建配置變量</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>demo</summary><div><div class="collapsibleContent_i85q"><div><div>This is the detailed content</div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">on:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">workflow_dispatch:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Setting an environment variable with the value of a configuration variable</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env_var: ${{ vars.ENV_CONTEXT_VAR }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">display-variables:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: ${{ vars.JOB_NAME }} # You can use configuration variables with the `vars` context for dynamic jobs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if: ${{ vars.USE_VARIABLES == 'true' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runs-on: ${{ vars.RUNNER }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">environment: ${{ vars.ENVIRONMENT_STAGE }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">steps: - name: Use variables</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">run: |</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "repository variable : ${{ vars.REPOSITORY_VAR }}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "organization variable : ${{ vars.ORGANIZATION_VAR }}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "overridden variable : ${{ vars.OVERRIDE_VAR }}"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">echo "variable from shell environment : $env_var"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    - name: ${{ vars.HELLO_WORLD_STEP }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      if: ${{ vars.HELLO_WORLD_ENABLED == 'true' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      uses: actions/hello-world-javascript-action@main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      with:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        who-to-greet: ${{ vars.GREET_NAME }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div></div></details><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>在 github action 使用變量時，要考慮這個變量執行時是否在 runner 內執行！</p><p>在 runner 內執行預設是可以用$Greeting(linux) or $env:NAME(windows)去取得變量，</p><p>在 runner 外執行的例子，要使用<code>${{ env.DAY_OF_WEEK == 'Monday' }}</code>這樣的表達式，使用情境例如要先判斷 workflow 環境變量，再決定是否跑這個 step 的過程。
範例：</p><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>demo</summary><div><div class="collapsibleContent_i85q"><div><br><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">DAY_OF_WEEK: Monday</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">greeting_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">runs-on: ubuntu-latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Greeting: Hello</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">steps: - name: "Say Hello Mona it's Monday"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">if: ${{ env.DAY_OF_WEEK == 'Monday' }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        run: echo "$Greeting $First_Name. Today is $DAY_OF_WEEK!"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">env:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">First_Name: Mona</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>  </div></div></div></details></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="default-environment-variables">Default environment variables<a href="#default-environment-variables" class="hash-link" aria-label="Direct link to Default environment variables" title="Direct link to Default environment variables">​</a></h3><p>The default environment variables that GitHub sets are available to every step in a workflow.
<a href="https://docs.github.com/en/actions/learn-github-actions/variables#default-environment-variables" target="_blank" rel="noopener noreferrer">內建環境變量</a></p><p>因為很多，所以挑幾個記錄一下</p><ol><li><p>GITHUB_SHA - The commit SHA that triggered the workflow.</p></li><li><p>RUNNER_ARCH - 底層架構，The architecture of the runner executing the job. Possible values are X86, X64, ARM, or ARM64.</p></li><li><p>GITHUB_REPOSITORY_OWNER - The repository owner's name. For example, octocat.</p></li><li><p>GITHUB_REF_TYPE- The type of ref that triggered the workflow run. Valid values are branch or tag.</p></li><li><p>GITHUB_REF- The fully-formed ref of the branch or tag that triggered the workflow run.</p></li><li><p>GITHUB_JOB - The job_id of the current job. For example, greeting_job.
以下 job_id 分別為 My first job 、My second job</p></li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">jobs:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my_first_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: My first job</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">my_second_job:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">name: My second job</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol start="7"><li><p>GITHUB_EVENT_NAME- The name of the event that triggered the workflow. For example, workflow_dispatch.</p></li><li><p>GITHUB_ACTOR - The name of the person or app that initiated the workflow. For example, octocat.</p></li><li><p>GITHUB_ACTION_REPOSITORY - For a step executing an action, this is the owner and repository name of the action. For example, actions/checkout.</p></li><li><p>GITHUB_ACTION - 當前運行的操作的名稱，或 id 步驟的名稱,id 是 A unique identifier for the step. You can use the id to reference the step in contexts.</p></li><li><p>GITHUB_REPOSITORY - The owner and repository name. For example, octocat/Hello-World.</p></li></ol><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p><a href="https://docs.github.com/en/actions/learn-github-actions/contexts#matrix-context" target="_blank" rel="noopener noreferrer">參考的管網資料-contexts</a>
<a href="https://docs.github.com/en/actions/learn-github-actions/expressions" target="_blank" rel="noopener noreferrer">參考的管網資料-expression</a></p><p><a href="https://docs.github.com/en/actions/learn-github-actions/variables" target="_blank" rel="noopener noreferrer">參考的管網資料-variables</a></p></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="github action" term="github action"/>
        <category label="CICD" term="CICD"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[linux command(sed grep awk)]]></title>
        <id>https://suyuying.github.io/blog/2023/03/08/linux-server/linux-command-repratice</id>
        <link href="https://suyuying.github.io/blog/2023/03/08/linux-server/linux-command-repratice"/>
        <updated>2023-03-08T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[從有關鍵字為 QOO 那一行到以}為開頭的那一行(^代表正則開頭字元),sed -n "/QOO/,/^}/p" common.js.]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="sed">sed<a href="#sed" class="hash-link" aria-label="Direct link to sed" title="Direct link to sed">​</a></h2><p>一般打印
印 5~7 行 其他行數 silence</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">cat -n xxxx.md | sed -n '5,7p'</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>印出指定字樣範圍
從有關鍵字為 QOO 那一行到以}為開頭的那一行(^代表正則開頭字元)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">sed -n "/QOO/,/^}/p" common.js</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="grep">grep<a href="#grep" class="hash-link" aria-label="Direct link to grep" title="Direct link to grep">​</a></h2><p>sort 排列
uniq 去掉重複，要計數可以用 uniq -c</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">grep -r "bin" * | grep -Eo "code\":[0-9]{0,}" |sort | uniq</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="awk">awk<a href="#awk" class="hash-link" aria-label="Direct link to awk" title="Direct link to awk">​</a></h2>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="linux" term="linux"/>
        <category label="sed" term="sed"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[DNS Poisoning vs Domain Hijacking,Brief summary]]></title>
        <id>https://suyuying.github.io/blog/2023/03/07/linux-server/dns-pollution-hijack</id>
        <link href="https://suyuying.github.io/blog/2023/03/07/linux-server/dns-pollution-hijack"/>
        <updated>2023-03-07T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[record what is Domain Hijacking and DNS Poisoning, and the difference between them,小結：劫持是官方被駭或故意改的（大陸常發生），污染是路由到dns server過程某台路由器被駭。]]></summary>
        <content type="html"><![CDATA[<ol><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex max-h-[24px] w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">1</span>劫持：dns server 管理端或者你的域名解析商把你的 url 對應 ip 換成其他 ip 或 url</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">2</span>污染：dns serer 的某個節點catch 被駭然後改掉，把這個 url 換成其他 ip 或 url</li></ol><p>小結：劫持是官方被駭或故意改的（大陸常發生），污染是路由到dns server過程某台路由器被駭。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資料:</p><ol><li><a href="https://heimdalsecurity.com/blog/domain-hijacking-vs-dns-poisoning-do-you-know-the-difference/#:~:text=1.,and%20changes%20its%20DNS%20settings." target="_blank" rel="noopener noreferrer">Domain Hijacking vs DNS Poisoning: Do You Know the Difference</a></li><li><a href="https://www.williamlong.info/archives/3356.html" target="_blank" rel="noopener noreferrer">DNS 劫持和 DNS 污染的区别</a></li></ol></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="dns" term="dns"/>
        <category label="Domain Hijacking" term="Domain Hijacking"/>
        <category label="DNS Poisoning" term="DNS Poisoning"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Azure cloud container service Introduction and demo]]></title>
        <id>https://suyuying.github.io/blog/2023/03/06/Azure/azure-cloud-container</id>
        <link href="https://suyuying.github.io/blog/2023/03/06/Azure/azure-cloud-container"/>
        <updated>2023-03-06T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[介紹azure雲端container資源時，並分析如何選擇服務，最後提供自己使用上遇到的問題及解法]]></summary>
        <content type="html"><![CDATA[<div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>如果提供的資訊有錯，請用 comment 系統告知～</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="basic-demand">Basic demand<a href="#basic-demand" class="hash-link" aria-label="Direct link to Basic demand" title="Direct link to Basic demand">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>需求： 1.免費的 server 跟 db，單純掛流量很小，沒有運算密集跟吃記憶體的程式。 2.使用 CICD 配合 container 部署 簡化布版流程</p></div></div><p>server 部分免費滿多的，但都 12 個月試用居多，最後就先挑了 azure，之後會補上 gcp 、 AWS。</p><p>ps: <a href="https://render.com/" target="_blank" rel="noopener noreferrer">render</a> 後來同事推薦，這個是免費的，之後補 CICD 部署到這裡的方法！</p><p>db 基本上就沒有了，免費的有 heroku clear db 不過他只有 5MB 可以用...... 所以目前還是乖乖用 squlite 吧</p><p>資料收集:</p><p>1.三家知名的雲服務廠商都有提供免費額度，這邊提供 azure 方面資訊
<a href="https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree" target="_blank" rel="noopener noreferrer">https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree</a></p><p>2.因為目的只是要單獨要做 api server，所以在 web app, VM,container-based app 之間做選擇。
因為無其他用途，所以不考慮 VM，而又要用到 container 所以最後挑 Deploy and run a container-based app 裡面
提供的三種服務 Azure Kubernetes Service(AKS)、Azure Container Instances(ACI)、Azure Container Apps
再做選擇。</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/azure-quick-start-e82cb82b227ff159f96c5f11c0d3e660.png" alt="azure-quick-start.png" class="img_CujE"></div><p>Azure 官網也有提供一個<a href="https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree" target="_blank" rel="noopener noreferrer">判斷樹</a></p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/compute-choices-c86c9b2e0c2dd50fc83964f23d8a3901.png" alt="azure-quick-start.png" class="img_CujE"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="azure-container-service">Azure container service<a href="#azure-container-service" class="hash-link" aria-label="Direct link to Azure container service" title="Direct link to Azure container service">​</a></h2><p>基本上 Azure 雲服務，跟 container 有關的就是 Azure Container Instances,Azure Kubernetes Service,
Azure Container Apps</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-kubernetes-serviceaks">Azure Kubernetes Service(AKS)<a href="#azure-kubernetes-serviceaks" class="hash-link" aria-label="Direct link to Azure Kubernetes Service(AKS)" title="Direct link to Azure Kubernetes Service(AKS)">​</a></h3><p>AKS 基本上就是跟 azure 租多台 VM(看你的 node 樹），然後使用 mastet node 管理 node cluster，做到提高 HA，也達到提高機器效能使用率</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>以小型的後端程式為例，整套需要 mysql,redis,api 服務，後台統計服務 為背景</p></div></div><h4 class="anchor anchorWithStickyNavbar_LWe7" id="k8s-元件說明">K8s 元件說明<a href="#k8s-元件說明" class="hash-link" aria-label="Direct link to K8s 元件說明" title="Direct link to K8s 元件說明">​</a></h4><p>Container、Pod、Node。</p><p>what is container?
通常一個功能一個 container（當然你要全硬塞同個也可以，不過不建議），如果你不用 cloud db，那麼以上面 info 的背景情況，會有 4 個 container。</p><p>What is pod in Kubernetes?
是 k8s 最小執行單位，舉例來說，你的整套服務共四個 container 下來算是一個 pod。</p><p>what is node in Kubernetes? 一個 node 代表一台 VM
由 Worker Node 跟 Control Plane 組成。
Worker Node(部署 pod 的 vm，內部還可細分為 kubelet、kube-proxy 及 Container Runtime 3 個元件。)
Control Plane 負責各個 Worker Node 的管理</p><p>what is Kubernetes cluster?
因為高可用性跟擴展會有多個 node，所以就有了 cluster。
由 control panels 跟 nodes 組成。</p><p>Azure k8s?
直接幫你做好免費的控制平面了。但是要付 VM 的錢，透過 control plane 管理 k8s cluster。
control plane 不用付錢，但會吃 node 的資源。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-container-instancesaci">Azure Container Instances(ACI)<a href="#azure-container-instancesaci" class="hash-link" aria-label="Direct link to Azure Container Instances(ACI)" title="Direct link to Azure Container Instances(ACI)">​</a></h3><p>ACI 就是個雲端 container，拿來執行爬蟲之類的程式，他不支援擴展，附載平衡及憑證驗證。
基本上創完，Azure 會給你一組的連入 ip</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="azure-container-apps">Azure Container Apps<a href="#azure-container-apps" class="hash-link" aria-label="Direct link to Azure Container Apps" title="Direct link to Azure Container Apps">​</a></h3><p>相較於 ACI，提供了 AutoScale,Https 入口，憑證代管，多 container 內部網路溝通等，
<a href="https://learn.microsoft.com/en-us/azure/container-apps/overview" target="_blank" rel="noopener noreferrer">詳細功用連結</a></p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="mychoice">MyChoice<a href="#mychoice" class="hash-link" aria-label="Direct link to MyChoice" title="Direct link to MyChoice">​</a></h3><p>基本上，只有一個不需要效能的服務，AKS 可以直接砍掉。因為是 api server，且傳的資訊有些需要保密資訊，所以選用
Azure Container Apps。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="deployment">Deployment<a href="#deployment" class="hash-link" aria-label="Direct link to Deployment" title="Direct link to Deployment">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="教學網站">教學網站<a href="#教學網站" class="hash-link" aria-label="Direct link to 教學網站" title="Direct link to 教學網站">​</a></h3><p><a href="https://learn.microsoft.com/en-us/azure/app-service/quickstart-custom-container?pivots=container-linux-vscode&amp;WT.mc_id=UI-AQC&amp;tabs=dotnet" target="_blank" rel="noopener noreferrer">官網教學</a></p><p>執行的過程都是依據教學，但之後換自己的 Dockerfile 有遇到狀況，所以記錄一下遇到的問題。</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="遇到的問題">遇到的問題<a href="#遇到的問題" class="hash-link" aria-label="Direct link to 遇到的問題" title="Direct link to 遇到的問題">​</a></h3><ol><li>Container xxx didn't respond to HTTP pings on port: 8000, failing site start. See container logs for debugging.</li></ol><p>網上查可能原因：</p><ol><li>Use the EXPOSE instruction in your Dockerfile to expose port 3000.(not useful, azure will scan internally)</li><li>Use the WEBSITES_PORT app setting with a value of "3000" to expose that port.</li></ol><p>以上都不行ＱＡＱ</p><p>最後發現是機器的 CPU 架構問題，因為是 m1 底下寫的 code，docker 會用 arm build 版，但一 🥚 部署環境是 azure 的 x86，底層不同服務起不來</p><p>解決方法：
將原本 Dockerfile</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM  python:3.11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./requirment.txt /code/requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN uname -a &gt; /os.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./sql_app /code/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV PORT 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT ["uvicorn", "app.maingog:app", "--host", "0.0.0.0", "--port", "80"]</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>修改成</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">FROM --platform=$TARGETPLATFORM  python:3.11</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">WORKDIR /code</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./requirment.txt /code/requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN pip install --no-cache-dir --upgrade -r /code/requirements.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">RUN uname -a &gt; /os.txt</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">COPY ./sql_app /code/app</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENV PORT 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">EXPOSE 80</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">ENTRYPOINT ["uvicorn", "app.maingog:app", "--host", "0.0.0.0", "--port", "80"]</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>然後再用以下指令推到 azure cotainer registry(請換成自己 acr 的樣子)</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">docker buildx build . --platform linux/arm64,linux/amd64 -t fastapiserver.azurecr.io/fordserver/v1.9 --push</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>之後使用這個 image 時，docker 內建就會幫你判斷是哪個系統，並起服務！</p><p>至於，buildx 跟--use 跟 context 這幾個 docker 指令也是第一次遇到，完全不熟，所以之後會再補上</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="acr-換-git-hub-container">ACR 換 git hub container<a href="#acr-換-git-hub-container" class="hash-link" aria-label="Direct link to ACR 換 git hub container" title="Direct link to ACR 換 git hub container">​</a></h3><p>因為用 ACR 要錢，然後 free plan 也不給開 private registry，所以可以用 github or gitlab，
因為沒特別想用 private，所以就用 git hub 吧。</p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="cloud" term="cloud"/>
        <category label="Azure" term="Azure"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[gitcus comment system add to docusaurus but meet giscus.app refused to connect.]]></title>
        <id>https://suyuying.github.io/blog/2023/03/03/Docusaurus/gitcus-comment-in-docusaurus</id>
        <link href="https://suyuying.github.io/blog/2023/03/03/Docusaurus/gitcus-comment-in-docusaurus"/>
        <updated>2023-03-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[how to add comment system to docusaurus and problem giscus.app refused to connect.]]></summary>
        <content type="html"><![CDATA[<p>建立過程，以下只提供當初時作參考的網址，並紀錄過程遇到的問題。</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><ol><li><a href="https://dev.to/m19v/how-to-add-giscus-comments-to-docusaurus-439h" target="_blank" rel="noopener noreferrer">docs 加 github discussion by giscus</a></li></ol></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><ol><li><a href="https://madrus4u.com/blog/blog-comments" target="_blank" rel="noopener noreferrer">blog 加 disqus system by disqus</a></li></ol></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">When meet giscus.app refused to connect:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">this is caused of the reason that setting domain name wrong.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">For example:</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    https://suyuying.github.io./</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    you will see giscus.app refused to connect.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">But if you change url to, than it will fine.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    https://suyuying.github.io</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docusaurus" term="docusaurus"/>
        <category label="comment system" term="comment system"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Markdown syntax reference]]></title>
        <id>https://suyuying.github.io/blog/2023/03/03/Docusaurus/md-form</id>
        <link href="https://suyuying.github.io/blog/2023/03/03/Docusaurus/md-form"/>
        <updated>2023-03-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[demo在Docusaurus官網看到的md格式使用範例，給不熟悉md語法的使用者查詢格式用]]></summary>
        <content type="html"><![CDATA[<div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// how to import</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import Tabs from "@theme/Tabs";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import TabItem from "@theme/TabItem";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import Highlight from "@site/src/components/Highlight";</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><span style="background-color:#25c2a0;border-radius:20px;color:#fff;padding:6px;cursor:pointer">Docusaurus green</span> and <span style="background-color:#1877F2;border-radius:20px;color:#fff;padding:6px;cursor:pointer">Facebook blue</span> are my favorite colors.<p>I can write <strong>Markdown</strong> alongside my <em>JSX</em>!</p><blockquote><p>Easy to maintain open source documentation websites.</p><p>— Docusaurus</p></blockquote><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">以下為上述用法的程式碼。</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Highlight color="#25c2a0"&gt;Docusaurus green&lt;/Highlight&gt; and &lt;Highlight color="#1877F2"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Facebook blue</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/Highlight&gt; are my favorite colors.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">I can write **Markdown** alongside my _JSX_!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; Easy to maintain open source documentation websites.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&gt; — Docusaurus</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="details-element-example">Details element example<a href="#details-element-example" class="hash-link" aria-label="Direct link to Details element example" title="Direct link to Details element example">​</a></h3><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Toggle me!</summary><div><div class="collapsibleContent_i85q"><div><div>This is the detailed content</div><br><details class="details_lb9f alert alert--info details_b_Ee" data-collapsed="true"><summary>Nested toggle! Some surprise inside...</summary><div><div class="collapsibleContent_i85q"><div>😲😲😲😲😲</div></div></div></details></div></div></div></details><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;details&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;summary&gt;Toggle me!&lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;div&gt;This is the detailed content&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;br /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;details&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;summary&gt;Nested toggle! Some surprise inside...&lt;/summary&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;div&gt;😲😲😲😲😲&lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/details&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/details&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/malta_street-e4f6aff8d369f995fe829a9c92330f9d.jpeg" style="width:50%" alt="malta_street png" class="img_CujE"></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">how to import img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;div style={{ display: "flex", justifyContent: "center" }}&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;img</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      src={require("./malta_street.jpeg").default}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      style={{ width: "50%" }}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      alt="malta_street png"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    /&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="my-doc-section">My Doc Section<a href="#my-doc-section" class="hash-link" aria-label="Direct link to My Doc Section" title="Direct link to My Doc Section">​</a></h3><p>Hello world message with some <strong>bold</strong> text, some <em>italic</em> text, and a <a href="https://www.yahoo.com" target="_blank" rel="noopener noreferrer">link</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">//demo bold text ,italic style and superlink</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Hello world message with some **bold** text, some _italic_ text, and a [link](https://www.yahoo.com)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Apple</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Orange</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">Banana</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6">This is an apple 🍎</div><div role="tabpanel" class="tabItem_Ymn6" hidden="">This is an orange 🍊</div><div role="tabpanel" class="tabItem_Ymn6" hidden="">This is a banana 🍌</div></div></div><div class="tabs-container tabList__CuJ"><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_LNqP tabs__item--active">Android</li><li role="tab" tabindex="-1" aria-selected="false" class="tabs__item tabItem_LNqP">iOS</li></ul><div class="margin-top--md"><div role="tabpanel" class="tabItem_Ymn6">Android</div><div role="tabpanel" class="tabItem_Ymn6" hidden="">iOS</div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">demo tabs and tabs bring query string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// here are just tabs</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Tabs&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="apple" label="Apple" default&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    This is an apple 🍎</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="orange" label="Orange"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    This is an orange 🍊</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="banana" label="Banana"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    This is a banana 🍌</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/Tabs&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">//here bring query string</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;Tabs groupId="current-os" queryString&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="android" label="Android"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Android</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;TabItem value="ios" label="iOS"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    iOS</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/TabItem&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/Tabs&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">/src/components/HelloCodeTitle.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">HelloCodeTitle</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">Hello, </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">props</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">name</span><span class="token punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h1</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">```jsx title="/src/components/HelloCodeTitle.js"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function HelloCodeTitle(props) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return &lt;h1&gt;Hello, {props.name}&lt;/h1&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token imports maybe-class-name">React</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"react"</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function maybe-class-name" style="color:#d73a49">MyComponent</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">isBar</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">Bar</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">Foo</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword module" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token maybe-class-name">MyComponent</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">```jsx {1,4-6,11}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">import React from "react";</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">const MyComponent = (props) =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  if (props.isBar) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return &lt;div&gt;Bar&lt;/div&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return &lt;div&gt;Foo&lt;/div&gt;;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">};</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">export default MyComponent;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="playgroundContainer_X_Ta"><div class="playgroundHeader_dyrN">Live Editor</div><div class="playgroundEditor_Q6Y7" style="position:relative;text-align:left;box-sizing:border-box;padding:0;overflow:hidden;white-space:pre;font-family:monospace;color:#393A34;background-color:#f6f8fa"><textarea style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:absolute;top:0;left:0;height:100%;width:100%;resize:none;color:inherit;overflow:hidden;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased;-webkit-text-fill-color:transparent;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px" class="npm__react-simple-code-editor__textarea" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false" data-gramm="false">// need install jsx live
function Clock(props) {
  const [date, setDate] = useState(new Date());
  useEffect(() =&gt; {
    const timerID = setInterval(() =&gt; tick(), 1000);

    return function cleanup() {
      clearInterval(timerID);
    };
  });

  function tick() {
    setDate(new Date());
  }

  return (
    &lt;div&gt;
      &lt;h2&gt;It is {date.toLocaleTimeString()}.&lt;/h2&gt;
    &lt;/div&gt;
  );
}</textarea><pre aria-hidden="true" style="margin:0;border:0;background:none;box-sizing:inherit;display:inherit;font-family:inherit;font-size:inherit;font-style:inherit;font-variant-ligatures:inherit;font-weight:inherit;letter-spacing:inherit;line-height:inherit;tab-size:inherit;text-indent:inherit;text-rendering:inherit;text-transform:inherit;white-space:pre-wrap;word-break:keep-all;overflow-wrap:break-word;position:relative;pointer-events:none;padding-top:10px;padding-right:10px;padding-bottom:10px;padding-left:10px"><div class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// need install jsx live</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function maybe-class-name" style="color:#d73a49">Clock</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">date</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> setDate</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token function" style="color:#d73a49">useEffect</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> timerID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token arrow operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">cleanup</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token function" style="color:#d73a49">clearInterval</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">timerID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword" style="color:#00009f">function</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">tick</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">setDate</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name">Date</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">      </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag" style="color:#00009f">h2</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text">It is </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">date</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">toLocaleTimeString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text">.</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">h2</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span></div><div class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag" style="color:#00009f">div</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span></div><div class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span></div></pre><style>
/**
 * Reset the text fill color so that placeholder is visible
 */
.npm__react-simple-code-editor__textarea:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .npm__react-simple-code-editor__textarea {
    color: transparent !important;
  }

  .npm__react-simple-code-editor__textarea::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
</style></div><div class="playgroundHeader_dyrN">Result</div><div class="playgroundPreview_DzOI"><div>Loading...</div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">```jsx live</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// need install jsx live</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">function Clock(props) {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  const [date, setDate] = useState(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  useEffect(() =&gt; {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    const timerID = setInterval(() =&gt; tick(), 1000);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    return function cleanup() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      clearInterval(timerID);</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    };</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  });</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  function tick() {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    setDate(new Date());</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  }</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  return (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;h2&gt;It is {date.toLocaleTimeString()}.&lt;/h2&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/div&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  );</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">```</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="theme-admonition theme-admonition-note alert alert--secondary admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M6.3 5.69a.942.942 0 0 1-.28-.7c0-.28.09-.52.28-.7.19-.18.42-.28.7-.28.28 0 .52.09.7.28.18.19.28.42.28.7 0 .28-.09.52-.28.7a1 1 0 0 1-.7.3c-.28 0-.52-.11-.7-.3zM8 7.99c-.02-.25-.11-.48-.31-.69-.2-.19-.42-.3-.69-.31H6c-.27.02-.48.13-.69.31-.2.2-.3.44-.31.69h1v3c.02.27.11.5.31.69.2.2.42.31.69.31h1c.27 0 .48-.11.69-.31.2-.19.3-.42.31-.69H8V7.98v.01zM7 2.3c-3.14 0-5.7 2.54-5.7 5.68 0 3.14 2.56 5.7 5.7 5.7s5.7-2.55 5.7-5.7c0-3.15-2.56-5.69-5.7-5.69v.01zM7 .98c3.86 0 7 3.14 7 7s-3.14 7-7 7-7-3.12-7-7 3.14-7 7-7z"></path></svg></span>note</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="theme-admonition theme-admonition-caution alert alert--warning admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="theme-admonition theme-admonition-danger alert alert--danger admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M5.05.31c.81 2.17.41 3.38-.52 4.31C3.55 5.67 1.98 6.45.9 7.98c-1.45 2.05-1.7 6.53 3.53 7.7-2.2-1.16-2.67-4.52-.3-6.61-.61 2.03.53 3.33 1.94 2.86 1.39-.47 2.3.53 2.27 1.67-.02.78-.31 1.44-1.13 1.81 3.42-.59 4.78-3.42 4.78-5.56 0-2.84-2.53-3.22-1.25-5.61-1.52.13-2.03 1.13-1.89 2.75.09 1.08-1.02 1.8-1.86 1.33-.67-.41-.66-1.19-.06-1.78C8.18 5.31 8.68 2.45 5.05.32L5.03.3l.02.01z"></path></svg></span>danger</div><div class="admonitionContent_S0QG"><p>Some <strong>content</strong> with <em>Markdown</em> <code>syntax</code>. Check <a href="#">this <code>api</code></a>.</p></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::note</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::tip</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::info</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::caution</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::danger</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Some **content** with _Markdown_ `syntax`. Check [this `api`](#).</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">:::</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a target="_blank" href="/assets/files/DONe-5d595c68c8a1502cdcc9a36280bcc412.json">Download this docx using Markdown</a></p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">[Download this docx using Markdown](./DONe.json)</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ul><li><b>title</b>: <!-- -->Markdown syntax reference</li><li><b>description</b>: <!-- -->demo在Docusaurus官網看到的md格式使用範例，給不熟悉md語法的使用者查詢格式用</li><li><b>authors</b>: <!-- -->suyuying</li><li><b>tags</b>: <!-- -->docusaurus<!-- -->Markdown manual</li><li><b>comments</b>: </li></ul><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">// how to get build in object attributes</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;ul&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  {Object.entries(frontMatter).map(([key, value]) =&gt; (</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;li key={key}&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      &lt;b&gt;{key}&lt;/b&gt;: {value}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  ))}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/ul&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><ol><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex max-h-[24px] w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">1</span>Lorem ipsum dolor sit amet</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">2</span>It is a long established fact reader</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">3</span>The point of using Lorem Ipsum</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">4</span>There are many variations of passages</li><li class="text-body-color mb-4 flex text-base"><span class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white">5</span>If you are going to use a of Lorem</li></ol><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;ol&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex max-h-[24px]  w-full max-w-[24px]  items-center justify-center rounded-full text-base  text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      1</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    Lorem ipsum dolor sit amet</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      2</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    It is a long established fact reader</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    The point of using Lorem Ipsum</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      4</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    There are many variations of passages</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;li class="text-body-color mb-4 flex text-base"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;span</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      class="bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white"</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      5</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    &lt;/span&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    If you are going to use a of Lorem</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  &lt;/li&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/ol&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>actions/checkout@v3 參數篇</p><ul><li><code>ref</code>：要檢出的分支、標籤或提交 ID。</li><li><code>repository</code>：要檢出的儲存庫名稱。</li><li><code>submodules</code>：是否檢出子模組。</li><li><code>ssh-key</code>：用於從儲存庫獲取程式碼的 SSH 金鑰。</li><li><code>persist-credentials</code>：是否在持久化工作區時保存 GITHUB_TOKEN 和 SSH_AUTH_SOCK 環境變數。</li><li><code>fetch-depth</code>：要檢出的提交數量。</li><li><code>lfs</code>：是否下載 Git LFS 文件。</li><li><code>clean</code>：是否在檢出前運行 <code>git clean</code>。</li><li><code>workspace</code>：檢出的儲存庫的目錄。</li></ul><kbd>F1</kbd> <kbd>F2</kbd> <kbd>F3</kbd> <kbd>F4</kbd><kbd>Ctrl</kbd> + <kbd>C</kbd><kbd>🡄</kbd> <kbd>🡆</kbd> <kbd>🡅</kbd> <kbd>🡇</kbd><kbd>PrtScn</kbd> <kbd>Tab ↹</kbd><kbd>Enter</kbd><kbd>⊞ Win</kbd><kbd>😆</kbd><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;F1&lt;/kbd&gt; &lt;kbd&gt;F2&lt;/kbd&gt; &lt;kbd&gt;F3&lt;/kbd&gt; &lt;kbd&gt;F4&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;Ctrl&lt;/kbd&gt; + &lt;kbd&gt;C&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;🡄&lt;/kbd&gt; &lt;kbd&gt;🡆&lt;/kbd&gt; &lt;kbd&gt;🡅&lt;/kbd&gt; &lt;kbd&gt;🡇&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;PrtScn&lt;/kbd&gt; &lt;kbd&gt;Tab ↹&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;Enter&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;⊞ Win&lt;/kbd&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;kbd&gt;😆&lt;/kbd&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>並設定</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">src/css/custom.css</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">kbd </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">margin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 0px </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">2em</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">padding</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">1em </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">6em</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  border</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">radius</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 3px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">border</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 1px solid #ccc</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">color</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rgb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">51</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"Arial Black"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Impact</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">display</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> inline</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">block</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  box</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shadow</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 1px 0px </span><span class="token function" style="color:#d73a49">rgba</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 2px #fff inset</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  background</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">color</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">rgb</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">247</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">247</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">247</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">moz</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">box</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shadow</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 1px 0px </span><span class="token function" style="color:#d73a49">rgba</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 2px #fff inset</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">webkit</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">box</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">shadow</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 1px 0px </span><span class="token function" style="color:#d73a49">rgba</span><span class="token punctuation" style="color:#393A34">(</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0.2</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> 2px #fff inset</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">moz</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">border</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">radius</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 3px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token operator" style="color:#393A34">-</span><span class="token plain">webkit</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">border</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">radius</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 3px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docusaurus" term="docusaurus"/>
        <category label="Markdown manual" term="Markdown manual"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[Use Google Fonts in Docusaurus]]></title>
        <id>https://suyuying.github.io/blog/2023/03/03/Docusaurus/use-google-font</id>
        <link href="https://suyuying.github.io/blog/2023/03/03/Docusaurus/use-google-font"/>
        <updated>2023-03-03T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[整理網路提供的使用google font方法，最後是採用一般css import的方法,寫法上來說，直接在 custom css import 比較方便的,傳送的大小跟時間也是沒啥差,所以目前都用 css import 的方法,有寫錯麻煩指正]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="一一般-css-import">一、一般 css import<a href="#一一般-css-import" class="hash-link" aria-label="Direct link to 一、一般 css import" title="Direct link to 一、一般 css import">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1在-html-head-import">1.在 html head import<a href="#1在-html-head-import" class="hash-link" aria-label="Direct link to 1.在 html head import" title="Direct link to 1.在 html head import">​</a></h3><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;head&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Sofia"&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;style&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">body {</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  font-family: "Sofia", sans-serif;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">}</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/style&gt;</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">&lt;/head&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2在-css-import">2.在 css import<a href="#2在-css-import" class="hash-link" aria-label="Direct link to 2.在 css import" title="Direct link to 2.在 css import">​</a></h3><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">scr/css/custom.css</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Caveat:wght@500&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// css選擇器選使用範圍</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nav </span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">navbar__items</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 30px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Caveat</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//如果多個font import</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Caveat:wght@500&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// css 選擇標示用逗號分隔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">html </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Noto</span><span class="token plain"> </span><span class="token maybe-class-name">Sans</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">TC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sans</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">serif</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="二在-docusaurus-使用">二、在 docusaurus 使用<a href="#二在-docusaurus-使用" class="hash-link" aria-label="Direct link to 二、在 docusaurus 使用" title="Direct link to 二、在 docusaurus 使用">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="1在-html-head-import-1">1.在 html head import<a href="#1在-html-head-import-1" class="hash-link" aria-label="Direct link to 1.在 html head import" title="Direct link to 1.在 html head import">​</a></h3><p>這個方法相當於一般 css 使用在 head 打 link，只是寫在設定檔內，會於<span style="background-color:#1877F2;border-radius:20px;color:#fff;padding:6px;cursor:pointer">編譯後</span>產生在 index.html 的 head 裡面</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">&lt;link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC&amp;amp;display=swap"&gt;</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">docusaurus.config.js</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">theme</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">customCss</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> require</span><span class="token punctuation" style="color:#393A34">.</span><span class="token method function property-access" style="color:#d73a49">resolve</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"./src/css/custom.css"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">stylesheets</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">rel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"preconnect"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">href</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">rel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"preconnect"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">href</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"https://fonts.gstatic.com"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">crossorigin</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"anonymous"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">rel</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"stylesheet"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token literal-property property" style="color:#36acaa">href</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h3 class="anchor anchorWithStickyNavbar_LWe7" id="2在-css-import-1">2.在 css import<a href="#2在-css-import-1" class="hash-link" aria-label="Direct link to 2.在 css import" title="Direct link to 2.在 css import">​</a></h3><p>做法同一般 css import</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">scr/css/custom.css</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Caveat:wght@500&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// css選擇器選使用範圍</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  nav </span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">navbar__items</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">size</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> 30px</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Caveat</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">//如果多個font import</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Caveat:wght@500&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">@</span><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">url</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&amp;display=swap"</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// css 選擇標示用逗號分隔</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">html </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  font</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">family</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Noto</span><span class="token plain"> </span><span class="token maybe-class-name">Sans</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">TC</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> sans</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">serif</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="三比較兩種方法差異">三、比較兩種方法差異<a href="#三比較兩種方法差異" class="hash-link" aria-label="Direct link to 三、比較兩種方法差異" title="Direct link to 三、比較兩種方法差異">​</a></h2><p>一般css import</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/incss-9ed31de818e42e0d6f354a136c0b9bfb.png" alt="malta_street png" class="img_CujE"></div><p>link import</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/inlink1-528d5e3e355506d35b176fb8bf4cf495.png" alt="malta_street png" class="img_CujE"></div><div class="theme-admonition theme-admonition-tip alert alert--success admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</div><div class="admonitionContent_S0QG"><p>寫法上來說，直接在 custom css import 比較方便的，傳送的大小跟時間也是沒啥差，
所以目前都用 css import 的方法。有寫錯麻煩指正～</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="四-參考資料">四、 參考資料<a href="#四-參考資料" class="hash-link" aria-label="Direct link to 四、 參考資料" title="Direct link to 四、 參考資料">​</a></h2><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資料：</p><p>1.<a href="https://ouch1978.github.io/docs/docusaurus/customization/use-google-fonts-with-correct-way" target="_blank" rel="noopener noreferrer">以正確的姿勢使用 Google Fonts</a></p><p>2.<a href="https://from8to8.com/diary/lastestposts-font/" target="_blank" rel="noopener noreferrer">背景圖案及字體設定</a></p><p>3.<a href="https://theochu.com/docusaurus/styling/#custom-fonts" target="_blank" rel="noopener noreferrer">How to customize the styling of the Docusaurus Classic Theme</a></p></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="docusaurus" term="docusaurus"/>
        <category label="css" term="css"/>
        <category label="google font" term="google font"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[use react to build your own static website by github page]]></title>
        <id>https://suyuying.github.io/blog/2023/03/02/Git/git-hub-page-deploy-from-vite</id>
        <link href="https://suyuying.github.io/blog/2023/03/02/Git/git-hub-page-deploy-from-vite"/>
        <updated>2023-03-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[記錄一下github page配合git hub action的部署react vite過程，並提供github multiple repo管理辦法，主要步驟1.建立一個repo名為your_github_username.github.io 2.建立gh-pages分枝3.地端建立CI yml檔 4.設定github page使用branch gh-pages 5.推地端資料到main branch 6.CI會幫你執行build並把資源放到gh-pages branch ,Done]]></summary>
        <content type="html"><![CDATA[<h2 class="anchor anchorWithStickyNavbar_LWe7" id="step1-建立-repo">step1. 建立 repo<a href="#step1-建立-repo" class="hash-link" aria-label="Direct link to step1. 建立 repo" title="Direct link to step1. 建立 repo">​</a></h2><p>創建 repo 資料，網路上很多，可以 google 一下，說一下我遇到的問題是我有兩個 github repo，在 mac m1 電腦上推第二個 repo 會一直報 403 錯誤，解法
參考 <a href="https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-your-personal-account/managing-multiple-accounts" target="_blank" rel="noopener noreferrer">官網：管理多個帳戶</a></p><p>::: tip
但是！我後來切回原本那個 repo 他又開始 403 報錯了，而且同樣方式再操作也失敗，之後嘗試用 ssh 方式，就沒遇到上述問題，所以建議用 ssh 來推 code 吧！
:::</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git config --get credential.helper</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 如果輸出為osxkeychain，則您使用的是 macOS 鑰匙串。要清除憑據，請輸入以下命令</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">#清除憑據</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git credential-osxkeychain erase https://github.com</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># 將 Git 配置為緩存您克隆存儲庫的每個本地目錄的憑據</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git config --global credential.useHttpPath true</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>創立 repo 名稱這邊就講比較簡單做法，不加路由的版本，repo 名稱是
username.github.io (把 username 換成你的 git 註冊名字)</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/git-repo-git-page-82b098f93b830fa79a07aab4bf912077.png" alt="git-repo name set yourusername.github.io" class="img_CujE"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step2在你的-github-repo-建立-gh-pages-分枝">step2.在你的 github repo 建立 gh-pages 分枝<a href="#step2在你的-github-repo-建立-gh-pages-分枝" class="hash-link" aria-label="Direct link to step2.在你的 github repo 建立 gh-pages 分枝" title="Direct link to step2.在你的 github repo 建立 gh-pages 分枝">​</a></h2><p>這個就在 github 上建立該分枝就好，裡面檔案預設會 copy main 分枝，這沒關係。</p><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step3地端-yml-檔">step3.地端 yml 檔<a href="#step3地端-yml-檔" class="hash-link" aria-label="Direct link to step3.地端 yml 檔" title="Direct link to step3.地端 yml 檔">​</a></h2><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain"># 在git 根目錄</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">mkdir -p ./github/workflows</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>複製以下這段到名為 deploy.yml 的檔案，注意的是因為我是用 vite，然後管理包用 yarn，vite build 的資料夾放在 dist 底下，如果你是用一般建立 react 包的方法，會在 build。</p><div class="language-jsx codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockTitle_Ktv7">./github/workflows/deploy.yml</div><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-jsx codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">on</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">push</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">branches</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> main</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # </span><span class="token maybe-class-name">Review</span><span class="token plain"> gh actions docs </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> you want to further define triggers</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> paths</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> etc</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    # https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">docs</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">en</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">using</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">workflows</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">workflow</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">syntax</span><span class="token operator" style="color:#393A34">-</span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">github</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions#on</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">permissions</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">contents</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  pull</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">requests</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> write</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token literal-property property" style="color:#36acaa">jobs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">  </span><span class="token literal-property property" style="color:#36acaa">deploy</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    runs</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">on</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> ubuntu</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">latest</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token literal-property property" style="color:#36acaa">steps</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkout@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">setup</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">node@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          node</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">version</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">18</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">cache</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Install</span><span class="token plain"> dependencies</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn install </span><span class="token operator" style="color:#393A34">--</span><span class="token plain">frozen</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">lockfile</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Build</span><span class="token plain"> website</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">run</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> yarn build</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # </span><span class="token maybe-class-name">Popular</span><span class="token plain"> action to deploy to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      # </span><span class="token maybe-class-name">Docs</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">peaceiris</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gh</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pages#</span><span class="token operator" style="color:#393A34">%</span><span class="token constant" style="color:#36acaa">EF</span><span class="token operator" style="color:#393A34">%</span><span class="token constant" style="color:#36acaa">B8</span><span class="token operator" style="color:#393A34">%</span><span class="token plain">8F</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">docusaurus</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">      </span><span class="token operator" style="color:#393A34">-</span><span class="token plain"> name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">Deploy</span><span class="token plain"> to </span><span class="token maybe-class-name">GitHub</span><span class="token plain"> </span><span class="token maybe-class-name">Pages</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token literal-property property" style="color:#36acaa">uses</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> peaceiris</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">gh</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">pages@v3</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">with</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">github_token</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> $</span><span class="token punctuation" style="color:#393A34">{</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> secrets</span><span class="token punctuation" style="color:#393A34">.</span><span class="token constant" style="color:#36acaa">GITHUB_TOKEN</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token maybe-class-name">Build</span><span class="token plain"> output to publish to the </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">gh-pages</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">branch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">          # 這裡要改成你的build出來的資料夾！！</span><br></span><span class="token-line theme-code-block-highlighted-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">publish_dir</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">.</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">dist</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token maybe-class-name">The</span><span class="token plain"> following lines assign commit authorship to the official</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token constant" style="color:#36acaa">GH</span><span class="token operator" style="color:#393A34">-</span><span class="token maybe-class-name">Actions</span><span class="token plain"> bot </span><span class="token keyword control-flow" style="color:#00009f">for</span><span class="token plain"> deploys to </span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token template-string string" style="color:#e3116c">gh-pages</span><span class="token template-string template-punctuation string" style="color:#e3116c">`</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">branch</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # https</span><span class="token operator" style="color:#393A34">:</span><span class="token operator" style="color:#393A34">/</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">actions</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">checkout</span><span class="token operator" style="color:#393A34">/</span><span class="token plain">issues</span><span class="token operator" style="color:#393A34">/</span><span class="token number" style="color:#36acaa">13</span><span class="token plain">#issuecomment</span><span class="token operator" style="color:#393A34">-</span><span class="token number" style="color:#36acaa">724415212</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token maybe-class-name">The</span><span class="token plain"> </span><span class="token constant" style="color:#36acaa">GH</span><span class="token plain"> actions bot is used by </span><span class="token keyword module" style="color:#00009f">default</span><span class="token plain"> </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> you didn't specify the two fields</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          # </span><span class="token maybe-class-name">You</span><span class="token plain"> can swap them out </span><span class="token keyword" style="color:#00009f">with</span><span class="token plain"> your own user credentials</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">user_name</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> github</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">bot</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">          </span><span class="token literal-property property" style="color:#36acaa">user_email</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">41898282</span><span class="token operator" style="color:#393A34">+</span><span class="token plain">github</span><span class="token operator" style="color:#393A34">-</span><span class="token plain">actions</span><span class="token punctuation" style="color:#393A34">[</span><span class="token plain">bot</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain">@users</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">noreply</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">github</span><span class="token punctuation" style="color:#393A34">.</span><span class="token property-access">com</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step4設定預設分枝為-gh-pages">step4.設定預設分枝為 gh-pages<a href="#step4設定預設分枝為-gh-pages" class="hash-link" aria-label="Direct link to step4.設定預設分枝為 gh-pages" title="Direct link to step4.設定預設分枝為 gh-pages">​</a></h2><p>這布很重要，因為我每次設定都忘記要設定這個！ 忘記的話，最後連線到網站都會 F12 報錯
Failed to load module script: Expected a JavaScript module script but the server responded with a MIME type of "text/jsx". Strict MIME type checking is enforced for module scripts per HTML spec.</p><p>!!!很重要!!! 不然網站會是白的ＱＡＱ</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/gh-pages-01429e5af8a40496cac863a258a1b422.png" alt="how to set default branck of gh-pages" class="img_CujE"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="step5-推檔案到-github-main-branch">step5. 推檔案到 github main branch<a href="#step5-推檔案到-github-main-branch" class="hash-link" aria-label="Direct link to step5. 推檔案到 github main branch" title="Direct link to step5. 推檔案到 github main branch">​</a></h2><p>就 <code>git push</code> ，然後你可以到 action 那邊確認是否 CI 成功，成功的話請到 gh-pages 確認資料夾結構是你 build 完資料夾的長相，當然，地端請確認 build 完資料，是可以成功提供服務的！</p><p>成功畫面要長這樣</p><div style="display:flex;justify-content:center"><img loading="lazy" src="/assets/images/github-ci-success-fe00ac4263bfc9497ce5880bd3c95187.png" alt="picture of the success result of ci" class="img_CujE"></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="done">DONE<a href="#done" class="hash-link" aria-label="Direct link to DONE" title="Direct link to DONE">​</a></h2><p>請連線 <a href="https://yourusername.github.io/" target="_blank" rel="noopener noreferrer">https://yourusername.github.io/</a> 做確認</p><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>參考資料</p><ol><li><p><a href="https://vitejs.dev/guide/static-deploy.html#github-pages" target="_blank" rel="noopener noreferrer">Vite Official Documentation</a></p></li><li><p><a href="https://www.youtube.com/watch?v=yo2bMGnIKE8" target="_blank" rel="noopener noreferrer">Youtube Video - How to deploy Vite App on GitHub Pages</a></p></li><li><p><a href="https://docusaurus.io/docs/deployment#deploying-to-github-pages" target="_blank" rel="noopener noreferrer">Deployment Docusaurus</a></p></li></ol></div></div>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="git" term="git"/>
    </entry>
    <entry>
        <title type="html"><![CDATA[reset git remote origin branch]]></title>
        <id>https://suyuying.github.io/blog/2023/03/02/Git/reset-git-origin-branch</id>
        <link href="https://suyuying.github.io/blog/2023/03/02/Git/reset-git-origin-branch"/>
        <updated>2023-03-02T00:00:00.000Z</updated>
        <summary type="html"><![CDATA[在local端發現build完東西fail，但是已經推到main branch了，所以執行遠端registry退版，需要使用 git push --force,基本上 main branch 都會是保護的，也可以考慮用 pull request 先進行測試(不能自己發 pull request 自己審)，過了再 merge。]]></summary>
        <content type="html"><![CDATA[<p>需要使用 git push --force,基本上 main branch 都會是保護的，
也可以考慮用 pull request 先進行測試(不能自己發 pull request 自己審)，過了再 merge。</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">git checkout master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git reset --hard e3f1e37</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git push --force origin master</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"># Then to prove it (it won't print any diff)</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">git diff master..origin/master</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#393A34;--prism-background-color:#f6f8fa"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#393A34"><span class="token plain">pull request</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">settings -&gt; branches-&gt;Branch protection rules</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// if you just want to try merger just choose</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Require status checks to pass before merging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// if you choose Require a pull request before merging</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">// will get error Pull request authors cannot approve their own pull requests!</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p><a href="https://stackoverflow.com/questions/17667023/git-how-to-reset-origin-master-to-a-commit" target="_blank" rel="noopener noreferrer">參考網址</a></p>]]></content>
        <author>
            <name>zaxro</name>
            <uri>https://github.com/suyuying</uri>
        </author>
        <category label="git" term="git"/>
    </entry>
</feed>