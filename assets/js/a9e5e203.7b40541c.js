"use strict";(self.webpackChunkwebsitev_1=self.webpackChunkwebsitev_1||[]).push([[8667],{3905:(e,t,n)=>{n.d(t,{Zo:()=>s,kt:()=>b});var r=n(67294);function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){i(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function u(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},l=Object.keys(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)n=l[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var o=r.createContext({}),p=function(e){var t=r.useContext(o),n=t;return e&&(n="function"==typeof e?e(t):a(a({},t),e)),n},s=function(e){var t=p(e.components);return r.createElement(o.Provider,{value:t},e.children)},c="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return r.createElement(r.Fragment,{},t)}},m=r.forwardRef((function(e,t){var n=e.components,i=e.mdxType,l=e.originalType,o=e.parentName,s=u(e,["components","mdxType","originalType","parentName"]),c=p(n),m=i,b=c["".concat(o,".").concat(m)]||c[m]||d[m]||l;return n?r.createElement(b,a(a({ref:t},s),{},{components:n})):r.createElement(b,a({ref:t},s))}));function b(e,t){var n=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var l=n.length,a=new Array(l);a[0]=m;var u={};for(var o in t)hasOwnProperty.call(t,o)&&(u[o]=t[o]);u.originalType=e,u[c]="string"==typeof e?e:i,a[1]=u;for(var p=2;p<l;p++)a[p]=n[p];return r.createElement.apply(null,a)}return r.createElement.apply(null,n)}m.displayName="MDXCreateElement"},14351:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>o,contentTitle:()=>a,default:()=>d,frontMatter:()=>l,metadata:()=>u,toc:()=>p});var r=n(87462),i=(n(67294),n(3905));const l={title:"aws VPC , subnet,security group design",description:"\u7c21\u55ae\u8b1b\u4e00\u4e0b\u7db2\u8def\u898f\u5283,\u4f46\u898f\u5283 VPC \u6c92\u6709\u500b\u4e00\u5b9a\u7684\u7b54\u6848,\u5982\u679c\u662f\u70ba\u4e86\u958b\u767c\u4e0a\u7684\u65b9\u4fbf,\u53ef\u80fd\u53ea\u6703\u6709\u4e00\u500b public subnet \u653e nginx,\u5176\u4ed6 private subnet \u96d6\u7136\u6709\u4ee5\u7522\u54c1\u5340\u5206\u7db2\u6bb5,\u4f46\u662f security group \u662f VPC \u5167\u5b8c\u5168\u4e92\u901a,\u4e26\u958b\u653e\u7279\u5b9a port \u9023\u5165\u9019\u6a23,\u518d\u4e4b\u5f8c\u4e0a\u6b63\u5f0f\u74b0\u5883\u53ef\u80fd\u5c31\u8b8a\u6210\u7528 vpc \u5207\u5206\u7522\u54c1,\u7e3d\u8a00\u4e4b,\u9019\u5c31\u8981\u770b\u5c0d\u74b0\u5883\u7684\u8981\u6c42\uff01",authors:"suyuying",tags:["AWS"]},a=void 0,u={permalink:"/blog/2023/04/26/Aws/VPC-subnet-design",editUrl:"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Aws/2023-04-26-VPC-subnet-design.md",source:"@site/blog/Aws/2023-04-26-VPC-subnet-design.md",title:"aws VPC , subnet,security group design",description:"\u7c21\u55ae\u8b1b\u4e00\u4e0b\u7db2\u8def\u898f\u5283,\u4f46\u898f\u5283 VPC \u6c92\u6709\u500b\u4e00\u5b9a\u7684\u7b54\u6848,\u5982\u679c\u662f\u70ba\u4e86\u958b\u767c\u4e0a\u7684\u65b9\u4fbf,\u53ef\u80fd\u53ea\u6703\u6709\u4e00\u500b public subnet \u653e nginx,\u5176\u4ed6 private subnet \u96d6\u7136\u6709\u4ee5\u7522\u54c1\u5340\u5206\u7db2\u6bb5,\u4f46\u662f security group \u662f VPC \u5167\u5b8c\u5168\u4e92\u901a,\u4e26\u958b\u653e\u7279\u5b9a port \u9023\u5165\u9019\u6a23,\u518d\u4e4b\u5f8c\u4e0a\u6b63\u5f0f\u74b0\u5883\u53ef\u80fd\u5c31\u8b8a\u6210\u7528 vpc \u5207\u5206\u7522\u54c1,\u7e3d\u8a00\u4e4b,\u9019\u5c31\u8981\u770b\u5c0d\u74b0\u5883\u7684\u8981\u6c42\uff01",date:"2023-04-26T00:00:00.000Z",formattedDate:"April 26, 2023",tags:[{label:"AWS",permalink:"/blog/tags/aws"}],readingTime:3.335,hasTruncateMarker:!1,authors:[{name:"zaxro",title:"Life is too short to live someone else's dream",url:"https://github.com/suyuying",imageURL:"https://github.com/suyuying.png",key:"suyuying"}],frontMatter:{title:"aws VPC , subnet,security group design",description:"\u7c21\u55ae\u8b1b\u4e00\u4e0b\u7db2\u8def\u898f\u5283,\u4f46\u898f\u5283 VPC \u6c92\u6709\u500b\u4e00\u5b9a\u7684\u7b54\u6848,\u5982\u679c\u662f\u70ba\u4e86\u958b\u767c\u4e0a\u7684\u65b9\u4fbf,\u53ef\u80fd\u53ea\u6703\u6709\u4e00\u500b public subnet \u653e nginx,\u5176\u4ed6 private subnet \u96d6\u7136\u6709\u4ee5\u7522\u54c1\u5340\u5206\u7db2\u6bb5,\u4f46\u662f security group \u662f VPC \u5167\u5b8c\u5168\u4e92\u901a,\u4e26\u958b\u653e\u7279\u5b9a port \u9023\u5165\u9019\u6a23,\u518d\u4e4b\u5f8c\u4e0a\u6b63\u5f0f\u74b0\u5883\u53ef\u80fd\u5c31\u8b8a\u6210\u7528 vpc \u5207\u5206\u7522\u54c1,\u7e3d\u8a00\u4e4b,\u9019\u5c31\u8981\u770b\u5c0d\u74b0\u5883\u7684\u8981\u6c42\uff01",authors:"suyuying",tags:["AWS"]},prevItem:{title:"Common folder and their uses in Linux",permalink:"/blog/2023/04/27/linux-server/linux-default-use-of-folder"},nextItem:{title:"aws EC2 and ELB setting introduction",permalink:"/blog/2023/04/26/Aws/aws-ec2-elb-setting"}},o={authorsImageUrls:[void 0]},p=[{value:"\u7db2\u8def\u898f\u5283",id:"\u7db2\u8def\u898f\u5283",level:2},{value:"VPC \u898f\u5283",id:"vpc-\u898f\u5283",level:3},{value:"subnet \u898f\u5283",id:"subnet-\u898f\u5283",level:3},{value:"security group \u898f\u5283",id:"security-group-\u898f\u5283",level:3},{value:"\u547d\u540d\u898f\u5283",id:"\u547d\u540d\u898f\u5283",level:3},{value:"\u5c0f\u7d50",id:"\u5c0f\u7d50",level:3}],s={toc:p},c="wrapper";function d(e){let{components:t,...n}=e;return(0,i.kt)(c,(0,r.Z)({},s,n,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("h2",{id:"\u7db2\u8def\u898f\u5283"},"\u7db2\u8def\u898f\u5283"),(0,i.kt)("h3",{id:"vpc-\u898f\u5283"},"VPC \u898f\u5283"),(0,i.kt)("p",null,"\u5728\u4e00\u500b\u6216\u591a\u500b VPC \u5e95\u4e0b\u4f9d\u64da\u7522\u54c1\u5283\u5206 CIDR,\u5404\u7522\u54c1 server \u5728 private,nginx \u5728 public,\u4e3b\u8981\u900f\u904e nginx \u505a\u8f49\u5c0e,public subnet \u4e3b\u8981\u662f route \u51fa\u5916\u7db2\u6703\u8a2d\u5b9a\u5230 IgW,\u4e14\u88e1\u9762\u7684 server \u6709\u5c0d\u5916 ip,\u90a3\u5728 private \u90a3\u908a\u7684 route \u5728\u51fa\u5916\u7db2\u6642\u90fd\u900f\u904e NAT.\u751a\u81f3\u4e0d\u6703\u51fa\u5916\u7db2\uff01"),(0,i.kt)("p",null,"\u9019\u908a\u5c31\u770b\u516c\u53f8\u5c0d\u65bc\u5404\u74b0\u5883\u7684\u898f\u5283\uff01"),(0,i.kt)("h3",{id:"subnet-\u898f\u5283"},"subnet \u898f\u5283"),(0,i.kt)("p",null,"\u7522\u7247\u5c31\u4f9d\u64da VPC \u7684 CIDR,\u6bcf\u500b Region \u7684 VPC \u6703\u4f9d\u7167\u7528\u9014\u6216\u8005\u529f\u80fd\u898f\u5283\u6578\u500b Subnet\uff0c\u4e3b\u8981\u4ee5 Public Subnet, Private Subnet \u5207\u5206,\u4f8b\u5982,\u5f71\u97f3\u7522\u54c1\u7684 private \u5728 10.0.0.0/24,public \u5728 10.0.168.0/24,\u96fb\u73a9\u7522\u54c1 private \u5728 10.0.1.0/24,public \u5728 10.0.169.0/24,\u5982\u679c\u5927\u4e00\u9ede\u516c\u53f8\u6703\u5206\u54c1\u724c,\u90a3\u5340\u5206\u898f\u5247\u53ef\u80fd\u6703\u8b8a\u6210\u7528 VPC \u76f4\u63a5\u5340\u5206."),(0,i.kt)("p",null,"public \u901a\u5e38\u653e web server,AD \u7b49,private subnet \u6703\u653e\u5f8c\u7aef\u908f\u8f2f ."),(0,i.kt)("h3",{id:"security-group-\u898f\u5283"},"security group \u898f\u5283"),(0,i.kt)("p",null,"\u5982\u679c\u6a5f\u5668\u4e0d\u591a\u7684\u60c5\u6cc1\u4e0b,\u5c31\u4e0d\u6703\u7279\u5225\u7528 NACL \u53bb\u898f\u5283\u5b50 subnet \u7684\u7db2\u8def\u6d41\u91cf\u9032\u51fa,\u800c\u662f\u900f\u904e security group \u898f\u5283,\u9019\u6642\u5019 sg \u898f\u5283\u901a\u5e38\u90fd\u6703\u7528\u5806\u758a\u7684,\u4e3b\u8981\u662f\u90fd\u898f\u7bc4 ingress(inbound rules)\u5176\u8a9e\u6cd5\u662f \u5141\u8a31 ip \u7db2\u6bb5\u5230\u6211\u7684 server \u7684\u54ea\u500b port(ex.3306 TCP 125.227.142.21/32 \u9019\u6a23\u8a2d\u5b9a\u4ee3\u8868\u5141\u8a31 ip125.227.142.21 \u5230\u6211\u9019\u53f0 server \u7684 3306 port!),\u9019\u500b\u662f\u6709\u72c0\u614b\u7684,\u4e5f\u5c31\u662f\u8aaa\u5141\u8a31\u9032\u4f86,\u5728 response \u6642\u4e5f\u76f4\u63a5\u5141\u8a31\u5230\u9054\u8a72 ip\uff01"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"default")," - \u4e3b\u8981\u8ca0\u8cac",(0,i.kt)("inlineCode",{parentName:"li"},"ssh"),"\u9023\u5165\u4ee5\u53ca\u666e\u904d\u6027\u7684\u76e3\u63a7\u8edf\u9ad4\u9023\u5165,ex.Zabbix,prometheus.")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"# \u5141\u8a31 \u5916\u9762\u54ea\u4e9bip\u9023\u5165\n77.56.156.77/32 TCP SSH\n177.56.156.77/32 TCP SSH\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"container or xx service")," - \u7a0b\u5f0f\u908f\u8f2f,\u4e3b\u8981\u7528\u5728\u5f8c\u7aef\u7a0b\u5f0f\u9593\u8981\u4e92\u901a,\u53ef\u4ee5\u518d\u9032\u4e00\u6b65\u5206\u7d30\u90e8\u7db2\u6bb5")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"10.0.0.0/16 TCP xxx port\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"redis/pika")," - redis-client \u7aef\u9023\u5165 redis-server \u7684 inbound rule,\u6703\u639b\u5728 redis server \u90a3\u908a")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"10.0.0.0/16  TCP 6050\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"mysql"),"- mysql-client \u7aef\u9023\u5165 mysql-server \u7684 inbound rule,\u6703\u639b\u5728 mysql server \u90a3\u908a")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"177.227.142.71/32   TCP 3306\n")),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},(0,i.kt)("inlineCode",{parentName:"li"},"nginx")," - \u958b\u555f nginx inbound \u7684 rule,\u5c0d\u5916\u5141\u8a31\u6240\u6709 ip \u5230 443 or 80,\u5c0d\u5167\u5141\u8a31\u6240\u6709\u5167\u90e8 ip \u8ddf port \u904e\u4f86")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"0.0.0.0/0 TCP 443\n0.0.0.0/0 TCP 80\n10.0.0.0/16 all traffic\n")),(0,i.kt)("h3",{id:"\u547d\u540d\u898f\u5283"},"\u547d\u540d\u898f\u5283"),(0,i.kt)("p",null,"\u53ef\u4ee5\u57fa\u65bc\u670d\u52d9\u529f\u80fd,\u74b0\u5883,\u5730\u7406\u4f4d\u7f6e\u6216\u670d\u52d9\u540d\u7a31\u7b49\u505a\u898f\u5283"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"\u670d\u52d9\u529f\u80fd ex. ",(0,i.kt)("inlineCode",{parentName:"li"},"backend-servers-sg")),(0,i.kt)("li",{parentName:"ol"},"\u74b0\u5883\u5340\u5206 ex. ",(0,i.kt)("inlineCode",{parentName:"li"},"prod-backend-servers-sg")),(0,i.kt)("li",{parentName:"ol"},"\u5730\u7406\u4f4d\u7f6e\u5340\u5206 ex. ",(0,i.kt)("inlineCode",{parentName:"li"},"sg-us-east-backend")),(0,i.kt)("li",{parentName:"ol"},"\u57fa\u65bc\u61c9\u7528\u540d\u7a31 ex. ",(0,i.kt)("inlineCode",{parentName:"li"},"myapp-backend-sg"))),(0,i.kt)("h3",{id:"\u5c0f\u7d50"},"\u5c0f\u7d50"),(0,i.kt)("p",null,"\u898f\u5283 VPC \u6c92\u6709\u500b\u4e00\u5b9a\u7684\u7b54\u6848,\u5982\u679c\u662f\u70ba\u4e86\u958b\u767c\u4e0a\u7684\u65b9\u4fbf,\u53ef\u80fd\u53ea\u6703\u6709\u4e00\u500b public subnet \u653e nginx,\u5176\u4ed6 private subnet \u96d6\u7136\u6709\u4ee5\u7522\u54c1\u5340\u5206\u7db2\u6bb5,\u4f46\u662f security group \u662f VPC \u5167\u5b8c\u5168\u4e92\u901a,\u4e26\u958b\u653e\u7279\u5b9a port \u9023\u5165\u9019\u6a23.\u800c\u4e4b\u5f8c\u4e0a\u6b63\u5f0f\u74b0\u5883\u53ef\u80fd\u5c31\u8b8a\u6210\u7528 vpc \u5207\u5206\u7522\u54c1,\u7e3d\u8a00\u4e4b,\u9019\u5c31\u8981\u770b\u5c0d\u74b0\u5883\u7684\u8981\u6c42\uff01"),(0,i.kt)("admonition",{type:"info"},(0,i.kt)("p",{parentName:"admonition"},"\u53c3\u8003\u8cc7\u6599"),(0,i.kt)("ol",{parentName:"admonition"},(0,i.kt)("li",{parentName:"ol"},(0,i.kt)("a",{parentName:"li",href:"https://rickhw.github.io/2017/07/07/AWS/Plan-And-Deisgn-Multiple-VPCs-in-Different-Regions/"},"vpc \u898f\u5283")))))}d.isMDXComponent=!0}}]);