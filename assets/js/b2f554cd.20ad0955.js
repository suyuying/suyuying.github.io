"use strict";(self.webpackChunkwebsitev_1=self.webpackChunkwebsitev_1||[]).push([[1477],{10:n=>{n.exports=JSON.parse('{"blogPosts":[{"id":"/2023/04/18/Data Analysis/pandas/intro-of-pandas","metadata":{"permalink":"/blog/2023/04/18/Data Analysis/pandas/intro-of-pandas","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Data Analysis/pandas/2023-04-18-intro-of-pandas.md","source":"@site/blog/Data Analysis/pandas/2023-04-18-intro-of-pandas.md","title":"intro of pandas","description":"\u8655\u7406\u8cc7\u6599\u5f88\u5e38\u6703\u7528\u5230datetime,\u9019\u908a\u7d00\u9304\u4e00\u4e0b\u4f7f\u7528\u4e0a\u9762\u6703\u7528\u904e\u7684\u65b9\u6cd5,\u4e4b\u5f8c\u7b49\u8cc7\u6599\u9f4a\u5168\u518d\u5f59\u6574.","date":"2023-04-18T00:00:00.000Z","formattedDate":"April 18, 2023","tags":[{"label":"Python","permalink":"/blog/tags/python"},{"label":"pandas","permalink":"/blog/tags/pandas"},{"label":"data analysis","permalink":"/blog/tags/data-analysis"}],"readingTime":12.295,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"intro of pandas","description":"\u8655\u7406\u8cc7\u6599\u5f88\u5e38\u6703\u7528\u5230datetime,\u9019\u908a\u7d00\u9304\u4e00\u4e0b\u4f7f\u7528\u4e0a\u9762\u6703\u7528\u904e\u7684\u65b9\u6cd5,\u4e4b\u5f8c\u7b49\u8cc7\u6599\u9f4a\u5168\u518d\u5f59\u6574.","image":"https://github.com/suyuying.png","authors":"suyuying","tags":["Python","pandas","data analysis"]},"nextItem":{"title":"Python datetime guide","permalink":"/blog/2023/04/17/Python/datetime/datetime-guide"}},"content":"## basic intro\\n\\n\u5c0d\u8cc7\u6599\u9032\u884c\u5206\u6790,\u57fa\u672c\u4e0a\u904e\u7a0b\u5927\u81f4\u5982\u4ee5\u4e0b\\n\\n1. \u53d6\u5f97\u8cc7\u6599\\n2. \u4f7f\u7528\u5de5\u5177\u5206\u6790\u8cc7\u6599\\n3. \u5716\u793a\u5316\\n\\n\u7db2\u8def\u4e0a\u8cc7\u6599\u6536\u96c6\u65b9\u5f0f\u6709\u5f88\u591a,\u5f9e\u7c21\u4fbf\u5230\u9ebb\u7169\u4f9d\u5e8f\u5927\u81f4\u5982\u4ee5\u4e0b,\u5982\u679c\u9047\u5230\u9700\u8981\u53d6\u8cc7\u6599\u6642,\u53ef\u4ee5\u689d\u5217\u5f0f\u7684\u7be9\u9078\u627e\u5230\u5408\u9069\u65b9\u6cd5.\\n\\n```\\nAPI < \u958b\u767c\u8005\u5de5\u5177\u7684xhr/fetch\u89e3\u6790 < bs4\u89e3\u6790html\u4e2dcss\u8ddftag < selenium\u89e3\u6790html\u8ddf\u9ede\u64ca\\n```\\n\\n\u57fa\u672c\u4e0a\u7576\u7136\u662f\u5148\u5f9e\u7c21\u55ae\u958b\u59cb try,\u5047\u8a2d\u4eca\u5929\u5df2\u7d93\u53d6\u5230\u6240\u9700\u7684\u8cc7\u6599\u4e86,\u5b83\u53ef\u80fd\u662f csv,Json \u7b49\u683c\u5f0f,\u63a5\u8457\u5c31\u6703\u662f<highlight color=\\"#25c2a0\\">pandas</highlight>\u4e0a\u5834\u7684\u6642\u5019.\\n\\n\u5e38\u7528\u64cd\u4f5c\u6709 \u6578\u64da\u6e96\u5099\u3001\u9078\u53d6\u3001\u904e\u6ffe\u3001\u805a\u5408\u3001\u5206\u7d44\u3001\u6392\u5e8f\u3001\u5408\u4f75\u3001\u586b\u5145\u7f3a\u5931\u503c,\u53e6\u5916\u56e0\u70ba\u4ed6\u7684\u8cc7\u6599\u7d50\u69cb\u4e5f\u6709\u8ddf python \u7684\u7e6a\u5716\u5de5\u5177\u505a\u6574\u5408,\u4e5f\u53ef\u4ee5\u642d\u914d\u4f7f\u7528,\u5e38\u7528\u7684\u7e6a\u5716\u5de5\u5177\u5982\u4ee5\u4e0b.\\n\\n- Plotly \u548c Bokeh \u662f\u57fa\u65bc JavaScript \u7684\u4ea4\u4e92\u5f0f\u5716\u8868\uff0c\u4e5f\u652f\u63f4\u5176\u4ed6\u8a9e\u8a00 ex.Python,\u53ef\u4ee5\u5275\u5efa\u4e92\u52d5\u6027\u66f4\u5f37\u7684\u5716\u8868\uff0c\u5982\u6ed1\u584a\u3001\u4e0b\u62c9\u9078\u55ae\u7b49\u3002\\n- Altair \u662f\u57fa\u65bc Vega-Lite \u7684 Python \u5957\u4ef6\uff0c\u652f\u6301\u5c07\u6578\u64da\u8f49\u63db\u70ba\u4ea4\u4e92\u5f0f\u5716\u8868,\u512a\u9ede\u662f\u8a9e\u6cd5\u8f03\u7c21\u55ae\u3002\\n- Seaborn \u5247\u662f\u4e00\u500b\u7d71\u8a08\u5716\u8868\u5957\u4ef6\uff0c\u5c08\u6ce8\u65bc\u7d71\u8a08\u7e6a\u5716\uff0c\u65b9\u4fbf\u4f7f\u7528\u8005\u9032\u884c\u5e38\u898b\u7684\u6578\u64da\u5206\u6790\u548c\u7e6a\u5716\u64cd\u4f5c\u3002\\n- Matplotlib \u662f Python \u6700\u65e9\u671f\u7684\u7e6a\u5716\u5957\u4ef6\u4e4b\u4e00\uff0c\u529f\u80fd\u5f37\u5927\uff0c\u53ef\u4ee5\u7e6a\u88fd\u5404\u7a2e\u5716\u8868\uff0c\u5305\u62ec\u689d\u5f62\u5716\u3001\u76f4\u65b9\u5716\u3001\u6563\u9ede\u5716\u7b49\u7b49,\u57fa\u672c\u4e0a Seaborn \u662f\u5efa\u7acb\u5728 Matplotlib \u4e4b\u4e0a\u3002\\n- Pyecharts \u5247\u662f\u4e2d\u570b\u7684\u4e00\u500b\u958b\u6e90\u5716\u8868\u5eab\uff0c\u63d0\u4f9b\u4e86\u5404\u7a2e\u5404\u6a23\u7684\u5716\u8868\uff0c\u80fd\u5920\u7e6a\u88fd\u5730\u5716\u3001\u95dc\u4fc2\u5716\u3001\u71b1\u529b\u5716\u7b49\u591a\u7a2e\u5716\u8868\u3002\\n\\n### \u6578\u64da\u6e96\u5099\\n\\n\u4ee5\u4e0b\u6578\u64da\u662f\u6539\u904e\u5f8c\u7684\u6578\u64da,\u6703\u4f5c\u70ba\u5f8c\u9762 demo \u904e\u7a0b\u7bc4\u4f8b,\u57fa\u672c\u4e0a\u4f60\u60f3\u5f97\u5230\u7684\u6578\u64da\u683c\u5f0f pandas \u90fd\u652f\u63f4\u4e86,md \u6a94,csv,dict,json...\\n\\npandas \u4e3b\u8981\u6578\u64da\u7d50\u69cb\u6709\\n\\n- Series\uff1a\u4e00\u7dad\u6578\u64da\u7d50\u69cb\uff0c\u985e\u4f3c\u65bc\u5e36\u6709\u6a19\u7c64\u7684\u4e00\u7dad\u6578\u7d44\uff0c\u53ef\u4ee5\u5bb9\u7d0d\u4e0d\u540c\u985e\u578b\u7684\u6578\u64da\u3002\\n\\n- DataFrame\uff1a\u4e8c\u7dad\u6578\u64da\u7d50\u69cb\uff0c\u985e\u4f3c\u65bc\u4e00\u500b\u4e8c\u7dad\u6578\u7d44\u6216\u4e00\u500b\u95dc\u806f\u6578\u64da\u5eab\u8868\uff0c\u6bcf\u5217\u53ef\u4ee5\u6709\u4e0d\u540c\u7684\u6578\u64da\u985e\u578b\u3002\\n\\n- Panel\uff1a\u4e09\u7dad\u6578\u64da\u7d50\u69cb\uff0c\u985e\u4f3c\u65bc\u4e00\u500b\u7531 DataFrame \u5c0d\u8c61\u7d44\u6210\u7684\u5b57\u5178\uff0c\u53ef\u4ee5\u7528\u4f86\u8868\u793a\u7531\u591a\u500b DataFrame \u5c0d\u8c61\u7d44\u6210\u7684\u6578\u64da\u96c6\u3002\\n\\n\u6700\u5e38\u6703\u4f7f\u7528\u5230\u7684\u5c31\u662f DataFrame.\\n\\n#### Python \u7269\u4ef6\u8f49 pandas dataframe\\n\\n\u4ee5\u4e0b\u662f\u628a\u8cc7\u6599\u5b58\u6210 dict in list \u7684\u578b\u614b\\n\\n```\\n[{\'name\': \'TM-Zx-1040\', \'filePath\': \'/AppliZxations/iMyFone LoZxkWiper.app/Zxontents/MaZxOS/fixiOSLib/FixOS\', \'start_time\': \'2023-03-29 14:25:05\', \'open_id\': \'H-GOGO-20230329-00001\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-04-18 02:38:40\', \'open_id\': \'H-GOGO-20230418-00001\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-04-13 21:51:19\', \'open_id\': \'H-GOGO-20230413-00029\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-04-10 22:13:29\', \'open_id\': \'H-GOGO-20230410-00053\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-04-05 18:47:26\', \'open_id\': \'H-GOGO-20230405-00001\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-04-03 21:04:38\', \'open_id\': \'H-GOGO-20230403-00002\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-04-03 04:51:22\', \'open_id\': \'H-GOGO-20230403-00001\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-04-01 22:42:13\', \'open_id\': \'H-GOGO-20230402-00002\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZx.exe\', \'start_time\': \'2023-04-01 23:58:44\', \'open_id\': \'H-GOGO-20230402-00001\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-03-30 20:11:05\', \'open_id\': \'H-GOGO-20230330-00001\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-03-29 21:15:40\', \'open_id\': \'H-GOGO-20230329-00002\'}, {\'name\': \'XD-Zx-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Program Files (x86)\\\\\\\\IObit\\\\\\\\AdvanZxed SystemZxare\\\\\\\\ASZxServiZxe.exe\', \'start_time\': \'2023-03-28 22:28:29\', \'open_id\': \'H-GOGO-20230328-00001\'}, {\'name\': \'XD-SAS-1045\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume5\\\\\\\\Users\\\\\\\\miriam.lin\\\\\\\\AppData\\\\\\\\Roaming\\\\\\\\InsLogiZxZxfg\\\\\\\\PS\\\\\\\\PSDD\\\\\\\\9487.exe\', \'start_time\': \'2023-04-17 18:04:27\', \'open_id\': \'H-GOGO-20230417-00027\'}, {\'name\': \'XD-SAS-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Users\\\\\\\\DON\\\\\\\\Desktop\\\\\\\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe\', \'start_time\': \'2023-04-18 11:17:21\', \'open_id\': \'H-GOGO-20230418-00004\'}, {\'name\': \'XD-SAS-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Users\\\\\\\\DON\\\\\\\\Desktop\\\\\\\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe\', \'start_time\': \'2023-04-18 11:17:23\', \'open_id\': \'H-GOGO-20230418-00003\'}, {\'name\': \'XD-SAS-1073\', \'filePath\': \'\\\\\\\\DeviZxe\\\\\\\\HarddiskVolume3\\\\\\\\Users\\\\\\\\DON\\\\\\\\Desktop\\\\\\\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe\', \'start_time\': \'2023-04-18 11:17:01\', \'open_id\': nan}]\\n```\\n\\n\u628a dict in list \u8f49\u6210 dataframe,dict \u7684 key \u6703\u5c0d\u61c9\u5230\u6b04\u4f4d\u540d\u7a31\uff0cvalue \u5c0d\u61c9\u6b04\u4f4d\u8cc7\u6599\u5167\u5bb9\\n\\n```\\ndf=pd.DataFrame(json_data)\\nprint(df)\\n## data\\n           name                                           filePath           start_time                open_id\\n0    TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  2023-03-29 14:25:05  H-GOGO-20230329-00001\\n1    XD-Zx-1073  \\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\I...  2023-04-18 02:38:40  H-GOGO-20230418-00001\\n2    XD-Zx-1073  \\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\I...  2023-04-13 21:51:19  H-GOGO-20230413-00029\\n3    XD-Zx-1073  \\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\I...  2023-04-10 22:13:29  H-GOGO-20230410-00053\\n......\\n```\\n\\n#### CSV \u8f49 pandas dataframe\\n\\n\u4ee5\u4e0b\u662f CSV \u683c\u5f0f\\n\\n```javascript title=\\"xxx.csv\\"\\nname,filePath,start_time,open_id\\nTM-Zx-1040,/AppliZxations/iMyFone LoZxkWiper.app/Zxontents/MaZxOS/fixiOSLib/FixOS,2023-03-29 14:25:05,H-GOGO-20230329-00001\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-04-18 02:38:40,H-GOGO-20230418-00001\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-04-13 21:51:19,H-GOGO-20230413-00029\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-04-10 22:13:29,H-GOGO-20230410-00053\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-04-05 18:47:26,H-GOGO-20230405-00001\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-04-03 21:04:38,H-GOGO-20230403-00002\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-04-03 04:51:22,H-GOGO-20230403-00001\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-04-01 22:42:13,H-GOGO-20230402-00002\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZx.exe,2023-04-01 23:58:44,H-GOGO-20230402-00001\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-03-30 20:11:05,H-GOGO-20230330-00001\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-03-29 21:15:40,H-GOGO-20230329-00002\\nXD-Zx-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe,2023-03-28 22:28:29,H-GOGO-20230328-00001\\nXD-SAS-1045,\\\\DeviZxe\\\\HarddiskVolume5\\\\Users\\\\miriam.lin\\\\AppData\\\\Roaming\\\\InsLogiZxZxfg\\\\PS\\\\PSDD\\\\9487.exe,2023-04-17 18:04:27,H-GOGO-20230417-00027\\nXD-SAS-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Users\\\\DON\\\\Desktop\\\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe,2023-04-18 11:17:21,H-GOGO-20230418-00004\\nXD-SAS-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Users\\\\DON\\\\Desktop\\\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe,2023-04-18 11:17:23,H-GOGO-20230418-00003\\nXD-SAS-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Users\\\\DON\\\\Desktop\\\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe,2023-04-18 11:17:01,\\n\\n```\\n\\n\u628a csv \u8b80\u6210 dataframe\\n\\n```\\ndf = pd.read_csv(\'XXX.csv\')\\n```\\n\\n\u6709\u4e86 df \u4ee5\u5f8c\u53ef\u4ee5\u7528\u57fa\u672c\u7684\u5c6c\u6027\u53bb\u4e86\u89e3\u4ed6\u7684 index,column name, \u8868\u7e3d\u9577\u5ea6\u7b49\\n\\n```\\n# \u78ba\u8a8d DataFrame \u7684 index\\nprint(df.index) #RangeIndex(start=0, stop=16, step=1)\\n\\n\\n# \u78ba\u8a8d DataFrame \u7684\u6b04\u4f4d\u540d\u7a31\\nprint(df.columns) #Index([\'name\', \'filePath\', \'start_time\', \'open_id\'], dtype=\'object\')\\n\\n# \u78ba\u8a8d DataFrame \u7684\u7e3d\u9577\u5ea6\\nprint(len(df)) #16\\n\\n#\u8b80\u524d\u5341\u884c\\nprint(df.head(10))\\n\\n#\u5217\u51fa\u5404\u6b04\u4f4d\u578b\u614b\\nprint(df.dtypes)\\nname          object\\nfilePath      object\\nstart_time    object\\nopen_id       object\\ndtype: object\\n\\nprint(df.shape) #(16, 4) \u986f\u793a (16, 4) \u8868\u793a df \u6709 16 \u5217(row) \u548c 4 \u884c(column)\u3002\\n\\n\\n\\n#\u62ec\u6bcf\u500b column \u7684\u540d\u7a31\u3001\u975e\u7a7a\u503c\u7684\u6578\u91cf\u3001\u6578\u503c\u578b\u5225\u3001\u4ee5\u53ca\u4f54\u7528\u7684\u8a18\u61b6\u9ad4\u5927\u5c0f\u7b49\u7b49\u3002\\nprint(df.info())\\n<class \'pandas.core.frame.DataFrame\'>\\nRangeIndex: 16 entries, 0 to 15\\nData columns (total 4 columns):\\n #   Column      Non-Null Count  Dtype\\n---  ------      --------------  -----\\n 0   name        16 non-null     object\\n 1   filePath    16 non-null     object\\n 2   start_time  16 non-null     object\\n 3   open_id     15 non-null     object\\ndtypes: object(4)\\nmemory usage: 640.0+ bytes\\n\\n# \u6b04\u4f4d\u7684\u7e3d\u6578\u3001\u5e73\u5747\u503c\u3001\u6a19\u6e96\u5dee\u3001\u6700\u5c0f\u503c\u300125% \u5206\u4f4d\u6578\u300150% \u5206\u4f4d\u6578\u300175% \u5206\u4f4d\u6578\u3001\u6700\u5927\u503c\u7b49\u8cc7\\nprint(df.describe())\\n              name                                           filePath           start_time                open_id\\ncount           16                                                 16                   16                     15\\nunique           4                                                  5                   16                     15\\ntop     XD-Zx-1073  \\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\I...  2023-03-29 14:25:05  H-GOGO-20230329-00001\\nfreq            11                                                 10                    1                      1\\n\\n\\n```\\n\\n#### \u5c0f\u7d50\\n\\n\u5e38\u7528\u7684\u662f df.shape,df.index,df.dtypes,df.info(),df.columns,\u9084\u6709 len(df)\u7b49,\u53bb\u63cf\u8ff0 df \u7684\u6b04\u4f4d\u7684\u578b\u614b.\\n\\n`df.shape`: \u8fd4\u56de DataFrame \u7684\u884c\u6578\u548c\u5217\u6578\uff0c\u4ee5\u5143\u7d44\u5f62\u5f0f\u8fd4\u56de (rows, columns)\u3002\\n\\n`df.index`: \u8fd4\u56de DataFrame \u7684\u7d22\u5f15 (Index)\u3002\\n\\n`df.columns`: \u8fd4\u56de DataFrame \u7684\u5217\u540d\u3002\\n\\n`df.dtypes`: \u8fd4\u56de DataFrame \u6bcf\u500b\u5217\u7684\u6578\u64da\u985e\u578b\u3002\\n\\n`df.info()`: \u8fd4\u56de DataFrame \u7684\u7c21\u8981\u6458\u8981\uff0c\u5305\u62ec\u6bcf\u500b\u5217\u7684\u540d\u7a31\u3001\u975e\u7a7a\u503c\u7684\u6578\u91cf\u3001\u6bcf\u500b\u5217\u7684\u6578\u64da\u985e\u578b\u3001\u7d22\u5f15\u7684\u6578\u91cf\u3001\u8a18\u61b6\u9ad4\u4f7f\u7528\u91cf\u7b49\u7b49\u3002\\n\\n`len(df)`: \u8fd4\u56de DataFrame \u7684\u884c\u6578\u3002\\n\\n\u5728 dataframe \u88e1\u9762 axis \u4ee3\u8868\u8ef8.\\naxis=0\uff1a\u8868\u793a\u6cbf\u7740\u884c\u7684\u65b9\u5411\u8fdb\u884c\u64cd\u4f5c\uff0c\u4f8b\u5982 drop \u65b9\u6cd5\u522a\u9664\u884c\u6642\u5c31\u662f\u6cbf\u7740\u884c\u65b9\u5411\u9032\u884c\u522a\u9664\u3002\\naxis=1\uff1a\u8868\u793a\u6cbf\u7740\u5217\u7684\u65b9\u5411\u8fdb\u884c\u64cd\u4f5c\uff0c\u4f8b\u5982 drop \u65b9\u6cd5\u522a\u9664\u5217\u6642\u5c31\u662f\u6cbf\u7740\u5217\u65b9\u5411\u9032\u884c\u522a\u9664\u3002\\n\\n### \u9078\u53d6\\n\\n- \u4f7f\u7528\u96b1\u6027\u7d22\u5f15\u4f86\u9078\u53d6\u8cc7\u6599\\n\\n```\\n# \u5217\u51fa0~10\u884c\\n print(df[0:11])\\n```\\n\\n- iloc \u5207\u7247 :iloc \u662f\u4f7f\u7528\u96b1\u6027\u7d22\u5f15\u4f86\u9078\u53d6\u8cc7\u6599\uff0c\u6771\u897f\u5728 [] \u88e1\u9762\uff0c\u7d22\u5f15\u503c 0 \u662f\u884c\uff0c\u7d22\u5f15\u503c 1 \u662f\u5217\u3002 \u53ef\u4ee5\u4f7f\u7528 : \u9078\u53d6\u4e00\u5b9a\u7bc4\u570d\u7684\u5217\u6216\u884c\u3002\\n\\n```\\n  df.iloc[1:4,0:3]: \u9078\u53d6 1~3 \u884c,0~2 \u5217\\n  df.iloc[[0, 1]]\uff1a\u4f7f\u7528\u96b1\u5f0f\u7d22\u5f15\u9078\u53d6\u7b2c 0 \u548c\u7b2c 1 \u884c\u3002\\n  df.iloc[[0, 2], [1, 3]]\uff1a\u4f7f\u7528\u96b1\u5f0f\u7d22\u5f15\u9078\u53d6\u7b2c 0 \u548c\u7b2c 2 \u884c\u4ee5\u53ca\u7b2c 1 \u548c\u7b2c 3 \u5217\u3002\\n  df.iloc[:,0:7]\uff1a\u9078\u53d6\u6240\u6709\u884c\u7684\u524d 7 \u5217\u3002\\n  df.iloc[10:30,2:3]=None\uff1a\u5c07\u7b2c 10 \u5230\u7b2c 29 \u884c\u7684\u7b2c 2 \u5217\u503c\u8a2d\u70ba None\u3002\\n  df.iloc[10:30,:]=None: \u7b2c 10 ~29 \u884c \u6240\u6709\u5217\u63db\u6210 None\\n  df.iloc[10:30,:-2]=None: \u7b2c 10 ~29 \u884c \u9664\u4e86\u5012\u6578\u5169\u5217\u4e4b\u5916\u7684\u5217\u63db\u6210 None\\n```\\n\\n- loc \u906e\u7f69:\u53ef\u4ee5\u7528\u5207\u7247\u6216\u8005\u5e03\u6797\u5411\u91cf\u9078\u503c,\u9019\u908a index \u662f\u986f\u793a\u7d22\u5f15,\u4e00\u5b9a\u8981\u6709\u5c0d\u61c9\u7684 index \u540d\u7a31\\n  .\u6709\u7528\u7bc4\u570d\u5c31\u7528\u5207\u7247:,\u7528\u5207\u7247\u4e0d\u7528\u7a7a\u683c.\\n\\n```\\nprint(df.loc[[1, 3], [\\"name\\", \\"start_time\\"]]) # \u53d6\u51fa index \u70ba 1, 3 \u7684 name \u548c start_time \u5169\u500b column\\n\\nprint(df.loc[1:3, [\\"name\\", \\"start_time\\"]]) # \u53d6\u51fa index \u70ba 1, 2, 3 \u7684 name \u548c start_time \u5169\u500b column\\n\\nprint(df.loc[1:3, \\"name\\":\\"start_time\\"]) # \u53d6\u51fa index \u70ba 1, 2, 3 \u7684 name \u5230 start_time \u4e09\u500b column\\n\\n```\\n\\n- \u5012\u653e df.T\\n\\n```\\nprint(df.T)\\n                                                           0   ...                                                 15\\nname                                               TM-Zx-1040  ...                                        XD-SAS-1073\\nfilePath    /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...  ...  \\\\DeviZxe\\\\HarddiskVolume3\\\\Users\\\\DON\\\\Desktop\\\\Nav...\\nstart_time                                2023-03-29 14:25:05  ...                                2023-04-18 11:17:01\\nopen_id                                 H-GOGO-20230329-00001  ...                                                NaN\\n\\nprint(df.T.index) #Index([\'name\', \'filePath\', \'start_time\', \'open_id\'], dtype=\'object\')\\n\\n\\n```\\n\\n- \u76f4\u63a5\u62ff\u67d0\u6b04\u4f4d\u503c at[],\u4f7f\u7528 label (index & column name) \u53d6\u503c, .iat[]. (.at[\'a\',\'b\'] \u7d22\u5f15\u70ba a \u5217\u540d\u70ba b)\uff0c df.iat[3, 2] \u53ea\u80fd\u7528\u96b1\u6027\u7d22\u5f15 (integer) \u53d6\u503c,\u9019\u908a\u662f\u53d6\u7b2c 4 \u884c\u7b2c 3 \u5217(2023-04-10 22:13:29).\\n\\n### \u904e\u6ffe\\n\\n\u4f7f\u7528 query \u65b9\u5f0f\uff1a\\n\\n```\\ndf.query(\\"name.str.contains(\'XD-Zx\')\\")\\n```\\n\\n\u4f7f\u7528 [bool] \u5e03\u6797\u9078\u64c7\u7684\u65b9\u5f0f\uff1a\\n\\n```\\ndf[df[\'name\'].str.contains(\'XD-Zx\')]\\n```\\n\\n### \u5206\u7d44\u805a\u5408\\n\\n\u5728 Pandas \u4e2d\uff0c\u805a\u5408\u6307\u7684\u662f\u5c07\u8cc7\u6599\u96c6\u6309\u7167\u67d0\u4e9b\u689d\u4ef6\u5206\u7d44\uff0c\u7136\u5f8c\u5c0d\u5206\u7d44\u5f8c\u7684\u8cc7\u6599\u96c6\u9032\u884c\u8a08\u7b97\u7684\u904e\u7a0b\u3002\u5e38\u898b\u7684\u805a\u5408\u51fd\u6578\u6709\uff1asum\uff08\u6c42\u548c\uff09\u3001mean\uff08\u6c42\u5e73\u5747\uff09\u3001median\uff08\u6c42\u4e2d\u4f4d\u6578\uff09\u3001min\uff08\u6c42\u6700\u5c0f\u503c\uff09\u3001max\uff08\u6c42\u6700\u5927\u503c\uff09\u7b49\u7b49\u3002\\n\\nPandas \u4e2d\u805a\u5408\u7684\u65b9\u6cd5\u4e3b\u8981\u6709\u5169\u7a2e\uff1agroupby \u548c pivot_table\u3002\\n\\ngroupby \u65b9\u6cd5\u5c07\u8cc7\u6599\u96c6\u6309\u7167\u67d0\u4e9b\u6b04\u4f4d\u9032\u884c\u5206\u7d44\uff0c\u7136\u5f8c\u5c0d\u5206\u7d44\u5f8c\u7684\u8cc7\u6599\u9032\u884c\u805a\u5408\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u5c07\u8cc7\u6599\u96c6\u6309\u7167\u67d0\u4e00\u6b04\u4f4d\u9032\u884c\u5206\u7d44\uff0c\u7136\u5f8c\u8a08\u7b97\u6bcf\u500b\u5206\u7d44\u7684\u5e73\u5747\u503c\u3002\\n\\n[\u53c3\u8003\u9019\u7bc7\u6587\u7ae0](https://zhuanlan.zhihu.com/p/101284491)\u5c0d\u65bc groupby \u7684\u8b1b\u89e3,groupby \u5176\u5be6\u5c31\u662f\u5c0d\u8cc7\u6599\u9032\u884c\u5206\u7d44,\u4f8b\u5982\u9014\u4e2d company \u6709\u591a\u500b C\u3001\uff21\u3001\uff22,\u9019\u4e9b\u884c\u90fd\u6703\u88ab\u805a\u96c6\u5728\u4e00\u8d77,\u5f8c\u7e8c\u53ef\u4ee5\u7528 agg \u6216 transform \u805a\u5408\u64cd\u4f5c,\u4e5f\u53ef\u4ee5\u900f\u904e apply \u4f7f\u7528\u81ea\u8a02\u610f\u51fd\u5f0f\u8655\u7406\u8cc7\u6599.\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src=\\"https://pic2.zhimg.com/80/v2-c619d636a34458a51b375b0ad2cbf7c5_1440w.webp\\"\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n\\nlab 1.\u4f7f\u7528 groupby \u7136\u5f8c\u628a\u91cd\u8907\u7684 name,filePath \u4f75\u6210\u4e00\u500b,\u7136\u5f8c\u628a path \u8ddf name \u8f38\u51fa(\u7b54\u6848\u5f88\u591a,\u9019\u908a\u5beb\u5e7e\u500b)\\n\\n\u6cd5\u3127\u3001\u900f\u904e\u4ee5[\'name\', \'filePath\']\u5206\u7d44,\u4f7f\u7528 agg \u628a\u6b04\u4f4d\u58d3\u6210\u4e00\u500b\uff08\u4e0d\u58d3\u6703\u53ea\u6709\u8a18\u61b6\u9ad4\u4f4d\u7f6e\uff09,\u7136\u5f8c\u628a[\'name\', \'filePath\']\u62ff\u6703\u53bb\u7576\u6b04\u4f4d\\n\\n```\\ngroup_df=df.groupby([\'name\', \'filePath\']).agg({\'start_time\': \'count\'}).reset_index()\\nprint(group_df)\\n          name                                           filePath  start_time\\n0   TM-Zx-1040  /AppliZxations/iMyFone LoZxkWiper.app/Zxontent...           1\\n1  XD-SAS-1045  \\\\DeviZxe\\\\HarddiskVolume5\\\\Users\\\\miriam.lin\\\\AppD...           1\\n2  XD-SAS-1073  \\\\DeviZxe\\\\HarddiskVolume3\\\\Users\\\\DON\\\\Desktop\\\\Nav...           3\\n3   XD-Zx-1073  \\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\I...           1\\n4   XD-Zx-1073  \\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\I...          10\\n\\n# \u6253\u5370\u8868\u4e2d\u6bcf\u884c\u8cc7\u8a0a\\nfor index, row in group_df.iterrows():\\n    print(type(row)) #<class \'pandas.core.series.Series\'>\\n    print(row[\'filePath\'],row[\'name\'])\\n\\n<class \'pandas.core.series.Series\'>\\n/AppliZxations/iMyFone LoZxkWiper.app/Zxontents/MaZxOS/fixiOSLib/FixOS TM-Zx-1040\\n<class \'pandas.core.series.Series\'>\\n\\\\DeviZxe\\\\HarddiskVolume5\\\\Users\\\\miriam.lin\\\\AppData\\\\Roaming\\\\InsLogiZxZxfg\\\\PS\\\\PSDD\\\\9487.exe XD-SAS-1045\\n<class \'pandas.core.series.Series\'>\\n\\\\DeviZxe\\\\HarddiskVolume3\\\\Users\\\\DON\\\\Desktop\\\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe XD-SAS-1073\\n<class \'pandas.core.series.Series\'>\\n\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZx.exe XD-Zx-1073\\n<class \'pandas.core.series.Series\'>\\n\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe XD-Zx-1073\\n\\n```\\n\\nor\\n\\n\u6cd5\u4e8c\u3001\u9019\u6bb5\u7a0b\u5f0f\u78bc\u6703\u5148\u7528 groupby \u65b9\u6cd5\u6309\u7167 \'name\' \u5217\u9032\u884c\u5206\u7d44\uff0c\u7136\u5f8c\u5c0d \'filePath\' \u5217\u9032\u884c\u805a\u5408\u64cd\u4f5c\uff0c\u4f7f\u7528 lambda \u51fd\u6578\u4f86\u5c07\u76f8\u540c\u7684 filePath \u5408\u4f75\u6210\u4e00\u500b\u5b57\u7b26\u4e32\uff0c\u4e26\u5c07\u5b57\u7b26\u4e32\u4e2d\u7684\u91cd\u8907\u503c\u53bb\u9664\u3002\u6700\u5f8c\u7528 sort_index() \u65b9\u6cd5\u5c0d\u7d50\u679c\u9032\u884c\u6392\u5e8f\uff0c\u6309\u7167 \'name\' \u5217\u7684\u5b57\u6bcd\u9806\u5e8f\u6392\u5e8f\u3002\\n\u63a5\u4e0b\u4f86\u7684 for \u5faa\u74b0\uff0c\u5c0d df_join \u4e2d\u7684\u6bcf\u4e00\u884c\u9032\u884c\u8fed\u4ee3\uff0c\u5176\u4e2d index \u662f\u7576\u524d\u884c\u7684\u7d22\u5f15\u503c\uff0crow \u662f\u7576\u524d\u884c\u7684 Series \u5c0d\u8c61\u3002\u5728\u5faa\u74b0\u9ad4\u4e2d\uff0c\u5148\u6253\u5370\u51fa index\uff0c\u7136\u5f8c\u6253\u5370\u51fa row\uff0c\u767c\u73fe row \u662f\u4e00\u500b Series \u5c0d\u8c61\uff0c\u5305\u542b\u4e86\u7576\u524d\u884c\u7684\u6240\u6709\u5217\u3002\\n\\n```\\ndf_join=df.groupby(\'name\').agg({\'filePath\': lambda x: \'\\\\n \'.join(set(x))}).sort_index()\\ndf_join.to_csv(\\"test.csv\\")\\n\\n```\\n\\n\u7d50\u679c\\n\\n```\\nname,filePath\\nTM-Zx-1040,/AppliZxations/iMyFone LoZxkWiper.app/Zxontents/MaZxOS/fixiOSLib/FixOS\\nXD-SAS-1045,\\\\DeviZxe\\\\HarddiskVolume5\\\\Users\\\\miriam.lin\\\\AppData\\\\Roaming\\\\InsLogiZxZxfg\\\\PS\\\\PSDD\\\\9487.exe\\nXD-SAS-1073,\\\\DeviZxe\\\\HarddiskVolume3\\\\Users\\\\DON\\\\Desktop\\\\NaviZxat Keygen PatZxh v5.6.0 DFoX.exe\\nXD-Zx-1073,\\"\\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZxServiZxe.exe\\n \\\\DeviZxe\\\\HarddiskVolume3\\\\Program Files (x86)\\\\IObit\\\\AdvanZxed SystemZxare\\\\ASZx.exe\\"\\n```\\n\\npivot_table \u65b9\u6cd5\u5c07\u8cc7\u6599\u96c6\u6309\u7167\u67d0\u4e9b\u6b04\u4f4d\u9032\u884c\u5206\u985e\uff0c\u4e26\u6839\u64da\u53e6\u4e00\u6b04\u4f4d\u7684\u503c\u4f86\u8a08\u7b97\u532f\u7e3d\u8cc7\u6599\u3002\u4f8b\u5982\uff0c\u6309\u7167\u67d0\u4e00\u6b04\u4f4d\u9032\u884c\u5206\u985e\uff0c\u7136\u5f8c\u8a08\u7b97\u6bcf\u7d44\u7684\u5e73\u5747\u503c\u3002\\n\\n### \u6392\u5e8f\uff08\u5f85\u88dc\\n\\n\u4e3b\u8981\u6709 sort_index \u8ddf sort_values\\n\\n### \u5408\u4f75\uff08\u5f85\u88dc\\n\\nmerge, concat\\n\\n### \u586b\u5145\u7f3a\u5931\u503c\\n\\n\u628a nan \u63db\u6210 0\\ndf.fillna(0, inplace=True)"},{"id":"/2023/04/17/Python/datetime/datetime-guide","metadata":{"permalink":"/blog/2023/04/17/Python/datetime/datetime-guide","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Python/datetime/2023-04-17-datetime-guide.md","source":"@site/blog/Python/datetime/2023-04-17-datetime-guide.md","title":"Python datetime guide","description":"\u8655\u7406\u8cc7\u6599\u5f88\u5e38\u6703\u7528\u5230datetime,\u9019\u908a\u7d00\u9304\u4e00\u4e0b\u4f7f\u7528\u4e0a\u9762\u6703\u7528\u904e\u7684\u65b9\u6cd5,\u4e4b\u5f8c\u7b49\u8cc7\u6599\u9f4a\u5168\u518d\u5f59\u6574.","date":"2023-04-17T00:00:00.000Z","formattedDate":"April 17, 2023","tags":[{"label":"Python","permalink":"/blog/tags/python"},{"label":"datetime","permalink":"/blog/tags/datetime"}],"readingTime":2.555,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"Python datetime guide","description":"\u8655\u7406\u8cc7\u6599\u5f88\u5e38\u6703\u7528\u5230datetime,\u9019\u908a\u7d00\u9304\u4e00\u4e0b\u4f7f\u7528\u4e0a\u9762\u6703\u7528\u904e\u7684\u65b9\u6cd5,\u4e4b\u5f8c\u7b49\u8cc7\u6599\u9f4a\u5168\u518d\u5f59\u6574.","image":"https://github.com/suyuying.png","authors":"suyuying","tags":["Python","datetime"]},"prevItem":{"title":"intro of pandas","permalink":"/blog/2023/04/18/Data Analysis/pandas/intro-of-pandas"},"nextItem":{"title":"aws vpc setting introduction","permalink":"/blog/2023/04/11/Aws/aws-vpc-setting"}},"content":"## \u5e38\u898b datetime \u61c9\u7528\\n\\n### \u65e5\u671f\u4ecb\u65bc\u5e7e\u5929\u4e4b\u9593\\n\\n#### \u7bc4\u4f8b\u4e00.\u65e5\u671f\u4ecb\u65bc\u6628\u65e5\u5230\u4e03\u5929\u524d\\n\\n\u8cc7\u6599`ticket_detail[\'result\'][\'close_time\']`\u4ed6\u7684\u5b57\u4e32\u503c\u662f`2023-04-17 02:36:55`\u9019\u985e,\u662f\u5426\u5c46\u65bc\u6628\u65e5\u5230\u4e03\u5929\u524d,\u662f\u5c31 print yes\\n\\n```\\nformat=datetime.now() #<class \'datetime.datetime\'>\\n\\ntoday = datetime.now().date() #<class \'datetime.date\'>\\n\\nyesterday = today - timedelta(days=1) #<class \'datetime.date\'>\\n\\nseven_days_ago = today - timedelta(days=7) #<class \'datetime.date\'>\\n\\ndate_format = \\"%Y-%m-%d %H:%M:%S\\" #\u628a\u5b57\u4e32\u70ba2023-04-17 02:36:55\u4f9d\u64da\u683c\u5f0f\u63db\u6210datetime.datetime\u7269\u4ef6\\n\\n# \u4f7f\u7528datetime.strptime\u65b9\u6cd5\u628a\u5b57\u4e32\u4f9d\u64da\u683c\u5f0f\u63db\u6210 datetime.datetime\u7269\u4ef6,\u4f7f\u7528date\u65b9\u6cd5\u8b8a\u6210datetime.date\u7269\u4ef6\u9032\u884c\u6bd4\u8f03\\nif seven_days_ago<= datetime.strptime(\\"2023-04-17 02:36:55\\",date_format).date() <= yesterday:\\n    print(\\"yes\\")\\n```\\n\\n:::info\\n\\n- datetime.strptime \u662f\u628a\u5b57\u4e32\u63db\u6210 datetime.datetime \u7269\u4ef6\\n- datetime.strftime()\u662f\u628a datetime.datetime \u7269\u4ef6\u63db\u6210\u683c\u5f0f\u5316\u5b57\u4e32\\n\\n  [\u5b98\u65b9 strftime() and strptime() \u683c\u5f0f\u8f49\u63db](https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior)\\n\\n:::\\n\\n#### \u7bc4\u4f8b\u4e8c:timedelta \u7269\u4ef6\u904b\u7528,\u6191\u8b49\u662f\u5426\u5728\u4eca\u5929\u5230 30 \u5929\u4e4b\u9593\u5230\u671f\\n\\n```\\n# \u5c07\u5230\u671f\u65e5\u671f\u5b57\u4e32\u8f49\u63db\u70ba datetime \u683c\u5f0f\\nvaild_date = datetime.strptime(\\"2023-04-17 02:36:55\\", date_format)\\n\\n# \u53d6\u5f97\u7576\u524d\u6642\u9593\\nnow_time = datetime.now() #2023-04-17 20:33:01.577635\\n\\n# \u8a08\u7b97\u5230\u671f\u65e5\u671f\u8207\u7576\u524d\u6642\u9593\u7684\u6642\u9593\u5dee,\u6ce8\u610f\u9019\u908a\u662ftimedelta\u7269\u4ef6\u56c9\uff01\\nvaild_days = vaild_date - now_time\\n\\n# \u5370\u51fa\u6642\u9593\u5dee\u548c\u6642\u9593\u5dee\u7684\u8cc7\u6599\u578b\u614b\\nprint(vaild_days) #-1 day, 6:11:15.206948\\nprint(type(vaild_days)) #<class \'datetime.timedelta\'>\\n\\n# \u5224\u65b7\u6642\u9593\u5dee\u662f\u5426\u5728 \u7576\u4e0b\u5230 30 \u5929\u4e4b\u9593\u5230\u671f\\nif vaild_days > timedelta(days=0) and vaild_days < timedelta(days=30):\\n    print(vaild_days)\\n    print(\\"ok\\")\\n\\n```\\n\\n:::tip\\n\u6ce8\u610f\uff5e\\n\\n\u4ee5\u4e0a\u9762\u70ba\u4f8b,\u5230\u671f\u6642\u9593\u70ba\\"2023-04-17 02:36:55\\",\u7576\u4e0b\u6642\u9593\u70ba 2023-04-17 20:25:39.793060,\u9019\u7a2e\u60c5\u6cc1\u4e0b\u5f88\u660e\u986f\u5230\u671f\u6642\u9593\u662f\u5c0f\u65bc\u7576\u4e0b\u6642\u9593\u7684,\u76f8\u6e1b\u7d50\u679c\u6703\u662f-1 day, 6:03:53.422373.\\n\\n\u7531\u6b64\u53ef\u77e5,\u53ea\u8981\u524d\u6642\u9593\u5c0f\u65bc\u5f8c\u6642\u9593,\u526a\u51fa\u4f86\u7684 day \u90fd\u6703\u662f\u8ca0\u6578,\u4e5f\u5c31\u662f\u4f60\u7684\u6191\u8b49\u5230\u671f\u4e86\uff01\\n\\n:::\\n\\n\u53e6\u5916,\u5982\u679c\u662f datetime.date \u4e4b\u985e\u7269\u4ef6\u6e1b\u53bb timedelta \u7269\u4ef6,\u662f\u4e0d\u6703\u8b8a\u6210 timedelta \u7269\u4ef6\uff01\\n\\n```\\nvaild_date=datetime.strptime(\\"2023-04-17 02:36:55\\",date_format).date()\\nprint(type(vaild_date-timedelta(days=1))) # <class \'datetime.date\'>\\n```\\n\\n\u5982\u679c\u662f datetime.date \u4e4b\u985e\u7269\u4ef6\u6e1b\u53bb datetime.date \u7269\u4ef6,\u662f\u6703\u8b8a\u6210 timedelta \u7269\u4ef6\u7684\uff01\\n\\n```\\nvaild_date=datetime.strptime(\\"2023-04-17 02:36:55\\",date_format).date()\\nprint(type(datetime.now().date()-vaild_date)) #<class \'datetime.timedelta\'>\\n```\\n\\n\u4f46\u5982\u679c\u662f datetime.datetime \u4e4b\u985e\u7269\u4ef6\u6e1b\u53bb datetime.date \u7269\u4ef6\u6703\u5831\u932f\\n`TypeError: unsupported operand type(s) for -: \'datetime.date\' and \'datetime.datetime\'\\n`\\n:::tip\\ndatetime.datetime \u540c\u985e\u5225\u53ef\u4ee5\u76f8\u6e1b\\n\\ndatetime.date \u540c\u985e\u5225\u53ef\u4ee5\u76f8\u6e1b\\n\\ndatetime.datetime \u4e4b\u985e\u6e1b\u53bb datetime.date \u6703\u5831\u932f\\n\\ndatetime.datetime \u8ddf datetime.date \u90fd\u53ef\u4ee5\u6e1b\u53bb timedelta\\n\\n:::"},{"id":"/2023/04/11/Aws/aws-vpc-setting","metadata":{"permalink":"/blog/2023/04/11/Aws/aws-vpc-setting","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Aws/2023-04-11-aws-vpc-setting.md","source":"@site/blog/Aws/2023-04-11-aws-vpc-setting.md","title":"aws vpc setting introduction","description":"\u5b98\u65b9\u5efa\u8b70\u5927\u591a\u60c5\u6cc1\u90fd\u6703\u9069\u7528 IAM role\uff0c\u4f7f\u7528 IMA role \u7684\u512a\u9ede\u662f\u4ed6\u662f\u4f7f\u7528\u66ab\u6642\u6027\u6191\u8b49(\u53ef\u8a2d\u5b9a\u5230\u671f\u6642\u9593)\uff0c\u800c IAM \u4f7f\u7528\u8005\u7528\u7684\u90fd\u662f\u9577\u671f\u7684 aws_secret_access_key(\u56e0\u6b64\u5b98\u65b9\u6703\u5efa\u8b70\u5b9a\u6642\u63db\uff0c\u4e0d\u904e\u4e00\u822c\u4f86\u8aaa\u6c92\u4eba\u90a3\u9ebc\u52e4\u52de ZZZ)\u3002","date":"2023-04-11T00:00:00.000Z","formattedDate":"April 11, 2023","tags":[{"label":"AWS","permalink":"/blog/tags/aws"}],"readingTime":0.32,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"aws vpc setting introduction","description":"\u5b98\u65b9\u5efa\u8b70\u5927\u591a\u60c5\u6cc1\u90fd\u6703\u9069\u7528 IAM role\uff0c\u4f7f\u7528 IMA role \u7684\u512a\u9ede\u662f\u4ed6\u662f\u4f7f\u7528\u66ab\u6642\u6027\u6191\u8b49(\u53ef\u8a2d\u5b9a\u5230\u671f\u6642\u9593)\uff0c\u800c IAM \u4f7f\u7528\u8005\u7528\u7684\u90fd\u662f\u9577\u671f\u7684 aws_secret_access_key(\u56e0\u6b64\u5b98\u65b9\u6703\u5efa\u8b70\u5b9a\u6642\u63db\uff0c\u4e0d\u904e\u4e00\u822c\u4f86\u8aaa\u6c92\u4eba\u90a3\u9ebc\u52e4\u52de ZZZ)\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["AWS"],"sidebar_position":3},"prevItem":{"title":"Python datetime guide","permalink":"/blog/2023/04/17/Python/datetime/datetime-guide"},"nextItem":{"title":"linux disk management command used commonly","permalink":"/blog/2023/04/11/linux-server/linux-disk-management"}},"content":"## VPC \u57fa\u672c\u4ecb\u7d39\\n\\n\u4e00\u822c\u5730\u7aef\u8981\u8b93\u7db2\u8def\u9032\u5230 server,\u7d50\u69cb\u7c21\u55ae\u7684\u9577\u9019\u6a23\\n\\n```\\ninternet -> Router -> Switch -> server or database\\n```\\n\\n\u8981\u5efa\u7acb\u540c\u6a23\u7684\u7db2\u8def\u904b\u884c\u74b0\u5883\u5728 aws \u8981\u900f\u904e Amazon Virtual Private Cloud(VPC)\\n\\n### \u914d\u7f6e VPC\\n\\n\u6709 subnet\u3001Internet gateway\u3001NAT gateway"},{"id":"/2023/04/11/linux-server/linux-disk-management","metadata":{"permalink":"/blog/2023/04/11/linux-server/linux-disk-management","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/linux-server/2023-04-11-linux-disk-management.md","source":"@site/blog/linux-server/2023-04-11-linux-disk-management.md","title":"linux disk management command used commonly","description":"\u5728\u7ba1\u7406\u4e0a\u6703\u53bb\u6aa2\u8996\u786c\u789f\u4f7f\u7528\u91cf,\u8cc7\u6599\u593e\u8cc7\u6599\u5927\u5c0f,\u5982\u679c\u639b\u786c\u789f\u8ddf\u5378\u4e0b\u786c\u789f\u4e5f\u6703\u6709\u5c08\u7528 command,\u96d6\u7136\u5404\u5bb6\u7533\u8acb\u786c\u789f\u65b9\u5f0f\u4e0d\u4e00\u6a23,\u4f46\u662f linux command \u662f\u53ef\u4ee5\u5171\u7528\u7684\uff01","date":"2023-04-11T00:00:00.000Z","formattedDate":"April 11, 2023","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"disk command","permalink":"/blog/tags/disk-command"},{"label":"aws","permalink":"/blog/tags/aws"}],"readingTime":5.395,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"linux disk management command used commonly","description":"\u5728\u7ba1\u7406\u4e0a\u6703\u53bb\u6aa2\u8996\u786c\u789f\u4f7f\u7528\u91cf,\u8cc7\u6599\u593e\u8cc7\u6599\u5927\u5c0f,\u5982\u679c\u639b\u786c\u789f\u8ddf\u5378\u4e0b\u786c\u789f\u4e5f\u6703\u6709\u5c08\u7528 command,\u96d6\u7136\u5404\u5bb6\u7533\u8acb\u786c\u789f\u65b9\u5f0f\u4e0d\u4e00\u6a23,\u4f46\u662f linux command \u662f\u53ef\u4ee5\u5171\u7528\u7684\uff01","image":"https://github.com/suyuying.png","authors":"suyuying","tags":["linux","disk command","aws"]},"prevItem":{"title":"aws vpc setting introduction","permalink":"/blog/2023/04/11/Aws/aws-vpc-setting"},"nextItem":{"title":"difference between read_repository and read_registry in gitlab","permalink":"/blog/2023/04/07/gitlab-action/difference-between-read-repository-and-read-registry"}},"content":"## disk management command\\n\\n\u5728\u7ba1\u7406\u4e0a\u6703\u53bb\u6aa2\u8996\u786c\u789f\u4f7f\u7528\u91cf,\u8cc7\u6599\u593e\u8cc7\u6599\u5927\u5c0f,\u5982\u679c\u639b\u786c\u789f\u8ddf\u5378\u4e0b\u786c\u789f\u4e5f\u6703\u6709\u5c08\u7528 command\\n\\n`df -h`: \u5217\u51fa\u6240\u6709\u5df2\u639b\u8f09\u7684\u786c\u76e4\u7684\u5206\u5340\u4fe1\u606f\u4ee5\u53ca\u5269\u9918\u7a7a\u9593\u5927\u5c0f,\u7d50\u679c\u9577\u9019\u6a23\\n\\n```\\nFilesystem      Size  Used Avail Use% Mounted on\\ndevtmpfs        7.6G     0  7.6G   0% /dev\\ntmpfs           7.7G     0  7.7G   0% /dev/shm\\ntmpfs           7.7G  801M  6.9G  11% /run\\ntmpfs           7.7G     0  7.7G   0% /sys/fs/cgroup\\n/dev/nvme0n1p1  100G  6.0G   95G   6% /\\n/dev/nvme1n1    300G  7.1G  293G   3% /var/gogo\\ntmpfs           1.6G     0  1.6G   0% /run/user/1000\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n`du -sh *`: \u5217\u51fa\u7576\u524d\u76ee\u9304\u4e0b\u6240\u6709\u6587\u4ef6\u548c\u5b50\u76ee\u9304\u7684\u5927\u5c0f\\n\\n```\\n[root@72slaves ~]# du -sh *\\n0\\t123\\n4.0K\\t123.sh\\n4.0K\\tanaconda-ks.cfg\\n60K\\tapp\\n156K\\tasync-fastapi-mongo\\n2.8M\\tcf-workers-status-page-v1\\n36K\\tdocker\\n......\\n```\\n\\n`lsblk -f`:\u6aa2\u8996\u662f\u5426\u6709\u4efb\u4f55\u78c1\u789f\u5340\u5df2\u5728\u555f\u52d5\u6642\u6620\u5c04\uff0c\u4f46\u5c1a\u672a\u683c\u5f0f\u5316\u548c\u639b\u8f09\u3002 \u4ee5\u4e0b\u662f\u4e00\u822c\u90fd\u6709\u639b\u8f09\u6642.\\n\\n```\\nNAME            FSTYPE      LABEL           UUID                                   MOUNTPOINT\\nsr0             iso9660     CentOS 7 x86_64 2020-04-22-00-54-00-00\\nvda\\n\u251c\u2500vda1          xfs                         68c17843-072c-45ce-b3ea-c48a6eb5317c   /boot\\n\u2514\u2500vda2          LVM2_member                 4GHWpr-dPQk-Dn22-Uhou-uxN4-4ZbT-r9OY0H\\n  \u251c\u2500centos-root xfs                         ff74c584-efb1-40b3-b607-c0f0b5d37fa1   /\\n  \u251c\u2500centos-swap swap                        8d866b90-7445-4ee7-ae20-f3742e5971ec   [SWAP]\\n  \u2514\u2500centos-home xfs                         0119a471-e11b-4803-9c19-42e637ed372a   /home\\n```\\n\\n:::danger\\n\u5982\u679c\u60a8\u8981\u639b\u8f09\u7684\u78c1\u789f\u5340\u5df2\u6709\u8cc7\u6599 (\u4f8b\u5982\uff0c\u5f9e\u5feb\u7167\u5efa\u7acb\u7684\u78c1\u789f\u5340)\uff0c\u8acb\u4e0d\u8981\u4f7f\u7528\u6b64\u547d\u4ee4\u3002\\n\\n`mkfs -t xfs /dev/urdisk`:\u683c\u5f0f\u5316\u786c\u789f\u4e26\u6307\u5b9a\u6a94\u6848\u7cfb\u7d71.\\n\\n:::\\n\\n`mkdir -p /data`:\u5148\u5efa\u7acb\u597d/data \u8cc7\u6599\u593e\\n\\n`mount /dev/urdisk /data`:\u628a\u786c\u789f\u639b\u8f09\u5230/data \u8cc7\u6599\u593e(\u8acb\u5148\u5efa\u7acb\u597d/data \u8cc7\u6599\u593e)\\n\\n`umount /data`:\u7531/data \u5378\u8f09\u786c\u789f\\n\\n### how to mount disk in aws\\n\\n\u4ee5 aws \u70ba\u4f8b,\u8981\u7533\u8acb\u786c\u789f\u4e26\u5728 instance \u4e0a\u7528\u6a5f\u5668\u639b\u8f09\\n\\n1. \u958b\u555f AWS EC2 \u63a7\u5236\u53f0\\n2. \u9078\u64c7\u8981\u639b\u8f09\u786c\u789f\u7684\u5be6\u4f8b\uff0c\u4e26\u5728\u5de6\u5074\u9078\u55ae\u9ede\u64ca\u300cVolumes\u300d\\n3. \u5728\u300cVolumes\u300d\u9801\u9762\u9ede\u64ca\u300cCreate Volume\u300d\\n4. \u8a2d\u5b9a\u786c\u789f\u5927\u5c0f\u3001AZ\u3001\u985e\u578b\u7b49\u8cc7\u8a0a\uff0c\u4e26\u9ede\u64ca\u300cCreate Volume\u300d\\n5. \u7b49\u5f85\u786c\u789f\u5275\u5efa\u5b8c\u6210\\n6. \u5728\u300cVolumes\u300d\u9801\u9762\u52fe\u9078\u525b\u525b\u5275\u5efa\u7684\u786c\u789f\uff0c\u9ede\u64ca\u300cActions\u300d\uff0c\u9078\u64c7\u300cAttach Volume\u300d\\n7. \u5728\u300cAttach Volume\u300d\u5f48\u51fa\u6846\u4e2d\u9078\u64c7\u8981\u639b\u8f09\u786c\u789f\u7684 EC2 \u5be6\u4f8b\uff0c\u4ee5\u53ca\u8a2d\u5b9a\u639b\u8f09\u8def\u5f91\u548c\u88dd\u7f6e\u540d\u7a31\\n8. \u9ede\u64ca\u300cAttach\u300d\\n9. \u767b\u5165 EC2 \u5be6\u4f8b\uff0c\u57f7\u884c\u6307\u4ee4 lsblk -f \u78ba\u8a8d\u786c\u789f\u662f\u5426\u639b\u8f09\u6210\u529f,\u53bb\u627e\u90a3\u500b\u6c92\u6709 FSTYPE \u7684 NAME,EX:\\n\\n```\\nNAME\\t\\tFSTYPE\\tLABEL\\tUUID\\t\\t\\t\\t\\t\\tMOUNTPOINT\\nnvme1n1\\t        xfs\\t\\t7f939f28-6dcc-4315-8c42-6806080b94dd\\nnvme0n1\\n\u251c\u2500nvme0n1p1\\txfs\\t    /\\t90e29211-2de8-4967-b0fb-16f51a6e464c\\t        /\\n\u2514\u2500nvme0n1p128\\nnvme2n1\\n```\\n\\n10. \u5982\u679c\u786c\u789f\u9084\u6c92\u6709\u683c\u5f0f\u5316\uff0c\u57f7\u884c\u6307\u4ee4 sudo mkfs -t xfs /dev/xvdf \u683c\u5f0f\u5316\u786c\u789f\uff08\u5047\u8a2d\u786c\u789f\u88dd\u7f6e\u540d\u7a31\u662f /dev/xvdf\uff09\\n11. \u5efa\u7acb\u8981\u639b\u8f09\u786c\u789f\u7684\u76ee\u9304\uff0c\u4f8b\u5982 sudo mkdir /data\\n12. \u5c07\u786c\u789f\u639b\u8f09\u5230\u76ee\u9304\u4e0a\uff0c\u4f8b\u5982 sudo mount /dev/xvdf /data\\n13. \u78ba\u8a8d\u639b\u8f09\u6210\u529f\uff0c\u57f7\u884c\u6307\u4ee4 df -h \u67e5\u770b\u786c\u789f\u4f7f\u7528\u60c5\u6cc1\\n14. \u7528 lsblk -f \u53bb\u770b UUID\\n15. \u82e5\u8981\u5728\u6bcf\u6b21\u7cfb\u7d71\u958b\u6a5f\u6642\u639b\u8f09\u9023\u63a5\u7684 EBS \u78c1\u789f\u5340,\u5148\u7528 lsblk -f \u770b UUID,\u4e26 vim /etc/fstab \u52a0\u5165\u4ee5\u4e0b(UUID \u63db\u6210\u81ea\u5df1\u7684).\\n\\n```\\nUUID=aebf131c-6957-451e-8d34-ec978d9581ae  /data  xfs  defaults  0  2\\n```\\n\\n:::info\\n\u5728\u4ee5\u4e0a\u7bc4\u4f8b\u4e2d\uff0c\u5c07 UUID aebf131c-6957-451e-8d34-ec978d9581ae \u7684\u88dd\u7f6e\u639b\u8f09\u81f3\u639b\u8f09\u9ede /data\uff0c\u4e26\u4f7f\u7528 xfs \u6a94\u6848\u7cfb\u7d71.\\n\\n\u7b2c\u56db\u6b04\u662f\u6a94\u6848\u7cfb\u7d71\u53c3\u6578,\u53ef\u4ee5\u4e0a\u7db2\u67e5\u500b\u9078\u9805\uff01\\n\\n\u7b2c\u4e94\u6b04\u662f dump,dump \u6703\u6839\u64da\u9019\u500b\u8a2d\u5b9a\u6c7a\u5b9a\u662f\u5426\u9700\u8981\u5099\u4efd\uff0c\u4e00\u822c\u70ba 0, \u5373\u4e0d\u5099\u4efd\uff1b1 \u70ba\u6bcf\u65e5\u5099\u4efd\uff1b2 \u70ba\u9694\u65e5\u5099\u4efd,dump \u50c5\u652f\u63f4 EXT \u5bb6\u65cf\uff0c\u82e5\u4f7f\u7528 xfs \u6a94\u6848\u7cfb\u7d71\uff0c\u5247\u4e0d\u7528\u8003\u616e dump \u9805\u76ee\u3002\u56e0\u6b64\u76f4\u63a5\u8f38\u5165 0 \u5373\u53ef\u3002\\n\\n\u7b2c\u516d\u6b04\uff1a fsck \uff0c\u65e9\u671f\u958b\u6a5f\u7684\u6d41\u7a0b\u4e2d\uff0c\u6703\u6709\u4e00\u6bb5\u6642\u9593\u53bb\u6aa2\u9a57\u672c\u6a5f\u7684\u6a94\u6848\u7cfb\u7d71\uff0c\u770b\u770b\u6a94\u6848\u7cfb\u7d71\u662f\u5426\u5b8c\u6574 (clean)\u3002 \u4e0d\u904e\u9019\u500b\u65b9\u5f0f\u4f7f\u7528\u7684\u4e3b\u8981\u662f\u900f\u904e fsck \u53bb\u505a\u7684\uff0c\u6211\u5011\u73fe\u5728\u7528\u7684 xfs \u6a94\u6848\u7cfb\u7d71\u5c31\u6c92\u6709\u8fa6\u6cd5\u9069\u7528\uff0c\u56e0\u70ba xfs \u6703\u81ea\u5df1\u9032\u884c\u6aa2\u9a57\uff0c\u4e0d\u9700\u8981\u984d\u5916\u9032\u884c\u9019\u500b\u52d5\u4f5c\uff01\u6240\u4ee5\u76f4\u63a5\u586b 0 \u5c31\u597d\u4e86\u3002(\u4ee5\u4e0a\u56db\u4e94\u516d\u9805\u5167\u5bb9\u53c3\u8003\u81ea[\u9ce5\u54e5](https://linux.vbird.org/linux_basic_train/centos7/unit06.php#6.2))\\n:::\\n\\n16. \u6aa2\u67e5\u662f\u5426\u6709\u639b\u8f09\u6210\u529f\\n\\n```\\n# Verify mount disk successfully\\numount /data\\nmount -a\\n```\\n\\n### how to umount disk in aws\\n\\n0. \u5148\u505a\u597d\u5099\u4efd\uff0c\u5982\u679c\u505a\u932f\u4e86\uff0c\u8a72\u600e\u9ebc\u9084\u539f\u8981\u5148\u60f3\u597d\\n1. \u6aa2\u67e5\u8a72 300G \u662f\u5426\u6709\u88ab\u555f\u52d5\u7684\u670d\u52d9\u4f7f\u7528\u5230 \u6307\u4ee4 ex.`lsof /dev/vda1`\\n2. \u505c\u6389\u76f8\u95dc\u6709\u4f7f\u7528\u7684\u670d\u52d9\\n3. \u5c07\u8a72 300G \u7684\u786c\u789f umount \u6389 ex.`umount /data`\\n4. \u6aa2\u67e5/etc/fstab \u4e0a\u6709\u7121\u8a2d\u5b9a\u639b\u8f09\u90a3 300G \u786c\u789f\\n5. \u5c07/etc/fstab \u6709\u8a2d\u5b9a\u7684\u90a3 300G \u8a3b\u89e3\u6389\\n6. \u4e0b mount -a \u6aa2\u67e5\u6709\u6c92\u6709\u78ba\u5be6\u62ff\u6389\uff0c\u9019\u6a23\u5728\u4e0b\u6b21\u91cd\u958b\u6a5f\u5c31\u4e0d\u6703\u5728\u5403\u5230\u7684\\n7. \u5f9e AWS \u4e0a\u76f4\u63a5\u628a\u90a3\u9846\u786c\u789f\u505a\u522a\u9664\\n\\n### Brief summary\\n\\n\u5404\u5bb6\u7533\u8acb\u786c\u789f\u65b9\u5f0f\u4e0d\u4e00\u6a23,\u4f46\u662f linux command \u662f\u53ef\u4ee5\u5171\u7528\u7684\uff01"},{"id":"/2023/04/07/gitlab-action/difference-between-read-repository-and-read-registry","metadata":{"permalink":"/blog/2023/04/07/gitlab-action/difference-between-read-repository-and-read-registry","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/gitlab-action/2023-04-07-difference-between-read-repository-and-read-registry.md","source":"@site/blog/gitlab-action/2023-04-07-difference-between-read-repository-and-read-registry.md","title":"difference between read_repository and read_registry in gitlab","description":"\u5728gitlab\u88e1,read_repository \u4e3b\u8981\u662f\u8b93\u4f60\u53ea\u80fd\u6293 image \u4e0b\u4f86,read_repository \u5247\u662f\u53ef\u4ee5\u6aa2\u67e5 repo \u88e1\u9762\u6240\u6709\u5206\u652f,commit \u7b49,\u4e26\u53ef\u4ee5 clone repository,\u4f46\u4e0d\u80fd push!","date":"2023-04-07T00:00:00.000Z","formattedDate":"April 7, 2023","tags":[{"label":"gitlab action","permalink":"/blog/tags/gitlab-action"},{"label":"CICD","permalink":"/blog/tags/cicd"}],"readingTime":0.72,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"difference between read_repository and read_registry in gitlab","description":"\u5728gitlab\u88e1,read_repository \u4e3b\u8981\u662f\u8b93\u4f60\u53ea\u80fd\u6293 image \u4e0b\u4f86,read_repository \u5247\u662f\u53ef\u4ee5\u6aa2\u67e5 repo \u88e1\u9762\u6240\u6709\u5206\u652f,commit \u7b49,\u4e26\u53ef\u4ee5 clone repository,\u4f46\u4e0d\u80fd push!","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["gitlab action","CICD"]},"prevItem":{"title":"linux disk management command used commonly","permalink":"/blog/2023/04/11/linux-server/linux-disk-management"},"nextItem":{"title":"CI:gitlab basic intro about  CI/CD, build image and push to git-lab container","permalink":"/blog/2023/04/06/gitlab-action/gitlab-basic-intro-dind-build-image"}},"content":"## gitlab \u6b0a\u9650\u7ba1\u7406\\n\\ngitlab \u6709\u4e00\u5806\u6b0a\u9650\u7ba1\u7406\u6771\u6771,[\u8a73\u60c5](https://docs.gitlab.com/ee/user/profile/personal_access_tokens.html#personal-access-token-scopes),\u900f\u904e\u9069\u7576\u7684\u8a2d\u8a08\u4f86\u5b89\u5168\u6b0a\u9650\u7d66\u4e88.\\n\\n\u9019\u908a\u8aaa\u4e00\u4e0b\u4e4b\u524d\u9047\u5230\u7684\u554f\u984c,read_repository and read_registry \u5dee\u5225\u5728\u54ea\u88e1!\u5b98\u65b9\u89e3\u91cb\u5c0d\u500b\u5225\u89e3\u91cb\u5982\u4e0b:\\n\\n`read_registry`-Grants read-only (pull) access to a Container Registry images if a project is private and authorization is required. Available only when the Container Registry is enabled.\\n\\n`read_repository`-Grants read-only access to repositories on private projects using Git-over-HTTP or the Repository Files API.\\n\\n\u5c0f\u7d50:read_registry \u4e3b\u8981\u662f\u8b93\u4f60\u53ea\u80fd\u6293 image \u4e0b\u4f86,read_repository \u5247\u662f\u53ef\u4ee5\u6aa2\u67e5 repo \u88e1\u9762\u6240\u6709\u5206\u652f,commit \u7b49,\u4e26\u53ef\u4ee5 clone repository,\u4f46\u4e0d\u80fd push!"},{"id":"/2023/04/06/gitlab-action/gitlab-basic-intro-dind-build-image","metadata":{"permalink":"/blog/2023/04/06/gitlab-action/gitlab-basic-intro-dind-build-image","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/gitlab-action/2023-04-06-gitlab-basic-intro-dind-build-image.md","source":"@site/blog/gitlab-action/2023-04-06-gitlab-basic-intro-dind-build-image.md","title":"CI:gitlab basic intro about  CI/CD, build image and push to git-lab container","description":"\u4ecb\u7d39\u5b98\u7db2\u8cc7\u6599,\u4e26\u63d0\u4f9bgitlab ci\u4f7f\u7528\u7bc4\u4f8b,\u88dc\u5145alpine/git:latest\u8981\u7528script\u8981\u7528\u5230\u7684entrypoint[\\"\\"]","date":"2023-04-06T00:00:00.000Z","formattedDate":"April 6, 2023","tags":[{"label":"gitlab action","permalink":"/blog/tags/gitlab-action"},{"label":"CICD","permalink":"/blog/tags/cicd"}],"readingTime":9.995,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"CI:gitlab basic intro about  CI/CD, build image and push to git-lab container","description":"\u4ecb\u7d39\u5b98\u7db2\u8cc7\u6599,\u4e26\u63d0\u4f9bgitlab ci\u4f7f\u7528\u7bc4\u4f8b,\u88dc\u5145alpine/git:latest\u8981\u7528script\u8981\u7528\u5230\u7684entrypoint[\\"\\"]","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["gitlab action","CICD"]},"prevItem":{"title":"difference between read_repository and read_registry in gitlab","permalink":"/blog/2023/04/07/gitlab-action/difference-between-read-repository-and-read-registry"},"nextItem":{"title":"Do Internet gateways and modem need to be used together?","permalink":"/blog/2023/03/30/Others/modemVSigw"}},"content":"## basic tutorial\\n\\n[\u4ee5\u4e0b\u51fa\u81ea\u5b98\u7db2](https://docs.gitlab.com/ee/ci/#concepts). \u4e3b\u8981\u4ecb\u7d39\u5e7e\u500b\u5927\u65b9\u5411.\\n\\n### Concepts\\n\\n- Pipelines: CI/CD \u900f\u904e pipeline \u5efa\u7acb\u3002\\n- CI/CD variables: \u6709 GitLab [\u9810\u8a2d\u8b8a\u6578](https://docs.gitlab.com/ee/ci/variables/predefined_variables.html)\uff08\u53ef\u4ee5\u5728 script \u7528 export \u53d6\u5f97\uff09\u3001\u81ea\u5b9a\u7fa9\u74b0\u5883\u8b8a\u6578\u548c[secure files](https://docs.gitlab.com/ee/ci/secure_files/)\u3002\\n- Environments: \u8981\u628a\u61c9\u7528\u90e8\u7f72\u5728\u4e0d\u540c\u74b0\u5883\u8981\u4f7f\u7528\u3002\\n- Job artifacts: \u7a0b\u5f0f\u904e\u7a0b\u4e2d\u57f7\u884c\u7684\u7522\u7269\uff08\u4f8b\u5982 xxx.csv\uff09\u6a94\u6848\u7684\u8f38\u51fa\u4ee5\u53ca\u5176\u4ed6 job \u4f7f\u7528\u7b49\u3002\\n- Cache dependencies: \u4f7f\u7528 cache \u95dc\u9375\u5b57\u53ef\u4ee5\u5e6b\u52a9\u6e1b\u5c11 pipeline \u7684\u904b\u884c\u6642\u9593\uff0c\u63d0\u9ad8 CI/CD \u6548\u7387\u3002\u901a\u904e\u7de9\u5b58\u4f9d\u8cf4\u9805\uff0c\u53ef\u4ee5\u907f\u514d\u5728\u6bcf\u6b21\u904b\u884c pipeline \u6642\u90fd\u5f9e\u982d\u958b\u59cb\u5b89\u88dd\u76f8\u540c\u7684\u4f9d\u8cf4\u9805\u3002\\n- GitLab Runner: \u8a2d\u5b9a\u57f7\u884c\u9019\u500b pipeline \u7684\u8a08\u7b97\u6a5f\u3002\\n- Pipeline efficiency: \u5728 pipeline \u904e\u7a0b\u4e2d\u4e5f\u6703\u9047\u5230\u4e00\u4e9b\u7169\u4eba\u7684\u554f\u984c\uff0c\u4f8b\u5982\u904b\u884c\u4e86\u4e00\u5206\u9418\u624d\u5931\u6557\uff0c\u9700\u8981\u591a\u6b21\u67e5\u770b\u7b49\u3002\u5982\u4f55\u63d0\u9ad8\u6548\u7387\u5462\uff1f\u53ef\u4ee5\u4f7f\u7528\u7de9\u5b58\u3001\u7e2e\u6e1b\u8981\u62c9\u7684\u6620\u50cf\u6a94\u5927\u5c0f\u3001\u4f7f\u7528\u898f\u5247\u4ee5\u53ca `only`/`except` \u95dc\u9375\u5b57\u4f86\u63a7\u5236\u4f5c\u696d\u5728\u4f55\u6642\u548c\u4f55\u8655\u904b\u884c\u3002\\n- Test cases: \u5728\u6e2c\u8a66\u5e73\u53f0\u4e0a\u5efa\u7acb\u6e2c\u8a66\u60c5\u5883\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n### Configuration\\n\\n\u53ef\u4ee5\u8a2d\u5b9a\u7684\u5167\u5bb9.\\n\\n- Schedule pipelines: \u6392\u7a0b\\n- Custom path for .gitlab-ci.yml: \u5ba2\u88fd\u5316\u8def\u5f91\\n- Git submodules for CI/CD: \u5982\u679c\u4f60\u8981\u7528\u5176\u4ed6 repo \u8cc7\u6599\u53ef\u4ee5\u7528\u9019\u500b\\n- SSH keys for CI/CD: \u5982\u679c\u4f60\u8981\u5728\u76ee\u6a19 server \u4e0a\u9762\u90e8\u7f72\u7a0b\u5f0f\uff0c\u5728\u4f7f\u7528 gitlab runner \u662f docker containers \u60c5\u6cc1\u4e0b\uff0c\u9700\u8981\u5efa\u7acb SSH \u516c\u79c1\u9470\uff0c\u4ee5\u4fbf container \u900f\u904e ssh \u9023\u7dda\u4e26\u90e8\u7f72\u3002\\n- Pipeline triggers: \u9700\u8981\u7528 webhook \u65b9\u5f0f\u547c\u559a pipline \u6642\u4f7f\u7528\\n- Merge request pipelines: \u5982\u679c\u662f\u8981\u5728\u767c\u51fa merge \u8acb\u6c42\u6642\u8dd1\u7684 pipline \u8981\u53e6\u5916\u8a2d\u5b9a\\n- Integrate with Kubernetes clusters\uff1a\u9023 k8s \u8981\u7528\u7684\u8a2d\u5b9a\\n- Optimize GitLab and GitLab Runner for large repositories: \u512a\u5316 pipline \u539f\u5247\\n- .gitlab-ci.yml full reference\uff1a.gitlab-ci.yml \u88e1\u9762\u6709\u4e00\u5927\u5806\u53ef\u4ee5\u7528\u7684[\u8a2d\u5b9a\u95dc\u9375\u5b57](https://docs.gitlab.com/ee/ci/yaml/index.html)\\n\\n### .gitlab-ci.yml \u914d\u7f6e\u53c2\u6570\\n\\n[stages](https://docs.gitlab.com/ee/ci/yaml/index.html#stages)- \u9ed8\u8a8d\u6709 build\u3001test\u3001deploy \u4e09\u968e\u7aef,\u5982\u679c\u6709\u5de5\u4f5c\u672a\u6a19\u8a18 stage \u5247\u4f7f\u7528 test\uff0c\u76f8\u540c stage \u4e26\u884c\u904b\u884c\uff0c\u9ed8\u8a8d\u4e0a\u4e00\u500b stage \u5b8c\u6210\u624d\u6703\u63a5\u4e0b\u4e00\u500b stage\uff0c\u4e14\u524d\u4e00\u968e\u6bb5 stage \u7684\u5931\u6557\u7684\u8a71\uff0c\u4e0b\u4e00\u968e\u6bb5\u4e0d\u6703\u57f7\u884c\uff0c\u4e14\u6a19\u8a18\u8a72 commit \u662f failed.\\n\\n`stage`- \u63cf\u8ff0 stages \u4e2d\u5b9a\u7fa9\u7684 stage\uff0c\u4f9d\u5e8f\u57f7\u884c\uff0c\u540c stage \u6703\u4f75\u767c\u57f7\u884c.\\n\\n`only`- \u78ba\u5b9a\u4e86\u54ea\u4e9b\u5206\u652f\u6216\u6a19\u7c64(branches and tags)\u7684\u5de5\u4f5c\u6703\u904b\u884c\\n\\n`except`- \u78ba\u5b9a\u4e86\u54ea\u4e9b\u5206\u652f\u6216\u6a19\u7c64(branches and tags)\u7684\u5de5\u4f5c\u4e0d\u6703\u904b\u884c\\n\\n`only` `except`-\u53ef\u4ee5\u540c\u6642\u5b9a\u7fa9\uff0c\u6709\u885d\u7a81\u4ee5 only \u70ba\u4e3b\uff0c\u652f\u63f4\u6b63\u5247\uff0c\u6709\u4ee5\u4e0b key word \u53ef\u4ee5\u4f7f\u7528\\n\\n| Value                  | Description                                                                                                                                    |\\n| ---------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------- |\\n| api                    | For pipelines triggered by the pipelines API.                                                                                                  |\\n| branches               | When the Git reference for a pipeline is a branch.                                                                                             |\\n| chat                   | For pipelines created by using a GitLab ChatOps command.                                                                                       |\\n| external               | When you use CI services other than GitLab.                                                                                                    |\\n| external_pull_requests | When an external pull request on GitHub is created or updated (See Pipelines for external pull requests).                                      |\\n| merge_requests         | For pipelines created when a merge request is created or updated. Enables merge request pipelines, merged results pipelines, and merge trains. |\\n| pipelines              | For multi-project pipelines created by using the API with CI_JOB_TOKEN, or the trigger keyword.                                                |\\n| pushes                 | For pipelines triggered by a git push event, including for branches and tags.                                                                  |\\n| schedules              | For scheduled pipelines.                                                                                                                       |\\n| tags                   | When the Git reference for a pipeline is a tag.                                                                                                |\\n| triggers               | For pipelines created by using a trigger token.                                                                                                |\\n| web                    | For pipelines created by selecting Run pipeline in the GitLab UI, from the project\u2019s CI/CD > Pipelines section.                                |\\n\\n```jsx title=\u6b63\u5247\u7bc4\u4f8b\\njob:\\n  # use regexp\\n  only:\\n    - /^issue-.*$/\\n  # use special keyword\\n  except:\\n    - branches\\n\\n```\\n\\n`when`-\u7576\u4f5c\u696d fail \u6216\u6545\u969c\u6642\u904b\u884c\\n`environment`- \u7528\u65bc\u5c07\u60a8\u7684\u61c9\u7528\u7a0b\u5e8f\u90e8\u7f72\u5230\u7279\u5b9a\u7684\u74b0\u5883\u4e2d\u3002\u900f\u904e\u57f7\u884c\u8173\u672c\u7b49\u529f\u80fd\u9054\u6210\\n\\n```\\ndeploy:\\n  stage: deploy\\n  script:\\n    - deploy_to_production.sh\\n  environment:\\n    name: production\\n    url: https://example.com\\n  only:\\n    - master\\n```\\n\\n`artifacts`- \u6307\u5b9a\u5c07\u54ea\u4e9b\u6587\u4ef6\u9644\u52a0\u5230\u4f5c\u696d\u4e2d\\n`dependencies` - \u50b3\u905e\u7522\u751f\u7684 artifacts\\n\\n\u4ee5\u4e0a\u662f\u4e00\u4e9b\u5e38\u7528\u7684 key word.\\n\\n### gitlab CI working directory\\n\\n:::tip\\n\u4e00\u822c\u9810\u8a2d\u5de5\u4f5c\u76ee\u9304\u90fd\u662f\u5728/builds \u8cc7\u6599\u593e\u5e95\u4e0b\uff0c\u4ed6\u6703\u628a\u4f60 git repo \u7684\u6771\u897f clone \u5230\u6bcf\u500b img \u7684 build \u8cc7\u6599\u593e\u88e1\u9762,\u6240\u4ee5\u5de5\u4f5c\u76ee\u9304\u57fa\u672c\u4e0a\u5728/builds/$CI_PROJECT_NAMESPACE/$CI_PROJECT_NAME \u88e1\u9762,\u7528\u8aaa\u7684\u5f88\u96e3\u61c2,\u6539\u7528\u8209\u4f8b\u5427:\\n\u5982\u679c namespace \u662f it, repo \u540d\u7a31\u4e5f\u6703\u662f nginx-log-session-clear,\u6240\u4ee5\u5de5\u4f5c\u76ee\u9304\u6703\u5728/builds/it/nginx-log-session-clear \u5e95\u4e0b,\u4e5f\u5c31\u662f CI_PROJECT_DIR=\'/builds/it/nginx-log-session-clear\',\u5167\u5bb9\u6703\u662f\u4f60\u7684 git repo \u5167\u5bb9.\\n\\n\u4e5f\u53ef\u4ee5\u5728 script \u88e1\u9762\u7528 export \u6c42\u8b49\u6b50\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./CI_DIR_GITLAB.png\\").default}\\n      alt=\\"CI_WORK_DIR_GITLAB.png\\"\\n    />\\n  </div>\\n</>\\n:::\\n\\n## basic example\\n\\n\u4ee5\u4e0b\u662f\u7bc4\u4f8b\u61c9\u7528,CI \u5efa\u7acb image \u4e26\u63a8\u5012 container registry\\n\\n```jsx title=\\".gitlab-ci.yml\\"\\nvariables:\\n    IMAGE_NAME: vmnotconnect\\n    CI_IMAGE: $CI_REGISTRY_IMAGE/$IMAGE_NAME:$CI_COMMIT_SHORT_SHA\\n# \u69cb\u5efa moni\\nbuild-img:\\n  # \u5b9a\u7fa9 job \u6240\u5728\u7684\u968e\u6bb5\\n  stage: build\\n  # \u5b9a\u7fa9 job \u6240\u4f7f\u7528\u7684 Docker \u93e1\u50cf\\n  image: docker:dind\\n  # \u5b9a\u7fa9 Runner \u6a19\u7c64,\u6c92\u6709\u5c0d\u61c9\u5230runner tag\u6703\u5831\u932f\\n  tags:\\n    - docker\\n  # \u5728\u57f7\u884c job \u4e4b\u524d\u8981\u57f7\u884c\u7684\u547d\u4ee4\\n  before_script:\\n    # \u4f7f\u7528\u5167\u5efa\u8b8a\u6578\u767b\u5165 GitLab \u5bb9\u5668\u5009\u5eab,\u62ff\u5230\u6700\u5916\u5c64\u6703\u56e0\u70ba\u6c92\u6709docker \u6307\u4ee4\u800c\u5831\u932f\\n    - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY\\n  # \u5b9a\u7fa9 job \u7684\u5be6\u969b\u57f7\u884c\u5167\u5bb9\\n  script:\\n    # \u4f7f\u7528 Docker \u69cb\u5efa\u60a8\u7684\u61c9\u7528\u7a0b\u5e8f\uff0c\u4e26\u5c07\u5176\u547d\u540d\u70ba $CI_IMAGE\\n    - docker build . -t $CI_IMAGE\\n    # \u5c07 Docker \u93e1\u50cf\u63a8\u9001\u5230 GitLab \u7684\u5bb9\u5668\u5009\u5eab\\n    - docker push $CI_IMAGE\\n    # \u522a\u9664\u672c\u5730\u6a5f\u5668\u4e0a\u7684 Docker \u93e1\u50cf\\n    - docker rmi $CI_IMAGE\\n  # \u5b9a\u7fa9\u4e0d\u57f7\u884c\u8a72 job \u7684\u60c5\u6cc1\\n  except:\\n    # \u4e0d\u5728\u9810\u5b9a\u7684\u4efb\u52d9\u548c\u6a19\u7c64\u63d0\u4ea4\u6642\u57f7\u884c\\n    - schedules\\n    - tags\\n\\n```\\n\\n\u4ee5\u4e0b\u662f\u7bc4\u4f8b\u61c9\u7528,\u628a\u7a0b\u5f0f\u57f7\u884c\u5f8c\u7522\u751f\u7684\u6a94\u6848\uff0c\u4ee5\u57f7\u884c\u7576\u4e0b\u6642\u9593\u6253 tag \u4e26\u63a8\u5012 git repo\\n\\n```\\nstages:\\n  - runCode  # \u904b\u884c\u4ee3\u78bc\u7684\u968e\u6bb5\\n  - addFinalCsvToGit  # \u5c07\u7d50\u679c\u63d0\u4ea4\u5230 Git \u968e\u6bb5\\n\\n# \u5b9a\u7fa9\u904b\u884c\u4f5c\u696d\u524d\u8981\u904b\u884c\u7684\u4efb\u4f55\u8173\u672c\\nbefore_script:\\n  - export COMMIT_TIME=$(date  +\'%Y-%-m-%-d-%H-%M\')  # \u5efa\u7acb\u74b0\u5883\u8b8a\u6578\u4ee5\u5b9a\u7fa9git\u63d0\u4ea4\u7684\u6642\u9593\\n\\n# \u5b9a\u7fa9\u4e00\u500b\u4f5c\u696d\uff0c\u5b83\u5728 `runCode` \u968e\u6bb5\u904b\u884c\\nrunCodeToTg:\\n  stage: runCode  # \u8a2d\u5b9a\u4f5c\u696d\u6240\u8655\u7684\u968e\u6bb5\\n  image:  # \u8a2d\u5b9a\u4f5c\u696d\u4f7f\u7528\u7684 Docker \u6620\u50cf\u6a94\\n    name: python:3.11-slim\\n  only:  # \u8a2d\u5b9a\u4f5c\u696d\u5728\u54ea\u4e9b\u60c5\u6cc1\u4e0b\u904b\u884c\\n    changes:  # \u53ea\u6709\u7576\u6307\u5b9a\u76ee\u9304\u4e2d\u7684\u6587\u4ef6\u767c\u751f\u8b8a\u5316\u6642\u624d\u904b\u884c\\n      - nginx-log/*\\n  # except:  # \u5982\u679c\u5e0c\u671b\u6392\u9664\u67d0\u4e9b\u60c5\u6cc1\u4e0b\u4e0d\u904b\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528 except \u5b57\u6bb5\\n  #   - schedules\\n  #   - tags\\n  tags:  # \u4f7f\u7528 Docker \u6a19\u7c64\u9650\u5236\u4f5c\u696d\u5728\u54ea\u4e9b Runner \u4e0a\u904b\u884c,\u6c92\u6709\u5c0d\u61c9\u7684runner\u5c31\u4e0d\u6703\u57f7\u884c\\n    - docker\\n  script:  # \u5b9a\u7fa9\u4f5c\u696d\u6240\u9700\u904b\u884c\u7684\u547d\u4ee4\\n    - pip install --no-cache-dir -r ./requirment.txt  # \u5b89\u88dd\u4f9d\u8cf4\u5eab\\n    - python3 main.py  # \u57f7\u884c\u4ee3\u78bc\\n    - ls  # \u67e5\u770b\u7576\u524d\u76ee\u9304\\n    - pwd  # \u67e5\u770b\u7576\u524d\u5de5\u4f5c\u76ee\u9304\\n  artifacts:  # \u5b9a\u7fa9\u4f5c\u696d\u8981\u4fdd\u5b58\u7684\u7522\u7269\\n    paths:\\n      - history/  # \u4fdd\u5b58 history \u76ee\u9304\\n\\n# \u5b9a\u7fa9\u4e00\u500b\u4f5c\u696d\uff0c\u5b83\u5728 `addFinalCsvToGit` \u968e\u6bb5\u904b\u884c\\naddGitFile:\\n  stage: addFinalCsvToGit  # \u8a2d\u5b9a\u4f5c\u696d\u6240\u8655\u7684\u968e\u6bb5\\n  image:  # \u8a2d\u5b9a\u4f5c\u696d\u4f7f\u7528\u7684 Docker \u6620\u50cf\u6a94\\n    name: alpine/git:latest\\n    entrypoint: [\\"\\"]  # \u8a2d\u5b9aimage run \u8d77\u4f86\u57f7\u884c\u7684\u7a0b\u5f0f\u78bc\\n  only:  # \u8a2d\u5b9a\u4f5c\u696d\u5728\u54ea\u4e9b\u60c5\u6cc1\u4e0b\u904b\u884c\\n    changes:  # \u53ea\u6709\u7576\u6307\u5b9a\u76ee\u9304\u4e2d\u7684\u6587\u4ef6\u767c\u751f\u8b8a\u5316\u6642\u624d\u904b\u884c\\n      - nginx-log/*\\n  # except:  # \u5982\u679c\u5e0c\u671b\u6392\u9664\u67d0\u4e9b\u60c5\u6cc1\u4e0b\u4e0d\u904b\u884c\uff0c\u53ef\u4ee5\u4f7f\u7528 except \u5b57\u6bb5\\n  #   - schedules\\n  #   - tags\\n  tags:  # \u4f7f\u7528 Docker \u6a19\u7c64\u9650\u5236\u4f5c\u696d\u5728\u54ea\u4e9b Runner \u4e0a\u904b\u884c\\n    - docker\\n  script:\\n    - ls  # \u5217\u51fa\u7576\u524d\u76ee\u9304\u7684\u5167\u5bb9\\n    - export  # \u67e5\u770b\u6240\u6709\u7684\u74b0\u5883\u8b8a\u91cf\\n    - pwd  # \u67e5\u770b\u7576\u524d\u5de5\u4f5c\u76ee\u9304\u7684\u8def\u5f91\\n    - git config --global user.name \\"ford\\"  # \u8a2d\u7f6e Git \u5168\u5c40\u7528\u6236\u540d\\n    - git config --global user.email \\"ford\\"  # \u8a2d\u7f6e Git \u5168\u5c40\u7528\u6236\u90f5\u7bb1\\n    - git add .  # \u6dfb\u52a0\u7576\u524d\u76ee\u9304\u4e2d\u7684\u6240\u6709\u66f4\u6539\u5230 Git \u5009\u5eab\\n    - git commit -m \'test\' || echo \\"No changes, nothing to commit!\\"  # \u63d0\u4ea4\u66f4\u6539\\n    - git tag $COMMIT_TIME  # \u70ba\u63d0\u4ea4\u6253\u6a19\u7c64\\n    - git push https://${ciname}:${cicode}@gitlab.go2cloudten.com/it/nginx-log-session-clear.git $COMMIT_TIME  # \u63a8\u9001\u66f4\u6539\u5230 Git \u5009\u5eab\\n    - echo \'add file done\'  # \u986f\u793a\u4efb\u52d9\u57f7\u884c\u5b8c\u6210\u7684\u6d88\u606f\\n# \u5f9erunCodeToTg\u90a3\u908a\u53d6\u5f97history\u8cc7\u6599\u593e\u5230\u7576\u4e0bgit \u76ee\u9304\\n  dependencies:\\n    - runCodeToTg\\n```\\n\\n\u88dc\u5145:\\n\\n1. entrypoint: [\\"\\"] \u9019\u662f\u500b\u795e\u5947\u7684 issue \u8a2d\u5b9a image run \u8d77\u4f86\u5f8c\u9762\u8981\u57f7\u884c script \u8981\u9019\u6a23\u52a0,\u4e0d\u9019\u6a23\u52a0\u6703\u9047\u5230\u5831\u932f git: \'sh\' is not a git command. See \'git --help\',\u76f8\u95dc[issue](https://gitlab.com/gitlab-org/gitlab-runner/-/issues/4027)\\n\\n2. repo \u901a\u5e38\u6307 Git \u7248\u672c\u63a7\u5236\u7cfb\u7d71\u4e2d\u7684\u5b58\u5132\u5eab,registry \u662f\u4e00\u500b\u5b58\u5132 image \u7684\u5730\u65b9,\u5169\u8005\u6709\u5dee\u5225\u6b50,\u4e0d\u904e\u9019\u4e5f\u770b\u5404\u5bb6\u5b9a\u7fa9,\\n   \u5728 docker \u88e1 registry \u6703\u5305\u542b\u591a\u500b repo,\u800c repo \u6703\u6709\u4e0d\u540c\u7248\u672c\u7684 image.\\n\\n:::info\\n\u53c3\u8003\u8cc7\u6599\\n\\n- [\u5b98\u7db2\u9996\u9801](https://docs.gitlab.com/ee/ci/yaml/index.html)\\n- [\u5b98\u7db2 pipline demo](https://docs.gitlab.com/ee/ci/examples/)\\n- [GitLab CI \u6d41\u6c34\u7ebf\u914d\u7f6e\u6587\u4ef6.gitlab-ci.yml \u8be6\u89e3](https://meigit.readthedocs.io/en/latest/gitlab_ci_.gitlab-ci.yml_detail.html#gitlab-ci-gitlab-ci-yml)\\n\\n:::"},{"id":"/2023/03/30/Others/modemVSigw","metadata":{"permalink":"/blog/2023/03/30/Others/modemVSigw","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Others/2023-03-30-modemVSigw.md","source":"@site/blog/Others/2023-03-30-modemVSigw.md","title":"Do Internet gateways and modem need to be used together?","description":"\u7c21\u8a00\u4e4b\uff0c\u5982\u679c\u4f60\u5bb6\u4f7f\u7528\u64a5\u63a5\u6216\u6709\u7dda\u96fb\u8996\u63d0\u4f9b\u7684\u7db2\u8def\uff0c\u5c31\u6703\u9700\u8981\u6578\u64da\u6a5f\uff0c\u5982\u679c\u4f60\u5bb6\u7528\u5149\u7e96\u3001DSL\u3001\u96fb\u7e9c\u7b49\uff0c\u5c31\u53ef\u4ee5\u4e0d\u7528\u8f49\u63db\u8a0a\u865f\uff0c\u76f4\u63a5\u900f\u904e Igw \u5c07\u8a0a\u865f routing \u5230\u5916\u90e8\u7db2\u8def\u3002","date":"2023-03-30T00:00:00.000Z","formattedDate":"March 30, 2023","tags":[{"label":"curl","permalink":"/blog/tags/curl"}],"readingTime":2.12,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"Do Internet gateways and modem need to be used together?","description":"\u7c21\u8a00\u4e4b\uff0c\u5982\u679c\u4f60\u5bb6\u4f7f\u7528\u64a5\u63a5\u6216\u6709\u7dda\u96fb\u8996\u63d0\u4f9b\u7684\u7db2\u8def\uff0c\u5c31\u6703\u9700\u8981\u6578\u64da\u6a5f\uff0c\u5982\u679c\u4f60\u5bb6\u7528\u5149\u7e96\u3001DSL\u3001\u96fb\u7e9c\u7b49\uff0c\u5c31\u53ef\u4ee5\u4e0d\u7528\u8f49\u63db\u8a0a\u865f\uff0c\u76f4\u63a5\u900f\u904e Igw \u5c07\u8a0a\u865f routing \u5230\u5916\u90e8\u7db2\u8def\u3002","image":"https://github.com/suyuying.png","authors":"suyuying","tags":["curl"]},"prevItem":{"title":"CI:gitlab basic intro about  CI/CD, build image and push to git-lab container","permalink":"/blog/2023/04/06/gitlab-action/gitlab-basic-intro-dind-build-image"},"nextItem":{"title":"aws book study note","permalink":"/blog/2023/3/29/Aws/aws-book-study-note"}},"content":"## Device basic introduction\\n\\n### internet gateway\\n\\n\u4e92\u806f\u7db2\u9598\u9053\u5668\uff08Internet Gateway\uff09\u662f\u4e00\u7a2e\u7db2\u8def\u8a2d\u5099\uff0c\u7528\u65bc\u9023\u63a5\u4f4d\u65bc\u672c\u5730\u7db2\u8def\uff08\u4f8b\u5982\u516c\u53f8\u6216\u5bb6\u5ead\u7db2\u8def\uff09\u5167\u7684\u8a2d\u5099\u8207\u4e92\u806f\u7db2\u9593\u7684\u901a\u8a0a\uff0c\u626e\u6f14\u7db2\u8def\u4e2d\u4ecb\uff0c\u5c07\u672c\u5730\u7db2\u8def\u5c01\u5305\u8f49\u5230\u5916\u7db2\uff0c\u518d\u628a\u5916\u7db2\u5c01\u5305\u8f49\u56de\u672c\u5730\u7db2\u8def\uff0c\u6240\u4ee5\u9700\u8981\u6709 router \u529f\u80fd\\n\\n### Modem\\n\\n\u6578\u64da\u6a5f(Moden)\uff0c\u4e3b\u8981\u529f\u7528\u662f\u5c07\u6578\u5b57\u8a0a\u865f\u8f49\u63db\u6210\u6a21\u64ec\u8a0a\u865f\u3002\\n\\n#### \u6578\u5b57\u8a0a\u865f\\n\\n\u6578\u5b57\u4fe1\u865f\u662f\u4e00\u7a2e\u96e2\u6563\u7684\u4fe1\u865f\uff0c\u5b83\u7531\u4e00\u7cfb\u5217\u96e2\u6563\u7684\u6578\u5b57\u6216\u4e8c\u9032\u5236\u78bc\u8868\u793a\u3002\u9019\u4e9b\u4e8c\u9032\u5236\u78bc\u53ea\u80fd\u53d6 0 \u6216 1 \u7684\u503c\u3002\\n\\n#### \u6a21\u64ec\u8a0a\u865f\\n\\n\u6a21\u64ec\u4fe1\u865f\u662f\u4e00\u7a2e\u9023\u7e8c\u7684\u4fe1\u865f\uff0c\u5b83\u662f\u7531\u4e00\u500b\u9023\u7e8c\u7684\u6ce2\u5f62\u8868\u793a\u7684\u3002\u6a21\u64ec\u4fe1\u865f\u53ef\u4ee5\u53d6\u7121\u9650\u500b\u503c\uff0c\u56e0\u70ba\u5b83\u5011\u662f\u57fa\u65bc\u7269\u7406\u91cf\uff08\u5982\u96fb\u58d3\u3001\u96fb\u6d41\u3001\u8072\u97f3\u6ce2\u5f62\u7b49\uff09\u7684\u9023\u7e8c\u8b8a\u5316\u3002\u6a21\u64ec\u4fe1\u865f\u5e38\u7528\u65bc\u8072\u97f3\u548c\u8996\u983b\u7b49\u6a21\u64ec\u8a2d\u5099\u4e2d\uff0c\u5982\u6536\u97f3\u6a5f\u3001\u96fb\u8996\u548c\u624b\u6a5f\u7b49\\n\\n## Do Internet gateway and modem need to be used together?\\n\\n\u4e0d\u4e00\u5b9a\uff0c\u9019\u4f9d\u64da\u60c5\u5f62\u800c\u5b9a\u3002\u4ee5\u4e0b\u60c5\u5f62\u6703\u9700\u8981\u4e00\u8d77\u7528\uff1a\\n\\n1. \u64a5\u865f\u7db2\u8def: \u9700\u8981\u5c07\u8a08\u7b97\u6a5f\u7684\u6578\u5b57\u8a0a\u865f\u8f49\u6210\u6a21\u64ec\u8a0a\u865f\uff0c\u4e26\u900f\u904e\u96fb\u8a71\u7dda\u50b3\u905e\u8a0a\u865f\u5230\u4e92\u806f\u7db2\u3002\\n2. \u96fb\u8996\u7db2\u8def: \u540c\u4e0a\uff0c\u4e00\u4e9b\u6709\u7dda\u96fb\u8996\u7db2\u8def\u63d0\u4f9b\u7684\u7db2\u8def\u670d\u52d9\u4e00\u6a23\u8981\u5148\u505a\u8a0a\u865f\u8f49\u63db\uff0c\u518d\u900f\u904e\u6709\u7dda\u96fb\u8996\u7db2\u8def\u50b3\u8f38\u3002\\n\\n\u7c21\u8a00\u4e4b\uff0c\u5982\u679c\u4f60\u5bb6\u4f7f\u7528\u64a5\u63a5\u6216\u6709\u7dda\u96fb\u8996\u63d0\u4f9b\u7684\u7db2\u8def\uff0c\u5c31\u6703\u9700\u8981\u6578\u64da\u6a5f\\n\\n\u5982\u679c\u4f60\u5bb6\u7528\u5149\u7e96\u3001DSL\u3001\u96fb\u7e9c\u7b49\uff0c\u5c31\u53ef\u4ee5\u4e0d\u7528\u8f49\u63db\u8a0a\u865f\uff0c\u76f4\u63a5\u900f\u904e Igw \u5c07\u6578\u5b57\u8a0a\u865f routing \u5230\u5916\u90e8\u7db2\u8def\u3002"},{"id":"/2023/3/29/Aws/aws-book-study-note","metadata":{"permalink":"/blog/2023/3/29/Aws/aws-book-study-note","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Aws/2023-3-29-aws-book-study-note.md","source":"@site/blog/Aws/2023-3-29-aws-book-study-note.md","title":"aws book study note","description":"\u8a18\u9304\u7b46\u8a18,Region aws \u57fa\u790e\u8a2d\u65bd\u7684\u4e00\u500b\u55ae\u4f4d\uff0c\u6bcf\u500b\u5340\u57df\u90fd\u662f\u7368\u7acb\u6578\u64da\u4e2d\u5fc3\u7fa4\u96c6\uff0c\u7531\u591a\u500b Availability Zone \u7d44\u6210\uff0c\u6240\u4ee5\u50cf\u65b0\u52a0\u5761\u5340\uff0caws \u76ee\u524d\u5c31 3 \u500b\u53ef\u7528\u5340\u57df\u3002","date":"2023-03-29T00:00:00.000Z","formattedDate":"March 29, 2023","tags":[{"label":"AWS","permalink":"/blog/tags/aws"}],"readingTime":12.64,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"aws book study note","description":"\u8a18\u9304\u7b46\u8a18,Region aws \u57fa\u790e\u8a2d\u65bd\u7684\u4e00\u500b\u55ae\u4f4d\uff0c\u6bcf\u500b\u5340\u57df\u90fd\u662f\u7368\u7acb\u6578\u64da\u4e2d\u5fc3\u7fa4\u96c6\uff0c\u7531\u591a\u500b Availability Zone \u7d44\u6210\uff0c\u6240\u4ee5\u50cf\u65b0\u52a0\u5761\u5340\uff0caws \u76ee\u524d\u5c31 3 \u500b\u53ef\u7528\u5340\u57df\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["AWS"],"sidebar_position":1},"prevItem":{"title":"Do Internet gateways and modem need to be used together?","permalink":"/blog/2023/03/30/Others/modemVSigw"},"nextItem":{"title":"Zabbix Sender monitor key word in log, and show data in grafana","permalink":"/blog/2023/03/29/Zabbix/zabbix-monitor-log"}},"content":"## \u540d\u8a5e\u89e3\u91cb\\n\\nIAAS: \u96f2\u7aef\u696d\u8005\u63d0\u4f9b\u786c\u9ad4\u8a2d\u65bd\u3001\u7db2\u8def\u3002\u4e0d\u5305\u542b\u4f5c\u696d\u7cfb\u7d71(Linux or Windows),\u4e2d\u4ecb\u8edf\u9ad4(MySql,Pika)\uff0c\u4ee5\u53ca\u61c9\u7528\u7a0b\u5f0f\u3002\\n\\nPAAS: \u96f2\u7aef\u696d\u8005\u63d0\u4f9b\u786c\u9ad4\u8a2d\u65bd\u3001\u7db2\u8def\u3001\u4f5c\u696d\u7cfb\u7d71\u3001\u4e2d\u4ecb\u8edf\u9ad4\uff0c\u56e0\u6b21\u4f3a\u670d\u5668\u6545\u969c\u8ddf\u5099\u4efd\u8cc7\u6599\u5eab\u7b49\u5de5\u4f5c\u53ef\u4ee5\u7531\u96f2\u7aef\u696d\u8005\u8ca0\u8cac\u3002\\n\\nSAAS: \u96f2\u7aef\u696d\u8005\u63d0\u4f9b\u786c\u9ad4\u8a2d\u65bd\u3001\u7db2\u8def\u3001\u4f5c\u696d\u7cfb\u7d71\u3001\u4e2d\u4ecb\u8edf\u9ad4\u3001\u61c9\u7528\u7a0b\u5f0f\u3002Gmail \u5c31\u5c6c\u9019\u985e\u578b.\\n\\nRegion: aws \u57fa\u790e\u8a2d\u65bd\u7684\u4e00\u500b\u55ae\u4f4d\uff0c\u6bcf\u500b\u5340\u57df\u90fd\u662f\u7368\u7acb\u6578\u64da\u4e2d\u5fc3\u7fa4\u96c6\uff0c\u7531\u591a\u500b Availability Zone \u7d44\u6210\uff0c\u6240\u4ee5\u50cf\u65b0\u52a0\u5761\u5340\uff0caws \u76ee\u524d\u5c31 3 \u500b\u53ef\u7528\u5340\u57df\u3002\\n\\nAvailability Zone: \u5177\u6709\u7368\u7acb\u7684\u96fb\u6e90\u3001\u7db2\u7d61\u548c\u51b7\u537b\u7cfb\u7d71\uff0c\u4ee5\u53ca\u8207\u5176\u4ed6\u53ef\u7528\u5340\u57df\u4e4b\u9593\u9ad8\u5e36\u5bec\u3001\u4f4e\u5ef6\u9072\u7684\u7db2\u7d61\u9023\u63a5\u3002\u6bcf\u500b\u53ef\u7528\u5340\u57df\u90fd\u662f\u4e00\u500b\u7368\u7acb\u7684\u6578\u64da\u4e2d\u5fc3\u7fa4\u96c6\uff0c\u5177\u6709\u9ad8\u5ea6\u7684\u5197\u9918\u6027\u548c\u53ef\u9760\u6027\uff0c\u4e26\u4e14\u53ef\u4ee5\u901a\u904e\u4f4e\u5ef6\u9072\u7684\u9023\u63a5\u5be6\u73fe\u53ef\u7528\u5340\u57df\u4e4b\u9593\u7684\u5bb9\u932f\u548c\u8ca0\u8f09\u5e73\u8861\u3002\\n\\nVPC(Virtual Private Cloud): VPC \u53ea\u80fd\u9650\u5728\u55ae\u500b region \u5167\uff0c\u4f46\u53ef\u4ee5\u8de8\u540c\u4e00\u683c region \u5167\u7684\u591a\u500b Availability Zone\\n\\n\x3c!--truncate--\x3e\\n\\nNetwork Access Control List(NACL):\u5b50\u7db2\u8def\u5c64\u7d1a\u7684\u5b89\u5168\u6027\u7ba1\u7406\uff0c\u4e3b\u8981\u7528\u65bc\u7ba1\u7406 OSI \u6a21\u578b\u4e2d\u7684 3\u30014 \u5c64\uff0c\u4e5f\u5c31\u662f\u53ef\u4ee5\u7ba1\u7406\u9023\u5165 IP \u8ddf Port \u865f\u9650\u5236\u4ee5\u53ca\u5354\u8b70\u9650\u5236\u3002\u8209\u4f8b: \u53ef\u4ee5\u53ea\u8b93\u81ea\u5df1\u5bb6 ip 66.66.66.66 \u9032\u4f86\uff0c\u5141\u8a31\u6240\u6709 port\uff0c\u4f46\u7981\u6b62 Ping(ICMP \u5354\u8b70)\u3002\\n\\nSecurity Group: EC2 \u5be6\u4f8b\u5c64\u7d1a\u7684\u5b89\u5168\u6027\u7ba1\u7406\uff0c\u60a8\u53ef\u4ee5\u5b9a\u7fa9\u5141\u8a31\u901a\u904e\u7fa4\u7d44\u7684\u7db2\u8def\u6d41\u91cf\uff0c\u4f8b\u5982 TCP \u6216 UDP \u9023\u7dda\u3002\u7576\u4f7f\u7528\u5b89\u5168\u7fa4\u7d44\u548c NACL \u6642\uff0c\u5b89\u5168\u7fa4\u7d44\u7684\u6d41\u91cf\u898f\u5247\u512a\u5148\u65bc NACL \u7684\u898f\u5247\u3002\\n\\nIGW: \u4e92\u806f\u7db2\u9598\u9053\u5668\uff0c\u4e3b\u8981\u7528\u65bc\u5916\u7db2\u8ddf\u5167\u7db2\u7684\u8a0a\u865f\u8def\u7531\u3002\\n\\nMetadata: \u57f7\u884c\u500b\u9ad4\u4e2d\u7e7c\u8cc7\u6599\uff0c\u53ef\u4ee5\u7528\u4f86\u7ba1\u7406\u57f7\u884c\u500b\u9ad4\uff0c\u5305\u542b\u4e3b\u6a5f\u540d\u7a31\u8ddf IP \u7b49\\n\\nPlacement Group: \u4e00\u7fa4 EC2 \u7684\u555f\u52d5\u7b56\u7565\uff0c\u5206\u70ba\u53e2\u96c6\u3001\u5206\u5340\u3001\u5206\u6563\\n\\nServerless \u61c9\u7528\u7a0b\u5f0f: \u958b\u767c\u4eba\u54e1\u958b\u767c\u7a0b\u5f0f\u5f8c\uff0c\u90fd\u6703\u9047\u5230\u8981\u958b\u591a\u5c11\u898f\u683c\u7684\u554f\u984c\uff0c\u5728 Serverless \u89e3\u6c7a\u65b9\u6848\u4e0b\uff0c\u96f2\u7aef\u5ee0\u5546\u63d0\u4f9b\u8a2d\u5b9a\u81ea\u52d5\u64f4\u5c55\u6216\u8005\u63d0\u9ad8\u6027\u80fd\u7b49\u670d\u52d9\uff0c\u9069\u5408\u7a81\u767c\u6027\u9ad8\u9644\u8f09\u7684\u670d\u52d9\uff0c\u5982:\u552e\u7968\u7cfb\u7d71.Serverless \u80cc\u5f8c\u4f7f\u7528\u7684\u662f lambda \u670d\u52d9\u3002\\n\\n\u6a5f\u5668\u5b78\u7fd2: \u9700\u8981\u9ad8\u6027\u80fd\u96fb\u8166\u9032\u884c\u8cc7\u6599\u8a13\u7df4\uff0c\u5efa\u6a21\uff0c\u4e26\u90e8\u7f72\u61c9\u7528\u7a0b\u5f0f.\\n\\nIoT:\u5229\u7528\u611f\u6e2c\u5668\u7b49\u5c0f\u578b\u8a2d\u5099\u5efa\u7acb\u7269\u806f\u7db2\u7cfb\u7d71\\n\\nData Lake House: \u70ba\u6eff\u8db3\u5404\u7a2e\u8cc7\u6599\u5206\u6790\u9700\u6c42\u7684\u5206\u6790\u9078\u64c7.\\n\\nAWS Resources: \u6307\u7528 AWS \u5404\u670d\u52d9\u6240\u5efa\u7acb\u800c\u6210\u7684\u5be6\u9ad4(instance)\\n\\n## IAM\\n\\nIAM \u5168\u540d\u662f\u300cIdentity and Access Management\u300d\uff0c\u70ba AWS \u8eab\u4efd\u548c\u8a2a\u554f\u7ba1\u7406\u670d\u52d9\u3002\\n\\n\u900f\u904e\u6cd5\u689d\u898f\u7bc4\u8eab\u4efd\u3002\\n\\n```\\n\u6cd5\u689d->\u8eab\u4efd\\n```\\n\\n### \u6cd5\u689d(policy)\\n\\n\u6cd5\u689d\u5efa\u7acb\u898f\u5247\u7c21\u7a31 EPCAR\\n\\nEffect + Principal + Condition + Action + Resource\\n\\n\u5141\u8a31/\u62d2\u7d55 + \u4e3b\u9ad4(IAM user,or \\\\* ...) + \u5565\u689d\u4ef6(ip or MFA...) + \u57f7\u884c\u52d5\u4f5c + \u5c0d\u54ea\u9805\u8cc7\u6e90(s3,rds...)\\n\\n### \u8eab\u4efd\\n\\n\u4e3b\u8981\u6709\u5169\u985e\\n\\n1. \u6388\u6b0a policy \u7684 group\uff0c\u4f9d\u9644\u5728 group \u5e95\u4e0b\u6709\u9577\u671f\u6191\u8b49\u7684 IAM user\u3002\\n2. \u4f7f\u7528\u77ed\u671f credential \u7684 IAM role\uff0c\u5916\u90e8\u7cfb\u7d71\u5e33\u865f\uff08Federating Exist User. \u4f8b\u5982: github action,google \u767b\u5165)\u7b49\uff0c\u516c\u53f8\u672c\u5730\u5e33\u865f\uff0c\u5176\u4ed6 aws \u5e33\u865f\uff0caws \u8cc7\u6e90\u9593\u6e9d\u901a\uff0c\u90fd\u53ef\u4ee5\u900f\u904e\u9023\u7d50\u7684\u672c aws \u5e33\u865f IAM role \u505a\u8cc7\u6e90\u64cd\u4f5c\u3002\\n\\n:::info\\n\u5916\u90e8\u4f7f\u7528\u8005\u8ddf\u672c\u5730 sso \u9a57\u8b49\u904e\u7a0b\\n\\n```\\n\u5ba2\u6236\u7aef\u61c9\u7528\u7a0b\u5f0f:A-> \u4f60\u7684Identity Provider(ldP)\u4e3b\u6a5f ex google,github\u7b49-> google,github\u7b49\u7684LDAP database \u9a57\u8b49 -> \u56de\u50b3SAML\u9a57\u8b49\u7d66\u5ba2\u6236\u7aefA->A\u547c\u53ebAWS STS(Security Token Service)\u9a57\u8b49->AWS \u56de\u61c9\u66ab\u6642\u6191\u8b49->\u5ba2\u6236\u7aefA\u900f\u904e\u6191\u8b49\u53d6\u5230aws\u8cc7\u6e90\\n```\\n\\n:::\\n\\n### IAM \u6b0a\u9650\u78ba\u8a8d\u6d41\u7a0b\\n\\n```jsx title=\\"\u57fa\u672caws\u78ba\u8a8d\u6b0a\u9650\u6d41\u7a0b\\"\\n\u4f7f\u7528\u8005-> AWS\u8fa8\u8a8d\u8eab\u4efd->\u78ba\u8a8d\u6b0a\u9650->\u6388\u6b0a\u64cd\u4f5c\\n```\\n\\n### IAM \u6b0a\u9650\u7ba1\u7406\\n\\nroot \u6b0a\u9650\u904e\u5927\u554f\u984c\uff0c\u900f\u904e\u8a2d\u5b9a\u4e0d\u540c\u6b0a\u9650\u5e33\u865f\u5207\u5272\uff0c\u5728 aws \u5c31\u662f\u900f\u904e\u591a\u500b\u7528\u6236\u7fa4\u7d44\u5207\u5206\u6b0a\u9650\uff0c\u8ddf linux \u7ba1\u7406\u985e\u4f3c\u3002\\n\\n## VPC\\n\\n### aws \u7db2\u8def\u74b0\u5883\u7d44\u6210\\n\\n```\\n\u5c01\u5305->IGW->Route Table ->Network Access Control Lists(NACL)->Public Subnet->Security group -> Instance\\n```\\n\\n### NACL vs Security group\\n\\n\u9019\u5169\u8005\u90fd\u662f\u63a7\u5236\u7db2\u8def\u6d41\u91cf\uff0c\u90a3\u5dee\u5225\u53c8\u70ba\u4f55\u5462?\\n\\n- NACL \u662f\u5728\u5b50\u7db2\u8def\u7d1a\u5225\u904b\u4f5c, Security group \u662f\u5728 instance \u7d1a\u5225\\n- NACL \u662f\u7121\u72c0\u614b\u7684(stateless),\u4e0d\u8ddf\u8e64\u72c0\u614b,\u4e5f\u5c31\u662f\u8981\u898f\u5b9a 7.7.7.7 \u80fd\u9032\u4f86\u4e5f\u80fd\u51fa\u53bb,\u624d\u6703\u653e\u884c\u8ddf 7.7.7.7 \u7684\u6d41\u91cf. Security group \u662f\u6709\u72c0\u614b\u7684(stateful),\u9019\u4ee3\u8868\u6703\u81ea\u52d5\u5141\u8a31\u51fa\u7ad9\u6216\u5165\u7ad9\u7684\u8fd4\u56de\u6d41\u91cf,\u8209\u4f8b\u4f86\u8aaa:\u5982\u679c\u5c0d\u5916\u53ef\u4ee5\u9023\u63a5 7.7.7.7:80,\u90a3 7.7.7.7 \u56de\u4f86\u7684\u6d41\u91cf\u4e5f\u6703\u81ea\u52d5\u5141\u8a31,\u4f46\u6ce8\u610f,7.7.7.7 \u4e0d\u6703\u81ea\u5df1\u9032\u4f86.\\n- NACL \u6709\u5141\u8a31\u548c\u62d2\u7d55\u898f\u5247,Security group \u53ea\u6709\u5141\u8a31\u898f\u5247 \u3002\\n- NACL \u53ea\u80fd\u5f15\u7528 IP \u5730\u5740\u6216 CIDR \u584a,Security group \u53ef\u4ee5\u5728\u5176\u898f\u5247\u4e2d\u5f15\u7528\u5176\u4ed6\u5b89\u5168\u7d44\u3002\\n\\n### VPC \u670d\u52d9\u5c0d\u63a5\u65b9\u5f0f\\n\\n1. NAT Gateway \u8b93\u79c1\u6709\u7db2\u8def\u9023\u5916\\n2. \u4ee5\u5167\u7db2\u65b9\u5f0f\u64cd\u4f5c\u8cc7\u6e90-VPC Endpoint\\n3. VPC \u4e32\u63a5 VPC\\n4. VPC \u4e32\u672c\u5730-VPN Connection\\n\\n## EC2\\n\\n\u76f8\u95dc\u670d\u52d9\u9806\u5e8f\u8ddf\u5730\u7aef\u5c0d\u7167:\\n\\n\u8edf\u9ad4\u5e02\u5834-> \u4f5c\u696d\u7cfb\u7d71->\u786c\u9ad4\u898f\u683c->\u8edf\u9ad4\u5b89\u88dd\uff0c\u7a0b\u5f0f\u90e8\u7f72->\u786c\u789f\u64f4\u5145->\u6a19\u8a18\u8cc7\u7522->\u5efa\u7acb\u9632\u706b\u7246-> \u9023\u7dda\\n\\nAMI Marketplace->AMI->Instance->Userdata->EBS->Tag->Security Group->KeyPair\\n\\n\u7528 AMI \u5efa\u7acb\u4e3b\u6a5f\uff0c\u7528 Userdata \u90e8\u7f72\uff0cEBS \u64f4\u5145\u786c\u789f\uff0cTag \u65b9\u4fbf\u7ba1\u7406\u6a5f\u5668\uff0c\u53ef\u4ee5\u7528\u4f86\u770b\u6210\u672c\u8ddf\u6b0a\u9650\uff0cSecurity Group \u9650\u5236\u9023\u5165 IP \u8ddf prot\uff0cKeyPair \u9023\u5165\u6a5f\u5668\u3002\\n\\nAmazon Machine Image:AMI,\u865b\u64ec\u6620\u50cf\u6a94\uff0c\u5c6c\u65bc Region \u7d1a\u5225\uff0c\u4e0d\u80fd\u8de8 Region\uff0c\u4e5f\u5c31\u662f\u9999\u6e2f\u5340\u4e0d\u80fd\u62ff\u65e5\u672c\u7684 AMI \u5efa\u7acb\u6a5f\u5668\u3002\\n\\n\u6240\u4ee5\u5982\u679c\u8981\u8de8\u5340\u4f7f\u7528 AMI\uff0c\u5c31\u8ddf Immutable \u539f\u5247\u6709\u95dc\uff0c\u5fc5\u9808\u5148\u628a\u820a\u7684 AMI \u8907\u88fd\u5230\u5176\u4ed6\u5340\uff0c\u4e26\u5728\u5176\u4ed6 Region \u8d77\u6a5f\u5668\uff0c\u4e5f\u5c31\u662f AMI->snapshot->\u8907\u88fd AMI->\u8d77\u6a5f\u5668\u3002\\n\\n### instance \u5206\u985e\\n\\n\u4ee5 t2.micro \u70ba\u4f8b\uff0ct \u61c9\u7528\u5834\u666f\uff0c2 \u865b\u64ec\u5316\u6280\u8853\u7248\u672c\uff0cmicro \u6a5f\u5668\u898f\u683c\\n\\n## \u786c\u789f\\n\\n\u5169\u5927\u65b9\u6848\u5206\u70ba 1. EBS Volume 2.Instance Store\\n\\n### EBS Volume\\n\\nEBS Volume \u8ddf EC2 \u662f\u4e0d\u540c\u4f3a\u670d\u5668\uff0c\u6a5f\u5668\u8ddf\u786c\u789f\u5169\u8005\u900f\u904e\u7db2\u8def\u76f8\u9023\uff0c\\nEBS Volume \u5728\u6a5f\u5668\u95dc\u6a5f\u5f8c\u8cc7\u6599\u4e0d\u6703\u6d88\u5931\u3002 \u6240\u4ee5\u8981\u9577\u671f\u4fdd\u5b58\u7684\u8cc7\u6599\u8981\u7528 EBS \u4fdd\u5b58\u3002\\n\\n### Instance Store\\n\\nInstance Store \u8ddf EC2 \u5728\u540c\u4e00\u53f0 server \u4e0a\u3002\\nInstance Store \u95dc\u6a5f\u5f8c\u8cc7\u6599\u6703\u6d88\u5931\u3002\u91cd\u65b0\u958b\u6a5f\u8cc7\u6599\u4e0d\u6703\u6d88\u5931\u3002\u6240\u4ee5\u53ea\u9069\u5408\u653e\u7de9\u885d\u8ddf\u66ab\u6642\u6027\u8cc7\u6599\u3002\\n\\n## Snapshot\\n\\nAWS \u5feb\u7167\u670d\u52d9\u6709\u591a\u7a2e,\u4ee5\u4e0b\u5217\u51fa\u5e38\u7528\u7684:\\n\\n1. EBS \u5feb\u7167: \u5c0d EBS \u786c\u789f\u7684\u5feb\u7167\\n2. RDS \u5feb\u7167: RDS \u8cc7\u6599\u5eab\u5feb\u7167\\n3. EC2 \u6620\u50cf: \u5c0d\u6a5f\u5668\u7576\u4e0b\u72c0\u614b\u7684\u5feb\u7167\uff0c\u8981\u6ce8\u610f\u7576\u6703\u751f\u51fa\u4e00\u500b EBS \u5feb\u7167\u8ddf\u4e00\u500b AMIs\\n\\n## Elastic Network Interface \u7db2\u8def\u5361\\n\\nEC2 \u900f\u904e Elastic Network Interface(ENI)\u9023\u63a5\u7db2\u8def\uff0c\u8981\u56fa\u5b9a\u4f7f\u7528\u7684 IP \u8981\u7d81\u5b9a Elastic IP,\u7d81\u5b9a\u5f8c\u958b\u95dc\u6a5f\u4e0d\u6703\u6539\u8b8a\u5c0d\u5916 IP.\\n\\n## SSH KeyPair\\n\\n\u900f\u904e\u628a\u67d0\u53f0 server \u7684\u516c\u9470\u653e\u5165 EC2\uff0c\u7528 ssh \u65b9\u5f0f\u9032\u5165 EC2\\n\\n## S3\\n\\n### \u6838\u5fc3\u7d44\u6210\\n\\nBucket and Object,\u4f60\u7684\u8cc7\u6599\u5c31\u662f Object\uff0c\u6703\u88ab\u653e\u5728 Bucket \u5167\u4fdd\u5b58\uff0c\u6bcf\u500b\u7269\u4ef6\u90fd\u6709 https \u9023\u7d50\uff0c\u4f46\u6c92\u7279\u5225\u8a2d\u5b9a\u6b0a\u9650\u6703\u9047\u5230 Access denied.\\n\\n### \u5b58\u53d6\u6b0a\u9650\u63a7\u7ba1\\n\\n\u6b0a\u9650\u63a7\u7ba1\u7ba1\u7406\u6a5f\u5236\u4e3b\u8981\u6709\u4e09\u7a2e:\\n\\n1. Block Public Access:\u9019\u500b\u7b97\u662f\u9632\u5446\u6a5f\u5236\uff0c\u5c31\u5f88\u7c21\u55ae\u7684\u76f4\u63a5\u6c7a\u5b9a\u6a94\u6848\u662f\u5426\u516c\u958b\\n2. Access Control List: \u5206\u70ba\u5c0d Bucket \u8ddf Object \u7684 ACL,\u53ef\u4ee5\u8a2d\u5b9a\u8b80\u53d6\uff0c\u5beb\u5165\uff0c\u5217\u8209\uff0c\u6b0a\u9650\u64c1\u6709\u8005\u7b49\u3002\\n3. Bucket Policy: \u8981\u505a\u6700\u7cbe\u7d30\u8a2d\u5b9a\u8981\u900f\u904e Bucket Policy \u53bb\u7528 json \u683c\u5f0f\u505a\u898f\u7bc4\uff0c\u53ef\u4ee5\u898f\u7bc4\u7684\u6771\u897f\u6709\u5b58\u53d6\u6b0a\u9650(IAM user or Role)\uff0c\u8def\u5f91\uff0c\u689d\u4ef6(\u65e5\u671f ip bucket \u540d\u7a31)\\n\\n### \u5b58\u53d6\u76e3\u63a7\u7d00\u9304\\n\\n\u5c0d Bucket \u8ddf Object \u90fd\u6709\u76e3\u63a7\u7d00\u9304\\n\\n### Access Point Policy\\n\\nAccess Point \u53ef\u4ee5\u5321\u5217 Bucket \u4e2d\u4e00\u7cfb\u5217 object\uff0c\u91dd\u5c0d\u9019\u4e9b Object \u8a2d\u8a08\u65b0\u7684\u4e00\u5957 Access Point Policy.\\n\\n## RDS\\n\\nAmazon Relational Database Service (RDS)\u662f\u4e00\u9805\u6258\u7ba1\u95dc\u806f\u5f0f\u6578\u64da\u5eab\u670d\u52d9.\\n\u5728\u4f7f\u7528 RDS \u6642\uff0c\u6703\u81ea\u52d5\u958b\u6a5f\u5668\u4f86\u5b8c\u6210\u4efb\u52d9\uff0c\u6709\u958b\u6a5f\u5668\u5c31\u8981\u63a2\u8a0e\u662f\u5728\u54ea\u500b\u7db2\u6bb5\u958b\u6a5f\u5668\uff0c\u56e0\u6b64\u8981\u5148\u8a2d\u5b9a subnet group,RDS \u6703\u5728 group \u5167\u6311\u9078\u5408\u9069\u7684 subnet \u653e\u7f6e\u6a5f\u5668\\n\\n### \u8207\u81ea\u5efa\u8cc7\u6599\u5eab\u5dee\u5225\\n\\n\u5728 EC2 \u5efa\u7acb\u8cc7\u6599\u5eab\u9700\u8981\u7ba1\u7406 VM \uff0c\u4e14\u53ef\u4ee5\u9023\u5165\u6a5f\u5668\u505a\u53c3\u6578\u8abf\u6574.\\n\\n\u800c RDS \u4e3b\u8981\u5354\u52a9\\n\\n1. \u8cc7\u6599\u5099\u63f4: \u8cc7\u6599\u907a\u5931\u53ef\u4ee5\u6709\u6548\u56de\u5fa9\\n2. \u7cfb\u7d71\u9ad8\u53ef\u7528\u6027: \u6545\u969c\u8f49\u79fb\u548c\u64f4\u5c55\u7b49\u529f\u80fd\\n\\n### RDS \u6027\u80fd\u8abf\u6821\\n\\nAWS \u63d0\u4f9b Parameter Group \u529f\u80fd\uff0c\u8b93\u8cc7\u6599\u5eab\u6240\u4f7f\u7528\u7684\u53c3\u6578\u80fd\u532f\u5165,\u786c\u9ad4\u90e8\u5206\u53ef\u4ee5\u5c07 EBS Volume \u6539\u6210 Provision iops \u985e\u578b\u7684 EBS Volume.\\n\\n### RDS \u9ad8\u53ef\u7528\u8207\u5099\u63f4\\n\\n#### \u5099\u63f4\\n\\n\u53ef\u4ee5\u5c0d\u8cc7\u6599\u5eab(\u4e00\u822c\u7528\u4e3b\u5eab)\u505a snapshot,\u53c8\u5206\u70ba\u81ea\u5df1\u624b\u52d5\u5099\u4efd\u8ddf aws \u5b9a\u671f\u5099\u4efd\uff0c\u5dee\u5225\u5728\u672a\u4f86\u522a\u9664\u8cc7\u6599\u5eab\u6642\uff0caws \u5b9a\u671f\u5099\u4efd\u6703\u88ab\u522a\u5230\u5269\u6700\u7d42\u5099\u4efd\uff0c\u800c\u7528\u6236\u624b\u52d5\u5099\u4efd\u4e0d\u6703\u88ab AWS \u522a\u9664\u3002\\n\\n\u53e6\u5916\uff0c\u5132\u5b58\u9ad4\u78c1\u789f\u5340\u5feb\u7167\u5728\u55ae\u4e00 AZ \u4e2d\u5efa\u7acb\u6703\u5c0e\u81f4 I/O \u77ed\u66ab\u505c\u7528\uff01\u7570\u5730\u540c\u6b65\u5099\u4efd I/O \u4e0d\u6703\u53d7\u6b64 I/O \u5f71\u97ff\uff0c\u56e0\u70ba\u662f\u5728\u5f85\u547d\u72c0\u614b\u4e0b\u9032\u884c\u5099\u4efd\u3002\\n\\n#### \u9ad8\u53ef\u7528\\n\\n\u70ba\u7d13\u7de9\u4e3b\u8cc7\u6599\u5eab\u6d41\u91cf\uff0cRDS \u63d0\u4f9b\u552f\u7368\u526f\u672c\u670d\u52d9\uff0c\u628a\u4e3b\u5eab\u8cc7\u6599\u7570\u6b65\u8907\u88fd\u5230\u53e6\u5916\u4e00\u500b AZ \u7684 ReadOnly DB(Read Replica) \u55ae\u7d14\u7528\u4f86\u67e5\u8a62\u3002\\n\\n:::info\\nRead Replica \u8ddf slave DB \u76f8\u4f3c\uff0c\u5dee\u5225\u5728\u524d\u8005\u53ef\u4ee5\u505a\u5230\u8de8 Region \uff0c\u4e14\u53ef\u4ee5\u8f49\u6210 standalone DB instance.\\n\\n:::\\n\\n\u53e6\u5916\uff0c\u70ba\u907f\u514d\u4e3b\u5eab\u5931\u6548\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528 Multi-AZ \u670d\u52d9\u555f\u7528\u5099\u7528\u8cc7\u6599\u5eab(Standby)\uff0c\u5e73\u6642\u4e3b\u5eab\u8cc7\u6599\u6703\u540c\u6b65\u8907\u88fd\u5230 standby\uff0c\u552f\u7368\u526f\u672c\u8ddf\u5feb\u7167\u5099\u4efd\u5de5\u4f5c\u90fd\u4ea4\u7d66 Standby\uff0c\u7576\u4e3b\u5eab\u4e0d\u5c0f\u5fc3\u639b\u4e86\u5c31\u6703\u5207\u63db\u7528\u5099\u7528\u8cc7\u6599\u5eab\u3002\\n\\n## Route 53\\n\\n\u4e3b\u8981\u662f DNS Registry \u4e2d\u5efa\u7acb\u4e26\u7ba1\u7406 DNS Record, \u5e38\u7528\u7684 Record \u5f62\u5f0f\u6709 A,CName,\u53e6\u5916 aws \u9084\u6709\u63d0\u4f9b alias record(\u5e95\u5c64\u4f9d\u820a\u662f A record). \u4e26\u9078\u64c7\u8def\u7531\u653f\u7b56,\u6700\u5e38\u7528\u9593\u7684\u6703\u662f simple routing policy,\u6709\u7279\u6b8a\u9700\u6c42\u6703\u4f9d\u64da\u5730\u7406\u4f4d\u7f6e,\u6548\u80fd(\u5ef6\u9072\u6700\u5c11,\u6545\u969c\u8f49\u79fb),\u4f3a\u670d\u5668\u5ba2\u88fd.\\n\\n### alias record\\n\\n\u8981\u628a dns record \u63a5\u4e0a\u67d0\u500b aws \u8cc7\u6e90,\u4f8b\u5982 alb,\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u65b9\u5f0f\\n\\n1. \u81ea\u5df1\u516c\u53f8\u57df\u540d CNAME \u5230 aws \u8cc7\u6e90\u7522\u751f\u7684\u96a8\u6a5f\u57df\u540d,\u8a72\u7b46\u96a8\u6a5f\u57df\u540d\u5728 aws \u90a3\u908a\u6703\u88ab A record \u5230 ELB ip.\\n2. A record \u5728 Alias \u60c5\u6cc1\u4e0b\u9023\u63a5\u5230 aws \u8cc7\u6e90\\n\\n## CloudWatch\\n\\n\u76e3\u63a7 aws \u670d\u52d9\u8cc7\u6e90\u7684 log,\u786c\u9ad4\u670d\u52d9\u4ed6\u53ef\u4ee5\u76f4\u63a5\u6536\u96c6,"},{"id":"/2023/03/29/Zabbix/zabbix-monitor-log","metadata":{"permalink":"/blog/2023/03/29/Zabbix/zabbix-monitor-log","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Zabbix/2023-03-29-zabbix-monitor-log.md","source":"@site/blog/Zabbix/2023-03-29-zabbix-monitor-log.md","title":"Zabbix Sender monitor key word in log, and show data in grafana","description":"\u5b9a\u6642\u6293\u53d6\u67d0log file\u5176\u4e2d\u7684\u7279\u5b9a\u95dc\u9375\u5b57\uff0c\u7528zabbix-sender\u50b3\u9001\u8cc7\u8a0a\u7d66zabbix server\uff0c\u4e26\u628a\u8cc7\u6599\u8a2d\u5b9a\u5831\u8b66\u5230telegram\uff0c\u8cc7\u8a0a\u6703\u7528grafana\u7684log\u986f\u793a\u3002","date":"2023-03-29T00:00:00.000Z","formattedDate":"March 29, 2023","tags":[{"label":"Zabbix","permalink":"/blog/tags/zabbix"},{"label":"Grafana","permalink":"/blog/tags/grafana"}],"readingTime":3.805,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"Zabbix Sender monitor key word in log, and show data in grafana","description":"\u5b9a\u6642\u6293\u53d6\u67d0log file\u5176\u4e2d\u7684\u7279\u5b9a\u95dc\u9375\u5b57\uff0c\u7528zabbix-sender\u50b3\u9001\u8cc7\u8a0a\u7d66zabbix server\uff0c\u4e26\u628a\u8cc7\u6599\u8a2d\u5b9a\u5831\u8b66\u5230telegram\uff0c\u8cc7\u8a0a\u6703\u7528grafana\u7684log\u986f\u793a\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["Zabbix","Grafana"]},"prevItem":{"title":"aws book study note","permalink":"/blog/2023/3/29/Aws/aws-book-study-note"},"nextItem":{"title":"aws iam setting introduction","permalink":"/blog/2023/03/25/Aws/aws-iam-setting"}},"content":"## \u524d\u63d0\\n\\n\u9019\u908a\u5047\u8a2d\u5df2\u7d93\u8a2d\u5b9a\u597d host\uff0c\u4e14 zabbix \u6709\u63a5\u4e0a grafana \u60c5\u6cc1\u5f8c\uff0c\u7e7c\u7e8c\u5f80\u4e0b\u63cf\u8ff0.\\n\\n\u76ee\u7684: \u5b9a\u6642\u6293\u53d6\u67d0 log file \u5176\u4e2d\u7684\u7279\u5b9a\u95dc\u9375\u5b57\uff0c\u7528 zabbix-sender \u50b3\u9001\u8cc7\u8a0a\u7d66 zabbix server\uff0c\u4e26\u628a\u8cc7\u6599\u8a2d\u5b9a\u5831\u8b66\u5230 telegram\uff0c\u8cc7\u8a0a\u6703\u7528 grafana \u7684 log \u986f\u793a\u3002\\n\\n### step1. \u8a2d\u5b9a item\\n\\n\u6b63\u5e38 zabbix \u8a2d\u5b9a\u6a5f\u5668\u6d41\u7a0b\uff1a\\n\\n\u5efa\u7acb Hosts groups-> \u5efa\u7acb Templates->\u5f80 Template \u5167\u8a2d\u5b9a\u8981\u76e3\u63a7\u7684 item->\u518d\u628a templates \u9023\u7d50\u5230 Hosts Groups \u4e0a\u9762->\u6700\u5f8c\u628a\u4e3b\u6a5f\u4e5f\u5c31\u662f Host \u6dfb\u52a0\u5230\u6307\u5b9a\u7684 Host groups \u4e0a\u9762\u3002\\n\\n\u9019\u908a\u56e0\u70ba\u7279\u5225\u9700\u6c42\u95dc\u4fc2(\u53ea\u6709\u9019\u4e00\u53f0\u6a5f\u5668\u9700\u8981\uff09\uff0c\u56e0\u6b64\u76f4\u63a5\u5728\u8a72 Host \u4e0a\u9762\u8a2d\u5b9a item.\\n\\n\u9078 Hosts\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-side-bar.png\\").default}\\n      style={{ maxHeight: \\"300px\\" }}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n\u56e0\u70ba\u662f\u7528 zabbix-sender \u6240\u4ee5\u9019\u908a type \u7528 zabbix trapper\uff0c\u8981\u6ce8\u610f\u6a5f\u5668\u4e0a\u9762\u90fd\u7528 Key \u8ddf zabbix server \u6e9d\u901a\uff0cName \u662f\u8a72 Item \u7684\u540d\u5b57\uff0c\u5169\u500b\u8a2d\u5b9a\u5e38\u5e38\u6703\u641e\u6df7\u3002\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-traper.png\\").default}\\n      style={{ maxHeight: \\"300px\\" }}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n### step2. \u5b89\u88dd zabbix-sender \u4e26\u50b3\u8cc7\u6599\\n\\n\u6a5f\u5668\u4e0a\u8173\u672c\u8a2d\u5b9a zabbix_sender \u50b3\u9001\u8cc7\u6599\uff0c\u7528 key \u8ddf output \u505a\u50b3\u9001\\n\\n```\\n# \u5b89\u88ddzabbix-sender\\nyum install zabbix-sender\\n# \u50b3\u8cc7\u8a0a\u7d66zabbix server\\nzabbix_sender -z 10.121.0.9  -s yourHostName -k test -o \\"$(cat /tmp/Lost_connection_to_db_server_${range2}_${range1}.log)\\"\\n```\\n\\n\u78ba\u8a8d zabbix \u662f\u5426\u6709\u6536\u5230\u8cc7\u6599\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-get-last-data.png\\").default}\\n      style={{ maxHeight: \\"300px\\" }}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n### step3. \u8a2d\u5b9a grafana \u6293\u53d6\u8cc7\u6599\\n\\n\u78ba\u8a8d\u6709\u6536\u5230\u8cc7\u6599\u5f8c\uff0c\u5728 grafana \u65b0\u5efa panel\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/grafana-add-new-panel.png\\").default}\\n      style={{ maxHeight: \\"300px\\" }}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n\u8a2d\u5b9a\u8cc7\u6599\u539f\uff0c\u6ce8\u610f\u9019\u908a\u7684 Query Mode \u662f\u8a2d\u5b9a Text\uff0c\u6709\u5f88\u591a\u7a2e\u578b\u614b\uff0c\u9078\u932f\u6703\u627e\u4e0d\u5230\u8cc7\u6599\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/grafana-set-data-source.png\\").default}\\n      style={{ maxHeight: \\"300px\\" }}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\nGrafana \u6a21\u5f0f\u8a18\u5f97\u8981\u9078 log\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5176\u4ed6\u6a21\u5f0f\u73a9\u73a9\u770b\uff0c\u56e0\u70ba\u9019\u908a\u6c92\u5565\u96f7\uff0c\u5c31\u4e0d\u7279\u5225\u622a\u5716\u8aaa\u660e\\n\\n### (optional)step4. zabbix \u544a\u8b66 tg\\n\\n\u5148\u8a2d\u5b9a Trigger\uff0cProblem expression \u4e5f\u5c31\u662f\u7576\u50b3\u9001\u8cc7\u8a0a\u7b26\u5408\u8a2d\u5b9a\u7684\u689d\u4ef6\u5c31\u6703\u5f15\u767c\u544a\u8b66\uff0cRecovery experssion \u4e5f\u5c31\u662f\u7576\u8cc7\u8a0a\u7b26\u5408\u54ea\u4e9b\u689d\u4ef6\u5c31\u6703\u89e3\u9664\u544a\u8b66\u3002\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-sender-b-log.png\\").default}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n\u78ba\u5b9a\u5b8c\u7684\u78ba\u6703\u544a\u8b66\u8ddf\u56de\u5fa9\u5f8c\uff0c\u5c31\u53ef\u4ee5\u8a2d\u5b9a TG \u544a\u8b66\u3002\u5148\u53bb Administration->Media type \u8907\u88fd Telegram \u90a3\u683c\u3002\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-clone-telegrana.png\\").default}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n\u5728 Token \u4f4d\u7f6e\u52a0\u5165\u4f60 TG Token\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-add-token.png\\").default}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n\u5efa\u7acb\u65b0 User Group\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-add-zabbix-group.png\\").default}\\n      style={{ maxHeight: \\"300px\\" }}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n\u8a2d\u5b9a\u8a72 User Group \u5c0d\u54ea\u4e9b Host Group \u6709\u76e3\u63a7\u6b0a\u9650\u3002\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-group-permission.png\\").default}\\n      style={{ maxHeight: \\"300px\\" }}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n\u5efa\u7acb User\uff0c\u4e26\u628a\u8a72 User \u52a0\u5230 Group \u5167\u90e8\uff0c\u4e26\u8a2d\u5b9a\u7576\u54ea\u4e9b\u72c0\u614b\u767c\u751f\u5c31\u5f80 TG \u9001\u8cc7\u6599\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-user-media.png\\").default}\\n      style={{ maxHeight: \\"300px\\" }}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>\\n\\n\u4ee5\u4e0a\u90fd OK\uff0c\u53ef\u4ee5\u6703\u5230\u524d\u9762 media type \u90a3\u908a\u6e2c\u8a66\u662f\u5426\u53ef\u4ee5\u50b3\u8cc7\u6599\u5230\uff34\uff27\\n\\n\u5982\u679c\u8981\u5c07 Trigger \u7684\u8cc7\u6599\u9001\u5230 TG\uff0c\u4e00\u5b9a\u8981\u8a2d\u5b9a Actions\uff0c\u9019\u908a\u662f\u4e00\u500b\u5751\uff0c\u524d\u9762\u8a2d\u5b9a\u5b8c\u4e86\u4f46\u90fd\u6c92\u6709\u9001\u5230 TG\uff0c\u7d50\u679c\u767c\u73fe\u9019\u683c\u6c92\u6709\u8a2d\u5b9a\uff3a\uff3a\uff3a\\n\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./2023-03-29-zabbix-monitor-log-png-folder/zabbix-trigger-actions-to-tg.png\\").default}\\n      style={{ maxHeight: \\"300px\\" }}\\n      alt=\\"zabbix-side-bar\\"\\n    />\\n  </div>\\n</>"},{"id":"/2023/03/25/Aws/aws-iam-setting","metadata":{"permalink":"/blog/2023/03/25/Aws/aws-iam-setting","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Aws/2023-03-25-aws-iam-setting.md","source":"@site/blog/Aws/2023-03-25-aws-iam-setting.md","title":"aws iam setting introduction","description":"\u5b98\u65b9\u5efa\u8b70\u5927\u591a\u60c5\u6cc1\u90fd\u6703\u9069\u7528 IAM role\uff0c\u4f7f\u7528 IMA role \u7684\u512a\u9ede\u662f\u4ed6\u662f\u4f7f\u7528\u66ab\u6642\u6027\u6191\u8b49(\u53ef\u8a2d\u5b9a\u5230\u671f\u6642\u9593)\uff0c\u800c IAM \u4f7f\u7528\u8005\u7528\u7684\u90fd\u662f\u9577\u671f\u7684 aws_secret_access_key(\u56e0\u6b64\u5b98\u65b9\u6703\u5efa\u8b70\u5b9a\u6642\u63db\uff0c\u4e0d\u904e\u4e00\u822c\u4f86\u8aaa\u6c92\u4eba\u90a3\u9ebc\u52e4\u52de ZZZ)\u3002","date":"2023-03-25T00:00:00.000Z","formattedDate":"March 25, 2023","tags":[{"label":"AWS","permalink":"/blog/tags/aws"}],"readingTime":8.545,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"aws iam setting introduction","description":"\u5b98\u65b9\u5efa\u8b70\u5927\u591a\u60c5\u6cc1\u90fd\u6703\u9069\u7528 IAM role\uff0c\u4f7f\u7528 IMA role \u7684\u512a\u9ede\u662f\u4ed6\u662f\u4f7f\u7528\u66ab\u6642\u6027\u6191\u8b49(\u53ef\u8a2d\u5b9a\u5230\u671f\u6642\u9593)\uff0c\u800c IAM \u4f7f\u7528\u8005\u7528\u7684\u90fd\u662f\u9577\u671f\u7684 aws_secret_access_key(\u56e0\u6b64\u5b98\u65b9\u6703\u5efa\u8b70\u5b9a\u6642\u63db\uff0c\u4e0d\u904e\u4e00\u822c\u4f86\u8aaa\u6c92\u4eba\u90a3\u9ebc\u52e4\u52de ZZZ)\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["AWS"],"sidebar_position":2},"prevItem":{"title":"Zabbix Sender monitor key word in log, and show data in grafana","permalink":"/blog/2023/03/29/Zabbix/zabbix-monitor-log"},"nextItem":{"title":"How to let google find my website?","permalink":"/blog/2023/03/20/SEO/google-register"}},"content":"## what is aws IAM\\n\\n[\u4ec0\u9ebc\u662f IAM](https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/service_code_examples.html) aws \u5b98\u7db2\u7684\u8cc7\u8a0a\u4e00\u822c\u90fd\u5beb\u5f97\u6eff\u68d2\u7684\uff0c\u672c\u6587\u51fa\u8655\u4e3b\u8981\u662f\u53c3\u8003\u5b98\u7db2\u8cc7\u8a0a\u505a\u6574\u7406\uff0c\u56e0\u70ba\u7ba1\u7406\u4e0a\u7d93\u9a57\u53ea\u9650\u65bc\u81ea\u5df1\u7684\u74b0\u5883\u7528\u7684 s3,CI \u7b49\u7b49\uff0c\u6240\u4ee5\u6253\u7b97\u8d81\u9019\u500b\u6a5f\u6703\u6aa2\u8996\u4e4b\u524d\u8a2d\u5b9a\u7684 iAM \u6709\u6c92\u6709\u554f\u984c\uff0c\u7576\u7136\uff0c\u6211\u76f8\u4fe1\u9019\u53ea\u662f\u904e\u7a0b\uff0c\u96a8\u8457\u770b\u904e\u7684\u8cc7\u8a0a\u8ddf\u4e8b\u60c5\u8d8a\u591a\uff0c\u6703\u5f97\u5230\u4e0d\u540c\u6216\u8005\u591a\u500b\u7b54\u6848\uff0c\u7e3d\u4e4b\uff0c\u5c31\u5148\u5f9e\u9019\u4e00\u6b65\u958b\u59cb\u5427\uff01\\n\\nAWS Identity and Access Management (IAM) \u7528\u9014\uff1a\u5b89\u5168\u5730\u63a7\u5236\u5c0d Amazon Web Services (AWS) \u548c\u5e33\u6236\u8cc7\u6e90\u7684\u5b58\u53d6\u3002\u4f7f\u7528 IAM \u70ba\u4f7f\u7528\u8005\u548c\u89d2\u8272\u7b49\u8eab\u5206\u63d0\u4f9b\u60a8\u7684\u5e33\u6236\u4e2d\u8cc7\u6e90\u7684\u5b58\u53d6\u6b0a\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n\u4ee5\u4e0b\u662f IAM \u5b89\u5168\u67b6\u69cb\u53c3\u8003\u7db2\u8def\u8cc7\u6e90\uff0c\u4e3b\u8981\u7d44\u6210\u5982\u5716\\n\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./iam-structure.png\\").default}\\n      alt=\\"malta_street png\\"\\n    />\\n    \\n  </div>\\n  <div className=\\"text-center\\"><a href=\\"https://hackmd.io/@study-group-aws-book/HkhQ2BlRP\\" target=\\"_blank\\" >\u672c\u5716\u53c3\u8003\u8b80\u66f8\u6703-\u5927\u8a71AWS\u96f2\u7aef\u7d50\u69cb\\n</a></div>\\n</>\\n\\n## typical composition\\n\\n```\\nPolicy -> IAM identities(IAM group or Role)\\n```\\n\\n### Policy\\n\\n\u683c\u5f0f: \u7948\u4f7f\uff0b\u4e3b\u8a5e([IAM identities](#iam-identities))\uff0b\u689d\u4ef6\uff0b\u52d5\u8a5e(optional)\uff0b\u8cc7\u6e90\u53d7\u8a5e (\u5c0d\u61c9\uff1a\u5141\u8a31 Don \u5967\u4e01\u7834\u95dc\u4e00\u767e\u6b21\u6642 \u5403 \u9ea5\u7576\u52de)\\n\\n\u5c0d\u61c9 Aws Json(\u628a\u4e0a\u9762\u8209\u4f8b\u66f4\u63db\u800c\u5df2)\\n\\n```\\nEffect : \\"\u5141\u8a31\\"\\nPrincipal: \\"Don\\"\\nCondition:\\"\u5967\u4e01\u7834\u95dc\u4e00\u767e\u6b21\u6642\\"\\nAction: \\"\u5403\\"\\nResource :\\"\u9ea5\u7576\u52de\\"\\n```\\n\\n\u6b63\u5f0f\u7248 Aws Json\\n\\n```\\n{\\n    \\"Version\\": \\"2012-10-17\\",\\n    \\"Statement\\": [\\n        {\\n            \\"Sid\\": \\"PublicReadGetObject\\",\\n            \\"Effect\\": \\"Allow\\",\\n            \\"Principal\\": \\"*\\",\\n            \\"Action\\": \\"s3:GetObject\\",\\n            \\"Resource\\": \\"arn:aws:s3:::myresume-for-zaxx/*\\"\\n        }\\n    ]\\n}\\n```\\n\\n### IAM identities\\n\\n\u5171\u6709\u6839\u4f7f\u7528\u8005\u3001IAM \u4f7f\u7528\u8005\u3001IAM \u4f7f\u7528\u8005\u7fa4\u7d44\u3001IAM \u89d2\u8272\u3001\u66ab\u6642\u6027\u6191\u8b49\\n\\n#### \u6839\u4f7f\u7528\u8005\\n\\nRoot \u53ef\u4ee5\u5b58\u53d6\u6240\u6709 aws \u8cc7\u6e90,\u4e14\u6b0a\u9650\u6700\u9ad8,aws \u5efa\u8b70\u65e5\u5e38\u5de5\u4f5c\u4e8b\u9805\u90fd\u7528\u4e00\u822c\u4f7f\u7528\u8005,\u9664\u975e\u662f\u4ee5\u4e0b\u5de5\u4f5c:\\n\\n- \u7ba1\u7406\u4e00\u822c\u4f7f\u7528\u8005\u6b0a\u9650\\n- \u505c\u7528 AWS \u5e33\u6236\\n- \u5e33\u6236\u82b1\u8cbb\u7ba1\u7406\\n\\n\u66f4\u591a\u8cc7\u6599\u53ef\u4ee5\u770b[\u5b98\u7db2\u9019\u7bc7](https://docs.aws.amazon.com/accounts/latest/reference/root-user-tasks.html)\\n\\n#### IAM \u4f7f\u7528\u8005\\n\\n\u5177\u5099\u55ae\u4e00\u4eba\u54e1\u6216\u61c9\u7528\u7a0b\u5f0f\u7684\u7279\u5b9a\u8a31\u53ef\uff0cAWS \u5efa\u8b70\u4eba\u54e1\u91d1\u9470\u9577\u671f\u6191\u8b49\u8005\u8981\u5b9a\u671f\u66f4\u63db\uff0c\u800c\u76f8\u6bd4\u9577\u671f\u6191\u8b49\u66f4\u5efa\u8b70\u7528\u66ab\u6642\u6027\u6191\u8b49.\\n\\n#### IAM \u4f7f\u7528\u8005\u7fa4\u7d44\\n\\n\u4f7f\u7528\u8005\u96c6\u5408\u7684\u8eab\u4efd\uff0c\u900f\u904e IAM \u4f7f\u7528\u8005\u7fa4\u7d44\u7ba1\u7406 IAM \u4f7f\u7528\u8005\\n\\n#### IAM \u89d2\u8272\\n\\n\u5b83\u985e\u4f3c IAM \u4f7f\u7528\u8005\uff0c\u4f46\u4e0d\u8207\u7279\u5b9a\u7684\u4eba\u54e1\u76f8\u95dc\u806f\u3002\u89d2\u8272\u7684\u76ee\u7684\u662f\u8b93\u9700\u8981\u5b83\u7684\u4efb\u4f55\u4eba\u53ef\u4ee3\u5165\uff0c\u7406\u89e3\u4e0a\u5c31\u50cf\u662f\u500b\u5177\u6709\u6b0a\u9650\u7684\u6709\u6642\u6548\u6027 token\uff0c\u53ef\u4ee5\u7d66 code \u6216\u4f7f\u7528\u8005\u6216\u8cc7\u6e90\u4f7f\u7528\u3002\\n\\n#### \u66ab\u6642\u6027\u6191\u8b49\\n\\n[\u6700\u4f73\u5be6\u52d9](https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/best-practices.html)\u5b83\u985e\u4f3c IAM \u4f7f\u7528\u8005\uff0c\u4f46\u4e0d\u8207\u7279\u5b9a\u7684\u4eba\u54e1\u76f8\u95dc\u806f\\n\\n#### \u4f55\u6642\u4f7f\u7528 IAM Identity Center \u4f7f\u7528\u8005\uff1f\\n\\n[\u5b98\u65b9\u56de\u8986](https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id.html#id_temp-creds)\\n\\n\u770b\u8d77\u4f86\u662f\u53ef\u4ee5\u900f\u904e\u55ae\u4e00\u767b\u5165\uff0c\u53bb\u53d6\u5f97\u5728\u6240\u6709\u5e33\u6236\u4e2d\u6240\u6388\u7684\u6b0a\u9650\\n\\n#### \u4f55\u6642\u5efa\u7acb IAM \u4f7f\u7528\u8005 (\u800c\u4e0d\u662f\u89d2\u8272)\\n\\n\u5efa\u8b70\u60a8\u50c5\u5c07 IAM \u4f7f\u7528\u8005\u7528\u65bc\u806f\u5408\u8eab\u5206\u4f7f\u7528\u8005\u4e0d\u652f\u63f4\u7684\u4f7f\u7528\u6848\u4f8b\u3002\u806f\u5408\u8eab\u5206\u4f7f\u7528\u8005(federating exist user)\u662f\u900f\u904e\u5916\u90e8\u8cc7\u6e90\u53bb\u9023 AWS \u4e0a\u6642\uff0c\u900f\u904e IAM role \u5206\u914d\u8cc7\u6e90\u53d6\u5f97\u6b0a\u9650\uff0c\u914d\u5408\u8ddf ldP(external identity provider)ex.FB,google \u9a57\u8b49\uff0c\u8b93\u4f7f\u7528\u8005\u53ef\u4ee5\u53d6\u7684\u77ed\u671f\u6191\u8b49\u3002\\n\\n#### \u4f55\u6642\u5efa\u7acb IAM \u89d2\u8272 (\u800c\u4e0d\u662f\u4f7f\u7528\u8005)\\n\\n\u7a0b\u5f0f\u7aef\u5411 aws \u8cc7\u6e90\u8acb\u6c42\u3001aws \u670d\u52d9\u9593\u4e32\u63a5\u3001\u4ee5\u53ca\u516c\u53f8\u7684 single sign on(\u7cfb\u7d71\u6709\u63a1\u7528 SAML 2.0 \u6216\u5efa\u7acb\u4e26\u4f7f\u7528\u81ea\u8a02\u4ee3\u7406\u4f3a\u670d\u5668\uff0c\u5c07\u4f7f\u7528\u8005\u8eab\u5206\u5f9e\u4f01\u696d\u8f49\u63db\u70ba\u63d0\u4f9b\u66ab\u6642 AWS \u5b89\u5168\u6191\u8b49\u7684 IAM \u89d2\u8272)\\n\\n### Brief summary\\n\\n\u5b98\u65b9\u5efa\u8b70\u5927\u591a\u60c5\u6cc1\u90fd\u6703\u9069\u7528 IAM role\uff0c\u4f7f\u7528 IMA role \u7684\u512a\u9ede\u662f\u4ed6\u662f\u4f7f\u7528\u66ab\u6642\u6027\u6191\u8b49(\u53ef\u8a2d\u5b9a\u5230\u671f\u6642\u9593)\uff0c\u800c IAM \u4f7f\u7528\u8005\u7528\u7684\u90fd\u662f\u9577\u671f\u7684 aws_secret_access_key(\u56e0\u6b64\u5b98\u65b9\u6703\u5efa\u8b70\u5b9a\u6642\u63db\uff0c\u4e0d\u904e\u4e00\u822c\u4f86\u8aaa\u6c92\u4eba\u90a3\u9ebc\u52e4\u52de ZZZ)\u3002\\n\\n\u5b98\u7db2\u63d0\u5de5\u66ab\u6642\u6027\u6191\u8b49\u7684\u512a\u9ede\\n\\n1. \u4e0d\u5fc5\u96a8\u61c9\u7528\u7a0b\u5f0f\u6563\u767c\u6216\u5167\u5d4c\u9577\u671f AWS \u5b89\u5168\u6191\u8b49:\u8209\u4f8b\u4f86\u8aaa\uff0c\u516c\u53f8\u6709\u500b\u8173\u672c\u62ff\u4f86\u662f\u62ff\u4f86\u66f4\u65b0\u524d\u7aef\u8cc7\u6e90\u7684\uff0c\u5982\u679c\u4f7f\u7528 IAM \u4f7f\u7528\u8005\uff0c\u90a3\u4ed6\u7684\u79c1 key \u5c31\u6703\u8ddf\u8457\u9019\u96bb\u8173\u672c\u5230\u8655\u8dd1\uff0c\u4f46\u7528 role \u7684\u8a71\u4e0d\u7528\u3002\\n\\n2. \u53ef\u4ee5\u63d0\u4f9b AWS \u8cc7\u6e90\u5b58\u53d6\u7d66\u4f7f\u7528\u8005\uff0c\u800c\u4e0d\u5fc5\u70ba\u5176\u5b9a\u7fa9 AWS \u8eab\u5206\u3002\u66ab\u6642\u6191\u8b49\u662f[\u89d2\u8272\u548c\u806f\u5408\u8eab\u5206](https://docs.aws.amazon.com/zh_tw/IAM/latest/UserGuide/id_roles.html)\u7684\u57fa\u790e\u3002\\n\\n3. \u66ab\u6642\u6027\u5b89\u5168\u6191\u8b49\u7684\u5b58\u7559\u671f\u6709\u9650\uff0c\u56e0\u6b64\u7576\u4e0d\u518d\u9700\u8981\u6642\uff0c\u60a8\u4e0d\u9700\u8981\u8f2a\u63db\u5b83\u5011\u6216\u660e\u78ba\u4e88\u4ee5\u64a4\u92b7\\n\\n\u4e0d\u904e\u6bcf\u500b\u516c\u53f8\u90fd\u6709\u5404\u81ea\u6587\u5316\u3002\u7fd2\u6163\u4e4b\u5f8c\u518d\u53bb\u770b\u81ea\u5df1\u516c\u53f8\u90a3\u5957\u7684\u512a\u7f3a\u9ede\uff5e\\n\\n## aws iam setting guide\\n\\n\u56e0\u70ba root \u6b0a\u9650\u5f37\u5927,\u6240\u4ee5\u57fa\u672c\u4e0a\u6703\u7d66\u4e88\u4e00\u4e9b\u9650\u5236(\u8a2d\u5b9a\u5efa\u8b70).\u6d41\u7a0b\u70ba\u4ee5\u4e0b:\\n\\n- \u522a\u9664 Root \u5b58\u53d6\u91d1\u9470\\n- Root \u555f\u7528 MFA \u9a57\u8b49\\n\\n\u5728\u8a2d\u5b9a\u5b8c root \u7684\u57fa\u672c\u5b89\u5168\u8a2d\u5b9a\u5f8c,\u63a5\u8457\u5c31\u662f\u8981\u5efa\u7acb\u65e5\u5e38\u7684 IAM \u4f7f\u7528\u8005.\u6d41\u7a0b\u70ba\u4ee5\u4e0b:\\n\\n- \u5efa\u7acb\u500b\u5225 IAM \u4f7f\u7528\u8005\\n- \u5efa\u7acb\u7fa4\u7d44,\u4e26\u9023\u7d50 Policies \u8a2d\u5b9a\u4ee5\u5176\u4f7f\u7528\u8005\\n- \u5957\u7528 IAM \u5bc6\u78bc\u653f\u7b56\\n\\n### \u522a\u9664 Root \u5b58\u53d6\u91d1\u9470\\n\\n\u56e0\u70ba root \u6b0a\u9650\u592a\u9ad8,\u4e0d\u5efa\u8b70\u7528 root \u8eab\u4efd\u7684\u91d1\u9470(access key)\u5728\u7a0b\u5f0f\u4e2d\u5b58\u53d6 aws \u8cc7\u6e90,\u70ba\u907f\u514d\u610f\u5916,\u6703\u57f7\u884c root \u7684 access key \u522a\u9664(\u4e00\u822c\u9810\u8a2d\u4e0d\u6703\u7522\u751f,\u9664\u975e\u5148\u524d\u6709\u64cd\u4f5c\u7522\u751f access key).\\n\\n\u6b65\u9a5f:\\n\\nclick \u53f3\u4e0a\u89d2\u5e33\u865f\u6b04->security credentials->\u4e0b\u6ed1\u5230 Access key \u8655->\u505c\u7528->\u522a\u9664->done\\n\\n### \u555f\u7528 MFA \u9a57\u8b49\\n\\n\u9810\u8a2d\u4e0b,root \u767b\u5165\u90fd\u7528 email \u8ddf password,\u56e0\u70ba\u9019\u4e9b\u6771\u897f\u90fd\u6709\u53ef\u80fd\u4e0d\u5c0f\u5fc3\u6d29\u6f0f(\u7fd2\u6163\u7528\u540c\u4e00\u7d44\u5bc6\u78bc),aws \u900f\u904e MFA \u63d0\u5347\u5b89\u5168\u6027,\u9a57\u8b49\u65b9\u5f0f\u9019\u908a\u63d0\u4f9b\u5e38\u7528\u7684\u865b\u64ec MFA \u9a57\u8b49(Authenticator app).\\n\\n\u6b65\u9a5f:\\n\\n\u5148\u5b89\u88dd MFA \u9a57\u8b49 APP->click \u53f3\u4e0a\u89d2\u5e33\u865f\u6b04->\u5b89\u5168\u6191\u8b49 security credentials->\u555f\u7528 MFA(assign MFA device)->Authenticator app -> show QR code \u8b93 app \u6383\u63cf or \u586b\u5165 MFA codes ->done\\n\\n### \u5efa\u7acb\u500b\u5225 IAM \u4f7f\u7528\u8005\\n\\nroot \u6b0a\u9650\u592a\u9ad8,\u5efa\u8b70\u65e5\u5e38\u64cd\u4f5c\u90fd\u7528\u7b26\u5408\u76f8\u61c9\u6b0a\u9650\u7684 IAM \u4f7f\u7528\u8005\u53bb\u8655\u7406.\\n\\n\u6b65\u9a5f:\\nIAM -> Access management->\u4f7f\u7528\u8005(users)->create user-> click Provide user access to the AWS Management Console -> click i want to create an IAM user -> click Autogenerated password -> click Users must create a new password at next sign-in (recommended)\\n\\n\u9019\u908a\u662f demo \u5efa\u7acb\u4e00\u500b\u53ef\u4ee5\u9032\u5165 aws console \u7684\u4f7f\u7528\u8005,\u4e00\u822c\u800c\u8a00 aws \u5efa\u8b70\u7528 Identity Center \u53bb\u7ba1\u7406\u4f7f\u7528\u8005,\u4e0d\u904e\u5c0f\u516c\u53f8\u6216\u500b\u4eba\u4f7f\u7528\u5c31\u5148 i want to create an IAM user \u5c31\u597d,\u512a\u9ede\u662f\u4f60\u60f3\u8981\u5efa\u7acb\u80fd\u7d66\u7a0b\u5f0f\u7528\u7684 access key \u53ef\u4ee5\u76f4\u63a5\u5efa\u7acb.\u9019\u908a\u64cd\u4f5c\u70ba\u5148\u5efa\u7acb\u4f7f\u7528\u8005,\u4e4b\u5f8c\u518d\u9023\u7d50\u7fa4\u7d44\u8ddf\u653f\u7b56. ps.\u8981\u5efa\u7acb access key \u8acb\u53e6\u5916\u9ede\u5230 Users \u88e1\u9762\u7684 security credentials \u5efa\u7acb Access keys.\\n\\n### \u5efa\u7acb\u7fa4\u7d44,\u4e26\u9023\u7d50 Policies \u8a2d\u5b9a\\n\\n\u9019\u908a\u8a2d\u5b9a\u57fa\u672c\u4e0a\u5c31\u662f\u5efa\u7acb\u7fa4\u7d44,\u4e26\u9023\u7d50\u81ea\u5df1\u5efa\u7acb\u7684 policy(\u4f9d\u64da EPCAR \u539f\u5247) \u6216 aws \u5167\u5efa\u7684 policy\\n\\n\u6b65\u9a5f:\\n\\nIAM -> Access management -> User groups\\n\\n### \u5957\u7528 IAM \u5bc6\u78bc\u653f\u7b56\\n\\n\u57fa\u672c\u4e0a\u6bcf\u9593\u516c\u53f8\u90fd\u6703\u6709\u81ea\u5df1\u7684\u5bc6\u78bc\u653f\u7b56,\u5728 IAM \u88e1\u9762\u7576\u7136\u4e5f\u6709\uff01\\n\\n\u6b65\u9a5f:\\n\\nIAM ->Access management-> Account settings -> Password policy -> Edit ->Custom"},{"id":"/2023/03/20/SEO/google-register","metadata":{"permalink":"/blog/2023/03/20/SEO/google-register","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/SEO/2023-03-20-google-register.md","source":"@site/blog/SEO/2023-03-20-google-register.md","title":"How to let google find my website?","description":"register my website to google","date":"2023-03-20T00:00:00.000Z","formattedDate":"March 20, 2023","tags":[{"label":"google","permalink":"/blog/tags/google"}],"readingTime":0.325,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"How to let google find my website?","description":"register my website to google","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["google"]},"prevItem":{"title":"aws iam setting introduction","permalink":"/blog/2023/03/25/Aws/aws-iam-setting"},"nextItem":{"title":"docker gitlab runner error during connect Post \\"http://docker:2375/v1.24/auth\\" dial tcp lookup docker on 1.1.1.1:53 no such host","permalink":"/blog/2023/03/16/Docker/docker-gitlab-error-connect-docker"}},"content":"## \u8a18\u9304\u4e00\u4e0b\u6574\u500b google \u8a3b\u518a\u81ea\u5df1\u7db2\u7ad9\u904e\u7a0b\\n\\n1. \u4e3b\u8981\u53c3\u8003\u9019\u7bc7 https://web-design.vip/google-web-submit.html \uff0c \u4ed6\u6703\u63d0\u4f9b\u4f60\u4e09\u500b\u8b93 google \u722c\u87f2\u627e\u5230\u4f60\u6700\u5feb\u5f97\u65b9\u5f0f\u3002\\n\\n## \u8b93\u4f60\u7684\u7db2\u7ad9\u52a0\u5165\u641c\u5c0b\u529f\u80fd\\n\\n1. [Using Algolia DocSearch](https://docusaurus.io/docs/next/search)\u7533\u8acb Algolia \u5be9\u67e5\\n2."},{"id":"/2023/03/16/Docker/docker-gitlab-error-connect-docker","metadata":{"permalink":"/blog/2023/03/16/Docker/docker-gitlab-error-connect-docker","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Docker/2023-03-16-docker-gitlab-error-connect-docker.md","source":"@site/blog/Docker/2023-03-16-docker-gitlab-error-connect-docker.md","title":"docker gitlab runner error during connect Post \\"http://docker:2375/v1.24/auth\\" dial tcp lookup docker on 1.1.1.1:53 no such host","description":"\u57f7\u884c\u9019\u500b\u4fee\u6539\uff0cvolumes \u6539\u70ba [\\"/var/run/docker.sock:/var/run/docker.sock\\", \\"/cache\\"]\uff0c\u8b93 Runner Executor \u4f7f\u7528\u4e3b\u6a5f\u5916\u90e8\u7684 Docker Engine\u3002\u6240\u4ee5\u63a8\u6e2c\uff0c\u9019\u53ef\u80fd\u662f gitlab runner \u8ddf gitlab server \u4e0a\u9762\u9a57\u8b49\u7684\u6a5f\u5236\uff0c\u5982\u679c\u6c92\u6709\u9019\u6a23\u52a0\uff0cdind \u5c31\u627e\u4e0d\u5230 gitlab server \u7684\u9a57\u8b49\u90a3\u95dc\uff0c\u6240\u4ee5\u5c31\u6703\u5931\u6557","date":"2023-03-16T00:00:00.000Z","formattedDate":"March 16, 2023","tags":[{"label":"docker","permalink":"/blog/tags/docker"}],"readingTime":2.285,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"docker gitlab runner error during connect Post \\"http://docker:2375/v1.24/auth\\" dial tcp lookup docker on 1.1.1.1:53 no such host","description":"\u57f7\u884c\u9019\u500b\u4fee\u6539\uff0cvolumes \u6539\u70ba [\\"/var/run/docker.sock:/var/run/docker.sock\\", \\"/cache\\"]\uff0c\u8b93 Runner Executor \u4f7f\u7528\u4e3b\u6a5f\u5916\u90e8\u7684 Docker Engine\u3002\u6240\u4ee5\u63a8\u6e2c\uff0c\u9019\u53ef\u80fd\u662f gitlab runner \u8ddf gitlab server \u4e0a\u9762\u9a57\u8b49\u7684\u6a5f\u5236\uff0c\u5982\u679c\u6c92\u6709\u9019\u6a23\u52a0\uff0cdind \u5c31\u627e\u4e0d\u5230 gitlab server \u7684\u9a57\u8b49\u90a3\u95dc\uff0c\u6240\u4ee5\u5c31\u6703\u5931\u6557","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["docker"]},"prevItem":{"title":"How to let google find my website?","permalink":"/blog/2023/03/20/SEO/google-register"},"nextItem":{"title":"environment variable and  secrets variable config in github","permalink":"/blog/2023/03/16/github-action/githubaction-env-secrets-variablr-config"}},"content":"## \u9047\u5230\u554f\u984c\u7684\u60c5\u5883\\n\\nCICD \u6b65\u9a5f\u88e1\u9762\uff0c\u6bcf\u7576\u958b\u767c\u4eba\u54e1\u628a code \u5beb\u5b8c\u4e4b\u5f8c\uff0c\u6703\u9032\u884c\u6e2c\u8a66\u4e26\u628a code build \u6210 image \u5f8c\u63a8\u5230 image registry\\n\uff0c\u4e4b\u5f8c\u5230\u74b0\u5883\u57f7\u884c deploy\u3002\\n\\n\u5728 gitlab \u88e1\u9762\u6703\u7528 gitlab runner\uff0c\u4e26\u5728.gitlab-ci.yml \u8a2d\u8a08\u4fc3\u767c\u7684\u60c5\u5883\u4e0b\uff0c\u57f7\u884c.gitlab-ci.yml \u5167\u5bb9\uff0c\u8981\u5728 gitlab runner \u5167 build image \u901a\u5e38\u6703\u7528\u5230 docker:dind\uff0c\u5b83\u662f\u5177\u6709 docker \u5f15\u64ce\u7684 container\uff01\u4e00\u822c\u7684 image \u5167\u901a\u5e38\u90fd\u4e0d\u6703\u53bb\u5b89\u88dd docker \u5f15\u64ce\uff0c\u9019\u6bb5\u6709\u9ede\u96e3\u61c2\uff0c\u4f46\u4f60\u53ef\u4ee5\u60f3\u60f3\u6709 nginx,mysql \u7b49\u7b49\u7684 image\uff0c\u57fa\u672c\u4e0a\u53ea\u6703\u6709\u81ea\u5df1\u9810\u8a2d\u529f\u80fd\uff0c\u4e0d\u9700\u8981 docker \u5f15\u64ce\uff0c\u5c0d\u65bc docker \u800c\u8a00\uff0c\u88e1\u9762\u8981\u53ef\u4ee5\u7528 docker \u6307\u4ee4\u7684\uff0c docker:dind \u662f\u4e00\u500b\u9078\u9805\u3002\\n\\n\u5728 build \u7248\u57f7\u884c\u7684 yml \u5982\u4e0b\u3002\\n\u4e3b\u8981\u529f\u80fd\u5c31\u662f\u767b\u5165\u5728 gitlab \u4e0a\u9762\u7684\u516c\u53f8\u7684 image registry,\u4e4b\u5f8c\u5728 gitlab runner \u57f7\u884c build image \u4e26\u63a8\u5230 gitlab image registry.\\n\\n```jsx title=\\".gitlab-ci.yml\\"\\nstages:\\n    - build\\n\\nvariables:\\n    IMAGE_NAME: hahaha\\n    CI_IMAGE: $CI_REGISTRY_IMAGE/$IMAGE_NAME:$CI_COMMIT_SHORT_SHA\\n\\n# Build moni\\nbuild-moni:\\n    stage: build\\n    image: docker:dind\\n    tags:\\n        - docker\\n    before_script:\\n        - docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY\\n    script:\\n        - docker build . -t $CI_IMAGE\\n        - docker push $CI_IMAGE\\n        - docker rmi $CI_IMAGE\\n    except:\\n        - schedules\\n\\n\\n```\\n\\n```jsx title=\\"Dockerfile\\"\\nFROM node:16\\n\\nCOPY /node /node\\nWORKDIR /node\\nRUN npm install;npm install gulp -g;gulp build;\\nEXPOSE 4000\\nCMD [ \\"npm\\", \\"run\\", \\"start\\" ]\\n```\\n\\n\u57f7\u884c\u904e\u7a0b\u5230\u9019\u4e00\u6b65`- docker login -u $CI_REGISTRY_USER -p $CI_REGISTRY_PASSWORD $CI_REGISTRY`\u9047\u5230\u5831\u932f\uff0c\\n`error during connect: Post \\"http://docker:2375/v1.24/auth\\": dial tcp: lookup docker on 1.1.1.1:53: no such host`\u3002\\n\\n### \u89e3\u6cd5:\\n\\n\u5728\u4f60\u639b\u5230 gitlab runner \u4e2d /etc/gitlab-runner \u88e1\u9762\u7684 config.toml\uff0c\u8acb\u5148\u7528 docker inspect \u89c0\u5bdf volume \u639b\u8f09\u4f4d\u7f6e\uff0c\u5982\u679c\u4f60\u662f\u7528\u5b98\u7db2 local volume \u639b\u8f09\u65b9\u6cd5\uff0c\u90a3\u5c31\u662f\u5728 VM \u4e0a\u53bb vim /srv/gitlab-runner/config/config.toml\uff0c\u53bb\u4fee\u6539\\n`volumes = [\\"/cache\\"]` \u8b8a\u6210\\n`volumes = [\\"/var/run/docker.sock:/var/run/docker.sock\\",\\"/cache\\"]`\u3002\\n\\n\u4e26\u57f7\u884c`docker restart gitlab-runner`!\\n\\n### \u53ef\u80fd\u539f\u56e0\uff1a\\n\\n\u57f7\u884c\u9019\u500b\u4fee\u6539\uff0cvolumes \u6539\u70ba [\\"/var/run/docker.sock:/var/run/docker.sock\\", \\"/cache\\"]\uff0c\u8b93 Runner Executor \u4f7f\u7528\u4e3b\u6a5f\u5916\u90e8\u7684 Docker Engine\u3002\\n\\n\u6240\u4ee5\u63a8\u6e2c\uff0c\u9019\u53ef\u80fd\u662f gitlab runner \u8ddf gitlab server \u4e0a\u9762\u9a57\u8b49\u7684\u6a5f\u5236\uff0c\u5982\u679c\u6c92\u6709\u9019\u6a23\u52a0\uff0cdind \u5c31\u627e\u4e0d\u5230 gitlab server \u7684\u9a57\u8b49\u90a3\u95dc\uff0c\u6240\u4ee5\u5c31\u6703\u5931\u6557"},{"id":"/2023/03/16/github-action/githubaction-env-secrets-variablr-config","metadata":{"permalink":"/blog/2023/03/16/github-action/githubaction-env-secrets-variablr-config","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/github-action/2023-03-16-githubaction-env-secrets-variablr-config.md","source":"@site/blog/github-action/2023-03-16-githubaction-env-secrets-variablr-config.md","title":"environment variable and  secrets variable config in github","description":"\u4f7f\u7528 CI \u8ddf\u5beb\u7a0b\u5f0f\u90fd\u6703\u9047\u5230\u8981\u5f9e env \u62ff\u53d6\u8b8a\u6578\u503c\u7684\u6642\u5019\uff0c\u5728 github \u7ba1\u7406\u65b9\u5f0f\u5982\u4e0b\uff0c\u4e3b\u8981\u5224\u65b7\u662f\u9019\u500b\u8b8a\u6578\u662f\u5426\u8981\u7d66\u591a\u500b workflow \u4f7f\u7528\u3002\u5982\u679c\u60a8\u4e0d\u78ba\u5b9a\uff0c\u4e5f\u53ef\u4ee5\u5f9e\u5b58\u5132\u5eab\u5bc6\u9470\u958b\u59cb\u70ba\u6240\u6709\u6771\u897f\u5275\u5efa\u5bc6\u9470\u3002\u5982\u679c\u4e4b\u5f8c\u6709\u5f15\u5165\u9700\u8981\u4e0d\u540c\u5bc6\u9470\u7684\u4e0d\u540c\u74b0\u5883\uff0c\u4f8b\u5982 prod,dev,test \u7b49\uff0c\u5247\u53ef\u4ee5\u5c07\u5b58\u5132\u5eab\u5bc6\u9470\u79fb\u52d5\u5230\u7279\u5b9a\u74b0\u5883\u3002\u7136\u5f8c\u5728\u7279\u5b9a\u74b0\u5883\u7528\u7279\u5b9a\u8b8a\u6578\u503c\u3002","date":"2023-03-16T00:00:00.000Z","formattedDate":"March 16, 2023","tags":[{"label":"github action","permalink":"/blog/tags/github-action"},{"label":"CICD","permalink":"/blog/tags/cicd"}],"readingTime":2.54,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"environment variable and  secrets variable config in github","description":"\u4f7f\u7528 CI \u8ddf\u5beb\u7a0b\u5f0f\u90fd\u6703\u9047\u5230\u8981\u5f9e env \u62ff\u53d6\u8b8a\u6578\u503c\u7684\u6642\u5019\uff0c\u5728 github \u7ba1\u7406\u65b9\u5f0f\u5982\u4e0b\uff0c\u4e3b\u8981\u5224\u65b7\u662f\u9019\u500b\u8b8a\u6578\u662f\u5426\u8981\u7d66\u591a\u500b workflow \u4f7f\u7528\u3002\u5982\u679c\u60a8\u4e0d\u78ba\u5b9a\uff0c\u4e5f\u53ef\u4ee5\u5f9e\u5b58\u5132\u5eab\u5bc6\u9470\u958b\u59cb\u70ba\u6240\u6709\u6771\u897f\u5275\u5efa\u5bc6\u9470\u3002\u5982\u679c\u4e4b\u5f8c\u6709\u5f15\u5165\u9700\u8981\u4e0d\u540c\u5bc6\u9470\u7684\u4e0d\u540c\u74b0\u5883\uff0c\u4f8b\u5982 prod,dev,test \u7b49\uff0c\u5247\u53ef\u4ee5\u5c07\u5b58\u5132\u5eab\u5bc6\u9470\u79fb\u52d5\u5230\u7279\u5b9a\u74b0\u5883\u3002\u7136\u5f8c\u5728\u7279\u5b9a\u74b0\u5883\u7528\u7279\u5b9a\u8b8a\u6578\u503c\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["github action","CICD"]},"prevItem":{"title":"docker gitlab runner error during connect Post \\"http://docker:2375/v1.24/auth\\" dial tcp lookup docker on 1.1.1.1:53 no such host","permalink":"/blog/2023/03/16/Docker/docker-gitlab-error-connect-docker"},"nextItem":{"title":"A small issue with curl related to using different versions of curl between IDE and local terminal","permalink":"/blog/2023/03/16/linux-server/little-curl-problem"}},"content":"## workflow \u5340\u5206 env \u8a2d\u5b9a\u6a21\u5f0f\\n\\n\u4f7f\u7528 CI \u8ddf\u5beb\u7a0b\u5f0f\u90fd\u6703\u9047\u5230\u8981\u5f9e env \u62ff\u53d6\u8b8a\u6578\u503c\u7684\u6642\u5019\uff0c\u5728 github \u7ba1\u7406\u65b9\u5f0f\u5982\u4e0b\uff0c\u4e3b\u8981\u5224\u65b7\u662f\u9019\u500b\u8b8a\u6578\u662f\u5426\u8981\u7d66\u591a\u500b workflow \u4f7f\u7528\u3002\\n\\n### \u55ae workflow \u4f7f\u7528\\n\\n\u975e\u5bc6\u78bc\u985e\u578b\uff0c\u5728 workflow \u4e2d\u5b9a\u7fa9 env \u5373\u53ef\u3002\\n\\n```\\nname: Greeting on variable day\\n\\non:\\n  workflow_dispatch\\n\\nenv:\\n  DAY_OF_WEEK: Monday\\n\\njobs:\\n  greeting_job:\\n    runs-on: ubuntu-latest\\n    env:\\n      Greeting: Hello\\n    steps:\\n      - name: \\"Say Hello Mona it\'s Monday\\"\\n        run: echo \\"$Greeting $First_Name. Today is $DAY_OF_WEEK!\\"\\n        env:\\n          First_Name: Mona\\n```\\n\\n\u4e0d\u540c\u5c64\u6b21\u7684\u74b0\u5883\u8b8a\u6578\u53ef\u4ee5\u7e7c\u627f\u4e26\u8986\u84cb\u8f03\u9ad8\u5c64\u6b21\u7684\u74b0\u5883\u8b8a\u6578\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5728\u9802\u7d1a\u5de5\u4f5c\u6d41\u7a0b\u6587\u4ef6\u4e2d\u8a2d\u7f6e\u4e86\u4e00\u500b\u74b0\u5883\u8b8a\u6578\uff0c\u4e26\u4e14\u5728\u4f5c\u696d\u4e2d\u4f7f\u7528\u76f8\u540c\u7684\u8b8a\u6578\u540d\u7a31\u5b9a\u7fa9\u4e86\u53e6\u4e00\u500b\u503c\uff0c\u90a3\u9ebc\u5728\u8a72\u4f5c\u696d\u4e2d\u4f7f\u7528\u7684\u503c\u5c07\u8986\u84cb\u9802\u7d1a\u503c\u3002\\n\\n\u5bc6\u78bc\u985e\u578b\uff0c\u5c31\u9700\u8981\u7528\u5230\u6703\u8de8\u591a\u500b workflow \u7684 secrets \u53bb\u7ba1\u7406\u3002\\n\\n### \u591a workflow \u4f7f\u7528\\n\\n\u9700\u5728 github UI \u8a2d\u5b9a\u8b8a\u6578\u3002\u9019\u4e9b\u8b8a\u6578\u53ef\u4ee5\u8de8\u591a\u500b\u5de5\u4f5c\u6d41\u7a0b\u4f7f\u7528\u3002\\n\u4f4d\u7f6e\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./github-env-repo-variable.png\\").default}\\n      alt=\\"github-env-repo-variable.png\\"\\n    />\\n  </div>\\n</>\\n\\n\u4e3b\u8981\u4e09\u5c64\u7d1a:\\n\\n1. \u7d44\u7e54\\n2. \u5b58\u5132\u5eab\\n3. \u74b0\u5883\\n\\n   \u4e0a\u9762\u5716\u6709 repo \u8ddf env \u7684\uff0c\u4f7f\u7528\u9806\u5e8f\u90e8\u5206\uff1aEnvironment > Repository > Organization\u3002\\n   \u5982\u679c\u6709\u76f8\u540c\u8b8a\u6578\uff0c\u512a\u5148\u7528 Environment , than Repository, than\uff1aOrganization\u3002\\n\\n## \u4f7f\u7528\u60c5\u5883\\n\\n\u9019\u908a\u63d0\u4f9b\u53c3\u8003\\n\\n\u5982\u679c\u60a8\u4e0d\u78ba\u5b9a\uff0c\u4e5f\u53ef\u4ee5\u5f9e\u5b58\u5132\u5eab\u5bc6\u9470\u958b\u59cb\u70ba\u6240\u6709\u6771\u897f\u5275\u5efa\u5bc6\u9470\u3002\u5982\u679c\u4e4b\u5f8c\u6709\u5f15\u5165\u9700\u8981\u4e0d\u540c\u5bc6\u9470\u7684\u4e0d\u540c\u74b0\u5883\uff0c\u4f8b\u5982 prod,dev,test \u7b49\uff0c\u5247\u53ef\u4ee5\u5c07\u5b58\u5132\u5eab\u5bc6\u9470\u79fb\u52d5\u5230\u7279\u5b9a\u74b0\u5883\u3002\u7136\u5f8c\u5728\u7279\u5b9a\u74b0\u5883\u7528\u7279\u5b9a\u8b8a\u6578\u503c\u3002\\n\\n## \u4f7f\u7528\u65b9\u6cd5\\n\\n### \u8a2d\u5b9a\u5728 sercrets\\n\\n\u8981\u7528\u8981\u9019\u6a23\u7528`${{ secrets.YOURKEY }}`\\n\u70ba\u5565\u683c\u5f0f\u9577\u9019\u6a23\u8981\u770b[secrets \u4e0a\u4e0b\u6587](https://docs.github.com/en/actions/learn-github-actions/contexts#secrets-context)\\n\\n### \u8a2d\u5b9a\u5728 variables\\n\\n\u8981\u7528\u8981\u9019\u6a23\u7528`${{ vars.YOURKEY }}`\\n\u70ba\u5565\u683c\u5f0f\u9577\u9019\u6a23\u8981\u770b[vars \u4e0a\u4e0b\u6587](https://docs.github.com/en/actions/learn-github-actions/contexts#vars-context)\\n\\n### \u8a2d\u5b9a\u5728 workflow \u88e1\u7684 env\\n\\n\u5982\u679c\u662f\u5728\u6a5f\u5668\u5e95\u4e0b\uff0c\u53ef\u4ee5\u7528`$KEY`(linux).\\n\\n\u8a2d\u5b9a\u5728\u6a5f\u5668\u5916\u9762(job \u4ee5\u4e0a\u5c64\u7d1a)\u8981\u7528[env \u4e0a\u4e0b\u6587](https://docs.github.com/en/actions/learn-github-actions/contexts#env-context)\uff0c`${{ env.mascot }}`\\n\\n:::info\\n\\n[\u53c3\u8003\u7684\u5b98\u7db2\u8cc7\u6599-variables \u7ba1\u7406](https://docs.github.com/en/actions/learn-github-actions/variables)\\n:::"},{"id":"/2023/03/16/linux-server/little-curl-problem","metadata":{"permalink":"/blog/2023/03/16/linux-server/little-curl-problem","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/linux-server/2023-03-16-little-curl-problem.md","source":"@site/blog/linux-server/2023-03-16-little-curl-problem.md","title":"A small issue with curl related to using different versions of curl between IDE and local terminal","description":"\u524d\u9663\u5b50\u56e0\u70ba\u9700\u8981\u6aa2\u67e5\u57df\u540d\u8a2d\u5b9a\uff0c\u6e2c\u8a66\u904e\u7a0b\u4e2d\u767c\u73fe\u5728 pycharm \u904b\u884c curl \u6307\u4ee4\uff0c\u904b\u884c\u7d50\u679c\u8ddf iterm2 \u7684\u904b\u884c\u7d50\u679c\u4e0d\u540c\uff0c\u4ee5\u4e0b\u662f demo \u6307\u4ee4\uff0c\u6700\u5f8c\u4f7f\u7528which curl\u767c\u73fe\u5169\u908acurl\u6709\u5dee\u5225\uff0c\u9032\u4e00\u6b65\u6aa2\u67e5\u767c\u73fe\u5169\u8005\u6a94\u6848 size \u4e5f\u6709\u5dee\uff0c\u4f7f\u7528\u7684\u76f8\u95dc\u5957\u4ef6\u4e5f\u6709\u5dee\u3002\u5fc3\u5f97\uff1a\u57fa\u672c\u4e0a\u9023\u81ea\u5df1\u96fb\u8166\u74b0\u5883\u90fd\u53ef\u80fd\u7528\u9ad2\u4e86\uff0c\u4e4b\u5f8c\u6392\u67e5\u985e\u4f3c\u7684bug\u9806\u5e8f\u6703\u5148\u6aa2\u67e5\u5f7c\u6b64\u4f7f\u7528\u6307\u4ee4\u7684\u7248\u672c\uff0c\u78ba\u8a8d\u6c92\u5dee\u592a\u591a\uff0c\u5728\u958b\u59cb\u5f80\u5176\u4ed6\u65b9\u5411\u6392\u67e5\u3002","date":"2023-03-16T00:00:00.000Z","formattedDate":"March 16, 2023","tags":[{"label":"curl","permalink":"/blog/tags/curl"}],"readingTime":2.635,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"A small issue with curl related to using different versions of curl between IDE and local terminal","description":"\u524d\u9663\u5b50\u56e0\u70ba\u9700\u8981\u6aa2\u67e5\u57df\u540d\u8a2d\u5b9a\uff0c\u6e2c\u8a66\u904e\u7a0b\u4e2d\u767c\u73fe\u5728 pycharm \u904b\u884c curl \u6307\u4ee4\uff0c\u904b\u884c\u7d50\u679c\u8ddf iterm2 \u7684\u904b\u884c\u7d50\u679c\u4e0d\u540c\uff0c\u4ee5\u4e0b\u662f demo \u6307\u4ee4\uff0c\u6700\u5f8c\u4f7f\u7528which curl\u767c\u73fe\u5169\u908acurl\u6709\u5dee\u5225\uff0c\u9032\u4e00\u6b65\u6aa2\u67e5\u767c\u73fe\u5169\u8005\u6a94\u6848 size \u4e5f\u6709\u5dee\uff0c\u4f7f\u7528\u7684\u76f8\u95dc\u5957\u4ef6\u4e5f\u6709\u5dee\u3002\u5fc3\u5f97\uff1a\u57fa\u672c\u4e0a\u9023\u81ea\u5df1\u96fb\u8166\u74b0\u5883\u90fd\u53ef\u80fd\u7528\u9ad2\u4e86\uff0c\u4e4b\u5f8c\u6392\u67e5\u985e\u4f3c\u7684bug\u9806\u5e8f\u6703\u5148\u6aa2\u67e5\u5f7c\u6b64\u4f7f\u7528\u6307\u4ee4\u7684\u7248\u672c\uff0c\u78ba\u8a8d\u6c92\u5dee\u592a\u591a\uff0c\u5728\u958b\u59cb\u5f80\u5176\u4ed6\u65b9\u5411\u6392\u67e5\u3002","image":"https://github.com/suyuying.png","authors":"suyuying","tags":["curl"]},"prevItem":{"title":"environment variable and  secrets variable config in github","permalink":"/blog/2023/03/16/github-action/githubaction-env-secrets-variablr-config"},"nextItem":{"title":"s3 set iam permissions for Github Actions to achieve CIBuild an AWS s3 static website","permalink":"/blog/2023/03/15/Aws/s3-setting-for-ci"}},"content":"## \u540c pc \u7684 curl \u7d50\u679c\u4e0d\u540c\\n\\n\u524d\u9663\u5b50\u56e0\u70ba\u9700\u8981\u6aa2\u67e5\u57df\u540d\u8a2d\u5b9a\uff0c\u6e2c\u8a66\u904e\u7a0b\u4e2d\u767c\u73fe\u5728 pycharm \u904b\u884c curl \u6307\u4ee4\uff0c\u904b\u884c\u7d50\u679c\u8ddf iterm2 \u7684\u904b\u884c\u7d50\u679c\u4e0d\u540c\uff0c\u4ee5\u4e0b\u662f demo \u6307\u4ee4\\n\\n```\\ncurl -XPOST \'https://www.boce.com/apiHtml/login\' \\\\\\n  -A \\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36\\" \\\\\\n  -H \'Content-Type: application/json\' \\\\\\n  -d \'{\\n    \\"email_or_phone\\":\\"thisIsSecret\\",\\n    \\"password\\":\\"thisIsSecret\\"\\n  }\'\\n```\\n\\n## curl \u6307\u4ee4\u57fa\u672c\u4ecb\u7d39\\n\\nCurl \u662f\u4e00\u7a2e\u5728\u547d\u4ee4\u5217\u4ecb\u9762\u4e0b\u4f7f\u7528\u7684\u958b\u653e\u539f\u59cb\u78bc\u6a94\u6848\u50b3\u8f38\u5de5\u5177\uff0c\u5e38\u7528\u65bc HTTP\u3001HTTPS\u3001FTP \u7b49\u5354\u5b9a\u7684\u50b3\u8f38\\n\u56e0\u70ba`curl`\u9078\u9805\u592a\u591a\uff0c\u53ef\u4ee5\u7528`curl --help all`\u770b\u6240\u6709\u9078\u9805\uff0c\\n\u5e38\u7528\u9078\u9805\u6709\u4ee5\u4e0b\\n\\n1. -H \u5e36 header\\n2. -A \u5e36 useragent\\n3. -i \u770b\u56de\u61c9 header(\u53ef\u4ee5\u62ff\u4f86\u67e5\u56de\u61c9 token)\\n4. -d \u4f7f\u7528 post \u65b9\u6cd5\u8981\u5e36\u5165 data\\n5. -X \u4f7f\u7528\u7684\u65b9\u6cd5 ex. POST PUT DELETE GET\\n6. -c cookie \u76f8\u95dc\u64cd\u4f5c\\n   \u4ee5\u4e0b\u70ba\u4f8b\uff0c\u767b\u5165\u7db2\u7ad9\u4e26\u628a\u56de\u61c9 cookie \u5b58\u5728 cookie.txt\\n\\n```\\ncurl -c cookie.txt -XPOST \'https://www.boce.com/apiHtml/login\' \\\\\\n  -A \\"Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/111.0.0.0 Safari/537.36\\" \\\\\\n  -H \'Content-Type: application/json\' \\\\\\n  -d \'{\\n    \\"email_or_phone\\":\\"thisIsSecret\\",\\n    \\"password\\":\\"thisIsSecret\\"\\n  }\'\\n```\\n\\n\u5f8c\u7e8c\u53ef\u4ee5\u7528`curl -b cookie.txt`\u5728\u8acb\u6c42\u6642\u628a cookie \u5e36\u5165\u5230 request \u4e2d\\n\\n7. -v \u8a73\u7d30\u6a21\u5f0f\\n8. `-o file\u540d\u7a31 \u7db2\u5740` \u4e0b\u8f09\u5716\u7247\u4f7f\u7528\uff0c\u6a94\u540d\u81ea\u5df1\u547d\u540d Write to file instead of stdout\\n9. `-O \u7db2\u5740` \u4e0b\u8f09\u8cc7\u6599\u4f7f\u7528\uff0c\u6a94\u540d\u540c\u9060\u7aef\u7db2\u5740\u6a94\u540d Write output to a file named as the remote file\\n10. -L \u8ddf\u96a8 301 302 \u8df3\u8f49\\n11. Basic Authentication\uff0c\u53ef\u4ee5\u651c\u5e36 --user username:password \u4f86\u901a\u904e\u9a57\u8b49\u3002\\n\\n### step1. \u554f\u984c\u6392\u67e5 curl -v \u770b\u904e\u7a0b\\n\\n\u6bd4\u8f03\u5f8c\u767c\u73fe\uff0cide \u8ddf terminal \u5e36\u7684 header \u8ddf useragent \u9019\u4e9b\u90fd\u6709\u5e36\uff0c\u554f\u984c\u4e0d\u5728\u9019\u908a\u3002\\n\\n### step2. \u6aa2\u67e5\u4f7f\u7528\u7684 curl \u662f\u5426\u6709\u5dee\\n\\n\u6aa2\u67e5`which crul`\u8f38\u51fa\\n\\nide: /usr/bin/curl (curl 7.79.1 (x86_64-apple-darwin21.0) libcurl/7.79.1 (SecureTransport) LibreSSL/3.3.6 zlib/1.2.11 nghttp2/1.45.1\\nRelease-Date: 2021-09-22)\\n\\nterminal: /Users/ford/opt/anaconda3/bin/curl (curl 7.82.0 (x86_64-apple-darwin13.4.0) libcurl/7.82.0 OpenSSL/1.1.1n zlib/1.2.12 libssh2/1.10.0 nghttp2/1.46.0\\nRelease-Date: 2022-03-05)\\n\\n\u767c\u73fe\u6709\u5dee\u5225\uff0c\u9032\u4e00\u6b65\u6aa2\u67e5\u767c\u73fe\u5169\u8005\u6a94\u6848 size \u4e5f\u6709\u5dee\uff0c\u4f7f\u7528\u7684\u76f8\u95dc\u5957\u4ef6\u4e5f\u6709\u5dee\u3002\\n\\n\u89e3\u6cd5\uff1a \u76f4\u63a5\u6307\u5b9a curl \u4f4d\u7f6e,/usr/bin/curl \u3002\\n\\n## \u5fc3\u5f97\\n\\n\u57fa\u672c\u4e0a\u9023\u81ea\u5df1\u96fb\u8166\u74b0\u5883\u90fd\u53ef\u80fd\u7528\u9ad2\u4e86\uff0c\u4e4b\u5f8c\u6392\u67e5\u985e\u4f3c\u7684 bug \u9806\u5e8f\u6703\u5148\u6aa2\u67e5\u5f7c\u6b64\u4f7f\u7528\u6307\u4ee4\u7684\u7248\u672c\uff0c\u78ba\u8a8d\u6c92\u5dee\u592a\u591a\uff0c\u5728\u958b\u59cb\u5f80\u5176\u4ed6\u65b9\u5411\u6392\u67e5\u3002"},{"id":"/2023/03/15/Aws/s3-setting-for-ci","metadata":{"permalink":"/blog/2023/03/15/Aws/s3-setting-for-ci","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Aws/2023-03-15-s3-setting-for-ci.md","source":"@site/blog/Aws/2023-03-15-s3-setting-for-ci.md","title":"s3 set iam permissions for Github Actions to achieve CIBuild an AWS s3 static website","description":"\u5efa\u7acbaws\u975c\u614b\u7db2\u7ad9\u63a5\u4e0acloudfront\uff0c\u6700\u5f8c\u8a2d\u5b9a github action \u5728 code \u66f4\u65b0\u4ee5\u5f8c\u6703\u628a build \u597d\u7684\u8cc7\u6599\u7531 build \u8cc7\u6599\u593e\u5e95\u4e0b\u6771\u897f\u767c\u5230 S3.","date":"2023-03-15T00:00:00.000Z","formattedDate":"March 15, 2023","tags":[{"label":"AWS","permalink":"/blog/tags/aws"}],"readingTime":7.745,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"s3 set iam permissions for Github Actions to achieve CIBuild an AWS s3 static website","description":"\u5efa\u7acbaws\u975c\u614b\u7db2\u7ad9\u63a5\u4e0acloudfront\uff0c\u6700\u5f8c\u8a2d\u5b9a github action \u5728 code \u66f4\u65b0\u4ee5\u5f8c\u6703\u628a build \u597d\u7684\u8cc7\u6599\u7531 build \u8cc7\u6599\u593e\u5e95\u4e0b\u6771\u897f\u767c\u5230 S3.","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["AWS"]},"prevItem":{"title":"A small issue with curl related to using different versions of curl between IDE and local terminal","permalink":"/blog/2023/03/16/linux-server/little-curl-problem"},"nextItem":{"title":"CI:use github action to build image and push to git hub container registry","permalink":"/blog/2023/03/11/github-action/githib-action-CI-to-github-container"}},"content":"## S3 \u975c\u614b\u7db2\u7ad9\u8a2d\u5b9a\\n\\n:::info\\n\u5982\u679c\u6709\u6253\u7b97\u9650\u5236\u80fd\u8fd1\u4f86\u7684\u57df\u540d\uff0c\u5c31\u8acb\u4e0d\u8981\u7528\u975c\u614b\u7db2\u7ad9\uff0c\u5c31\u7528\u9810\u8a2d\u7684 RestApi \u6a21\u5f0f\uff0c\u63a5 cloudfront \u900f\u904e header \u53bb\u9650\u5b9a\u3002\\n:::\\n[\u5b98\u7db2\u6559\u5b78\u5f88\u8a73\u7d30\uff01](https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/HostingWebsiteOnS3Setup.html)\\n\u8981\u5728 Amazon S3 \u4e0a\u8a2d\u5b9a\u975c\u614b\u7db2\u7ad9\uff0c\u5982\u679c\u662f\u4f7f\u7528 UI \u7684\u8a71\uff0c\u8acb\u6309\u7167\u4ee5\u4e0b\u6b65\u9a5f\u9032\u884c\u64cd\u4f5c\uff1a\\n\\n1. UI: \u5efa\u7acb\u65b0\u7684 S3 Bucket \u6216\u9078\u64c7\u4e00\u500b\u73fe\u6709\u7684 Bucket\u3002(Cli:`aws s3 mb s3://me-profile --profile ford --region us-west-1` \u5728 us-west-1 \u5efa\u7acb s3 bucket,bucket \u540d\u7a31\u662f me-profile,\u4f7f\u7528\u7684 user \u662f ford)\\n2. UI:\u5728 Bucket \u5c6c\u6027\u4e2d\u555f\u7528\u975c\u614b\u7db2\u7ad9\u4e3b\u6a5f\u3002\\n3. UI:\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u7d22\u5f15\u6587\u4ef6(index.html)\u548c\u932f\u8aa4\u6587\u4ef6\u3002(Cli:`aws s3 website s3://bucket-name --index-document index.html --error-document error.html`)\\n4. UI :\u5c07\u5fc5\u8981\u7684\u6587\u4ef6\u6dfb\u52a0\u5230 Bucket \u4e2d\u3002(\u53ef\u4ee5\u7528 \u4e5f\u53ef\u4ee5\u7528 cli\\n   Cli:`aws s3 sync ./dist/ s3://fordserver-front --delete --profile ford`)\\n5. UI :\u914d\u7f6e Bucket \u7b56\u7565\u4ee5\u5141\u8a31\u516c\u958b\u8a2a\u554f\u6587\u4ef6\uff0c\u9810\u8a2d\u6703\u5168\u64cb\u3002\\n6. UI :\u65b0\u589e\u5132\u5b58\u8caf\u9ad4\u653f\u7b56\uff0c\u5c07\u5132\u5b58\u8caf\u9ad4\u5167\u5bb9\u8a2d\u70ba\u53ef\u4f9b\u5927\u773e\u8b80\u53d6\uff0c\u628a\u9019\u500b json \u8907\u88fd\u8cbc\u4e0a\\n\\n```jsx {11-12}\\n{\\n    \\"Version\\": \\"2012-10-17\\",\\n    \\"Statement\\": [\\n        {\\n            \\"Sid\\": \\"PublicReadGetObject\\",\\n            \\"Effect\\": \\"Allow\\",\\n            \\"Principal\\": \\"*\\",\\n            \\"Action\\": [\\n                \\"s3:GetObject\\"\\n            ],\\n            \\"Resource\\": [\\n                \\"arn:aws:s3:::Bucket-Name/*\\"\\n            ]\\n        }\\n    ]\\n}\\n```\\n\\nResource \u66f4\u65b0\u70ba\u60a8\u7684\u5132\u5b58\u8caf\u9ad4\u540d\u7a31!\\n\\n\x3c!--truncate--\x3e\\n\\n7. (\u53ef\u9078)\u5982\u679c\u8981\u914d\u7f6e\u81ea\u5df1\u8cb7\u7684\u57df\u540d\uff0c \u628a cname \u8a2d\u7f6e\u4ee5\u6307\u5411 S3 \u7db2\u7ad9\u7aef\u9ede\u3002\\n\\n\u6309\u7167\u9019\u4e9b\u6b65\u9a5f\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Amazon S3 \u5efa\u7acb\u7c21\u55ae\u4e14\u5177\u6210\u672c\u6548\u76ca\u7684\u975c\u614b\u7db2\u7ad9\u3002\\n\\n## \u63a5 clourfront\\n\\n\u5efa\u7acb\u4e00\u500b\u975c\u614b\u7db2\u7ad9\u4e4b\u5f8c\uff0c\u53bb\u5efa\u7acb cloudfront\uff0c\u628a\u6d41\u91cf\u5c0e\u5230 s3\u3002\\n\\n\u4ee5\u4e0b\u662f\u5efa\u7acb CloudFront \u5206\u767c\u7684\u6b65\u9a5f\uff1a\\n\\n1. \u767b\u5165 AWS Management Console \u4e26\u524d\u5f80 CloudFront \u63a7\u5236\u53f0\u9801\u9762\u3002\\n2. \u9ede\u64ca\u300c\u5efa\u7acb distribution\u300d\u6309\u9215\u3002\\n3. \u5728\u300c\u5efa\u7acb distribution\u300d\u9801\u9762\u4e2d\uff0c\u60a8\u53ef\u4ee5\u5f9e\u4e0b\u62c9\u5f0f\u6e05\u55ae\u9078\u64c7\u300cWeb\u300d\u6216\u300cRTMP\u300d\u5206\u767c\u7684\u985e\u578b\u3002\\n4. \u5c0d\u65bc Web \u5206\u767c\uff0c\u5728 Origin \u6b04\u4f4d\u4e2d\uff0c\u5f9e\u4e0b\u62c9\u5f0f\u6e05\u55ae\u9078\u64c7\u60a8\u7684 S3 \u6876\u7684 REST API \u7aef\u9ede\u6216\u8f38\u5165\u60a8\u7684 S3 \u6876\u7684\u7db2\u7ad9\u7aef\u9ede\u3002[\u7db2\u7ad9\u7aef\u9ede\u548c REST API \u7aef\u9ede\u4e4b\u9593\u7684\u4e3b\u8981\u5dee\u7570](https://docs.aws.amazon.com/zh_tw/AmazonS3/latest/userguide/WebsiteEndpoints.html#WebsiteRestEndpointDiff)\\n5. \u5728\u9810\u8a2d\u5feb\u53d6\u884c\u70ba\u4e2d\uff0c\u70ba Viewer \u5354\u8b70\u539f\u5247\u9078\u64c7 HTTP \u548c HTTPS \u6216\u91cd\u65b0\u5c0e\u5411 HTTP \u5230 HTTPS\u3002\\n   \u6ce8\u610f\uff1a\u9078\u64c7\u50c5\u4f7f\u7528 HTTPS \u6703\u5c01\u9396\u6240\u6709 HTTP \u8acb\u6c42\u3002\\n6. \u5982\u679c\u60a8\u6c92\u6709\u4f7f\u7528 CloudFront \u7684\u66ff\u4ee3\u57df\u540d (CNAME)\uff0c\u5247\u9078\u64c7\u300c\u5efa\u7acb\u5206\u767c\u300d\u4ee5\u5b8c\u6210\u6d41\u7a0b\u3002\u5982\u679c\u60a8\u6b63\u5728\u4f7f\u7528 CNAME\uff0c\u5247\u5728\u5275\u5efa\u5206\u767c\u4e4b\u524d\u8acb\u6309\u7167\u4ee5\u4e0b\u984d\u5916\u6b65\u9a5f\u9032\u884c\u64cd\u4f5c\uff1a\\n   - \u5c0d\u65bc\u66ff\u4ee3\u57df\u540d (CNAME)\uff0c\u8acb\u9078\u64c7\u300c\u65b0\u589e\u9805\u76ee\u300d\uff0c\u7136\u5f8c\u8f38\u5165\u60a8\u7684\u66ff\u4ee3\u57df\u540d\u3002\\n   - \u5c0d\u65bc\u81ea\u8a02 SSL \u6191\u8b49\uff0c\u5f9e\u4e0b\u62c9\u5f0f\u6e05\u55ae\u4e2d\u9078\u64c7\u6db5\u84cb\u60a8\u7684 CNAME \u7684\u81ea\u8a02 SSL \u6191\u8b49\uff0c\u4ee5\u5c07\u5176\u6307\u6d3e\u7d66\u5206\u767c\u3002(\u9019\u88e1\u53ef\u4ee5\u7528 aws \u7684\u81ea\u7c3d\u6191\u8b49\u6703\u5f88\u65b9\u4fbf!)\\n\\n## lab: Provide CI access to write to S3 resources\\n\\n\u76ee\u6a19: \u8a2d\u5b9a github action \u5728 code \u66f4\u65b0\u4ee5\u5f8c\u6703\u628a build \u597d\u7684\u8cc7\u6599\u7531 build \u8cc7\u6599\u593e\u5e95\u4e0b\u6771\u897f\u767c\u5230 S3.\\n\\n\u540d\u8a5e\u5b9a\u7fa9\uff1a\\n\\nSTS: AWS Security Token Service API,\u63d0\u4f9b\u4fe1\u4efb\u7684\u4f7f\u7528\u8005\u66ab\u6642\u5b89\u5168\u6191\u8b49\uff0c\u63a7\u5236\u5c0d\u65bc AWS \u8cc7\u6e90\u7684\u5b58\u53d6\u3002\\n\\nOIDC: OpenID Connect,Google \u6216 Salesforce\u3002\u5982\u679c\u60f3\u8981\u5728 OIDC \u76f8\u5bb9\u7684 IdP \u548c\u60a8\u7684 AWS \u5e33\u6236 \u4e4b\u9593\u5efa\u7acb\u4fe1\u4efb\uff0c\u8acb\u4f7f\u7528 IAM OIDC \u8eab\u5206\u63d0\u4f9b\u8005\u3002\\n\\nIdP: Identity Provider \u8eab\u5206\u8b58\u5225\u8cc7\u8a0a\u63d0\u4f9b\u8005\\n\\nSAML: Security Assertion Markup Language\uff08\u5b89\u5168\u65b7\u8a00\u6a19\u8a18\u5f0f\u8a9e\u8a00\uff09\u7684\u7e2e\u5beb\uff0c\u662f\u6307\u5728\u8eab\u5206\u8b58\u5225\u8cc7\u8a0a\u63d0\u4f9b\u8005\uff08IdP\uff09\u8207\u670d\u52d9\u63d0\u4f9b\u8005\uff08Service Provider\uff0cSP\uff09\u4e4b\u9593\u50b3\u9001\u9a57\u8b49\u4ee5\u53ca\u6388\u6b0a\u8cc7\u6599\u7684\u4e00\u7a2e\u516c\u958b\u6a19\u6e96\u3002\\n\\n### lab 1.\u7528 IAM role \u914d\u5408 ODIC \u57f7\u884c CI\\n\\n\u9019\u908a\u793a\u7bc4\u7528 ODIC\uff0c\u8b93 aws \u8a8d\u53ef\u7684 IdP \u4f5c\u8eab\u4efd\u9a57\u8b49\u4e26\u9023\u7dda\u5230 AWS \u5b58\u53d6\u4e26\u66f4\u65b0 S3.\\n\\n\u5728\u5efa\u7acb IAM OIDC \u8eab\u5206\u63d0\u4f9b\u8005\u4e4b\u5f8c\uff0c\u5fc5\u9808\u5efa\u7acb\u4e00\u500b\u6216\u591a\u500b IAM \u89d2\u8272\u3002\u89d2\u8272\u662f AWS \u4e2d\u7684\u4e00\u500b\u8eab\u5206\uff0c\u4e26\u4e0d\u64c1\u6709\u81ea\u5df1\u7684\u6191\u8b49 (\u8207 IAM \u4f7f\u7528\u8005\u4e0d\u540c)\u3002\u5728\u6b64\u60c5\u6cc1\u4e2d\uff0c\u89d2\u8272\u4ee5\u52d5\u614b\u6307\u6d3e\u7d66\u806f\u5408\u8eab\u5206\u4f7f\u7528\u8005\uff0c\u800c\u8a72\u4f7f\u7528\u8005\u7531\u60a8\u7d44\u7e54\u7684\u8eab\u5206\u63d0\u4f9b\u8005 (IdP) \u9032\u884c\u9a57\u8b49\u3002\\n\\n```\\n\u9806\u5e8f:\\n\u5efa\u7acbIdentity Providers->\u5efa\u7acb\u89d2\u8272->\u81ea\u8a02\u4fe1\u4efb\u653f\u7b56->\u9023\u7d50\u8a31\u53ef\u653f\u7b56->\u8907\u88fd\u5efa\u7acb\u7684\u89d2\u8272ARN->\u8a2d\u5b9agithub CI/CD\u7684secret->\u5efa\u7acbyml\u6a94\\n```\\n\\n#### \u5efa\u7acb Identity Providers\\n\\n1. AWS console \u67e5\u8a62 IAM\uff0c\u5de6\u65b9 nav \u6b04\u4f4d\u9078\u4f9b\u61c9\u5546\u985e\u578b\u5f8c, \u9078 OpenID Connect.\\n2. \u4f9b\u61c9\u5546 URL, \u8f38\u5165 https://token.actions.githubusercontent.com\\n3. \u6309\\"\u53d6\u5f97\u6307\u7d0b\\"\\n4. \u5c0d\u8c61, \u8f38\u5165 sts.amazonaws.com\\n   \u4ee5\u4e0a\u5efa\u7acb\u4e4b\u5f8c\uff0carn:aws:iam::930209118237:oidc-provider/token.actions.githubusercontent.com\\n5. \u628a ARN \u8907\u88fd\u6e96\u5099\u5efa\u7acb role.\\n\\n#### \u5efa\u7acb\u89d2\u8272\\n\\n```\\n\u81ea\u8a02\u4fe1\u4efb\u653f\u7b56->\u9023\u7d50\u8a31\u53ef\\n```\\n\\n\u6388\u6b0a \u806f\u5408\u4f7f\u7528\u8005\u4e3b\u9ad4\uff0c\u7d66 github repo \u662f USERNAME/YOUR_REPO \u7684 pull or main \u53ef\u4ee5\u7528\u6b64\u89d2\u8272\uff0c\u4ee5\u4e0b\u8a18\u5f97\u66ff\u63db\u6210\u4f60\u7684 repo \u540d\u7a31\u6b50\uff01\\n\\n```jsx title=\\"\u4fe1\u4efb\u653f\u7b56(\u95dc\u4fc2)\\"\\n{\\n    \\"Version\\": \\"2012-10-17\\",\\n    \\"Statement\\": [\\n        {\\n            \\"Effect\\": \\"Allow\\",\\n            \\"Principal\\": {\\n                \\"Federated\\": \\"arn:aws:iam::9302XXX18237:oidc-provider/token.actions.githubusercontent.com\\"\\n            },\\n            \\"Action\\": \\"sts:AssumeRoleWithWebIdentity\\",\\n            \\"Condition\\": {\\n                \\"StringEquals\\": {\\n                    \\"token.actions.githubusercontent.com:sub\\": [\\n                        \\"repo:USERNAME/YOUR_REPO:pull_request\\",\\n                        \\"repo:USERNAME/YOUR_REPO:ref:refs/heads/main\\"\\n                    ],\\n                    \\"token.actions.githubusercontent.com:aud\\": \\"sts.amazonaws.com\\"\\n                }\\n            }\\n        }\\n    ]\\n}\\n```\\n\\n\u56e0\u70ba S3 \u8a31\u53ef\u8a2d\u5b9a\u771f\u7684\u592a\u591a\u4e86\uff0c\u9019\u908a\u4e3b\u8981\u5c31\u52fe\u9078 list \u8ddf\u5e7e\u500b\u6703\u7528\u5230\u7684 delete/get/put object\uff0c\u8a31\u53ef\u8a2d\u5b9a\u53c3\u8003[\u5b98\u7db2\u9019\u7bc7](https://docs.github.com/zh/enterprise-server@3.8/admin/github-actions/enabling-github-actions-for-github-enterprise-server/enabling-github-actions-with-amazon-s3-storage#%E4%BD%BF%E7%94%A8%E8%AE%BF%E9%97%AE%E5%AF%86%E9%92%A5%E9%80%9A%E8%BF%87-amazon-s3-%E5%AD%98%E5%82%A8%E5%90%AF%E7%94%A8-github-actions)\u3002\u5728\u770b\u8a31\u53ef\u904e\u7a0b\u4e2d\u6709\u770b\u5230 AWS cloudtrail \u63d0\u4f9b\u7684 IAM \u7d00\u9304\u89e3\u6790\uff0c\u5e6b\u4f60\u5206\u6790\u4e4b\u524d\u7684\u64cd\u4f5c\u4e26\u7528\u6700\u5c0f\u6b0a\u9650\u53bb\u8a2d\u5b9a(\u9019\u500b\u60c5\u5883\u5b98\u7db2\u6709\u8209\u4f8b: \u958b\u767c\u6642\u53ef\u80fd\u6703\u628a\u6b0a\u9650\u5168\u958b\uff0c\u4f46\u5be6\u969b\u4e0a PROD \u74b0\u5883\u5c31\u8981\u9650\u5236\u6b0a\u9650\uff0c\u53ef\u4ee5\u900f\u904e cloudtrail \u53bb\u5206\u6790\u4e4b\u524d\u6240\u6709\u5c0d S3 \u64cd\u4f5c\u6709\u7528\u5230\u7684\u6b0a\u9650\uff0c\u4e26\u8a2d\u5b9a\u4e4b)\uff0c\u4f46\u56e0\u70ba\u9084\u6c92\u5be6\u4f5c\uff0c\u6240\u4ee5\u5c31\u5148\u9019\u6a23\u3002\\n\\n```jsx title=\\"\u8a31\u53ef\u653f\u7b56for S3 CI/CD\\"\\n{\\n    \\"Version\\": \\"2012-10-17\\",\\n    \\"Statement\\": [\\n        {\\n            \\"Sid\\": \\"VisualEditor0\\",\\n            \\"Effect\\": \\"Allow\\",\\n            \\"Action\\": [\\n                \\"s3:PutObject\\",\\n                \\"s3:GetObject\\",\\n                \\"s3:ListBucketMultipartUploads\\",\\n                \\"s3:ListMultipartUploadParts\\",\\n                \\"s3:AbortMultipartUpload\\",\\n                \\"s3:DeleteObject\\",\\n                \\"s3:ListBucket\\"\\n            ],\\n            \\"Resource\\": \\"*\\"\\n        }\\n    ]\\n}\\n```\\n\\ngithub \u8a2d\u5b9a\u6a94\uff0c\u4ee5\u4e0b\u6703\u57f7\u884c build\uff0c\u9a57\u8b49 aws,\u628a\u7de8\u8b6f\u5f8c\u8cc7\u6599\u63a8\u5230 s3\u3002\\n\\n:::info\\npermissions \u4e00\u5b9a\u8981\u8a2d\u5b9a\u6210 write\uff0c\u9019\u6a23\u8a2d\u5b9a\u662f\u8981\u8a2d\u5beb\u5165\u6b0a\u9650\u624d\u80fd\u8acb\u6c42 OpenID Connect JWT \u4ee4\u724c\u3002\u6c92\u8a2d\u5b9a\u5c31\u6703\u8dd1\u51fa\u4ee5\u4e0b\u5831\u932f\\nError: Credentials could not be loaded, please check your action inputs: Could not load credentials from any providers\\n:::\\n\\n```jsx title=\\".github/workflows/deploy.yml\\" {10-11}\\nname: Deploy to GitHub Pages\\n\\non:\\n  push:\\n    branches:\\n      - main\\n    # Review gh actions docs if you want to further define triggers, paths, etc\\n    # https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#on\\n\\npermissions:\\n  id-token: write\\njobs:\\n  deploy:\\n    name: Deploy to GitHub Pages\\n    runs-on: ubuntu-latest\\n    steps:\\n      - uses: actions/checkout@v3\\n      - uses: actions/setup-node@v3\\n        with:\\n          node-version: 18\\n          cache: yarn\\n\\n      - name: Install dependencies\\n        run: yarn install --frozen-lockfile\\n      - name: Build website\\n        run: yarn build\\n      - name: Configure AWS Credentials\\n        uses: aws-actions/configure-aws-credentials@v1\\n        with:\\n          aws-region: ap-northeast-3\\n          role-to-assume: ${{ secrets.PROD_DEPLOY_ROLE }}\\n          role-session-name: OIDCSession\\n      - name: Deploy to S3 bucket\\n        run: aws s3 sync ./build/ s3://yours3 --delete\\n\\n```\\n\\n:::info\\n\u53c3\u8003\u8cc7\u8a0a\\n\\n1. [Enabling GitHub Actions with Amazon S3 storage](https://docs.github.com/zh/enterprise-server@3.8/admin/github-actions/enabling-github-actions-for-github-enterprise-server/enabling-github-actions-with-amazon-s3-storage)\\n\\n2. [Secure AWS deploys from GitHub Actions with OIDC](https://www.eliasbrange.dev/posts/secure-aws-deploys-from-github-actions-with-oidc/#2-add-github-as-an-identity-provider)\\n\\n:::"},{"id":"/2023/03/11/github-action/githib-action-CI-to-github-container","metadata":{"permalink":"/blog/2023/03/11/github-action/githib-action-CI-to-github-container","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/github-action/2023-03-11-githib-action-CI-to-github-container.md","source":"@site/blog/github-action/2023-03-11-githib-action-CI-to-github-container.md","title":"CI:use github action to build image and push to git hub container registry","description":"use CI in github action ,and variable in environments to build image and push to registry. github action \u5165\u9580\u653b\u7565\uff0cCI \u63a8image\u5230github","date":"2023-03-11T00:00:00.000Z","formattedDate":"March 11, 2023","tags":[{"label":"github action","permalink":"/blog/tags/github-action"},{"label":"CICD","permalink":"/blog/tags/cicd"}],"readingTime":4.675,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"CI:use github action to build image and push to git hub container registry","description":"use CI in github action ,and variable in environments to build image and push to registry. github action \u5165\u9580\u653b\u7565\uff0cCI \u63a8image\u5230github","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["github action","CICD"]},"prevItem":{"title":"s3 set iam permissions for Github Actions to achieve CIBuild an AWS s3 static website","permalink":"/blog/2023/03/15/Aws/s3-setting-for-ci"},"nextItem":{"title":"demo basic  github action","permalink":"/blog/2023/03/11/github-action/github-action-demo"}},"content":"## Build code registry\\n\\n\u628a code \u63a8\u5230 github \u6559\u5b78\u5f88\u591a\uff0c\u53ef\u4ee5 google \u4e00\u4e0b\uff0c\u4e0d\u904e\u8981\u6ce8\u610f\u7684\u662f\u73fe\u5728\u63a8 code \u90fd\u8981\u5148\u5728\u5b98\u7db2\u7533\u8acb token\uff0c\u65b0\u624b\u5f88\u5bb9\u6613\u5361\u5728\u9019\u3002\\n\\n## ways to build image and push\\n\\n\u57f7\u884c CI \u524d\uff0c\u8981\u78ba\u8a8d\u6709 Dockerfile \u4e26\u4e14\u5728\u5730\u7aef\u53ef\u4ee5 docker run \u670d\u52d9\u8d77\u4f86\uff0cCI \u904e\u7a0b\u6703\u7528\u8a72 Dokcerfile \u7522\u751f image\u3002\\n\\n### way1. build image and push from local side by docker command,use CI after to renew\\n\\n1. \u5728\u5730\u7aef build \u5b8c\uff0c\u7136\u5f8c\u63a8\u5230 github container registry(\u9700\u8981\u7528 github ui \u5efa\u7acb token,\u4e26\u7d66 token)\\n   \uff0c\u7136\u5f8c\u628a token \u5b58\u5230 txt \u6a94\\n\\n2. \u7528 token \u767b\u5165 github\\n\\n```\\ncat token.txt | docker login ghcr.io -u suyuying --password-stdin\\n```\\n\\n`-u` \u63db\u6210\u81ea\u5df1\u7684 username\\n\\n`token.txt`\u628a token \u653e\u5728\u88e1\u9762\\n\\n\x3c!--truncate--\x3e\\n\\n3. \u63a8 image \u5230 github container registry DONe\\n\\n```\\ndocker buildx build --platform=linux/arm64,linux/amd64 --push -t ghcr.io/suyuying/fastapi-backend:1.0 .\\n```\\n\\n:::info\\n\u9019\u500b\u65b9\u6cd5\u7576\u4e0b\u6c92\u5565\u554f\u984c\uff0c\u6703\u6210\u529f\u5efa\u7acb\uff0c\u5982\u679c\u4ee5\u4e0a\u65b9\u6cd5\u8981\u63a5\uff23\uff29\uff0c\u9084\u6709 step 4.\\nimage\uff0c\u4f46\u4e4b\u5f8c\u63a5 CI \u7684\u6642\u5019\u6703\\n\u9047\u5230\u6b0a\u9650\u554f\u984c\uff0c\u8c8c\u4f3c\u7528 token \u5efa\u7acb\u4ee5\u5f8c\uff0c\u4f60 CI \u88e1\u9762\u4f7f\u7528 registry \u7684 `password: ${{ secrets.GITHUB_TOKEN }} ` \u7684 token \u6703\u5931\u6548\uff0c[\u539f\u672c issue \u4f4d\u7f6e](https://github.com/orgs/community/discussions/26274)\\n\\n4.\u8acb\u524d\u5f80 $yourOrganization \u2192 Packages \u2192 $yourPackage \u2192 Package settings\uff08\u53f3\u5074/\u5e95\u90e8\uff09\uff0c\u4e26\u914d\u7f6e\u201c\u7ba1\u7406\u64cd\u4f5c\u8a2a\u554f\\"\u90e8\u5206\u4ee5\u5141\u8a31\u6709\u554f\u984c\u7684 git \u5b58\u5132\u5eab\u5c0d\u6b64\u5305 code \u5b58\u5132\u5eab\u6709 write \u6b0a\u9650\\n\\n:::\\n\\n### way2. use CI to create and push image first, and afterwards\\n\\n1.\u5728.github/workflows \u8cc7\u6599\u593e\u5efa\u7acb xxx.yml \u6a94\u6848\uff0c\u5167\u5bb9\\n\\n```\\n# This workflow uses actions that are not certified by GitHub.\\n# They are provided by a third-party and are governed by\\n# separate terms of service, privacy policy, and support\\n# documentation.\\n\\n# GitHub recommends pinning actions to a commit SHA.\\n# To get a newer version, you will need to update the SHA.\\n# You can also reference a tag or branch, but the action may change without warning.\\n\\nname: Create and publish a Docker image\\n\\non:\\n  push:\\n    branches: [\'main\']\\n\\njobs:\\n  build-and-push-image:\\n  // \u9019\u500b\u662f\u4e4b\u5f8c\u793a\u7bc4import config environment variable ,optional\\n    environment: prod\\n    runs-on: ubuntu-latest\\n    permissions:\\n      contents: read\\n      packages: write\\n    // \u9019\u500b\u662f\u5efa\u7acb\u9019\u4efd\u6587\u4ef6\u7684env\u8b8a\u6578\\n    env:\\n      Greeting: Hello\\n\\n    steps:\\n      - name: Checkout repository\\n        uses: actions/checkout@v3\\n\\n      - name: Log in to the Container registry\\n        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9\\n        with:\\n          registry: ghcr.io\\n          username: ${{ github.actor }}\\n          password: ${{ secrets.GITHUB_TOKEN }}\\n    //\u9019\u908a\u7684secrets\u8981\u7528Actions secrets and variables\u8a2d\u5b9a\\n      - uses: mr-smithers-excellent/docker-build-push@v6\\n        with:\\n    // \u9019\u908a\u683c\u5f0f\u5c31\u8a18\u4e0b\u4f86\uff0c\u56e0\u70ba\u4ed6\u5b98\u7db2\u5beb\u7684\u4e5f\u4e0d\u6e05\u4e0d\u695a\u7684\uff0c\u9019\u6a23\u6703\u505a\u51faghcr.io/suyuying/fastapi-backend\\n          image: fastapi-backend\\n          registry: ghcr.io\\n          username: ${{ secrets.GHCR_USERNAME }}\\n          password: ${{ secrets.GHCR_TOKEN }}\\n\\n```\\n\\n2. \u653e\u8b8a\u6578\u503c\u5230 github repo \u4e0a\\n<>\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./repo-secrect.png\\").default}\\n      style={{ width: \\"100%\\" }}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n\\nGHCR_USERNAME=\\"yourUserName\\"\\n\\nGHCR_TOKEN=\\"classic token \u7522\u51fa\u7684 token\\"\\n:::info\\n\u53ef\u4ee5\u7528 Environment secrets \u6216 Repository secrets\\n\u5c0d workflow \u800c\u8a00\u4ed6\u5011\u90fd\u6703\u653e\u5728 secrets \u9019\u500b\u7269\u4ef6\u88e1\u9762\uff0c\\n\u4f7f\u7528\u65b9\u5f0f\u5411\u662f\\n`${{ secrets.GHCR_TOKEN }}`\\n:::\\n\\n3.  \u56e0\u7232\u689d\u4ef6\u8a2d\u5b9a push main\uff0c\u6240\u4ee5\u78ba\u8a8d\u597d main branch \u76f4\u63a5\u63a8\u5c31\u6703\u767c\u73fe\u6709\u65b0\u4f5c image \u4e86\\n\\n:::tip\\n\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./vars-env.png\\").default}\\n      style={{ width: \\"100%\\" }}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n\\n\u5982\u679c\u8981\u4f7f\u7528\u4e0a\u9762\u518d environment \u74b0\u5883\u8b8a\u6578\u53d6\u503c\uff0c\u8981\u4f7f\u7528\u9019\u7a2e\u683c\u5f0f\\n`${{ vars.READ_MY_NAME }}` \u53bb\u53d6\u503c\\n:::\\n\\n:::info\\n\\n1. github action \u63d0\u4f9b\u4e86\u4e00\u5927\u5806 context\uff0c[\u53c3\u8003\u8cc7\u6599](https://docs.github.com/en/actions/learn-github-actions/contexts#vars-context) \uff0c\u4e0d\u77e5\u9053\u70ba\u5565\u7db2\u8def\u8b1b\u5230\u9019\u500b\u8cc7\u6e90\u5f88\u5c11\\n\\n2. \u5b98\u7db2\u6559\u5b78 CI build image \u63a8\u5230 container registry \u4f7f\u7528\u7684\u662f\u53e6\u4e00\u500b action\uff0c\u5169\u500b\u90fd\u7528\u904e\uff0c\u90fd\u53ef\u4ee5\u7528\u3002\\n   [\u53c3\u8003 actions](https://docs.github.com/en/actions/publishing-packages/publishing-docker-images#publishing-images-to-github-packages)\\n\\n```\\n# This workflow uses actions that are not certified by GitHub.\\n# They are provided by a third-party and are governed by\\n# separate terms of service, privacy policy, and support\\n# documentation.\\n\\n# GitHub recommends pinning actions to a commit SHA.\\n# To get a newer version, you will need to update the SHA.\\n# You can also reference a tag or branch, but the action may change without warning.\\n\\nname: Publish Docker image\\n\\non:\\n  release:\\n    types: [published]\\n\\njobs:\\n  push_to_registries:\\n    name: Push Docker image to multiple registries\\n    runs-on: ubuntu-latest\\n    permissions:\\n      packages: write\\n      contents: read\\n    steps:\\n      - name: Check out the repo\\n        uses: actions/checkout@v3\\n\\n      - name: Log in to Docker Hub\\n        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9\\n        with:\\n          username: ${{ secrets.DOCKER_USERNAME }}\\n          password: ${{ secrets.DOCKER_PASSWORD }}\\n\\n      - name: Log in to the Container registry\\n        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9\\n        with:\\n          registry: ghcr.io\\n          username: ${{ github.actor }}\\n          password: ${{ secrets.GITHUB_TOKEN }}\\n\\n      - name: Extract metadata (tags, labels) for Docker\\n        id: meta\\n        uses: docker/metadata-action@98669ae865ea3cffbcbaa878cf57c20bbf1c6c38\\n        with:\\n          images: |\\n            my-docker-hub-namespace/my-docker-hub-repository\\n            ghcr.io/${{ github.repository }}\\n\\n      - name: Build and push Docker images\\n        uses: docker/build-push-action@ad44023a93711e3deb337508980b4b5e9bcdc5dc\\n        with:\\n          context: .\\n          push: true\\n          tags: ${{ steps.meta.outputs.tags }}\\n          labels: ${{ steps.meta.outputs.labels }}\\n```\\n\\n:::"},{"id":"/2023/03/11/github-action/github-action-demo","metadata":{"permalink":"/blog/2023/03/11/github-action/github-action-demo","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/github-action/2023-03-11-github-action-demo.md","source":"@site/blog/github-action/2023-03-11-github-action-demo.md","title":"demo basic  github action","description":"GitHub Action \u662f continuous integration and continuous delivery (CI/CD)\u5e73\u53f0\uff0c\u9664\u4e86\u4e00\u822c\u7684 build test deploy \u4ed6\u53e6\u5916\u6709\u7d66\u5c08\u6848\u7ba1\u7406\u7684\u5404\u7a2e\u5c0f\u529f\u80fd\uff0c\u4f8b\u5982\u7d66 pull request \u6253\u6a19\u7c64\u3002\u63d0\u4f9b\u514d\u8cbb\u7684 runner \u5e6b\u4f60\u57f7\u884c\u4efb\u52d9\uff0c\u4e5f\u63a5\u53d7self-hosted runner\u3002","date":"2023-03-11T00:00:00.000Z","formattedDate":"March 11, 2023","tags":[{"label":"github action","permalink":"/blog/tags/github-action"},{"label":"CICD","permalink":"/blog/tags/cicd"}],"readingTime":7.54,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"demo basic  github action","description":"GitHub Action \u662f continuous integration and continuous delivery (CI/CD)\u5e73\u53f0\uff0c\u9664\u4e86\u4e00\u822c\u7684 build test deploy \u4ed6\u53e6\u5916\u6709\u7d66\u5c08\u6848\u7ba1\u7406\u7684\u5404\u7a2e\u5c0f\u529f\u80fd\uff0c\u4f8b\u5982\u7d66 pull request \u6253\u6a19\u7c64\u3002\u63d0\u4f9b\u514d\u8cbb\u7684 runner \u5e6b\u4f60\u57f7\u884c\u4efb\u52d9\uff0c\u4e5f\u63a5\u53d7self-hosted runner\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["github action","CICD"],"sidebar_position":1},"prevItem":{"title":"CI:use github action to build image and push to git hub container registry","permalink":"/blog/2023/03/11/github-action/githib-action-CI-to-github-container"},"nextItem":{"title":".env file management  in github action","permalink":"/blog/2023/03/11/github-action/github-action-env-file"}},"content":"## \u57fa\u672c\u4ecb\u7d39\\n\\nGitHub Action \u662f continuous integration and continuous delivery (CI/CD)\u5e73\u53f0\uff0c\\n\u9664\u4e86\u4e00\u822c\u7684 build test deploy \u4ed6\u53e6\u5916\u6709\u7d66\u5c08\u6848\u7ba1\u7406\u7684\u5404\u7a2e\u5c0f\u529f\u80fd\uff0c\u4f8b\u5982\u7d66 pull request \u6253\u6a19\u7c64\u3002\\n\u63d0\u4f9b\u514d\u8cbb\u7684 runner \u5e6b\u4f60\u57f7\u884c\u4efb\u52d9\uff0c\u4e5f\u63a5\u53d7 self-hosted runner\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n## GitHub Actions \u57fa\u672c\u5143\u7d20\\n\\n```\\nWorkflow-> Event -> Job-> Steps\\n```\\n\\n### Workflow\\n\\n\u4e00\u500b repository \u53ef\u4ee5\u6709\u591a\u500b workflow,\u6bcf\u500b workflow \u505a\u7684\u4e8b\u5b9a\u7fa9\u5728 yml\uff0c\u4e14\u898f\u5b9a\u5728.github/workflows \u5e95\u4e0b\uff0cworkflow \u5305\u542b\u4e00\u6b21\u8981\u904b\u884c\u7684\u6574\u500b\u904e\u7a0b\uff0c\u53ef\u4ee5\u7528\u624b\u52d5\u89f8\u767c\u6216\u8005 yml \u6a94\u5167\u5236\u5b9a\u689d\u4ef6\u89f8\u767c\u3002\\n\u8209\u4f8b\uff1a\u53ef\u4ee5\u7528\u4e00\u689d workflow \u505a build and test,\u53e6\u4e00\u500b workflow \u505a deploy\\n\\n### Events\\n\\n\u89f8\u767c Workflow \u7684\u4e8b\u4ef6\u7a31\u70ba Events\u3002\\n\\n### Jobs\\n\\n\u7531\u591a\u500b steps \u7d44\u6210\uff0c\u6bcf\u500b step \u53ef\u4ee5\u662f\u4e00\u500b shell script \u6216\u8005 action\uff0cstep \u6703\u4f9d\u5e8f\u5728\u540c\u4e00\u500b runner \u57f7\u884c\uff0c\u4e26\u53ef\u4ee5\u5171\u4eab data\uff0c\\n\u8209\u4f8b\u4f86\u8aaa\uff0cbuild \u5b8c\u5f8c\u7684\u6a94\u6848\uff0c\u53ef\u4ee5\u50b3\u7d66\u4e0b\u4e00\u500b test step \u6e2c\u8a66 build \u7d50\u679c\u3002\\n\\n\u4e00\u500b workflow \u53ef\u4ee5\u6709\u591a\u500b job,job \u9593\u5f7c\u6b64\u9810\u8a2d\u662f\u5e73\u884c\u57f7\u884c\uff0c\u4e5f\u53ef\u4ee5\u8a2d\u5b9a dependencies \u7b49\u5f85\u53e6\u4e00\u500b job\uff0c\\n\u8209\u4f8b\u4f86\u8aaa\uff0c\u4e00\u5305 code \u88e1\u9762\u8981 build \u591a\u500b\u6a94\u6848\uff0c\u6bcf\u500b build \u904e\u7a0b\u53ef\u4ee5\u662f\u4e00\u500b job \u5f7c\u6b64\u5e73\u884c\uff0c\u7b49\u5230\u90fd build \u7d50\u675f\uff0c\u5728\u57f7\u884c\u7d71\u4e00\u5230 packaging \u5de5\u4f5c\u3002\\n\\n### Actions\\n\\n\u52d5\u4f5c\u662f\u57f7\u884c\u8907\u96dc\u4f46\u7d93\u5e38\u91cd\u8907\u4efb\u52d9\uff0c GitHub Action \u5e73\u53f0\u63d0\u4f9b\u81ea\u5b9a\u7fa9\u61c9\u7528\u7a0b\u5e8f\u7684\u4e0a\u50b3\uff0c\u7c21\u55ae\u8aaa\u5c31\u662f\u628a\u67d0\u4e9b\u6703\u91cd\u8907\u51fa\u73fe\u7684 step \u505a\u6210 module \u4e26\u4f7f\u7528\uff0c\u56e0\u70ba\u9019\u683c\u539f\u56e0\uff0c\u6240\u4ee5\u4e5f\u53ef\u4ee5\u5f15\u7528\u5225\u4eba\u5beb\u597d\u5f97\uff0c\u6216\u81ea\u5efa\u5f97\uff0c\u5c31\u50cf\u662f\u5beb\u7a0b\u5f0f\u7528\u7684 package \u4e00\u6a23\u3002\\n\\n[\u5b98\u65b9\u7684 action \u5eab](https://github.com/marketplace?category=chat&type=actions&query=)\\n\\n[\u5982\u4f55\u5efa\u7acb\u81ea\u5df1\u7684 github action \u7684 actions](https://docs.github.com/zh/actions/creating-actions/about-custom-actions)\\n\\n### Runners\\n\\n\u57f7\u884c workflow \u7684\u6a5f\u5668\u3002\\n\\n## Demo\\n\\n### demo github actions\\n\\n```\\nname: learn-github-actions\\nrun-name: ${{ github.actor }} is learning GitHub Actions\\non: [push]\\njobs:\\n  check-bats-version:\\n    runs-on: ubuntu-latest\\n    steps:\\n      - uses: actions/checkout@v3\\n      - uses: actions/setup-node@v3\\n        with:\\n          node-version: \'14\'\\n      - run: npm install -g bats\\n      - run: bats -v\\n```\\n\\n`name`: All wolkflows \u96a8\u4fbf\u6311\u4e00\u500b\u9ede\u9032\u53bb\u770b\u5230\u5230 workflow \u540d\u5b57\uff0c\u5de5\u4f5c\u6d41\u7a0b\u7684\u540d\u7a31 learn-github-actions\\n\\n`run-name`: github \u9ede\u9032\u53bb Actions \u88e1\u9762\u770b\u5230 All wolkflows \u773e\u591a\u7684\u540d\u7a31\uff0c\u70ba\u5de5\u4f5c\u6d41\u7a0b\u904b\u884c\u6642\u7684\u540d\u7a31\uff0c${{ github.actor }} \u5167\u5efa\u8b8a\u6578\u3002\\n\\n`on`:\u6b64 workflow \u7684\u89f8\u767c\u689d\u4ef6\uff0c\u8a2d\u5b9a push \u662f\u63a8\u9001\u6216\u8005\u767c pull request \u5c31\u6703\u89f8\u767c\uff0c\u9032\u968e\u7248\u8acb\u6d3d\u5b98\u7db2\u63d0\u4f9b\u7684\\n[\u66f4\u7cbe\u7d30\u8a2d\u5b9a](https://docs.github.com/zh/actions/using-workflows/workflow-syntax-for-github-actions#onpushpull_requestpull_request_targetpathspaths-ignore)\\n\\n`jobs`:\u7d44\u5408\u591a\u500b work or action\uff0c\u76ee\u524d\u6709\u4e00\u683c\u4f5c\u696d\u53eb\u505a check-bats-version \u7684 work\\n\\n`check-bats-version`: \u4e00\u500b\u540d\u7232 check-bats-version \u7684\u4f5c\u696d\uff0c\u5b50\u9375\u5b9a\u7fa9\u4f5c\u696d\u5c6c\u6027\uff0c\u53ef\u4ee5\u63db\u6210\u5176\u4ed6\u7b26\u5408\u8a72 work \u5de5\u4f5c\u7684\u540d\u5b57\uff0c\u547d\u540d\u98a8\u683c\u662f-\u76f8\u9023\\n\\n`runs-on`: \u4f7f\u7528 github \u8a17\u7ba1\u7684 runner\uff0c\u4f5c\u696d\u904b\u884c\u7684\u64cd\u4f5c\u7cfb\u7d71\uff0c\u7232 ubuntu-latest\u3002\\n\\n`steps`: \u5b9a\u7fa9\u4f5c\u696d\u57f7\u884c\u6b65\u9a5f\uff0c\u53ef\u4ee5\u5305\u542b\u591a\u500b \u6307\u4ee4\u3001shell script\u3001action\uff08\u4e00\u5806\u6307\u4ee4\u7d44\u5408\u7684 module\uff09\\n\\n`uses`: \u904b\u4f5c\u67d0\u5ba2\u88fd\u5316 action\uff0caction \u5c31\u662f\u500b\u6307\u4ee4\u96c6\u5408\\n\\n- `actions/checkout@v3`\uff1a\u4f7f\u7528 v3 \u7248\u672c\u7684 `actions/checkout` Action\uff0c\u5f9e\u4ee3\u78bc\u5eab\u4e2d\u6aa2\u51fa\u4ee3\u78bc\u3002\\n- `actions/setup-node@v3`\uff1a\u4f7f\u7528 v3 \u7248\u672c\u7684 `actions/setup-node` Action\uff0c\u5b89\u88dd Node.js \u74b0\u5883\u3002\\n  with: \u5e36\u53c3\u6578\u5230 action \u88e1\u9762\\n\\n`run`: \u5728 runner \u4e0a\u904b\u884c\u7684\u6307\u4ee4\\n\\n- `run: npm install -g bats`\uff1a\u904b\u884c\u547d\u4ee4 `npm install -g bats`\uff0c\u5b89\u88dd Bats \u6e2c\u8a66\u6846\u67b6\u3002\\n- `run: bats -v`\uff1a\u904b\u884c\u547d\u4ee4 `bats -v`\uff0c\u986f\u793a Bats \u7684\u7248\u672c\u865f\u3002\\n\\n`name`: \u5b9a\u7fa9\u8a72 run \u7684\u540d\u5b57\uff0c\u4e0d\u5b9a\u7fa9\u5c31\u53ea\u7528 Run + \u5f8c\u9762\u57f7\u884c run \u5f97\u6307\u4ee4\\n\\n### \u88dc\u5145 actions \u5beb\u6cd5\\n\\nactions/checkout@v3 \u662f GitHub Action \u4e2d\u4e00\u500b\u5e38\u7528\u7684 action\uff0c\u7528\u65bc\u5c07\u7a0b\u5f0f\u78bc\u5009\u5eab\u7684\u7a0b\u5f0f\u78bc\u6aa2\u51fa\u5230\u5de5\u4f5c\u5340\u3002v3 \u662f\u9019\u500b action \u7684\u7248\u672c\u865f\u3002\u9019\u500b action \u7684\u4ee3\u78bc\u5009\u5eab\u4e2d\uff0c\u6709\u4e00\u500b action.yml \u6587\u4ef6\uff0c\u5b9a\u7fa9\u4e86\u9019\u500b action \u7684\u8f38\u5165\u548c\u8f38\u51fa\u53c3\u6578\u3002\u5177\u9ad4\u5982\u4e0b\uff1a\\n\\n```jsx title=\\"actions/checkout@v3\\"\\nname: \'Checkout\'\\ndescription: \'Checkout a Git repository\'\\ninputs:\\n  ref:\\n    description: \'The branch, tag or SHA to checkout\'\\n  repository:\\n    description: \'The name of the repository to checkout\'\\n    required: false\\n    default: ${{ github.repository }}\\n  submodules:\\n    description: \'Whether to checkout submodules\'\\n    required: false\\n    default: \'false\'\\n  ssh-key:\\n    description: \'SSH key used for fetching the repository. The key should have access to the repository or be able to authenticate for the repository URL.\'\\n    required: false\\n  persist-credentials:\\n    description: \'Whether to persist GITHUB_TOKEN and SSH_AUTH_SOCK environment variables when persisting the workspace\'\\n    required: false\\n    default: \'true\'\\n  fetch-depth:\\n    description: \'Depth of commits to fetch. Defaults to all commits.\'\\n    required: false\\n    default: \'0\'\\n  lfs:\\n    description: \'Whether to download Git LFS files\'\\n    required: false\\n    default: \'false\'\\n  clean:\\n    description: \\"Whether to run \'git clean\' before checkout\\"\\n    required: false\\n    default: \'false\'\\n  workspace:\\n    description: \'Directory to which checkout the repository\'\\n    required: false\\n    default: \'.\'\\noutputs:\\n  path:\\n    description: \'The path of the checked-out repository\'\\n    value: ${{ steps.checkout.outputs.path }}\\nruns:\\n  using: \'composite\'\\n  steps:\\n    - name: Checkout\\n      shell: bash\\n      run: echo \\"Error: No checkout implementation found.\\"\\n\\n```\\n\\n\u9019\u500b\u6587\u4ef6\u4e2d\uff0c\u5b9a\u7fa9\u4e86\u9019\u500b action \u7684\u8f38\u5165\u53c3\u6578\u5305\u62ec ref\u3001repository\u3001submodules\u3001ssh-key\u3001persist-credentials\u3001fetch-depth\u3001lfs\u3001clean \u548c workspace\u3002\\nGitHub Action `actions/checkout@v3` \u4e0b\u9762\u662f\u5b83\u7684\u8f38\u5165\u53c3\u6578\u5b9a\u7fa9\uff1a\\n<highlight color=\\"#25c2a0\\">actions/checkout@v3 \u53c3\u6578\u7bc7</highlight>\\n\\n- `ref`\uff1a\u8981\u6aa2\u51fa\u7684\u5206\u652f\u3001\u6a19\u7c64\u6216\u63d0\u4ea4 ID\u3002\\n- `repository`\uff1a\u8981\u6aa2\u51fa\u7684\u5132\u5b58\u5eab\u540d\u7a31\u3002\\n- `submodules`\uff1a\u662f\u5426\u6aa2\u51fa\u5b50\u6a21\u7d44\u3002\\n- `ssh-key`\uff1a\u7528\u65bc\u5f9e\u5132\u5b58\u5eab\u7372\u53d6\u7a0b\u5f0f\u78bc\u7684 SSH \u91d1\u9470\u3002\\n- `persist-credentials`\uff1a\u662f\u5426\u5728\u6301\u4e45\u5316\u5de5\u4f5c\u5340\u6642\u4fdd\u5b58 GITHUB_TOKEN \u548c SSH_AUTH_SOCK \u74b0\u5883\u8b8a\u6578\u3002\\n- `fetch-depth`\uff1a\u8981\u6aa2\u51fa\u7684\u63d0\u4ea4\u6578\u91cf\u3002\\n- `lfs`\uff1a\u662f\u5426\u4e0b\u8f09 Git LFS \u6587\u4ef6\u3002\\n- `clean`\uff1a\u662f\u5426\u5728\u6aa2\u51fa\u524d\u904b\u884c `git clean`\u3002\\n- `workspace`\uff1a\u6aa2\u51fa\u7684\u5132\u5b58\u5eab\u7684\u76ee\u9304\u3002\\n\\n\u5176\u4e2d\uff0cref \u662f\u5fc5\u9700\u7684\u53c3\u6578\uff0c\u5176\u4ed6\u53c3\u6578\u5747\u70ba\u53ef\u9078\u53c3\u6578\u3002\\n\\n\u8f38\u51fa\u53c3\u6578\u53ea\u6709\u4e00\u500b\uff0c\u5373 path\uff0c\u8868\u793a\u7a0b\u5f0f\u78bc\u5009\u5eab\u7684\u8def\u5f91\u3002\\n\\n\u6700\u5f8c\uff0c\u9019\u500b action \u5728\u904b\u884c\u6642\uff0c\u6703\u57f7\u884c\u4e00\u500b\u540d\u7232 Checkout \u7684\u5b50\u6b65\u9a5f\uff0c\u8a72\u5b50\u6b65\u9a5f\u6703\u8abf\u7528\u4e0d\u540c\u5e73\u81fa\u7684\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u5c07\u7a0b\u5f0f\u78bc\u5009\u5eab\u6aa2\u51fa\u5230\u6307\u5b9a\u7684\u5de5\u4f5c\u5340\u3002\\n\\n<highlight color=\\"#1877F2\\"> actions/setup-node@v3 \u53c3\u6578\u7bc7</highlight>\\n\\n- `node-version`\uff1a\u8981\u5b89\u88dd\u7684 Node.js \u7248\u672c\uff0c\u9ed8\u8a8d\u662f\u6700\u65b0\u7684\u7a69\u5b9a\u7248\u3002\\n- `registry-url`\uff1aNode.js \u7684\u5305\u7ba1\u7406\u5668\u4f7f\u7528\u7684\u9810\u8a2d\u5009\u5eab\u5730\u5740\uff0c\u9ed8\u8a8d\u662f npm \u7684\u5b98\u65b9\u5730\u5740\u3002\\n- `scope`\uff1aNode.js \u7684\u5305\u7ba1\u7406\u5668\u4f7f\u7528\u7684\u9810\u8a2d\u4f5c\u7528\u57df\uff0c\u9ed8\u8a8d\u662f\u7a7a\u3002\\n- `token`\uff1a\u7528\u65bc\u8a2a\u554f\u79c1\u6709\u9805\u76ee\u7684 GitHub \u6b0a\u6756\uff0c\u9ed8\u8a8d\u662f\u7a7a\u3002\\n- `always-auth`\uff1a\u662f\u5426\u7e3d\u662f\u4f7f\u7528\u6388\u6b0a\u4fe1\u606f\u8a2a\u554f\u9805\u76ee\uff0c\u9ed8\u8a8d\u662f false\u3002\\n- `check-latest`\uff1a\u662f\u5426\u6aa2\u67e5\u662f\u5426\u5b89\u88dd\u4e86\u6700\u65b0\u7684\u7248\u672c\uff0c\u9ed8\u8a8d\u662f false\u3002\\n- `debug`\uff1a\u662f\u5426\u5553\u7528 Debug \u6a21\u5f0f\uff0c\u9ed8\u8a8d\u662f false\u3002\\n\\n\u7e3d\u7684\u4f86\u8aaa\uff0cactions/setup-node@v3 \u53ef\u4ee5\u65b9\u4fbf\u5730\u5b89\u88dd Node.js \u74b0\u5883\uff0c\u4e26\u652f\u6301\u8a31\u591a\u81ea\u5b9a\u7fa9\u53c3\u6578\uff0c\u7528\u6236\u53ef\u4ee5\u6839\u64da\u81ea\u5df1\u7684\u9700\u8981\u9032\u884c\u914d\u7f6e\u3002\\n\\n:::tip\\n\u5728 github action \u8981\u5e36\u5165\u53c3\u6578\u5230 actions \u88e1\u9762\u8acb\u4f7f\u7528 with\\n\\n```\\n    steps:\\n      - uses: actions/checkout@v3\\n      - uses: actions/setup-node@v3\\n        with:\\n          node-version: \'14\'\\n```\\n\\n:::\\n\\n:::info\\n\\n1.[\u5be6\u4f5c\u958b\u6e90\u5c0f\u5de5\u5177\uff0c\u8207 Github Actions \u7684\u7b2c\u4e00\u6b21\u76f8\u9047\uff01](https://medium.com/starbugs/%E5%AF%A6%E4%BD%9C%E9%96%8B%E6%BA%90%E5%B0%8F%E5%B7%A5%E5%85%B7-%E8%88%87-github-actions-%E7%9A%84%E7%AC%AC%E4%B8%80%E6%AC%A1%E7%9B%B8%E9%81%87-3dd2d70eeb)\\n\\n2. [github action quick start \u5b98\u7db2](https://docs.github.com/en/actions/quickstart)\\n   :::"},{"id":"/2023/03/11/github-action/github-action-env-file","metadata":{"permalink":"/blog/2023/03/11/github-action/github-action-env-file","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/github-action/2023-03-11-github-action-env-file.md","source":"@site/blog/github-action/2023-03-11-github-action-env-file.md","title":".env file management  in github action","description":"\u56e0\u70ba\u662f\u4f7f\u7528.env file\u7ba1\u7406\u74b0\u5883\u8b8a\u6578\uff0c\u6240\u4ee5\u63a8\u5230github\u4e0a\u4e00\u5b9a\u6703\u6392\u9664.env\uff0c\u7136\u5f8c\u518d\u8a66CICD\u6642\u5019\u5c31\u60f3\u8aaa\u70ba\u5565\u672c\u5730build\u7684image\u8dd1\u8d77\u4f86\u6c92\u554f\u984c\uff0c\u4e00\u5230CI build\u51fa\u4f86\u7684image\u5c31\u639b\u4e86\uff0c\u8a66\u4e86\u534a\u5929\u624d\u60f3\u5230\u662f.evn\u6c92\u7d66\u3002\u9019\u908a\u6703demo\u5982\u4f55\u5728github action\u4f7f\u7528.env\u8cc7\u6599\u3002","date":"2023-03-11T00:00:00.000Z","formattedDate":"March 11, 2023","tags":[{"label":"github action","permalink":"/blog/tags/github-action"},{"label":"CICD","permalink":"/blog/tags/cicd"},{"label":".env","permalink":"/blog/tags/env"}],"readingTime":2.025,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":".env file management  in github action","description":"\u56e0\u70ba\u662f\u4f7f\u7528.env file\u7ba1\u7406\u74b0\u5883\u8b8a\u6578\uff0c\u6240\u4ee5\u63a8\u5230github\u4e0a\u4e00\u5b9a\u6703\u6392\u9664.env\uff0c\u7136\u5f8c\u518d\u8a66CICD\u6642\u5019\u5c31\u60f3\u8aaa\u70ba\u5565\u672c\u5730build\u7684image\u8dd1\u8d77\u4f86\u6c92\u554f\u984c\uff0c\u4e00\u5230CI build\u51fa\u4f86\u7684image\u5c31\u639b\u4e86\uff0c\u8a66\u4e86\u534a\u5929\u624d\u60f3\u5230\u662f.evn\u6c92\u7d66\u3002\u9019\u908a\u6703demo\u5982\u4f55\u5728github action\u4f7f\u7528.env\u8cc7\u6599\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["github action","CICD",".env"]},"prevItem":{"title":"demo basic  github action","permalink":"/blog/2023/03/11/github-action/github-action-demo"},"nextItem":{"title":"docker create context and docker context command","permalink":"/blog/2023/03/10/Docker/docker-create-context"}},"content":"## .env \u50b3\u5165\u65b9\u6cd5\\n\\n[\u53c3\u8003\u81ea\u9019\u7bc7 stack overflow](https://stackoverflow.com/questions/60176044/how-do-i-use-an-env-file-with-github-actions)\\n\\n\u5169\u7a2e\u65b9\u5f0f\uff0c\u9019\u4f9d\u64da\u4f60\u7684.env \u88e1\u9762\u5230\u5e95\u6709\u591a\u5c11\u500b\u8b8a\u6578\u3002\u4f46\u5171\u540c\u9ede\u90fd\u662f\u5728 github worlflow \u904e\u7a0b\u4f7f\u7528 secrets \u4e0a\u4e0b\u6587\uff0c\u4f8b\u5982${{ secrets.XXX }}\uff0c\u53bb\u628a\u5b58\u653e\u5728 github registry \u88e1\u9762\u7684\u74b0\u5883\u8b8a\u6578\uff0c\u5b58\u653e\u5230\u6307\u5b9a\u4f4d\u7f6e\u7684.env \u6a94\u3002\\n\\n### single vaiable\\n\\n\u5982\u679c\u53ea\u6709\u4e00\u500b\u8b8a\u6578\uff0c\u5c31\u628a\u8a72\u8b8a\u6578\u653e\u5230 github registry \u88e1\u9762\uff0c\u53d6\u4e0a\u4e0b\u6587\u4f86\u7528\u5c31\u597d\\n\\n```\\n    - name: \'Create env file\'\\n    run: |\\n        touch .env\\n        echo API_ENDPOINT=\\"https://xxx.execute-api.us-west-2.amazonaws.com\\" >> .env\\n        echo API_KEY=${{ secrets.API_KEY }} >> .env\\n        cat .env\\n```\\n\\n### Better method for multiple variables\\n\\n\u5982\u679c\u6709\u5f88\u591a\u500b\u8b8a\u6578\u5728.env \u6a94\uff0c\u5c31\u628a.env \u6a94\u6574\u4efd copy \u5230 github registry \u88e1\u9762\\n\\n\u4f8b\u5982\uff1a\\n\\n```jsx title=\\".env\\"\\nALGORITHM=\\"HS256\\"\\nACCESS_TOKEN_EXPIRE_MINUTES=60\\n# \u5c0dpassword\u52a0\u9e7d\u7684\u7269\u4ef6\\n# sql\u9023\u7dda\u7db2\u5740\\nSQLALCHEMY_DATABASE_URL=\\"sqlite:///./sql_app.db\\"\\nTOKENURL=\\"token\\"\\nARTICLE_CATEGORY=\'[\\\\\\"PythonBasic\\\\\\",\\\\\\"Fastapi\\\\\\",\\\\\\"DataScience\\\\\\",\\\\\\"PythonModule\\\\\\",\\\\\\"LinuxShellScript\\\\\\",\\\\\\"JavaScriptBasic\\\\\\",\\\\\\"React\\\\\\"]\'\\n```\\n\\n\u5c31\u628a\u4ed6\u6574\u4efd\u88e1\u9762\u7684\u503c copy \u5230 config \u88e1\u9762\u5c31\u597d\uff0c\u5047\u8a2d key \u53eb\u505a ENV_FILE\uff0c\u7136\u5f8c yml \u6a94\u9019\u6a23\u5beb\\n\\n```\\n     - name: \'Create env file\'\\n        run: |\\n          echo \\"${{ secrets.ENV_FILE }}\\" > .env\\n```\\n\\n\u4ed6\u5c31\u6703\u628a\u4f60\u6240\u6709 value \u9001\u5230.env \u6a94\u4e86\u3002\\n\\n:::info\\n\u8a18\u9304\u4e00\u4e0b\u6211\u9047\u5230\u7684\u72c0\u6cc1\uff0c\u56e0\u70ba\u9019\u500b\u771f\u7684\u5361\u9817\u4e45\uff0c\u4e5f\u8a66\u4e0d\u51fa\u4f86\u4e00\u500b\u65b9\u6cd5\uff0c\u6240\u4ee5\u5c31\u5148\u8a18\u9304\u5427\uff0c\u4e5f\u6b61\u8fce\u63d0\u4f9b\u89e3\u7b54\\npython dotenv \u5728.env \u6a94\u88e1\u9762\u5beb\u5165 list \uff0c\u8981\u7528\u4ee5\u4e0b\u65b9\u6cd5\u8868\u8ff0\\nARTICLE_CATEGORY=\'[\\"PythonBasic\\",\\"Fastapi\\",\\"DataScience\\",\\"PythonModule\\",\\"LinuxShellScript\\",\\"JavaScriptBasic\\",\\"React\\"]\'\uff0c\u914d\u5408 `json.loads(os.environ.get(\'ARTICLE_CATEGORY\'))`\u53bb\u62ff\u8cc7\u6599\u3002\\n\\n\u4f46\u662f\u5728\u4f7f\u7528 action \u9047\u5230\u4e00\u500b\u554f\u984c\uff0c`echo ${{ secrets.ENV_FILE }} > .env` \u6703\u8f38\u5165\u7a7a\u503c\u9032\u53bb\uff0c`echo \\"${{ secrets.ENV_FILE }}\\" > .env` \u9019\u6a23\u624d\u6703\u6709\u503c\uff0c\u4f46\u554f\u984c\u5728\u4f7f\u7528\\"\\"\u5305\u4f4f\u6703\u628a ARTICLE_CATEGORY=\'[\\"PythonBasic\\",\\"Fastapi\\",\\"DataScience\\",\\"PythonModule\\",\\"LinuxShellScript\\",\\"JavaScriptBasic\\",\\"React\\"]\'\u8f49\u6210\\n`ARTICLE_CATEGORY=\'[PythonBasic,Fastapi,DataScience,PythonModule,LinuxShellScript,JavaScriptBasic,React]\'\\n` \u9019\u500b\u683c\u5f0f\u5728\u8b80 json.loads(os.environ.get(\'ARTICLE_CATEGORY\'))\u5c31\u6703\u9047\u5230\u554f\u984c\uff0c\u6703\u5831 error \u56e0\u70ba\u9019\u500b\u683c\u5f0f\u4ed6\u4e0d\u884c\u3002\\n\\n\u76ee\u524d\u5728\u8655\u7406 list \u90e8\u5206\uff0c\u90fd\u5148\u7528`ARTICLE_CATEGORY=\'[\\\\\\"PythonBasic\\\\\\",\\\\\\"Fastapi\\\\\\",\\\\\\"DataScience\\\\\\",\\\\\\"PythonModule\\\\\\",\\\\\\"LinuxShellScript\\\\\\",\\\\\\"JavaScriptBasic\\\\\\",\\\\\\"React\\\\\\"]\'` \u9001\u8cc7\u6599\u3002\u7136\u5f8c\u7528`json.loads(os.environ.get(\'ARTICLE_CATEGORY\'))`\u53bb\u62ff\u8cc7\u6599\\n\\n:::"},{"id":"/2023/03/10/Docker/docker-create-context","metadata":{"permalink":"/blog/2023/03/10/Docker/docker-create-context","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Docker/2023-03-10-docker-create-context.md","source":"@site/blog/Docker/2023-03-10-docker-create-context.md","title":"docker create context and docker context command","description":"docker \u652f\u63f4\u591a\u500b\u4e0d\u540cremote docker deamon\u7ba1\u7406,`docker create context` \u662f\u7528\u4f86\u5efa\u7acb\u4e00\u500b\u65b0\u7684 context\uff0c\u4ee5\u6307\u5411\u4e00\u500b remote Docker daemon\uff0c\u7528\u65bc\u7ba1\u7406 Docker \u4e3b\u6a5f\u548c Docker registry \u7684\u6a5f\u5236\u3002","date":"2023-03-10T00:00:00.000Z","formattedDate":"March 10, 2023","tags":[{"label":"docker","permalink":"/blog/tags/docker"}],"readingTime":1.59,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"docker create context and docker context command","description":"docker \u652f\u63f4\u591a\u500b\u4e0d\u540cremote docker deamon\u7ba1\u7406,`docker create context` \u662f\u7528\u4f86\u5efa\u7acb\u4e00\u500b\u65b0\u7684 context\uff0c\u4ee5\u6307\u5411\u4e00\u500b remote Docker daemon\uff0c\u7528\u65bc\u7ba1\u7406 Docker \u4e3b\u6a5f\u548c Docker registry \u7684\u6a5f\u5236\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["docker"]},"prevItem":{"title":".env file management  in github action","permalink":"/blog/2023/03/11/github-action/github-action-env-file"},"nextItem":{"title":"docker manage logs in Docker to prevent service failure caused by excessively large container logs","permalink":"/blog/2023/03/10/Docker/docker-management"}},"content":"`docker create context` \u662f\u7528\u4f86\u5efa\u7acb\u4e00\u500b\u65b0\u7684 context\uff0c\u4ee5\u6307\u5411\u4e00\u500b remote Docker daemon\uff0c\u7528\u65bc\u7ba1\u7406 Docker \u4e3b\u6a5f\u548c Docker registry \u7684\u6a5f\u5236\u3002\\n\\n\u53ef\u4ee5\u4f7f\u7528 `docker context use` \u6307\u4ee4\u4f86\u5207\u63db context\uff0c\u5207\u63db\u5b8c\u6210\u5f8c\u5373\u53ef\u4f7f\u7528 docker \u6307\u4ee4\u64cd\u4f5c remote Docker daemon\u3002\u5982\u679c\u4f7f\u7528\u96f2\u7aef container\uff0c\u4f8b\u5982 azure web container service\uff0c\u5c31\u53ef\u4ee5\u7528\u9019\u500b\u6307\u4ee4\u53bb\u7ba1\u7406\u96f2\u7aef container\u3002\u5305\u542b\u65b0\u5efa \u522a\u9664\u90fd\u53ef\u4ee5\u4f7f\u7528\uff0c\u6240\u4ee5\u4e0d\u8981\u592a\u958b\u5fc3\u4e00\u6b21\u8d77\u4e00\u5927\u5806\u96f2\u7aef container \u9019\u6a23\u6703\u88ab charging \u5230\u7206\u3002\\n:::info\\n\u5982\u679c\u6709\u7528\u5230 docker buildx \u53ef\u80fd\u6703\u628a docker context \u8ddf docker buildx create --name \u641e\u6df7\uff0c\\n\u5169\u500b\u662f\u4e0d\u540c\u7684.\\n:::\\n\\n\u4ee5\u4e0b\u662f `docker create context` \u6307\u4ee4\u7684\u6559\u5b78\uff1a\\n\\n\u4f7f\u7528 `docker create context` \u6307\u4ee4\u53ef\u4ee5\u5efa\u7acb\u4e00\u500b\u65b0\u7684 context\uff0c\u7528\u4f86\u6307\u5411\u4e00\u500b remote Docker daemon\u3002\u4ee5\u4e0b\u662f\u6307\u4ee4\u7684\u8a73\u7d30\u8aaa\u660e\uff1a\\n\\n```\\ndocker context create CONTEXT_NAME --docker \\"host=REMOTE_DOCKER_HOST\\" --description \\"CONTEXT_DESCRIPTION\\"\\n```\\n\\n- `CONTEXT_NAME`: \u6307\u5b9a\u65b0\u5efa\u7acb\u7684 context \u7684\u540d\u7a31\u3002\\n- `REMOTE_DOCKER_HOST`: \u6307\u5b9a remote Docker daemon \u7684\u4f4d\u7f6e\uff0c\u53ef\u4ee5\u662f\u4e00\u500b IP \u6216\u662f\u4e00\u500b domain name\u3002\\n- `CONTEXT_DESCRIPTION`: \u53ef\u4ee5\u52a0\u5165\u5c0d context \u7684\u63cf\u8ff0\uff0c\u65b9\u4fbf\u7ba1\u7406\u3002\\n\\n\u4f8b\u5982\uff0c\u4ee5\u4e0b\u6307\u4ee4\u5efa\u7acb\u4e00\u500b\u540d\u70ba `mycontext` \u7684 context\uff0c\u6307\u5411\u4e00\u500b remote Docker daemon\uff0c\u4e26\u52a0\u5165\u63cf\u8ff0\uff1a\\n\\n```\\ndocker context create mycontext --docker \\"host=myremotehost:2376\\" --description \\"My remote Docker daemon\\"\\n```\\n\\n\u5efa\u7acb\u5b8c\u6210\u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528 `docker context use` \u6307\u4ee4\u4f86\u5207\u63db context\uff1a\\n\\n```\\ndocker context use mycontext\\n```"},{"id":"/2023/03/10/Docker/docker-management","metadata":{"permalink":"/blog/2023/03/10/Docker/docker-management","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Docker/2023-03-10-docker-management.md","source":"@site/blog/Docker/2023-03-10-docker-management.md","title":"docker manage logs in Docker to prevent service failure caused by excessively large container logs","description":"\u7576\u9047\u5230container log\u592a\u5927 \u9020\u6210\u670d\u52d9\u639b\u6389\u7684\u6392\u67e5\u65b9\u5411\uff0c\u4ee5\u53ca\u5982\u4f55\u907f\u514d\u3002\u56e0\u70ba docker \u904b\u884c\u904e\u7a0b\u672c\u8eab log \u4e5f\u6703\u4f54\u7528\u786c\u789f\u8cc7\u6e90\uff0c\u70ba\u4e86\u4e0d\u8b93\u9019\u500b log \u904e\u5ea6\u81a8\u8139\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u9650\u5236","date":"2023-03-10T00:00:00.000Z","formattedDate":"March 10, 2023","tags":[{"label":"docker","permalink":"/blog/tags/docker"}],"readingTime":4.485,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"docker manage logs in Docker to prevent service failure caused by excessively large container logs","description":"\u7576\u9047\u5230container log\u592a\u5927 \u9020\u6210\u670d\u52d9\u639b\u6389\u7684\u6392\u67e5\u65b9\u5411\uff0c\u4ee5\u53ca\u5982\u4f55\u907f\u514d\u3002\u56e0\u70ba docker \u904b\u884c\u904e\u7a0b\u672c\u8eab log \u4e5f\u6703\u4f54\u7528\u786c\u789f\u8cc7\u6e90\uff0c\u70ba\u4e86\u4e0d\u8b93\u9019\u500b log \u904e\u5ea6\u81a8\u8139\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u9650\u5236","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["docker"]},"prevItem":{"title":"docker create context and docker context command","permalink":"/blog/2023/03/10/Docker/docker-create-context"},"nextItem":{"title":"dockermultiplatform build - docker buildx\u6307\u4ee4","permalink":"/blog/2023/03/10/Docker/docker-muiltiplatform"}},"content":"## volume of docker\\n\\n\u4ee5\u524d\u90fd\u5728\u5f04\u81ea\u5df1\u7684\u5c0f\u5c08\u6848\uff0c\u53ea\u8981\u6771\u897f\u8dd1\u5f97\u8d77\u4f86\u5c31\u597d\uff0c\u6c92\u60f3\u904e\u6703\u9047\u904e\u56e0\u70ba\u786c\u789f\u5403\u6eff\u5c0e\u81f4 container \u670d\u52d9\u639b\u6389\u7684\u554f\u984c\u3002\\n\\ndocker \u639b\u8f09 volume \u6703\u6709\u4e09\u7a2e\u65b9\u5f0f\uff0c\u7d81\u5b9a\u639b\u8f09\uff08Bind Mount\uff09\uff0c\u547d\u540d\u5377\uff08Named Volume\uff09\uff0c\u533f\u540d\u5377\uff08Anonymous Volume\uff09\uff0c\u524d\u5169\u7a2e\u5728 container \u88ab\u522a\u9664\u6642\u4e0d\u6703\u88ab\u522a\uff0c\u6703\u6c38\u4e45\u4fdd\u5b58\uff0cdocker \u5167\u6c92\u88ab\u639b\u8f09\u6216\u4f7f\u7528 Anonymous Volume \u5247\u90fd\u6703\u88ab\u522a\u9664\u3002\\n\\n:::info\\ndocker logs \u8cc7\u6599\u5305\u542b\u54ea\u4e9b\uff1f\\nDocker \u6703\u6355\u6349\u6240\u6709\u5bb9\u5668\u7684\u6a19\u51c6\u8f38\u51fa\uff08\u548c\u6a19\u51c6\u932f\u8aa4\uff09\uff0c\u4e26\u4ee5 JSON \u683c\u5f0f\u5c07\u5176\u5beb\u5165\u6587\u4ef6\u4e2d\u3002 JSON \u683c\u5f0f\u5c07\u6bcf\u884c\u6ce8\u91cb\u70ba\u5176\u6e90\uff08stdout \u6216 stderr\uff09\u548c\u5176\u6642\u9593\u6233\u3002 \u6bcf\u500b\u65e5\u8a8c\u6587\u4ef6\u50c5\u5305\u542b\u6709\u95dc\u4e00\u500b\u5bb9\u5668\u7684\u4fe1\u606f\u3002\\n:::\\n\\n### \u5982\u4f55\u6e1b\u5c11\u4e0d\u5fc5\u8981\u7684\u786c\u9ad4\u4f54\u7528\\n\\n\u56e0\u70ba docker \u904b\u884c\u904e\u7a0b\u672c\u8eab log \u4e5f\u6703\u4f54\u7528\u786c\u789f\u8cc7\u6e90\uff0c\u70ba\u4e86\u4e0d\u8b93\u9019\u500b log \u904e\u5ea6\u81a8\u8139\uff0c\u53ef\u4ee5\u7528\u4ee5\u4e0b\u65b9\u5f0f\u9650\u5236\\n\\n1. \u4fee\u6539 docker \u8a2d\u5b9a\u6a94\\n\\n```jsx title=\\"/etc/docker/daemon.json\\"\\n{\\n  \\"log-driver\\":\\"json-file\\",\\n  \\"log-opts\\": {\\"max-size\\":\\"500m\\", \\"max-file\\":\\"3\\"}\\n}\\n\\n`systemctl daemon-reload`\\n`systemctl restart docker\\n`\\n```\\n\\n2. \u4fee\u6539 docker-compose.yml\\n\\n```\\nservices:\\n  hellow:\\n    build: .\\n    container_name: mattermost\\n    restart: always\\n    logging:\\n      driver: \\"json-file\\"\\n      options:\\n          max-size: \\"100m\\"\\n          max-file: \\"10\\"\\n```\\n\\n\u4e26\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u91cd\u555f\uff0c\u4e00\u822c restart \u4e0d\u6703\u5403\u65b0 config\\n\\n```\\ndocker-compose -f docker-compose.yml up -d --force-recreate mm\\n```\\n\\n:::danger\\n\u4e0b\u9019\u500b\u6307\u4ee4\u524d\u52d9\u5fc5\u60f3\u597d\u662f\u5426\u91cd\u8981\u8cc7\u8a0a\u6709\u7528 Bind Mount or Named Volume \u639b\u8f09\u51fa\u4f86\uff01\\n:::\\n\\n3. docker \u6307\u4ee4\\n\\n```\\ndocker run -d --log-opt max-size=1g nginx\\n```\\n\\n[\u5b98\u7db2 log \u7ba1\u7406](https://docs.docker.com/config/containers/logging/json-file/)\uff0c\u7ba1\u7406 docker log \u65b9\u5f0f\u5f88\u591a\uff0c\u9810\u8a2d\u90fd\u9069\u7528 json-file\uff0c\u8a2d\u5b9a\u53ef\u5df2\u900f\u904e\u4fee\u6539/etc/docker/daemon.json \u4e26\u91cd\u555f\u9054\u6210\u3002\\n\\n\u9810\u8a2d\u662f\u5728\u540c\u4e00\u4efd\u6a94\u6848\uff0c\u7121\u9650\u5927\u5c0f\u5beb\u5165\uff0c\u900f\u904e\u4ee5\u4e0a\u65b9\u6cd5\uff0c\u53ef\u4ee5\u9650\u5b9a\u6a94\u6848\u5927\u5c0f\u8ddf\u53ef\u7522\u751f\u6a94\u6848\u6578\u91cf\uff0c\u7576 log \u5bb9\u91cf\u5230\u9054\u4e0a\u9650\u6642\uff0cDocker \u7a0b\u5e8f\u5c07\u505c\u6b62\u5beb\u5165\u8a72\u65e5\u8a8c\u6587\u4ef6\uff0c\u4e26\u958b\u59cb\u4f7f\u7528\u65b0\u540d\u7a31\u555f\u52d5\u65b0\u7684\u65e5\u8a8c\u6587\u4ef6\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u65b0\u65e5\u8a8c\u6587\u4ef6\u5c07\u5177\u6709\u8207\u820a\u65e5\u8a8c\u6587\u4ef6\u76f8\u540c\u7684\u540d\u7a31\uff0c\u4f46\u6703\u5728\u672b\u5c3e\u6dfb\u52a0\u9023\u7e8c\u865f\uff08\u4f8b\u5982\uff0caccess.log.1\u3001access.log.2 \u7b49\uff09\u3002\\n\\nDocker \u4fdd\u7559\u7684\u65e5\u8a8c\u6587\u4ef6\u6578\u91cf\u7531`max-file`\u9078\u9805\u6c7a\u5b9a\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cDocker \u5c07\u4fdd\u7559\u6700\u591a 1 \u500b\u65e5\u8a8c\u6587\u4ef6(\u8981\u914d\u7f6e`max-size`\u624d\u6703\u751f\u6548)\u3002\u7576\u9054\u5230\u6700\u5927\u65e5\u8a8c\u6587\u4ef6\u6578\u91cf\u6642\uff0cDocker \u5c07\u958b\u59cb\u4f7f\u7528\u65b0\u7684\u65e5\u8a8c\u6578\u64da\u8986\u84cb\u6700\u820a\u7684\u65e5\u8a8c\u6587\u4ef6\u3002\\n\\n\uff08ps:\u8cc7\u8a0a\u4ee5\u6b64[\u9023\u7d50](https://docs.docker.com/config/containers/logging/json-file/)\u70ba\u6e96\uff0c\u8a2d\u5b9a\u53ef\u80fd\u6703\u6539\u8b8a\u7684\uff09\\n\\n## what should do when you find / or /var are full\\n\\n:::info\\n\u9810\u8a2d docker \u7684\u6771\u897f\u90fd\u653e\u5728/var/lib/docker \u5e95\u4e0b\\n\\n```jsx title=\\"/var/lib/docker\\"\\nbuilder  buildkit  containers  image  network  overlay2  plugins  runtimes  swarm  tmp  trust  volumes\\n```\\n\\n\u53ef\u4ee5\u5728\u8a72\u8cc7\u6599\u593e\u5e95\u4e0b\u7528`du -sh ./*`\u78ba\u8a8d\u54ea\u500b\u5730\u65b9\u5403\u5f97\u7570\u5e38\u5147\uff0c\\n\u4e26\u7528`docker system df`\u770b\u8cc7\u6599\u4f54\u7528\uff0c\u5982\u679c\u4e0d\u7528\u7684 image \u5f88\u591a\u53ef\u4ee5\u6e05\u9664\\n\\n`docker image prune --all`\\n\\n\u4ed6\u6703\u522a\u9664\u6240\u6709\u6c92\u6709\u88ab container \u4f7f\u7528\u7684 image\uff0c\u8b66\u793a\u5982\u4e0b\uff1a\\n\\nWARNING! This will remove all images without at least one container associated to them.\\n:::\\n\\n1.  \u5982\u679c\u7576\u521d\u6c92\u6709\u505a\u4efb\u4f55\u9810\u9632\uff0c\u5c0e\u81f4/var \u771f\u7684\u7206\u4e86\uff0c\u53ef\u4ee5\u512a\u5148\u6aa2\u67e5\u4ee5\u4e0b\u5e7e\u9805\\n\\n### \u6aa2\u67e5 docker logs \u662f\u5426\u4f54\u592a\u5147\\n\\n\u5176\u5be6\u5c31\u662f\u53bb/var/lib/docker/containers\uff0c\u57f7\u884c`du -sh ./* `\u770b\u54ea\u500b container \u4f54\u6700\u591a\u8cc7\u6e90\uff0c\u7136\u5f8c\u53bb\u770b\u88e1\u9762\u90a3\u96bb\u653e docker logs \u7684\u6a94\u540d\u70ba container-id-json.log \u7684\u6a94\u6848\u662f\u5426\u9577\u592a\u5927\uff0c\u78ba\u8a8d\u5f8c\u53ef\u4ee5\u780d\u6389\u3002\\n\\n### \u6aa2\u67e5 named volume \u4e2d\u5b58\u653e\u8cc7\u8a0a\\n\\n\u5176\u5be6\u5c31\u662f\u53bb/var/lib/docker/volumes \u5e95\u4e0b\uff0c\u770b\u6709\u6c92\u6709\u67d0\u500b volume \u4f54\u592a\u591a\u8cc7\u6e90\uff0c\u7136\u5f8c\u88e1\u9762\u653e\u7684\u6771\u897f\u53ef\u80fd\u4e0d\u91cd\u8981(\u4f8b\u5982 nginx log)\\n\\n### \u6aa2\u67e5 image \u8ddf\u6c92\u7528\u7684 container\\n\\nimage \u6307\u4ee4:\u522a\u9664\u6c92\u6709\u88ab\u6d3b\u52d5\u7684 container \u4f7f\u7528\u7684 image\\n`docker image prune --all`\\n\\ncontainer \u6307\u4ee4\uff1a\u522a\u9664\u505c\u6b62\u7684 container\\n`docker container prune`\\n\\n:::info\\n\\n[Prune unused Docker objects](https://docs.docker.com/config/pruning/)\\n[\u9650\u5236 Docker \u65e5\u5fd7\u5927\u5c0f](https://blog.csdn.net/fishinhouse/article/details/105310948)\\n:::"},{"id":"/2023/03/10/Docker/docker-muiltiplatform","metadata":{"permalink":"/blog/2023/03/10/Docker/docker-muiltiplatform","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Docker/2023-03-10-docker-muiltiplatform.md","source":"@site/blog/Docker/2023-03-10-docker-muiltiplatform.md","title":"dockermultiplatform build - docker buildx\u6307\u4ee4","description":"docker \u652f\u63f4\u591a\u5e73\u53f0image\u7684build\u6307\u4ee4,Docker Buildx \u662f Docker \u5b98\u65b9\u63d0\u4f9b\u7684\u4e00\u500b\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u65bc\u901a\u904e Dockerfile \u6784\u5efa Docker \u6620\u50cf\u3002\u5b83\u7684\u4e3b\u8981\u7279\u9ede\u662f\u53ef\u4ee5\u8de8\u5e73\u81fa\u69cb\u5efa Docker \u6620\u50cf\uff0c\u4e26\u652f\u6301\u591a\u7a2e CPU \u67b6\u69cb\uff08\u5982 x86\u3001ARM\u3001IBM Power \u7b49\uff09\uff0c\u662f\u4e00\u500b\u7528\u4f86\u5efa\u7acb\u548c\u7ba1\u7406 multi-arch Docker image \u7684\u5de5\u5177\u3002","date":"2023-03-10T00:00:00.000Z","formattedDate":"March 10, 2023","tags":[{"label":"docker","permalink":"/blog/tags/docker"}],"readingTime":4.93,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"dockermultiplatform build - docker buildx\u6307\u4ee4","description":"docker \u652f\u63f4\u591a\u5e73\u53f0image\u7684build\u6307\u4ee4,Docker Buildx \u662f Docker \u5b98\u65b9\u63d0\u4f9b\u7684\u4e00\u500b\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u65bc\u901a\u904e Dockerfile \u6784\u5efa Docker \u6620\u50cf\u3002\u5b83\u7684\u4e3b\u8981\u7279\u9ede\u662f\u53ef\u4ee5\u8de8\u5e73\u81fa\u69cb\u5efa Docker \u6620\u50cf\uff0c\u4e26\u652f\u6301\u591a\u7a2e CPU \u67b6\u69cb\uff08\u5982 x86\u3001ARM\u3001IBM Power \u7b49\uff09\uff0c\u662f\u4e00\u500b\u7528\u4f86\u5efa\u7acb\u548c\u7ba1\u7406 multi-arch Docker image \u7684\u5de5\u5177\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["docker"]},"prevItem":{"title":"docker manage logs in Docker to prevent service failure caused by excessively large container logs","permalink":"/blog/2023/03/10/Docker/docker-management"},"nextItem":{"title":"learn github action from github docs","permalink":"/blog/2023/03/10/github-action/githubaction-learing"}},"content":"## \u57fa\u672c\u4ecb\u7d39\\n\\n:::danger\\n\u5982\u679c\u4e0d\u652f\u63f4\u591a\u5e73\u53f0\uff0c\u5c31\u6703\u51fa\u73fe\u5728 arm build\uff0c\u7136\u5f8c\u5728 amd deploy \u5931\u6557\uff0c\u4e0a\u7db2\u67e5\u4e0d\u5230\u539f\u56e0\u7684\u554f\u984c\u3002\\n:::\\n\\nDocker Buildx \u662f Docker \u5b98\u65b9\u63d0\u4f9b\u7684\u4e00\u500b\u547d\u4ee4\u884c\u5de5\u5177\uff0c\u7528\u65bc\u901a\u904e Dockerfile \u6784\u5efa Docker \u6620\u50cf\u3002\u5b83\u7684\u4e3b\u8981\u7279\u9ede\u662f\u53ef\u4ee5\u8de8\u5e73\u81fa\u69cb\u5efa Docker \u6620\u50cf\uff0c\u4e26\u652f\u6301\u591a\u7a2e CPU \u67b6\u69cb\uff08\u5982 x86\u3001ARM\u3001IBM Power \u7b49\uff09\uff0c\u662f\u4e00\u500b\u7528\u4f86\u5efa\u7acb\u548c\u7ba1\u7406 multi-arch Docker image \u7684\u5de5\u5177\u3002\\n\\n:::info\\ndocker buildx \u7684\u55ae\u4f4d\u662f node\uff0c\u8ddf docker context \u4e0d\u540c\uff0c\u524d\u8005\u662f\u5efa\u7acb\u5f71\u50cf\u7684\u4e3b\u6a5f\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u500b\u7bc0\u9ede\u4f86\u52a0\u901f Docker \u6620\u50cf\u7684\u5efa\u7acb\u904e\u7a0b\uff0c\u5f8c\u8005\u5247\u662f\u7528\u4f86\u7ba1\u7406 Docker \u4e3b\u6a5f\u548c Docker registry \u7684\u6a5f\u5236\uff0c\u5b9a\u7fa9\u4e86\u4e00\u500b\u6216\u591a\u500b Docker \u4e3b\u6a5f\u548c Docker registry \u7684\u8a2d\u5b9a\u3002\\n\\n:::\\n\\n\u4ee5\u4e0b\u662f\u4f7f\u7528 Docker Buildx \u69cb\u5efa Docker \u6620\u50cf\u7684\u57fa\u672c\u6b65\u9a5f\uff1a\\n\\n## 1. \u555f\u7528 multi-arch \u652f\u63f4\\n\\n\u8981\u4f7f\u7528 `docker buildx` \u5efa\u7acb multi-arch Docker image\uff0c\u5fc5\u9808\u5148\u555f\u7528 multi-arch \u652f\u63f4(Docker Desktop \u9810\u914d\u7f6e\u4e86 binfmt_misc \u5c0d\u5176\u4ed6\u5e73\u53f0\u7684\u652f\u6301\uff0c\u53ef\u4ee5\u5ffd\u7565\u6b64\u6307\u4ee4)\u3002\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u555f\u7528 multi-arch \u652f\u63f4\uff1a\\n\\n```\\ndocker run --rm --privileged multiarch/qemu-user-static --reset -p yes\\n```\\n\\n## 2. \u5efa\u7acb builder(node)\\n\\n\u8981\u4f7f\u7528 `docker buildx` \u5efa\u7acb multi-arch Docker image\uff0c\u5fc5\u9808\u5148\u5efa\u7acb\u4e00\u500b builder\u3002\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u5efa\u7acb builder\uff1a\\n\\n```\\ndocker buildx create --name mybuilder\\n```\\n\\n## 3. \u8a2d\u5b9a builder\\n\\n\u5efa\u7acb builder \u5f8c\uff0c\u5fc5\u9808\u5c07 builder \u8a2d\u5b9a\u70ba\u76ee\u524d\u4f7f\u7528\u7684 builder\u3002\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u8a2d\u5b9a builder\uff1a\\n\\n```\\ndocker buildx use mybuilder\\n```\\n\\n## 4. \u5efa\u7acb Dockerfile\\n\\n\u63a5\u4e0b\u4f86\uff0c\u5efa\u7acb\u4e00\u500b Dockerfile\uff0c\u4e26\u5728\u5176\u4e2d\u6307\u5b9a\u8981\u5efa\u7acb\u7684 Docker image\u3002\u4f8b\u5982\uff0c\u5728 Dockerfile \u4e2d\u53ef\u4ee5\u6307\u5b9a\u8981\u5efa\u7acb\u7684 image \u70ba `ubuntu:latest`\uff0c\u4e26\u5728\u5176\u4e2d\u5b89\u88dd\u4e00\u4e9b\u8edf\u9ad4\u5957\u4ef6\uff1a\\n\\n```\\nFROM --platform=$TARGETPLATFORM ubuntu:latest\\n\\nRUN apt-get update && \\\\\\\\\\n    apt-get install -y software-properties-common && \\\\\\\\\\n    add-apt-repository -y ppa:nginx/stable && \\\\\\\\\\n    apt-get update && \\\\\\\\\\n    apt-get install -y nginx\\n```\\n\\n## 5. \u5efa\u7acb multi-arch Docker image\\n\\n\u5efa\u7acb Dockerfile \u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u5efa\u7acb multi-arch Docker image\uff1a\\n\\n```\\ndocker buildx build --platform linux/arm/v7 -t myimage:latest --load .\\n```\\n\\n\u5728\u4e0a\u9762\u7684\u547d\u4ee4\u4e2d\uff0c`--platform` \u53c3\u6578\u6307\u5b9a\u4e86\u8981\u69cb\u5efa\u7684 CPU \u67b6\u69cb\uff0c`-t` \u53c3\u6578\u6307\u5b9a\u4e86\u6620\u50cf\u7684\u6a19\u7c64\uff0c`.` \u8868\u793a\u7576\u524d\u76ee\u9304\u662f Dockerfile \u6240\u5728\u7684\u76ee\u9304\u3002\\n\\n--load \u76f8\u7576\u65bc`--output=type=docker` \u6c92\u6709\u6307\u5b9a\u6703\u51fa\u73fe warning\\n\\n```\\nWARN[0000] No output specified for docker-container driver. Build result will only remain in the build cache. To push result image into registry use --push or to load image into docker use --load\\n```\\n\\n--push \u9060\u7aef registry \u76f8\u7576\u65bc`--output=type=registry`\\n\\n:::info\\nhttps://github.com/docker/buildx/issues/59\\n2023/3/9 \u4f7f\u7528--platform \u914d\u5408--load\uff0c\u4e0d\u80fd\u652f\u63f4\u591a\u5e73\u53f0\uff0c\u4e00\u6b21\u4e00\u500b\u5e73\u53f0\uff0c\u5426\u5247\u6703\u5831\u932f\\n--push \u652f\u63f4\u4e00\u6b21\u591a\u5e73\u53f0 image\\n\\n```\\nerror: docker exporter does not currently support exporting manifest lists\\n```\\n\\n:::\\n\\n\u5efa\u7acb\u5b8c\u6210\u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6307\u4ee4\u67e5\u770b\u5efa\u7acb\u7684 Docker image\uff1a\\n\\n```\\ndocker images myimage\\n```\\n\\n\u63a8\u9001 Docker \u6620\u50cf\uff1a\\n\\n```\\n$ docker push myimage:latest\\n```\\n\\n\u4ee5\u4e0a\u5c31\u662f\u4f7f\u7528 Docker Buildx \u69cb\u5efa Docker \u6620\u50cf\u7684\u57fa\u672c\u6b65\u9a5f\u3002\u4f7f\u7528 Docker Buildx \u53ef\u4ee5\u8b93\u6211\u5011\u66f4\u65b9\u4fbf\u5730\u69cb\u5efa\u8de8\u5e73\u81fa\u7684 Docker \u6620\u50cf\uff0c\u63d0\u9ad8\u4e86\u958b\u767c\u6548\u7387\u3002\\n\\n:::info\\n`docker buildx rm docker-test` \u522a\u9664\\n\\n`docker buildx use docker-test`\u5207\u63db\\n:::\\n\\n## docker buildx create --name my-node \u662f\u5efa\u7acb\u7bc0\u9ede\u55ce\uff1f\\n\\n\u662f\u7684\uff0c`docker buildx create --name my-node` \u6307\u4ee4\u6703\u5efa\u7acb\u4e00\u500b\u540d\u70ba `my-node` \u7684\u7bc0\u9ede\u3002\u7bc0\u9ede\u662f\u7528\u4f86\u5efa\u7acb Docker \u6620\u50cf\u7684\u4e3b\u6a5f\uff0c\u53ef\u4ee5\u4f7f\u7528\u591a\u500b\u7bc0\u9ede\u4f86\u52a0\u901f Docker \u6620\u50cf\u7684\u5efa\u7acb\u904e\u7a0b\uff0c\u6216\u8005\u5efa\u7acb\u4e0d\u540c\u5e73\u53f0\u7684 Docker \u6620\u50cf\u3002\\n\\n\u5efa\u7acb\u7bc0\u9ede\u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 `--driver` \u9078\u9805\u6307\u5b9a\u7bc0\u9ede\u7684\u9a45\u52d5\u7a0b\u5f0f\uff0c\u4f8b\u5982 `docker-container` \u6216 `docker`\u3002\u9a45\u52d5\u7a0b\u5f0f\u9084\u53ef\u4ee5\u662f\u5176\u4ed6\u7b2c\u4e09\u65b9\u5e73\u53f0\uff0c\u4f8b\u5982 AWS\u3001Azure \u6216 Google Cloud\u3002\\n\\n\u5728\u5efa\u7acb\u7bc0\u9ede\u6642\uff0c\u53ef\u4ee5\u6307\u5b9a\u7bc0\u9ede\u7684\u540d\u7a31\u3001\u9a45\u52d5\u7a0b\u5f0f\u3001\u9a45\u52d5\u7a0b\u5f0f\u9078\u9805\u3001Docker \u6620\u50cf\u7b49\u8cc7\u8a0a\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u662f\u5efa\u7acb\u4e00\u500b\u540d\u70ba `my-node` \u7684\u7bc0\u9ede\uff0c\u4f7f\u7528 Docker \u5bb9\u5668\u4f5c\u70ba\u9a45\u52d5\u7a0b\u5f0f\uff0c\u4f7f\u7528 `moby/buildkit:v0.8.1` \u4f5c\u70ba Docker \u6620\u50cf\u7684\u793a\u7bc4\u6307\u4ee4\uff1a\\n\\n```\\ndocker buildx create --name my-node --driver docker-container --driver-opt image=moby/buildkit:v0.8.1\\n\\n```\\n\\n\u5efa\u7acb\u7bc0\u9ede\u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528 `docker buildx ls` \u6307\u4ee4\u5217\u51fa\u6240\u6709\u7bc0\u9ede\u3002\u5efa\u7acb Docker \u6620\u50cf\u6642\uff0c\u53ef\u4ee5\u4f7f\u7528 `--builder` \u9078\u9805\u6307\u5b9a\u8981\u4f7f\u7528\u7684\u7bc0\u9ede\u3002\u4f8b\u5982\uff1a\\n\\n```\\ndocker buildx build --builder my-node --platform linux/amd64 -t myimage:latest .\\n\\n```\\n\\n\u53ef\u4ee5\u4f7f\u7528\u540d\u70ba my-node \u7684\u7bc0\u9ede\u5efa\u7acb Docker \u6620\u50cf\uff0c\u4e26\u6307\u5b9a\u8981\u5efa\u7acb\u7684\u5e73\u53f0\u70ba linux/amd64\u3002"},{"id":"/2023/03/10/github-action/githubaction-learing","metadata":{"permalink":"/blog/2023/03/10/github-action/githubaction-learing","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/github-action/2023-03-10-githubaction-learing.md","source":"@site/blog/github-action/2023-03-10-githubaction-learing.md","title":"learn github action from github docs","description":"github action\u5728\u8a2d\u8a08\u4e0a\u63d0\u4f9b\u8a31\u591a\u8868\u793a\u5f0f\uff0c\u8ddf\u5167\u5efa\u51fd\u793a\uff0c\u4e0a\u4e0b\u6587\uff0c\u9019\u908a\u5c07\u6574\u7406\u5b98\u7db2\u6559\u5b78\u77e5\u8b58\uff0c\u4ee5\u53ca\u4f7f\u7528\u5fc3\u5f97\u3002","date":"2023-03-10T00:00:00.000Z","formattedDate":"March 10, 2023","tags":[{"label":"github action","permalink":"/blog/tags/github-action"},{"label":"CICD","permalink":"/blog/tags/cicd"}],"readingTime":10.97,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"learn github action from github docs","description":"github action\u5728\u8a2d\u8a08\u4e0a\u63d0\u4f9b\u8a31\u591a\u8868\u793a\u5f0f\uff0c\u8ddf\u5167\u5efa\u51fd\u793a\uff0c\u4e0a\u4e0b\u6587\uff0c\u9019\u908a\u5c07\u6574\u7406\u5b98\u7db2\u6559\u5b78\u77e5\u8b58\uff0c\u4ee5\u53ca\u4f7f\u7528\u5fc3\u5f97\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["github action","CICD"],"sidebar_position":2},"prevItem":{"title":"dockermultiplatform build - docker buildx\u6307\u4ee4","permalink":"/blog/2023/03/10/Docker/docker-muiltiplatform"},"nextItem":{"title":"linux command(sed grep awk)","permalink":"/blog/2023/03/08/linux-server/linux-command-repratice"}},"content":"## \u524d\u8a00\\n\\n\u4e00\u958b\u59cb\u662f\u8df3\u8457\u5b78\uff0c\u76f4\u63a5 google \u600e\u9ebc\u7528 github action \u505a\u5230 CI \u5efa\u7acb image \u4e26\u63a8\u5230 github container\uff0c\u4e0d\u904e\u9019\u95dc\u904e\u5b8c\u5f8c\uff0c\u5728 deploy \u5230 azure web container \u5c31\u5361\u95dc\u4e86\uff0c\u9019\u908a\u8cbc\u5361\u95dc\u7684[\u90e8\u5206](https://docs.github.com/en/actions/deployment/deploying-to-your-cloud-provider/deploying-to-azure/deploying-docker-to-azure-app-service)\\n\\n\x3c!--truncate--\x3e\\n\\n```\\n  deploy:\\n    runs-on: ubuntu-latest\\n\\n    needs: build\\n\\n    environment:\\n      name: \'production\'\\n      url: ${{ steps.deploy-to-webapp.outputs.webapp-url }}\\n\\n    steps:\\n      - name: Lowercase the repo name\\n        run: echo \\"REPO=${GITHUB_REPOSITORY,,}\\" >>${GITHUB_ENV}\\n\\n      - name: Deploy to Azure Web App\\n        id: deploy-to-webapp\\n        uses: azure/webapps-deploy@0b651ed7546ecfc75024011f76944cb9b381ef1e\\n        with:\\n          app-name: ${{ env.AZURE_WEBAPP_NAME }}\\n          publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}\\n          images: \'ghcr.io/${{ env.REPO }}:${{ github.sha }}\'\\n```\\n\\n\u5982\u679c\u6c92\u770b\u904e\u5b98\u7db2\u6559\u5b78\uff0c\u770b\u5230`${{ steps.deploy-to-webapp.outputs.webapp-url }}` `${{ env.AZURE_WEBAPP_NAME }}` `${{ github.sha }}` `${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}`\\n\u9019\u4e9b\u6771\u897f\u81ea\u7136\u6703\u50bb\u4f4f\uff0c\u7136\u5f8c\u56de\u53bb google\uff0c\u6703\u767c\u73fe\u5b98\u7db2\u7d66\u4e86\u4e00\u5927\u5806 context \u4ecb\u7d39\uff0c\u7c21\u8a00\u4e4b\uff0c\u9084\u662f\u8173\u8e0f\u5be6\u5730\u4f86\\n[Understanding GitHub Actions](https://docs.github.com/en/actions/learn-github-actions/understanding-github-actions)\u5427\uff01\\n\\n\u4e0b\u9762\u8cc7\u8a0a\u518d\u56de\u4f86\u770b\uff0c`${{ steps.deploy-to-webapp.outputs.webapp-url }}` \u9019\u6bb5\u610f\u601d\u6703 refer \u5230 id: deploy-to-webapp \u7684\u9019\u500b step\uff0c\u81f3\u65bc webapp-url \u662f\u5565\uff1f\u9019\u662f action \u7684 azure/webapps-deploy \u7684 output\u3002\\n\u81f3\u65bc output \u8ddf input \u662f\u5565\uff0c\u9019\u6703\u7559\u5230\u4e4b\u5f8c\u4e86\u89e3 actions \u6642\u5728\u4f86\u4e86\u89e3\uff5e\\n${GITHUB_REPOSITORY} \u662f\u5167\u5efa\u8b8a\u6578\uff0c${{ github.sha }}\u662f github \u4e0a\u4e0b\u6587\u7684\u5167\u5efa\u8b8a\u6578\uff0c${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}\u4f7f\u7528\u8a2d\u5b9a\u5728 configuration \u7684\u503c\uff0c\u4f7f\u7528\u7684\u662f sercrets \u4e0a\u4e0b\u6587\u3002\\n\\n<details>\\n  <summary> Create and publish a Docker image to github container registry and deploy to azure web container</summary>\\n  <a href=\\"https://docs.github.com/en/actions/deployment/deploying-to-your-cloud-provider/deploying-to-azure/deploying-docker-to-azure-app-service\\">github : Deploying Docker to Azure App Service\\n</a>\\n  <div>\\n    <br />\\n\\n```\\n\\nname: Create and publish a Docker image to github container registry and deploy to azure web container\\n\\nenv:\\n  AZURE_WEBAPP_NAME: ford-amd   # set this to your application\'s name\\non:\\n  push:\\n    branches: [\'main\']\\npermissions:\\n  contents: \'read\'\\n  packages: \'write\'\\n\\njobs:\\n  build:\\n    environment:\\n      name: prod\\n    runs-on: ubuntu-latest\\n    permissions:\\n      contents: read\\n      packages: write\\n    env:\\n      Greeting: Hello\\n\\n    steps:\\n\\n      - name: Checkout repository\\n        uses: actions/checkout@v3\\n      - name: \'Create env file\'\\n        run: |\\n          touch sql_app/.env\\n          echo \\"${{ secrets.ENV_FILE }}\\" > sql_app/.env\\n      - name: Set up QEMU\\n        uses: docker/setup-qemu-action@v2\\n      - name: Set up Docker Buildx\\n        uses: docker/setup-buildx-action@v2\\n\\n      - name: Log in to the Container registry\\n        uses: docker/login-action@f054a8b539a109f9f41c372932f1ae047eff08c9\\n        with:\\n          registry: ghcr.io\\n          username: ${{ github.actor }}\\n          password: ${{ secrets.GITHUB_TOKEN }}\\n      - name: Lowercase the repo name\\n        run: echo \\"REPO=${GITHUB_REPOSITORY,,}\\" >>${GITHUB_ENV}\\n      - name: Build and push container image to registry\\n        uses: docker/build-push-action@v4\\n        with:\\n          push: true\\n          context: .\\n          platforms: linux/amd64,linux/arm64\\n          tags: ghcr.io/${{ env.REPO }}:${{ github.sha }}\\n          file: ./Dockerfile\\n  deploy:\\n    runs-on: ubuntu-latest\\n\\n    needs: build\\n\\n    environment:\\n      name: prod\\n      url: ${{ steps.deploy-to-webapp.outputs.webapp-url }}\\n\\n    steps:\\n      - name: Lowercase the repo name\\n        run: echo \\"REPO=${GITHUB_REPOSITORY,,}\\" >>${GITHUB_ENV}\\n\\n      - name: Deploy to Azure Web App\\n        id: deploy-to-webapp\\n        uses: azure/webapps-deploy@0b651ed7546ecfc75024011f76944cb9b381ef1e\\n        with:\\n          app-name: ${{ env.AZURE_WEBAPP_NAME }}\\n          publish-profile: ${{ secrets.AZURE_WEBAPP_PUBLISH_PROFILE }}\\n          images: \'ghcr.io/${{ env.REPO }}:${{ github.sha }}\'\\n\\n\\n\\n\\n```\\n\\n  </div>\\n</details>\\n\\n## \u57fa\u672c\u529f\\n\\n\u56de\u9867\u4e00\u4e0b github action basic demo\uff0cgithub action \u662f\u7531 git \u6839\u76ee\u9304\u540c\u5c64\u7684\\n.github/workflows \u4e2d\u7684 xxxx.yml \u7d44\u6210\uff0cworkflow \u7684\u7d50\u69cb\u901a\u5e38\u662f\\n\\n```\\n\\nEvent \u89f8\u767c -> Job -> steps\\n\\n```\\n\\nEvent: \u63cf\u8ff0\u89f8\u767c\u8a72 pipline \u689d\u4ef6\\n\\nJob: \u5b9a\u7fa9 runner, \u74b0\u5883\u8b8a\u6578\u5f8c\uff0c\u5728\u9019\u500b\u689d\u4ef6\u4e0b\u57f7\u884c\u591a\u500b step \uff0c\u8209\u4f8b\uff1a \u7de8\u8b6f\u6a94\u6848 \u53ef\u4ee5\u7576\u4e00\u500b job\uff0c\u55ae\u5143\u6e2c\u8a66\u4e5f\u53ef\u4ee5\u7576\u4e00\u500b job\u3002 \u8981\u6ce8\u610f\u7684\u662f\uff0cjob \u9593\u662f\u5e73\u884c\u57f7\u884c\uff0c\u6240\u4ee5\u8981\u5728\u55ae\u5143\u6e2c\u8a66\u904e\u95dc\u5728\u57f7\u884c\u7de8\u8b6f\u7684\u8a71\uff0c\u8981\u984d\u5916\u5beb depends\u3002job \u9593\u53ef\u4ee5\u900f\u904e artifacts \u628a job \u7522\u51fa\u6a94\u6848\uff0c\u50b3\u7d66\u5225\u7684 job \u7528\u3002\\n\\nsteps: \u5b9a\u7fa9\u591a\u500b\u6307\u4ee4\uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u5225\u4eba\u63d0\u4f9b\u7684\u5957\u4ef6 actions\uff0c\u4e5f\u53ef\u4ee5\u662f\u67d0\u96bb shell script\\n\\n### Expressions\\n\\n\u5982\u679c\u4f60\u6709\u4e00\u500b job \u8981\u57f7\u884c\uff0c\u4f46\u60f3\u8a2d\u5b9a\u57f7\u884c\u524d\u63d0\u662f\u67d0\u500b\u74b0\u5883\u53c3\u6578 \u70ba true\uff0c\u8981\u600e\u9ebc\u57f7\u884c\uff1f\\n\u9019\u908a\u6709\u5e7e\u500b\u89c0\u5ff5\\n\\n1. \u74b0\u5883\u53c3\u6578:\\n\\n\u5728 github action \u6240\u6709\u7cfb\u7d71\u5167\u5efa\u8b8a\u6578\uff0c\u74b0\u5883\u8b8a\u6578\uff0c\u52a0\u5bc6\u7684\u8b8a\u6578\uff0c\u8a2d\u5b9a\u5728 configuration \u7684\u8b8a\u6578\u9019\u4e9b\u6771\u897f\u90fd\u88ab\u7576\u4f5c<highlight color=\\"blue\\">Contexts</highlight> \u7ba1\u7406\u3002\\n\\n2. \u8868\u9054\u5f0f\\n\\n\u7d50\u69cb\u90fd\u9577\u9019\u6a23`${{ <expression> }}`,\\n\\n\u652f\u63f4\u7684\u6578\u64da\u985e\u578b `boolen` `null` `number` `string`\uff0c\u5beb\u6cd5\u5982\u4e0b\\n\\n```\\n\\nenv:\\nmyNull: ${{ null }}\\nmyBoolean: ${{ false }}\\nmyIntegerNumber: ${{ 711 }}\\nmyFloatNumber: ${{ -9.2 }}\\nmyHexNumber: ${{ 0xff }}\\nmyExponentialNumber: ${{ -2.99e-2 }}\\nmyString: Mona the Octocat\\nmyStringInBraces: ${{ \'It\'\'s open source!\' }}\\n\\n```\\n\\n\u904b\u7b97\u5b50\u5982\u4e0b\\n\\n```\\n\\n( ) Logical grouping\\n[ ] Index\\n. Property de-reference\\n! Not\\n< Less than\\n<= Less than or equal\\n\\n>     Greater than\\n>\\n> = Greater than or equal\\n> == Equal\\n> != Not equal\\n> && And\\n> || Or\\n\\n```\\n\\nif \u5224\u65b7\u5beb\u6cd5\\n\\n```\\n\\nprod-check:\\nif: ${{ github.ref == \'refs/heads/main\' }}\\nruns-on: ubuntu-latest\\nsteps:\\n\\n```\\n\\n\u6b64\u5916 github action \u4e5f\u63d0\u4f9b\u5f88\u591a\u5167\u5efa function\uff0c\u4f8b\u5982\uff1a\\n\\n`contains( search, item )` \uff0c\u5982\u679c search \u542b\u6709 item\uff0c\u9019\u500b\u51fd\u6578\u5c07\u8fd4\u56de true\u3002\u5982\u679c search \u662f\u6578\u7d44\u4e2d\u3002\u5982\u679c item \u662f\u4e00\u500b search \u7684\u5143\u7d20\uff0c\u9019\u500b\u51fd\u6578\u5c07\u8fd4\u56de true\uff0c\u5982\u679c\u9805\u76ee\u662f\u641c\u7d22\u7684\u5b50\u5b57\u7b26\u4e32\u3002\u9019\u500b\u51fd\u6578\u4e0d\u5340\u5206\u5927\u5c0f\u5beb\u3002\u5b83\u5c07\u503c\u8f49\u63db\u70ba\u5b57\u7b26\u4e32\u9032\u884c\u6bd4\u8f03\u3002\\n\\ncontains(\'Hello world\', \'llo\') returns true.\\n\\ncontains(github.event.issue.labels.\\\\*.name, \'bug\') returns true if the issue related to the event has a label \\"bug\\".\\n\\n\u9084\u6709\u5f88\u591a\u5167\u5efa\u65b9\u6cd5\uff0c\u53ef\u4ee5[\u53c3\u8003\u5b98\u7db2](https://docs.github.com/en/actions/learn-github-actions/expressions)\\n\\n### Contexts\\n\\n\u4f60\u904b\u884c\u7684 workflow \u4e2d\u7684\u8cc7\u8a0a\uff0c\u53ef\u4ee5\u900f\u904e Contexts \u53d6\u7684\uff0c\u6bcf\u500b Context \u90fd\u662f\u4e00\u500b\u7269\u4ef6\uff0c\u5b83\u5e36\u6709\u7684\u5c6c\u6027\u53ef\u4ee5\u662f strings \u6216 \u7269\u4ef6\u3002\\n\\n\u8981\u4f7f\u7528 contexts \u9700\u8981\u6309\u7167\u9019\u500b\u683c\u5f0f`${{ <context> }}`\\n\\nContext \u7a2e\u985e\u8d85\u591a\uff0c\u9019\u908a\u6703\u5927\u81f4\u8b1b\u4ed6\u7684\u4f5c\u7528\\n\\n`github`- \u7576\u524d workflow \u7684 branch,\u89f8\u767c\u6a21\u5f0f\uff0crepo \u540d\u5b57\uff0cowner \u540d\u5b57\u7b49\u7b49\u3002\\n\\n`env` - \u5728 workflow or job or steps \u88e1\u9762\u8a2d\u5b9a\u5f97\u74b0\u5883\u8b8a\u6578\\n\\n`vars` - \u5728 repo \u6216 \u7d44\u7e54 \u6216 environment \u968e\u6bb5\uff0c\u8a2d\u5b9a\u5728 Variable \u7684 key value(\u5c31\u662f setting \u7684 variable \u76f8\u95dc\u6771\u897f)\\n\\n`job` - \u8ddf\u73fe\u5728\u6b63\u5728 run \u7684 job \u6709\u95dc\u4e8b\u9805\uff0c\u4f8b\u5982\u73fe\u5728\u8dd1\u7684 runner \u7684 id,\u8dd1\u6210\u529f\u6216\u5931\u6557\u3002\\n\\n`jobs` - \u50c5\u5728\u53ef\u91cd\u7528\u5de5\u4f5c\u6d41\u4e2d\u53ef\u7528\uff0c\u4e26\u4e14\u53ea\u80fd\u7528\u65bc\u8a2d\u7f6e\u53ef\u91cd\u7528\u5de5\u4f5c\u6d41\u7684\u8f38\u51fa\u3002\\n\\n`steps` - \u5b9a\u7fa9 steps \u968e\u6bb5\u8f38\u51fa\u7684\u6210\u54c1\uff0c\u4ee5\u53ca\u6b64 steps \u904b\u4f5c\u7d50\u679c\uff08\u6210\u529f \u5931\u6557 \u53d6\u6d88 \u8df3\u904e\uff09\\n\\n`runner` - Information about the runner that is running the current job\\n\\n`sercets` - \u5728 repo \u6216 \u7d44\u7e54 \u6216 environment \u968e\u6bb5\u8a2d\u5b9a\u5728 secrect \u7684 key value\\n\\n`strategy` - \u7b56\u7565\uff0c\u4e3b\u8981\u7528\u65bc\u5728 matrix \u77e9\u9663\u60c5\u6cc1\u74b0\u5883\u4e0b\u7684 job \u72c0\u614b\u63cf\u8ff0\\n\\n`matrix` - \u77e9\u9663\u8f38\u5165\uff0c\u5982\u679c\u4f60\u7684 job \u88e1\u9762\u7684\u6e2c\u8a66\u7cfb\u7d71\u8981\u6e2c\u8a66\u4f60\u7684 code \u5728 mac \u8ddf windows \u57f7\u884c\u90fd\u6c92\u554f\u984c\uff0c\u723e\u4e14\u4e5f\u8981\u78ba\u4fdd\u5728 node 14 \u8ddf node16 \u904b\u884c\u90fd\u6b63\u5e38\u3002\\n\\n```\\n\\nname: Test matrix\\non: push\\n\\njobs:\\n  build:\\n    runs-on: ${{ matrix.os }}\\n    strategy:\\n      matrix:\\n        os: [ubuntu-latest, windows-latest]\\n        node: [14, 16]\\n    steps:\\n      - uses: actions/checkout@v3\\n      - uses: actions/setup-node@v3\\n        with:\\n          node-version: ${{ matrix.node }}\\n      - name: Install dependencies\\n        run: npm ci\\n      - name: Run tests\\n        run: npm test\\n\\n```\\n\\n`needs`- \u7576\u524d\u4f5c\u696d\u7684\u4f9d\u8cf4\u9805\uff0c\u8981\u7528 id \u6307\u5b9a\\n\\n<details>\\n  <summary>needs demo</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n\\n```\\n\\nname: Build and deploy\\non: push\\n\\njobs:\\n  build:\\n    runs-on: ubuntu-latest\\n    outputs:\\n      build_id: ${{ steps.build_step.outputs.build_id }}\\n    steps:\\n      - uses: actions/checkout@v3\\n      - name: Build\\n        id: build_step\\n        run: |\\n          ./build\\n          echo \\"build_id=$BUILD_ID\\" >> $GITHUB_OUTPUT\\n  deploy:\\n    needs: build\\n    runs-on: ubuntu-latest\\n    steps:\\n      - uses: actions/checkout@v3\\n      - run: ./deploy --build ${{ needs.build.outputs.build_id }}\\n  debug:\\n    needs: [build, deploy]\\n    runs-on: ubuntu-latest\\n    if: ${{ failure() }}\\n    steps:\\n      - uses: actions/checkout@v3\\n      - run: ./debug\\n\\n```\\n\\n  </div>\\n</details>\\n\\n`inputs`- \u770b\u4e0d\u61c2\uff0c\u4e4b\u5f8c\u6709\u7528\u5230\u518d\u88dc\\n\\n### Variables\\n\\n\u57fa\u672c\u4e0a\u662f Contexts \u7684\u5ef6\u4f38\uff0c\u8b8a\u91cf\u4ee5\u662f\u5426\u8de8 workflow \u505a\u5340\u5206\u3002\\n\\n1. \u6c92\u6709\u8de8 workflow \u7684 Variable \u5b9a\u7fa9\u65b9\u6cd5\uff0c\u5728 workflow,job,step \u5b9a\u7fa9 key value\\n\\n<details>\\n  <summary>demo</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n\\n```\\nname: Greeting on variable day\\n\\non:\\n  workflow_dispatch\\n\\nenv:\\n  DAY_OF_WEEK: Monday\\n\\njobs:\\n  greeting_job:\\n    runs-on: ubuntu-latest\\n    env:\\n      Greeting: Hello\\n    steps:\\n      - name: \\"Say Hello Mona it\'s Monday\\"\\n        run: echo \\"$Greeting $First_Name. Today is $DAY_OF_WEEK!\\"\\n        env:\\n          First_Name: Mona\\n\\n```\\n\\n  </div>\\n</details>\\n\\nrun: env\uff1a\u60a8\u53ef\u4ee5\u901a\u904e\u5728\u6b65\u9a5f\u4e2d\u4f7f\u7528\u7136\u5f8c\u6aa2\u67e5\u6b65\u9a5f\u7684\u8f38\u51fa\u4f86\u5217\u51fa\u53ef\u7528\u65bc\u5de5\u4f5c\u6d41\u6b65\u9a5f\u7684\u6574\u7d44\u74b0\u5883\u8b8a\u91cf\u3002\\n\\n2. \u8de8 workflow \u7684 variable \u5b9a\u7fa9\u65b9\u6cd5\\n\\n\u5728\u4e0a\u4e0b\u6587\u4e2d\u81ea\u52d5\u53ef\u7528 vars\uff0c\u4f7f\u7528\u65b9\u5f0f${{ vars.\uff38\uff38\uff38\uff38 }}\uff0c\u6709\u591a\u7a2e\u5b9a\u7fa9\u65b9\u5f0f\\n\u5b58\u5132\u5eab\u3001\u74b0\u5883\u5275\u5efa\u914d\u7f6e\u8b8a\u91cf\u3001\u7d44\u7e54\u5275\u5efa\u914d\u7f6e\u8b8a\u91cf\\n\\n<details>\\n  <summary>demo</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n\\n```\\non:\\n  workflow_dispatch:\\nenv:\\n  # Setting an environment variable with the value of a configuration variable\\n  env_var: ${{ vars.ENV_CONTEXT_VAR }}\\n\\njobs:\\n  display-variables:\\n    name: ${{ vars.JOB_NAME }}\\n    # You can use configuration variables with the `vars` context for dynamic jobs\\n    if: ${{ vars.USE_VARIABLES == \'true\' }}\\n    runs-on: ${{ vars.RUNNER }}\\n    environment: ${{ vars.ENVIRONMENT_STAGE }}\\n    steps:\\n    - name: Use variables\\n      run: |\\n        echo \\"repository variable : ${{ vars.REPOSITORY_VAR }}\\"\\n        echo \\"organization variable : ${{ vars.ORGANIZATION_VAR }}\\"\\n        echo \\"overridden variable : ${{ vars.OVERRIDE_VAR }}\\"\\n        echo \\"variable from shell environment : $env_var\\"\\n\\n    - name: ${{ vars.HELLO_WORLD_STEP }}\\n      if: ${{ vars.HELLO_WORLD_ENABLED == \'true\' }}\\n      uses: actions/hello-world-javascript-action@main\\n      with:\\n        who-to-greet: ${{ vars.GREET_NAME }}\\n\\n\\n```\\n\\n  </div>\\n</details>\\n\\n:::tip\\n\u5728 github action \u4f7f\u7528\u8b8a\u91cf\u6642\uff0c\u8981\u8003\u616e\u9019\u500b\u8b8a\u91cf\u57f7\u884c\u6642\u662f\u5426\u5728 runner \u5167\u57f7\u884c\uff01\\n\\n\u5728 runner \u5167\u57f7\u884c\u9810\u8a2d\u662f\u53ef\u4ee5\u7528$Greeting(linux) or $env:NAME(windows)\u53bb\u53d6\u5f97\u8b8a\u91cf\uff0c\\n\\n\u5728 runner \u5916\u57f7\u884c\u7684\u4f8b\u5b50\uff0c\u8981\u4f7f\u7528`${{ env.DAY_OF_WEEK == \'Monday\' }}`\u9019\u6a23\u7684\u8868\u9054\u5f0f\uff0c\u4f7f\u7528\u60c5\u5883\u4f8b\u5982\u8981\u5148\u5224\u65b7 workflow \u74b0\u5883\u8b8a\u91cf\uff0c\u518d\u6c7a\u5b9a\u662f\u5426\u8dd1\u9019\u500b step \u7684\u904e\u7a0b\u3002\\n\u7bc4\u4f8b\uff1a\\n\\n<details>\\n  <summary>demo</summary>\\n  <div>\\n    <br />\\n\\n```\\nenv:\\n  DAY_OF_WEEK: Monday\\n\\njobs:\\n  greeting_job:\\n    runs-on: ubuntu-latest\\n    env:\\n      Greeting: Hello\\n    steps:\\n      - name: \\"Say Hello Mona it\'s Monday\\"\\n        if: ${{ env.DAY_OF_WEEK == \'Monday\' }}\\n        run: echo \\"$Greeting $First_Name. Today is $DAY_OF_WEEK!\\"\\n        env:\\n          First_Name: Mona\\n\\n```\\n\\n  </div>\\n</details>\\n:::\\n\\n### Default environment variables\\n\\nThe default environment variables that GitHub sets are available to every step in a workflow.\\n[\u5167\u5efa\u74b0\u5883\u8b8a\u91cf](https://docs.github.com/en/actions/learn-github-actions/variables#default-environment-variables)\\n\\n\u56e0\u70ba\u5f88\u591a\uff0c\u6240\u4ee5\u6311\u5e7e\u500b\u8a18\u9304\u4e00\u4e0b\\n\\n1. GITHUB_SHA - The commit SHA that triggered the workflow.\\n\\n2. RUNNER_ARCH - \u5e95\u5c64\u67b6\u69cb\uff0cThe architecture of the runner executing the job. Possible values are X86, X64, ARM, or ARM64.\\n\\n3. GITHUB_REPOSITORY_OWNER - The repository owner\'s name. For example, octocat.\\n\\n4. GITHUB_REF_TYPE- The type of ref that triggered the workflow run. Valid values are branch or tag.\\n\\n5. GITHUB_REF- The fully-formed ref of the branch or tag that triggered the workflow run.\\n\\n6. GITHUB_JOB - The job_id of the current job. For example, greeting_job.\\n   \u4ee5\u4e0b job_id \u5206\u5225\u70ba My first job \u3001My second job\\n\\n```\\n\\njobs:\\n  my_first_job:\\n    name: My first job\\n  my_second_job:\\n    name: My second job\\n\\n```\\n\\n7. GITHUB_EVENT_NAME- The name of the event that triggered the workflow. For example, workflow_dispatch.\\n\\n8. GITHUB_ACTOR - The name of the person or app that initiated the workflow. For example, octocat.\\n\\n9. GITHUB_ACTION_REPOSITORY - For a step executing an action, this is the owner and repository name of the action. For example, actions/checkout.\\n\\n10. GITHUB_ACTION - \u7576\u524d\u904b\u884c\u7684\u64cd\u4f5c\u7684\u540d\u7a31\uff0c\u6216 id \u6b65\u9a5f\u7684\u540d\u7a31,id \u662f A unique identifier for the step. You can use the id to reference the step in contexts.\\n\\n11. GITHUB_REPOSITORY - The owner and repository name. For example, octocat/Hello-World.\\n\\n:::info\\n[\u53c3\u8003\u7684\u7ba1\u7db2\u8cc7\u6599-contexts](https://docs.github.com/en/actions/learn-github-actions/contexts#matrix-context)\\n[\u53c3\u8003\u7684\u7ba1\u7db2\u8cc7\u6599-expression](https://docs.github.com/en/actions/learn-github-actions/expressions)\\n\\n[\u53c3\u8003\u7684\u7ba1\u7db2\u8cc7\u6599-variables](https://docs.github.com/en/actions/learn-github-actions/variables)\\n:::"},{"id":"/2023/03/08/linux-server/linux-command-repratice","metadata":{"permalink":"/blog/2023/03/08/linux-server/linux-command-repratice","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/linux-server/2023-03-08-linux-command-repratice.md","source":"@site/blog/linux-server/2023-03-08-linux-command-repratice.md","title":"linux command(sed grep awk)","description":"\u5f9e\u6709\u95dc\u9375\u5b57\u70ba QOO \u90a3\u4e00\u884c\u5230\u4ee5}\u70ba\u958b\u982d\u7684\u90a3\u4e00\u884c(^\u4ee3\u8868\u6b63\u5247\u958b\u982d\u5b57\u5143),sed -n \\"/QOO/,/^}/p\\" common.js.","date":"2023-03-08T00:00:00.000Z","formattedDate":"March 8, 2023","tags":[{"label":"linux","permalink":"/blog/tags/linux"},{"label":"sed","permalink":"/blog/tags/sed"}],"readingTime":1.815,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"linux command(sed grep awk)","description":"\u5f9e\u6709\u95dc\u9375\u5b57\u70ba QOO \u90a3\u4e00\u884c\u5230\u4ee5}\u70ba\u958b\u982d\u7684\u90a3\u4e00\u884c(^\u4ee3\u8868\u6b63\u5247\u958b\u982d\u5b57\u5143),sed -n \\"/QOO/,/^}/p\\" common.js.","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["linux","sed"]},"prevItem":{"title":"learn github action from github docs","permalink":"/blog/2023/03/10/github-action/githubaction-learing"},"nextItem":{"title":"DNS Poisoning vs Domain Hijacking,Brief summary","permalink":"/blog/2023/03/07/linux-server/dns-pollution-hijack"}},"content":"## sed\\n\\n\u4e00\u822c\u6253\u5370\\n\u5370 5~7 \u884c \u5176\u4ed6\u884c\u6578 silence\\n\\n```\\ncat -n xxxx.md | sed -n \'5,7p\'\\n\\n```\\n\\n\u628a whois \u6aa2\u67e5 domain \u4e2d\u7684 Registry Expiry Date \u7684\u524d\u9762\u7684\u7a7a\u683c\u53bb\u6389,\u4ee5\u4e0b\u610f\u601d\u662f\u628a 0 \u500b\u4ee5\u4e0a\u7684 space \u53bb\u6389\\n\\n```\\nsed \'s/\\\\s\\\\{0,\\\\}Registry Expiry Date: //\'\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n\u5370\u51fa\u6307\u5b9a\u5b57\u6a23\u7bc4\u570d\\n\u5f9e\u6709\u95dc\u9375\u5b57\u70ba QOO \u90a3\u4e00\u884c\u5230\u4ee5}\u70ba\u958b\u982d\u7684\u90a3\u4e00\u884c(^\u4ee3\u8868\u6b63\u5247\u958b\u982d\u5b57\u5143)\\n\\n```\\nsed -n \\"/QOO/,/^}/p\\" common.js\\n```\\n\\n## grep\\n\\nsort \u6392\u5217\\nuniq \u53bb\u6389\u91cd\u8907\uff0c\u8981\u8a08\u6578\u53ef\u4ee5\u7528 uniq -c\\n\\n```\\ngrep -r \\"bin\\" * | grep -Eo \\"code\\\\\\":[0-9]{0,}\\" |sort | uniq\\n```\\n\\n### grep -r vs grep -R\\n\\n\u5148\u8aaa\u7d50\u8ad6: \u5169\u8005\u5dee\u5225\u5728-R \u53ef\u4ee5\u6293\u5230\u8edf\u9023\u7d50\u8cc7\u6599\u9023\u7d50\u5230\u7684\u7269\u7406\u6a94\u6848\uff0c\u800c-r \u4e0d\u884c\uff0c\u6240\u4ee5-R \u529f\u80fd\u6bd4\u8f03\u5f37\u5927\u3002\\n\\n#### \u8edf\u9023\u7d50(soft link) vs \u786c\u9023\u7d50(hard link)\\n\\n\u786c\u9023\u7d50\u5efa\u7acb\u65b9\u5f0f`ln file.txt hardlink.txt` \u8edf\u9023\u7d50\u5efa\u7acb\u65b9\u5f0f`ln -s file.txt softlink.txt`,\u786c\u9023\u7d50\u7522\u751f\u7684 inode \u6578\u5b57\u6703\u8207 file.txt \u76f8\u540c\uff0c\u8edf\u9023\u7d50\u5247\u6703\u7522\u751f\u4e00\u500b\u65b0\u7684 inode.\u5728\u4f7f\u7528\u4e0a\u539f\u59cb\u6a94\u6848 file.txt \u88ab\u79fb\u9664\u6642,hardlink.txt \u4f9d\u820a\u53ef\u4ee5\u986f\u793a file.txt \u5167\u5bb9\uff0c\u800c softlink.txt \u6703\u5931\u6548\uff0c\u9664\u975e\u79fb\u9664\u6240\u6709 hardlink.txt \u624d\u6703\u79fb\u9664\u6389\u539f\u672c\u7684\u7269\u7406\u6a94\u6848.\\n\\n#### inode\\n\\ninode \u662f Unix \u98a8\u683c\u7684\u6a94\u6848\u7cfb\u7d71\u4e2d\u7684\u4e00\u7a2e\u8cc7\u6599\u7d50\u69cb,\u6703\u9023\u7d50\u5230\u6a94\u6848\u7cfb\u7d71\u7269\u4ef6,\u6bcf\u500b inode \u5132\u5b58\u4e86\u7269\u4ef6\u8cc7\u6599\u7684\u5c6c\u6027\u548c\u78c1\u789f\u5340\u584a\u4f4d\u7f6e,\u4f8b\u5982\u5143\u8cc7\u6599\u3001\u64c1\u6709\u8005\u3001\u6b0a\u9650\u3001\u5927\u5c0f\u7b49.inode \u865f\u78bc\u662f\u6a94\u6848\u7cfb\u7d71\u5167 inode \u7684\u552f\u4e00\u8b58\u5225\u78bc.\\n\\n## awk"},{"id":"/2023/03/07/linux-server/dns-pollution-hijack","metadata":{"permalink":"/blog/2023/03/07/linux-server/dns-pollution-hijack","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/linux-server/2023-03-07-dns-pollution-hijack.md","source":"@site/blog/linux-server/2023-03-07-dns-pollution-hijack.md","title":"DNS Poisoning vs Domain Hijacking,Brief summary","description":"record what is Domain Hijacking and DNS Poisoning, and the difference between them,\u5c0f\u7d50\uff1a\u52ab\u6301\u662f\u5b98\u65b9\u88ab\u99ed\u6216\u6545\u610f\u6539\u7684\uff08\u5927\u9678\u5e38\u767c\u751f\uff09\uff0c\u6c61\u67d3\u662f\u8def\u7531\u5230dns server\u904e\u7a0b\u67d0\u53f0\u8def\u7531\u5668\u88ab\u99ed\u3002","date":"2023-03-07T00:00:00.000Z","formattedDate":"March 7, 2023","tags":[{"label":"dns","permalink":"/blog/tags/dns"},{"label":"Domain Hijacking","permalink":"/blog/tags/domain-hijacking"},{"label":"DNS Poisoning","permalink":"/blog/tags/dns-poisoning"}],"readingTime":0.855,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"DNS Poisoning vs Domain Hijacking,Brief summary","description":"record what is Domain Hijacking and DNS Poisoning, and the difference between them,\u5c0f\u7d50\uff1a\u52ab\u6301\u662f\u5b98\u65b9\u88ab\u99ed\u6216\u6545\u610f\u6539\u7684\uff08\u5927\u9678\u5e38\u767c\u751f\uff09\uff0c\u6c61\u67d3\u662f\u8def\u7531\u5230dns server\u904e\u7a0b\u67d0\u53f0\u8def\u7531\u5668\u88ab\u99ed\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["dns","Domain Hijacking","DNS Poisoning"]},"prevItem":{"title":"linux command(sed grep awk)","permalink":"/blog/2023/03/08/linux-server/linux-command-repratice"},"nextItem":{"title":"Azure cloud container service Introduction and demo","permalink":"/blog/2023/03/06/Azure/azure-cloud-container"}},"content":"<>\\n\\n<ol>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex max-h-[24px]  w-full max-w-[24px]  items-center justify-center rounded-full text-base  text-white\\"\\n    >\\n      1\\n    </span>\\n    \u52ab\u6301\uff1adns server \u7ba1\u7406\u7aef\u6216\u8005\u4f60\u7684\u57df\u540d\u89e3\u6790\u5546\u628a\u4f60\u7684 url \u5c0d\u61c9 ip \u63db\u6210\u5176\u4ed6 ip \u6216 url\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      2\\n    </span>\\n    \u6c61\u67d3\uff1adns serer \u7684\u67d0\u500b\u7bc0\u9edecatch \u88ab\u99ed\u7136\u5f8c\u6539\u6389\uff0c\u628a\u9019\u500b url \u63db\u6210\u5176\u4ed6 ip \u6216 url\\n  </li>\\n\\n</ol>\\n\\n<p>\u5c0f\u7d50\uff1a\u52ab\u6301\u662f\u5b98\u65b9\u88ab\u99ed\u6216\u6545\u610f\u6539\u7684\uff08\u5927\u9678\u5e38\u767c\u751f\uff09\uff0c\u6c61\u67d3\u662f\u8def\u7531\u5230dns server\u904e\u7a0b\u67d0\u53f0\u8def\u7531\u5668\u88ab\u99ed\u3002\\n</p>\\n\\n</>\\n\\n\x3c!--truncate--\x3e\\n\\n:::info\\n\u53c3\u8003\u8cc7\u6599:\\n\\n1. [Domain Hijacking vs DNS Poisoning: Do You Know the Difference](https://heimdalsecurity.com/blog/domain-hijacking-vs-dns-poisoning-do-you-know-the-difference/#:~:text=1.,and%20changes%20its%20DNS%20settings.)\\n2. [DNS \u52ab\u6301\u548c DNS \u6c61\u67d3\u7684\u533a\u522b](https://www.williamlong.info/archives/3356.html)\\n\\n:::"},{"id":"/2023/03/06/Azure/azure-cloud-container","metadata":{"permalink":"/blog/2023/03/06/Azure/azure-cloud-container","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Azure/2023-03-06-azure-cloud-container.md","source":"@site/blog/Azure/2023-03-06-azure-cloud-container.md","title":"Azure cloud container service Introduction and demo","description":"\u4ecb\u7d39azure\u96f2\u7aefcontainer\u8cc7\u6e90\u6642\uff0c\u4e26\u5206\u6790\u5982\u4f55\u9078\u64c7\u670d\u52d9\uff0c\u6700\u5f8c\u63d0\u4f9b\u81ea\u5df1\u4f7f\u7528\u4e0a\u9047\u5230\u7684\u554f\u984c\u53ca\u89e3\u6cd5","date":"2023-03-06T00:00:00.000Z","formattedDate":"March 6, 2023","tags":[{"label":"cloud","permalink":"/blog/tags/cloud"},{"label":"Azure","permalink":"/blog/tags/azure"}],"readingTime":5.715,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"Azure cloud container service Introduction and demo","description":"\u4ecb\u7d39azure\u96f2\u7aefcontainer\u8cc7\u6e90\u6642\uff0c\u4e26\u5206\u6790\u5982\u4f55\u9078\u64c7\u670d\u52d9\uff0c\u6700\u5f8c\u63d0\u4f9b\u81ea\u5df1\u4f7f\u7528\u4e0a\u9047\u5230\u7684\u554f\u984c\u53ca\u89e3\u6cd5","authors":"suyuying","tags":["cloud","Azure"]},"prevItem":{"title":"DNS Poisoning vs Domain Hijacking,Brief summary","permalink":"/blog/2023/03/07/linux-server/dns-pollution-hijack"},"nextItem":{"title":"gitcus comment system add to docusaurus but meet giscus.app refused to connect.","permalink":"/blog/2023/03/03/Docusaurus/gitcus-comment-in-docusaurus"}},"content":":::tip\\n\u5982\u679c\u63d0\u4f9b\u7684\u8cc7\u8a0a\u6709\u932f\uff0c\u8acb\u7528 comment \u7cfb\u7d71\u544a\u77e5\uff5e\\n:::\\n\\n## Basic demand\\n\\n:::info\\n\u9700\u6c42\uff1a 1.\u514d\u8cbb\u7684 server \u8ddf db\uff0c\u55ae\u7d14\u639b\u6d41\u91cf\u5f88\u5c0f\uff0c\u6c92\u6709\u904b\u7b97\u5bc6\u96c6\u8ddf\u5403\u8a18\u61b6\u9ad4\u7684\u7a0b\u5f0f\u3002 2.\u4f7f\u7528 CICD \u914d\u5408 container \u90e8\u7f72 \u7c21\u5316\u5e03\u7248\u6d41\u7a0b\\n\\n:::\\n\\nserver \u90e8\u5206\u514d\u8cbb\u6eff\u591a\u7684\uff0c\u4f46\u90fd 12 \u500b\u6708\u8a66\u7528\u5c45\u591a\uff0c\u6700\u5f8c\u5c31\u5148\u6311\u4e86 azure\uff0c\u4e4b\u5f8c\u6703\u88dc\u4e0a gcp \u3001 AWS\u3002\\n\\nps: [render](https://render.com/) \u5f8c\u4f86\u540c\u4e8b\u63a8\u85a6\uff0c\u9019\u500b\u662f\u514d\u8cbb\u7684\uff0c\u4e4b\u5f8c\u88dc CICD \u90e8\u7f72\u5230\u9019\u88e1\u7684\u65b9\u6cd5\uff01\\n\\ndb \u57fa\u672c\u4e0a\u5c31\u6c92\u6709\u4e86\uff0c\u514d\u8cbb\u7684\u6709 heroku clear db \u4e0d\u904e\u4ed6\u53ea\u6709 5MB \u53ef\u4ee5\u7528...... \u6240\u4ee5\u76ee\u524d\u9084\u662f\u4e56\u4e56\u7528 squlite \u5427\\n\\n\x3c!--truncate--\x3e\\n\\n\u8cc7\u6599\u6536\u96c6:\\n\\n1.\u4e09\u5bb6\u77e5\u540d\u7684\u96f2\u670d\u52d9\u5ee0\u5546\u90fd\u6709\u63d0\u4f9b\u514d\u8cbb\u984d\u5ea6\uff0c\u9019\u908a\u63d0\u4f9b azure \u65b9\u9762\u8cc7\u8a0a\\nhttps://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree\\n\\n2.\u56e0\u70ba\u76ee\u7684\u53ea\u662f\u8981\u55ae\u7368\u8981\u505a api server\uff0c\u6240\u4ee5\u5728 web app, VM,container-based app \u4e4b\u9593\u505a\u9078\u64c7\u3002\\n\u56e0\u70ba\u7121\u5176\u4ed6\u7528\u9014\uff0c\u6240\u4ee5\u4e0d\u8003\u616e VM\uff0c\u800c\u53c8\u8981\u7528\u5230 container \u6240\u4ee5\u6700\u5f8c\u6311 Deploy and run a container-based app \u88e1\u9762\\n\u63d0\u4f9b\u7684\u4e09\u7a2e\u670d\u52d9 Azure Kubernetes Service(AKS)\u3001Azure Container Instances(ACI)\u3001Azure Container Apps\\n\u518d\u505a\u9078\u64c7\u3002\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./azure-quick-start.png\\").default}\\n      alt=\\"azure-quick-start.png\\"\\n    />\\n  </div>\\n</>\\n\\nAzure \u5b98\u7db2\u4e5f\u6709\u63d0\u4f9b\u4e00\u500b[\u5224\u65b7\u6a39](https://learn.microsoft.com/en-us/azure/architecture/guide/technology-choices/compute-decision-tree)\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./compute-choices.png\\").default}\\n      alt=\\"azure-quick-start.png\\"\\n    />\\n  </div>\\n</>\\n\\n## Azure container service\\n\\n\u57fa\u672c\u4e0a Azure \u96f2\u670d\u52d9\uff0c\u8ddf container \u6709\u95dc\u7684\u5c31\u662f Azure Container Instances,Azure Kubernetes Service,\\nAzure Container Apps\\n\\n### Azure Kubernetes Service(AKS)\\n\\nAKS \u57fa\u672c\u4e0a\u5c31\u662f\u8ddf azure \u79df\u591a\u53f0 VM(\u770b\u4f60\u7684 node \u6a39\uff09\uff0c\u7136\u5f8c\u4f7f\u7528 mastet node \u7ba1\u7406 node cluster\uff0c\u505a\u5230\u63d0\u9ad8 HA\uff0c\u4e5f\u9054\u5230\u63d0\u9ad8\u6a5f\u5668\u6548\u80fd\u4f7f\u7528\u7387\\n\\n:::info\\n\u4ee5\u5c0f\u578b\u7684\u5f8c\u7aef\u7a0b\u5f0f\u70ba\u4f8b\uff0c\u6574\u5957\u9700\u8981 mysql,redis,api \u670d\u52d9\uff0c\u5f8c\u53f0\u7d71\u8a08\u670d\u52d9 \u70ba\u80cc\u666f\\n:::\\n\\n#### K8s \u5143\u4ef6\u8aaa\u660e\\n\\nContainer\u3001Pod\u3001Node\u3002\\n\\nwhat is container?\\n\u901a\u5e38\u4e00\u500b\u529f\u80fd\u4e00\u500b container\uff08\u7576\u7136\u4f60\u8981\u5168\u786c\u585e\u540c\u500b\u4e5f\u53ef\u4ee5\uff0c\u4e0d\u904e\u4e0d\u5efa\u8b70\uff09\uff0c\u5982\u679c\u4f60\u4e0d\u7528 cloud db\uff0c\u90a3\u9ebc\u4ee5\u4e0a\u9762 info \u7684\u80cc\u666f\u60c5\u6cc1\uff0c\u6703\u6709 4 \u500b container\u3002\\n\\nWhat is pod in Kubernetes?\\n\u662f k8s \u6700\u5c0f\u57f7\u884c\u55ae\u4f4d\uff0c\u8209\u4f8b\u4f86\u8aaa\uff0c\u4f60\u7684\u6574\u5957\u670d\u52d9\u5171\u56db\u500b container \u4e0b\u4f86\u7b97\u662f\u4e00\u500b pod\u3002\\n\\nwhat is node in Kubernetes? \u4e00\u500b node \u4ee3\u8868\u4e00\u53f0 VM\\n\u7531 Worker Node \u8ddf Control Plane \u7d44\u6210\u3002\\nWorker Node(\u90e8\u7f72 pod \u7684 vm\uff0c\u5167\u90e8\u9084\u53ef\u7d30\u5206\u70ba kubelet\u3001kube-proxy \u53ca Container Runtime 3 \u500b\u5143\u4ef6\u3002)\\nControl Plane \u8ca0\u8cac\u5404\u500b Worker Node \u7684\u7ba1\u7406\\n\\nwhat is Kubernetes cluster?\\n\u56e0\u70ba\u9ad8\u53ef\u7528\u6027\u8ddf\u64f4\u5c55\u6703\u6709\u591a\u500b node\uff0c\u6240\u4ee5\u5c31\u6709\u4e86 cluster\u3002\\n\u7531 control panels \u8ddf nodes \u7d44\u6210\u3002\\n\\nAzure k8s?\\n\u76f4\u63a5\u5e6b\u4f60\u505a\u597d\u514d\u8cbb\u7684\u63a7\u5236\u5e73\u9762\u4e86\u3002\u4f46\u662f\u8981\u4ed8 VM \u7684\u9322\uff0c\u900f\u904e control plane \u7ba1\u7406 k8s cluster\u3002\\ncontrol plane \u4e0d\u7528\u4ed8\u9322\uff0c\u4f46\u6703\u5403 node \u7684\u8cc7\u6e90\u3002\\n\\n### Azure Container Instances(ACI)\\n\\nACI \u5c31\u662f\u500b\u96f2\u7aef container\uff0c\u62ff\u4f86\u57f7\u884c\u722c\u87f2\u4e4b\u985e\u7684\u7a0b\u5f0f\uff0c\u4ed6\u4e0d\u652f\u63f4\u64f4\u5c55\uff0c\u9644\u8f09\u5e73\u8861\u53ca\u6191\u8b49\u9a57\u8b49\u3002\\n\u57fa\u672c\u4e0a\u5275\u5b8c\uff0cAzure \u6703\u7d66\u4f60\u4e00\u7d44\u7684\u9023\u5165 ip\\n\\n### Azure Container Apps\\n\\n\u76f8\u8f03\u65bc ACI\uff0c\u63d0\u4f9b\u4e86 AutoScale,Https \u5165\u53e3\uff0c\u6191\u8b49\u4ee3\u7ba1\uff0c\u591a container \u5167\u90e8\u7db2\u8def\u6e9d\u901a\u7b49\uff0c\\n[\u8a73\u7d30\u529f\u7528\u9023\u7d50](https://learn.microsoft.com/en-us/azure/container-apps/overview)\\n\\n### MyChoice\\n\\n\u57fa\u672c\u4e0a\uff0c\u53ea\u6709\u4e00\u500b\u4e0d\u9700\u8981\u6548\u80fd\u7684\u670d\u52d9\uff0cAKS \u53ef\u4ee5\u76f4\u63a5\u780d\u6389\u3002\u56e0\u70ba\u662f api server\uff0c\u4e14\u50b3\u7684\u8cc7\u8a0a\u6709\u4e9b\u9700\u8981\u4fdd\u5bc6\u8cc7\u8a0a\uff0c\u6240\u4ee5\u9078\u7528\\nAzure Container Apps\u3002\\n\\n## Deployment\\n\\n### \u6559\u5b78\u7db2\u7ad9\\n\\n[\u5b98\u7db2\u6559\u5b78](https://learn.microsoft.com/en-us/azure/app-service/quickstart-custom-container?pivots=container-linux-vscode&WT.mc_id=UI-AQC&tabs=dotnet)\\n\\n\u57f7\u884c\u7684\u904e\u7a0b\u90fd\u662f\u4f9d\u64da\u6559\u5b78\uff0c\u4f46\u4e4b\u5f8c\u63db\u81ea\u5df1\u7684 Dockerfile \u6709\u9047\u5230\u72c0\u6cc1\uff0c\u6240\u4ee5\u8a18\u9304\u4e00\u4e0b\u9047\u5230\u7684\u554f\u984c\u3002\\n\\n### \u9047\u5230\u7684\u554f\u984c\\n\\n1. Container xxx didn\'t respond to HTTP pings on port: 8000, failing site start. See container logs for debugging.\\n\\n\u7db2\u4e0a\u67e5\u53ef\u80fd\u539f\u56e0\uff1a\\n\\n1. Use the EXPOSE instruction in your Dockerfile to expose port 3000.(not useful, azure will scan internally)\\n2. Use the WEBSITES_PORT app setting with a value of \\"3000\\" to expose that port.\\n\\n\u4ee5\u4e0a\u90fd\u4e0d\u884c\uff31\uff21\uff31\\n\\n\u6700\u5f8c\u767c\u73fe\u662f\u6a5f\u5668\u7684 CPU \u67b6\u69cb\u554f\u984c\uff0c\u56e0\u70ba\u662f m1 \u5e95\u4e0b\u5beb\u7684 code\uff0cdocker \u6703\u7528 arm build \u7248\uff0c\u4f46\u4e00 \ud83e\udd5a \u90e8\u7f72\u74b0\u5883\u662f azure \u7684 x86\uff0c\u5e95\u5c64\u4e0d\u540c\u670d\u52d9\u8d77\u4e0d\u4f86\\n\\n\u89e3\u6c7a\u65b9\u6cd5\uff1a\\n\u5c07\u539f\u672c Dockerfile\\n\\n```\\nFROM  python:3.11\\nWORKDIR /code\\nCOPY ./requirment.txt /code/requirements.txt\\nRUN pip install --no-cache-dir --upgrade -r /code/requirements.txt\\nRUN uname -a > /os.txt\\nCOPY ./sql_app /code/app\\nENV PORT 80\\nEXPOSE 80\\n\\n\\nENTRYPOINT [\\"uvicorn\\", \\"app.maingog:app\\", \\"--host\\", \\"0.0.0.0\\", \\"--port\\", \\"80\\"]\\n```\\n\\n\u4fee\u6539\u6210\\n\\n```\\nFROM --platform=$TARGETPLATFORM  python:3.11\\nWORKDIR /code\\nCOPY ./requirment.txt /code/requirements.txt\\nRUN pip install --no-cache-dir --upgrade -r /code/requirements.txt\\nRUN uname -a > /os.txt\\nCOPY ./sql_app /code/app\\nENV PORT 80\\nEXPOSE 80\\n\\n\\nENTRYPOINT [\\"uvicorn\\", \\"app.maingog:app\\", \\"--host\\", \\"0.0.0.0\\", \\"--port\\", \\"80\\"]\\n\\n```\\n\\n\u7136\u5f8c\u518d\u7528\u4ee5\u4e0b\u6307\u4ee4\u63a8\u5230 azure cotainer registry(\u8acb\u63db\u6210\u81ea\u5df1 acr \u7684\u6a23\u5b50)\\n\\n```\\ndocker buildx build . --platform linux/arm64,linux/amd64 -t fastapiserver.azurecr.io/fordserver/v1.9 --push\\n```\\n\\n\u4e4b\u5f8c\u4f7f\u7528\u9019\u500b image \u6642\uff0cdocker \u5167\u5efa\u5c31\u6703\u5e6b\u4f60\u5224\u65b7\u662f\u54ea\u500b\u7cfb\u7d71\uff0c\u4e26\u8d77\u670d\u52d9\uff01\\n\\n\u81f3\u65bc\uff0cbuildx \u8ddf--use \u8ddf context \u9019\u5e7e\u500b docker \u6307\u4ee4\u4e5f\u662f\u7b2c\u4e00\u6b21\u9047\u5230\uff0c\u5b8c\u5168\u4e0d\u719f\uff0c\u6240\u4ee5\u4e4b\u5f8c\u6703\u518d\u88dc\u4e0a\\n\\n### ACR \u63db git hub container\\n\\n\u56e0\u70ba\u7528 ACR \u8981\u9322\uff0c\u7136\u5f8c free plan \u4e5f\u4e0d\u7d66\u958b private registry\uff0c\u6240\u4ee5\u53ef\u4ee5\u7528 github or gitlab\uff0c\\n\u56e0\u70ba\u6c92\u7279\u5225\u60f3\u7528 private\uff0c\u6240\u4ee5\u5c31\u7528 git hub \u5427\u3002"},{"id":"/2023/03/03/Docusaurus/gitcus-comment-in-docusaurus","metadata":{"permalink":"/blog/2023/03/03/Docusaurus/gitcus-comment-in-docusaurus","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Docusaurus/2023-03-03-gitcus-comment-in-docusaurus.md","source":"@site/blog/Docusaurus/2023-03-03-gitcus-comment-in-docusaurus.md","title":"gitcus comment system add to docusaurus but meet giscus.app refused to connect.","description":"how to add comment system to docusaurus and problem giscus.app refused to connect.","date":"2023-03-03T00:00:00.000Z","formattedDate":"March 3, 2023","tags":[{"label":"docusaurus","permalink":"/blog/tags/docusaurus"},{"label":"comment system","permalink":"/blog/tags/comment-system"}],"readingTime":0.435,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"gitcus comment system add to docusaurus but meet giscus.app refused to connect.","description":"how to add comment system to docusaurus and problem giscus.app refused to connect.","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["docusaurus","comment system"]},"prevItem":{"title":"Azure cloud container service Introduction and demo","permalink":"/blog/2023/03/06/Azure/azure-cloud-container"},"nextItem":{"title":"Markdown syntax reference","permalink":"/blog/2023/03/03/Docusaurus/md-form"}},"content":"\u5efa\u7acb\u904e\u7a0b\uff0c\u4ee5\u4e0b\u53ea\u63d0\u4f9b\u7576\u521d\u6642\u4f5c\u53c3\u8003\u7684\u7db2\u5740\uff0c\u4e26\u7d00\u9304\u904e\u7a0b\u9047\u5230\u7684\u554f\u984c\u3002\\n\\n:::info\\n\\n1.  [docs \u52a0 github discussion by giscus](https://dev.to/m19v/how-to-add-giscus-comments-to-docusaurus-439h)\\n\\n:::\\n\\n\x3c!--truncate--\x3e\\n\\n:::info\\n\\n1.  [blog \u52a0 disqus system by disqus](https://madrus4u.com/blog/blog-comments)\\n\\n:::\\n\\n:::danger\\n\\n    When meet giscus.app refused to connect:\\n    this is caused of the reason that setting domain name wrong.\\n    For example:\\n        https://suyuying.github.io./\\n        you will see giscus.app refused to connect.\\n    But if you change url to, than it will fine.\\n        https://suyuying.github.io\\n\\n:::"},{"id":"/2023/03/03/Docusaurus/md-form","metadata":{"permalink":"/blog/2023/03/03/Docusaurus/md-form","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Docusaurus/2023-03-03-md-form.md","source":"@site/blog/Docusaurus/2023-03-03-md-form.md","title":"Markdown syntax reference","description":"demo\u5728Docusaurus\u5b98\u7db2\u770b\u5230\u7684md\u683c\u5f0f\u4f7f\u7528\u7bc4\u4f8b\uff0c\u7d66\u4e0d\u719f\u6089md\u8a9e\u6cd5\u7684\u4f7f\u7528\u8005\u67e5\u8a62\u683c\u5f0f\u7528","date":"2023-03-03T00:00:00.000Z","formattedDate":"March 3, 2023","tags":[{"label":"docusaurus","permalink":"/blog/tags/docusaurus"},{"label":"Markdown manual","permalink":"/blog/tags/markdown-manual"}],"readingTime":5.99,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"Markdown syntax reference","description":"demo\u5728Docusaurus\u5b98\u7db2\u770b\u5230\u7684md\u683c\u5f0f\u4f7f\u7528\u7bc4\u4f8b\uff0c\u7d66\u4e0d\u719f\u6089md\u8a9e\u6cd5\u7684\u4f7f\u7528\u8005\u67e5\u8a62\u683c\u5f0f\u7528","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["docusaurus","Markdown manual"],"comments":true},"prevItem":{"title":"gitcus comment system add to docusaurus but meet giscus.app refused to connect.","permalink":"/blog/2023/03/03/Docusaurus/gitcus-comment-in-docusaurus"},"nextItem":{"title":"Use Google Fonts in Docusaurus","permalink":"/blog/2023/03/03/Docusaurus/use-google-font"}},"content":"import Tabs from \\"@theme/Tabs\\";\\nimport TabItem from \\"@theme/TabItem\\";\\nimport Highlight from \\"@site/src/components/Highlight\\";\\n\\n```\\n// how to import\\nimport Tabs from \\"@theme/Tabs\\";\\nimport TabItem from \\"@theme/TabItem\\";\\nimport Highlight from \\"@site/src/components/Highlight\\";\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n<Highlight color=\\"#25c2a0\\">Docusaurus green</Highlight> and <Highlight color=\\"#1877F2\\">\\nFacebook blue\\n</Highlight> are my favorite colors.\\n\\nI can write **Markdown** alongside my _JSX_!\\n\\n> Easy to maintain open source documentation websites.\\n>\\n> \u2014 Docusaurus\\n\\n```\\n\u4ee5\u4e0b\u70ba\u4e0a\u8ff0\u7528\u6cd5\u7684\u7a0b\u5f0f\u78bc\u3002\\n<Highlight color=\\"#25c2a0\\">Docusaurus green</Highlight> and <Highlight color=\\"#1877F2\\">\\nFacebook blue\\n</Highlight> are my favorite colors.\\n\\nI can write **Markdown** alongside my _JSX_!\\n\\n> Easy to maintain open source documentation websites.\\n>\\n> \u2014 Docusaurus\\n```\\n\\n### Details element example\\n\\n<details>\\n  <summary>Toggle me!</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n    <details>\\n      <summary>Nested toggle! Some surprise inside...</summary>\\n      <div>\ud83d\ude32\ud83d\ude32\ud83d\ude32\ud83d\ude32\ud83d\ude32</div>\\n    </details>\\n  </div>\\n</details>\\n\\n```\\n<details>\\n  <summary>Toggle me!</summary>\\n  <div>\\n    <div>This is the detailed content</div>\\n    <br />\\n    <details>\\n      <summary>Nested toggle! Some surprise inside...</summary>\\n      <div>\ud83d\ude32\ud83d\ude32\ud83d\ude32\ud83d\ude32\ud83d\ude32</div>\\n    </details>\\n  </div>\\n</details>\\n```\\n\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./malta_street.jpeg\\").default}\\n      style={{ width: \\"50%\\" }}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n\\n```\\nhow to import img\\n<>\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./malta_street.jpeg\\").default}\\n      style={{ width: \\"50%\\" }}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n```\\n\\n### My Doc Section\\n\\nHello world message with some **bold** text, some _italic_ text, and a [link](https://www.yahoo.com)\\n\\n```\\n//demo bold text ,italic style and superlink\\nHello world message with some **bold** text, some _italic_ text, and a [link](https://www.yahoo.com)\\n```\\n\\n<Tabs>\\n  <TabItem value=\\"apple\\" label=\\"Apple\\" default>\\n    This is an apple \ud83c\udf4e\\n  </TabItem>\\n  <TabItem value=\\"orange\\" label=\\"Orange\\">\\n    This is an orange \ud83c\udf4a\\n  </TabItem>\\n  <TabItem value=\\"banana\\" label=\\"Banana\\">\\n    This is a banana \ud83c\udf4c\\n  </TabItem>\\n</Tabs>\\n\\n\x3c!-- \u4fdd\u5b58\u8cc7\u6599\u5230query string --\x3e\\n\\n<Tabs groupId=\\"current-os\\" queryString>\\n  <TabItem value=\\"android\\" label=\\"Android\\">\\n    Android\\n  </TabItem>\\n  <TabItem value=\\"ios\\" label=\\"iOS\\">\\n    iOS\\n  </TabItem>\\n</Tabs>\\n\\n```\\ndemo tabs and tabs bring query string\\n// here are just tabs\\n<Tabs>\\n  <TabItem value=\\"apple\\" label=\\"Apple\\" default>\\n    This is an apple \ud83c\udf4e\\n  </TabItem>\\n  <TabItem value=\\"orange\\" label=\\"Orange\\">\\n    This is an orange \ud83c\udf4a\\n  </TabItem>\\n  <TabItem value=\\"banana\\" label=\\"Banana\\">\\n    This is a banana \ud83c\udf4c\\n  </TabItem>\\n</Tabs>\\n\\n//here bring query string\\n<Tabs groupId=\\"current-os\\" queryString>\\n  <TabItem value=\\"android\\" label=\\"Android\\">\\n    Android\\n  </TabItem>\\n  <TabItem value=\\"ios\\" label=\\"iOS\\">\\n    iOS\\n  </TabItem>\\n</Tabs>\\n```\\n\\n```jsx title=\\"/src/components/HelloCodeTitle.js\\"\\nfunction HelloCodeTitle(props) {\\n  return <h1>Hello, {props.name}</h1>;\\n}\\n```\\n\\n````\\n```jsx title=\\"/src/components/HelloCodeTitle.js\\"\\nfunction HelloCodeTitle(props) {\\n  return <h1>Hello, {props.name}</h1>;\\n}\\n```\\n````\\n\\n```jsx {1,4-6,11}\\nimport React from \\"react\\";\\n\\nconst MyComponent = (props) => {\\n  if (props.isBar) {\\n    return <div>Bar</div>;\\n  }\\n\\n  return <div>Foo</div>;\\n};\\n\\nexport default MyComponent;\\n```\\n\\n````\\n```jsx {1,4-6,11}\\nimport React from \\"react\\";\\n\\nconst MyComponent = (props) => {\\n  if (props.isBar) {\\n    return <div>Bar</div>;\\n  }\\n\\n  return <div>Foo</div>;\\n};\\n\\nexport default MyComponent;\\n```\\n````\\n\\n```jsx live\\n// need install jsx live\\nfunction Clock(props) {\\n  const [date, setDate] = useState(new Date());\\n  useEffect(() => {\\n    const timerID = setInterval(() => tick(), 1000);\\n\\n    return function cleanup() {\\n      clearInterval(timerID);\\n    };\\n  });\\n\\n  function tick() {\\n    setDate(new Date());\\n  }\\n\\n  return (\\n    <div>\\n      <h2>It is {date.toLocaleTimeString()}.</h2>\\n    </div>\\n  );\\n}\\n```\\n\\n````\\n```jsx live\\n// need install jsx live\\nfunction Clock(props) {\\n  const [date, setDate] = useState(new Date());\\n  useEffect(() => {\\n    const timerID = setInterval(() => tick(), 1000);\\n\\n    return function cleanup() {\\n      clearInterval(timerID);\\n    };\\n  });\\n\\n  function tick() {\\n    setDate(new Date());\\n  }\\n\\n  return (\\n    <div>\\n      <h2>It is {date.toLocaleTimeString()}.</h2>\\n    </div>\\n  );\\n}\\n```\\n````\\n\\n\x3c!-- Prettier changes this --\x3e\\n\\n:::note\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::tip\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::info\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::caution\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::danger\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n```\\n\\n:::note\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::tip\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::info\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::caution\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n\\n:::danger\\n\\nSome **content** with _Markdown_ `syntax`. Check [this `api`](#).\\n\\n:::\\n```\\n\\n[Download this docx using Markdown](./DONe.json)\\n\\n```\\n[Download this docx using Markdown](./DONe.json)\\n```\\n\\n<ul>\\n  {Object.entries(frontMatter).map(([key, value]) => (\\n    <li key={key}>\\n      <b>{key}</b>: {value}\\n    </li>\\n  ))}\\n</ul>\\n\\n```\\n// how to get build in object attributes\\n<ul>\\n  {Object.entries(frontMatter).map(([key, value]) => (\\n    <li key={key}>\\n      <b>{key}</b>: {value}\\n    </li>\\n  ))}\\n</ul>\\n```\\n\\n<>\\n\\n<ol>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex max-h-[24px]  w-full max-w-[24px]  items-center justify-center rounded-full text-base  text-white\\"\\n    >\\n      1\\n    </span>\\n    Lorem ipsum dolor sit amet\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      2\\n    </span>\\n    It is a long established fact reader\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      3\\n    </span>\\n    The point of using Lorem Ipsum\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      4\\n    </span>\\n    There are many variations of passages\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      5\\n    </span>\\n    If you are going to use a of Lorem\\n  </li>\\n</ol>\\n</>\\n\\n```\\n<>\\n\\n<ol>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex max-h-[24px]  w-full max-w-[24px]  items-center justify-center rounded-full text-base  text-white\\"\\n    >\\n      1\\n    </span>\\n    Lorem ipsum dolor sit amet\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      2\\n    </span>\\n    It is a long established fact reader\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      3\\n    </span>\\n    The point of using Lorem Ipsum\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      4\\n    </span>\\n    There are many variations of passages\\n  </li>\\n  <li class=\\"text-body-color mb-4 flex text-base\\">\\n    <span\\n      class=\\"bg-primary mr-2 flex h-6 w-full max-w-[24px] items-center justify-center rounded-full text-base text-white\\"\\n    >\\n      5\\n    </span>\\n    If you are going to use a of Lorem\\n  </li>\\n</ol>\\n</>\\n```\\n\\nactions/checkout@v3 \u53c3\u6578\u7bc7\\n\\n- `ref`\uff1a\u8981\u6aa2\u51fa\u7684\u5206\u652f\u3001\u6a19\u7c64\u6216\u63d0\u4ea4 ID\u3002\\n- `repository`\uff1a\u8981\u6aa2\u51fa\u7684\u5132\u5b58\u5eab\u540d\u7a31\u3002\\n- `submodules`\uff1a\u662f\u5426\u6aa2\u51fa\u5b50\u6a21\u7d44\u3002\\n- `ssh-key`\uff1a\u7528\u65bc\u5f9e\u5132\u5b58\u5eab\u7372\u53d6\u7a0b\u5f0f\u78bc\u7684 SSH \u91d1\u9470\u3002\\n- `persist-credentials`\uff1a\u662f\u5426\u5728\u6301\u4e45\u5316\u5de5\u4f5c\u5340\u6642\u4fdd\u5b58 GITHUB_TOKEN \u548c SSH_AUTH_SOCK \u74b0\u5883\u8b8a\u6578\u3002\\n- `fetch-depth`\uff1a\u8981\u6aa2\u51fa\u7684\u63d0\u4ea4\u6578\u91cf\u3002\\n- `lfs`\uff1a\u662f\u5426\u4e0b\u8f09 Git LFS \u6587\u4ef6\u3002\\n- `clean`\uff1a\u662f\u5426\u5728\u6aa2\u51fa\u524d\u904b\u884c `git clean`\u3002\\n- `workspace`\uff1a\u6aa2\u51fa\u7684\u5132\u5b58\u5eab\u7684\u76ee\u9304\u3002\\n\\n<kbd>F1</kbd> <kbd>F2</kbd> <kbd>F3</kbd> <kbd>F4</kbd>\\n\\n<kbd>Ctrl</kbd> + <kbd>C</kbd>\\n\\n<kbd>\ud83e\udc44</kbd> <kbd>\ud83e\udc46</kbd> <kbd>\ud83e\udc45</kbd> <kbd>\ud83e\udc47</kbd>\\n\\n<kbd>PrtScn</kbd> <kbd>Tab \u21b9</kbd>\\n\\n<kbd>Enter</kbd>\\n\\n<kbd>\u229e Win</kbd>\\n\\n<kbd>\ud83d\ude06</kbd>\\n\\n```\\n<kbd>F1</kbd> <kbd>F2</kbd> <kbd>F3</kbd> <kbd>F4</kbd>\\n\\n<kbd>Ctrl</kbd> + <kbd>C</kbd>\\n\\n<kbd>\ud83e\udc44</kbd> <kbd>\ud83e\udc46</kbd> <kbd>\ud83e\udc45</kbd> <kbd>\ud83e\udc47</kbd>\\n\\n<kbd>PrtScn</kbd> <kbd>Tab \u21b9</kbd>\\n\\n<kbd>Enter</kbd>\\n\\n<kbd>\u229e Win</kbd>\\n\\n<kbd>\ud83d\ude06</kbd>\\n```\\n\\n\u4e26\u8a2d\u5b9a\\n\\n```jsx title=\\"src/css/custom.css\\"\\nkbd {\\n  margin: 0px 0.2em;\\n  padding: 0.1em 0.6em;\\n  border-radius: 3px;\\n  border: 1px solid #ccc;\\n  color: rgb(51, 51, 51);\\n  font-family: \\"Arial Black\\", Impact;\\n  display: inline-block;\\n  box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2), 0 0 0 2px #fff inset;\\n  background-color: rgb(247, 247, 247);\\n  -moz-box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2), 0 0 0 2px #fff inset;\\n  -webkit-box-shadow: 0 1px 0px rgba(0, 0, 0, 0.2), 0 0 0 2px #fff inset;\\n  -moz-border-radius: 3px;\\n  -webkit-border-radius: 3px;\\n}\\n```"},{"id":"/2023/03/03/Docusaurus/use-google-font","metadata":{"permalink":"/blog/2023/03/03/Docusaurus/use-google-font","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Docusaurus/2023-03-03-use-google-font.md","source":"@site/blog/Docusaurus/2023-03-03-use-google-font.md","title":"Use Google Fonts in Docusaurus","description":"\u6574\u7406\u7db2\u8def\u63d0\u4f9b\u7684\u4f7f\u7528google font\u65b9\u6cd5\uff0c\u6700\u5f8c\u662f\u63a1\u7528\u4e00\u822ccss import\u7684\u65b9\u6cd5,\u5beb\u6cd5\u4e0a\u4f86\u8aaa\uff0c\u76f4\u63a5\u5728 custom css import \u6bd4\u8f03\u65b9\u4fbf\u7684,\u50b3\u9001\u7684\u5927\u5c0f\u8ddf\u6642\u9593\u4e5f\u662f\u6c92\u5565\u5dee,\u6240\u4ee5\u76ee\u524d\u90fd\u7528 css import \u7684\u65b9\u6cd5,\u6709\u5beb\u932f\u9ebb\u7169\u6307\u6b63","date":"2023-03-03T00:00:00.000Z","formattedDate":"March 3, 2023","tags":[{"label":"docusaurus","permalink":"/blog/tags/docusaurus"},{"label":"css","permalink":"/blog/tags/css"},{"label":"google font","permalink":"/blog/tags/google-font"}],"readingTime":1.885,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"Use Google Fonts in Docusaurus","description":"\u6574\u7406\u7db2\u8def\u63d0\u4f9b\u7684\u4f7f\u7528google font\u65b9\u6cd5\uff0c\u6700\u5f8c\u662f\u63a1\u7528\u4e00\u822ccss import\u7684\u65b9\u6cd5,\u5beb\u6cd5\u4e0a\u4f86\u8aaa\uff0c\u76f4\u63a5\u5728 custom css import \u6bd4\u8f03\u65b9\u4fbf\u7684,\u50b3\u9001\u7684\u5927\u5c0f\u8ddf\u6642\u9593\u4e5f\u662f\u6c92\u5565\u5dee,\u6240\u4ee5\u76ee\u524d\u90fd\u7528 css import \u7684\u65b9\u6cd5,\u6709\u5beb\u932f\u9ebb\u7169\u6307\u6b63","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["docusaurus","css","google font"]},"prevItem":{"title":"Markdown syntax reference","permalink":"/blog/2023/03/03/Docusaurus/md-form"},"nextItem":{"title":"reset git remote origin branch","permalink":"/blog/2023/03/02/Git/reset-git-origin-branch"}},"content":"## \u4e00\u3001\u4e00\u822c css import\\n\\n### 1.\u5728 html head import\\n\\n```\\n\\n<head>\\n<link rel=\\"stylesheet\\" href=\\"https://fonts.googleapis.com/css?family=Sofia\\">\\n<style>\\nbody {\\n  font-family: \\"Sofia\\", sans-serif;\\n}\\n</style>\\n</head>\\n```\\n\\n\x3c!--truncate--\x3e\\n\\n### 2.\u5728 css import\\n\\n```jsx title=\\"scr/css/custom.css\\"\\n@import url(\\"https://fonts.googleapis.com/css2?family=Caveat:wght@500&display=swap\\");\\n// css\u9078\u64c7\u5668\u9078\u4f7f\u7528\u7bc4\u570d\\n  nav .navbar__items {\\n    font-size: 30px;\\n    font-family: Caveat;\\n  }\\n\\n//\u5982\u679c\u591a\u500bfont import\\n@import url(\\"https://fonts.googleapis.com/css2?family=Caveat:wght@500&display=swap\\");\\n@import url(\\"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap\\");\\n\\n// css \u9078\u64c7\u6a19\u793a\u7528\u9017\u865f\u5206\u9694\\nhtml {\\n  font-family: Noto Sans TC, sans-serif;\\n}\\n```\\n\\n## \u4e8c\u3001\u5728 docusaurus \u4f7f\u7528\\n\\n### 1.\u5728 html head import\\n\\n\u9019\u500b\u65b9\u6cd5\u76f8\u7576\u65bc\u4e00\u822c css \u4f7f\u7528\u5728 head \u6253 link\uff0c\u53ea\u662f\u5beb\u5728\u8a2d\u5b9a\u6a94\u5167\uff0c\u6703\u65bc<highlight color=\\"#1877F2\\">\u7de8\u8b6f\u5f8c</highlight>\u7522\u751f\u5728 index.html \u7684 head \u88e1\u9762\\n\\n```\\n<link rel=\\"stylesheet\\" href=\\"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&amp;display=swap\\">\\n```\\n\\n```jsx title=\\"docusaurus.config.js\\"\\n        theme: {\\n          customCss: require.resolve(\\"./src/css/custom.css\\"),\\n        },\\n      },\\n    ],\\n  ],\\n  stylesheets: [\\n    {\\n      rel: \\"preconnect\\",\\n      href: \\"https://fonts.googleapis.com\\",\\n    },\\n    {\\n      rel: \\"preconnect\\",\\n      href: \\"https://fonts.gstatic.com\\",\\n      crossorigin: \\"anonymous\\",\\n    },\\n    {\\n      rel: \\"stylesheet\\",\\n      href: \\"https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;700;900&display=swap\\",\\n    },\\n  ],\\n```\\n\\n### 2.\u5728 css import\\n\\n\u505a\u6cd5\u540c\u4e00\u822c css import\\n\\n```jsx title=\\"scr/css/custom.css\\"\\n@import url(\\"https://fonts.googleapis.com/css2?family=Caveat:wght@500&display=swap\\");\\n// css\u9078\u64c7\u5668\u9078\u4f7f\u7528\u7bc4\u570d\\n  nav .navbar__items {\\n    font-size: 30px;\\n    font-family: Caveat;\\n  }\\n\\n//\u5982\u679c\u591a\u500bfont import\\n@import url(\\"https://fonts.googleapis.com/css2?family=Caveat:wght@500&display=swap\\");\\n@import url(\\"https://fonts.googleapis.com/css2?family=Noto+Sans+TC&display=swap\\");\\n\\n// css \u9078\u64c7\u6a19\u793a\u7528\u9017\u865f\u5206\u9694\\nhtml {\\n  font-family: Noto Sans TC, sans-serif;\\n}\\n```\\n\\n## \u4e09\u3001\u6bd4\u8f03\u5169\u7a2e\u65b9\u6cd5\u5dee\u7570\\n\\n<>\\n\\n<p>\u4e00\u822ccss import</p>\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./incss.png\\").default}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n<>\\n\\n<p>link import</p>\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./inlink1.png\\").default}\\n      alt=\\"malta_street png\\"\\n    />\\n  </div>\\n</>\\n\\n:::tip\\n\\n\u5beb\u6cd5\u4e0a\u4f86\u8aaa\uff0c\u76f4\u63a5\u5728 custom css import \u6bd4\u8f03\u65b9\u4fbf\u7684\uff0c\u50b3\u9001\u7684\u5927\u5c0f\u8ddf\u6642\u9593\u4e5f\u662f\u6c92\u5565\u5dee\uff0c\\n\u6240\u4ee5\u76ee\u524d\u90fd\u7528 css import \u7684\u65b9\u6cd5\u3002\u6709\u5beb\u932f\u9ebb\u7169\u6307\u6b63\uff5e\\n\\n:::\\n\\n## \u56db\u3001 \u53c3\u8003\u8cc7\u6599\\n\\n:::info\\n\\n\u53c3\u8003\u8cc7\u6599\uff1a\\n\\n1.[\u4ee5\u6b63\u78ba\u7684\u59ff\u52e2\u4f7f\u7528 Google Fonts](https://ouch1978.github.io/docs/docusaurus/customization/use-google-fonts-with-correct-way)\\n\\n2.[\u80cc\u666f\u5716\u6848\u53ca\u5b57\u9ad4\u8a2d\u5b9a](https://from8to8.com/diary/lastestposts-font/)\\n\\n3.[How to customize the styling of the Docusaurus Classic Theme](https://theochu.com/docusaurus/styling/#custom-fonts)\\n:::"},{"id":"/2023/03/02/Git/reset-git-origin-branch","metadata":{"permalink":"/blog/2023/03/02/Git/reset-git-origin-branch","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/Git/2023-03-02-reset-git-origin-branch.md","source":"@site/blog/Git/2023-03-02-reset-git-origin-branch.md","title":"reset git remote origin branch","description":"\u5728local\u7aef\u767c\u73febuild\u5b8c\u6771\u897ffail\uff0c\u4f46\u662f\u5df2\u7d93\u63a8\u5230main branch\u4e86\uff0c\u6240\u4ee5\u57f7\u884c\u9060\u7aefregistry\u9000\u7248\uff0c\u9700\u8981\u4f7f\u7528 git push --force,\u57fa\u672c\u4e0a main branch \u90fd\u6703\u662f\u4fdd\u8b77\u7684\uff0c\u4e5f\u53ef\u4ee5\u8003\u616e\u7528 pull request \u5148\u9032\u884c\u6e2c\u8a66(\u4e0d\u80fd\u81ea\u5df1\u767c pull request \u81ea\u5df1\u5be9)\uff0c\u904e\u4e86\u518d merge\u3002","date":"2023-03-02T00:00:00.000Z","formattedDate":"March 2, 2023","tags":[{"label":"git","permalink":"/blog/tags/git"}],"readingTime":0.64,"hasTruncateMarker":true,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"reset git remote origin branch","description":"\u5728local\u7aef\u767c\u73febuild\u5b8c\u6771\u897ffail\uff0c\u4f46\u662f\u5df2\u7d93\u63a8\u5230main branch\u4e86\uff0c\u6240\u4ee5\u57f7\u884c\u9060\u7aefregistry\u9000\u7248\uff0c\u9700\u8981\u4f7f\u7528 git push --force,\u57fa\u672c\u4e0a main branch \u90fd\u6703\u662f\u4fdd\u8b77\u7684\uff0c\u4e5f\u53ef\u4ee5\u8003\u616e\u7528 pull request \u5148\u9032\u884c\u6e2c\u8a66(\u4e0d\u80fd\u81ea\u5df1\u767c pull request \u81ea\u5df1\u5be9)\uff0c\u904e\u4e86\u518d merge\u3002","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["git"]},"prevItem":{"title":"Use Google Fonts in Docusaurus","permalink":"/blog/2023/03/03/Docusaurus/use-google-font"},"nextItem":{"title":"use react to build your own static website by github page","permalink":"/blog/2023/03/02/github-action/git-hub-page-deploy-from-vite"}},"content":"\u9700\u8981\u4f7f\u7528 git push --force,\u57fa\u672c\u4e0a main branch \u90fd\u6703\u662f\u4fdd\u8b77\u7684\uff0c\\n\u4e5f\u53ef\u4ee5\u8003\u616e\u7528 pull request \u5148\u9032\u884c\u6e2c\u8a66(\u4e0d\u80fd\u81ea\u5df1\u767c pull request \u81ea\u5df1\u5be9)\uff0c\u904e\u4e86\u518d merge\u3002\\n\\n\x3c!--truncate--\x3e\\n\\n```\\ngit checkout master\\ngit reset --hard e3f1e37\\ngit push --force origin master\\n# Then to prove it (it won\'t print any diff)\\ngit diff master..origin/master\\n```\\n\\n```\\npull request\\nsettings -> branches->Branch protection rules\\n// if you just want to try merger just choose\\nRequire status checks to pass before merging\\n// if you choose Require a pull request before merging\\n// will get error Pull request authors cannot approve their own pull requests!\\n\\n```\\n\\n[\u53c3\u8003\u7db2\u5740](https://stackoverflow.com/questions/17667023/git-how-to-reset-origin-master-to-a-commit)"},{"id":"/2023/03/02/github-action/git-hub-page-deploy-from-vite","metadata":{"permalink":"/blog/2023/03/02/github-action/git-hub-page-deploy-from-vite","editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/blog/github-action/2023-03-02-git-hub-page-deploy-from-vite.md","source":"@site/blog/github-action/2023-03-02-git-hub-page-deploy-from-vite.md","title":"use react to build your own static website by github page","description":"\u8a18\u9304\u4e00\u4e0bgithub page\u914d\u5408git hub action\u7684\u90e8\u7f72react vite\u904e\u7a0b\uff0c\u4e26\u63d0\u4f9bgithub multiple repo\u7ba1\u7406\u8fa6\u6cd5\uff0c\u4e3b\u8981\u6b65\u9a5f1.\u5efa\u7acb\u4e00\u500brepo\u540d\u70bayour_github_username.github.io 2.\u5efa\u7acbgh-pages\u5206\u679d3.\u5730\u7aef\u5efa\u7acbCI yml\u6a94 4.\u8a2d\u5b9agithub page\u4f7f\u7528branch gh-pages 5.\u63a8\u5730\u7aef\u8cc7\u6599\u5230main branch 6.CI\u6703\u5e6b\u4f60\u57f7\u884cbuild\u4e26\u628a\u8cc7\u6e90\u653e\u5230gh-pages branch ,Done","date":"2023-03-02T00:00:00.000Z","formattedDate":"March 2, 2023","tags":[{"label":"git","permalink":"/blog/tags/git"}],"readingTime":3.9,"hasTruncateMarker":false,"authors":[{"name":"zaxro","title":"Life is too short to live someone else\'s dream","url":"https://github.com/suyuying","imageURL":"https://github.com/suyuying.png","key":"suyuying"}],"frontMatter":{"title":"use react to build your own static website by github page","description":"\u8a18\u9304\u4e00\u4e0bgithub page\u914d\u5408git hub action\u7684\u90e8\u7f72react vite\u904e\u7a0b\uff0c\u4e26\u63d0\u4f9bgithub multiple repo\u7ba1\u7406\u8fa6\u6cd5\uff0c\u4e3b\u8981\u6b65\u9a5f1.\u5efa\u7acb\u4e00\u500brepo\u540d\u70bayour_github_username.github.io 2.\u5efa\u7acbgh-pages\u5206\u679d3.\u5730\u7aef\u5efa\u7acbCI yml\u6a94 4.\u8a2d\u5b9agithub page\u4f7f\u7528branch gh-pages 5.\u63a8\u5730\u7aef\u8cc7\u6599\u5230main branch 6.CI\u6703\u5e6b\u4f60\u57f7\u884cbuild\u4e26\u628a\u8cc7\u6e90\u653e\u5230gh-pages branch ,Done","authors":"suyuying","image":"https://github.com/suyuying.png","tags":["git"]},"prevItem":{"title":"reset git remote origin branch","permalink":"/blog/2023/03/02/Git/reset-git-origin-branch"}},"content":"## step1. \u5efa\u7acb repo\\n\\n\u5275\u5efa repo \u8cc7\u6599\uff0c\u7db2\u8def\u4e0a\u5f88\u591a\uff0c\u53ef\u4ee5 google \u4e00\u4e0b\uff0c\u8aaa\u4e00\u4e0b\u6211\u9047\u5230\u7684\u554f\u984c\u662f\u6211\u6709\u5169\u500b github repo\uff0c\u5728 mac m1 \u96fb\u8166\u4e0a\u63a8\u7b2c\u4e8c\u500b repo \u6703\u4e00\u76f4\u5831 403 \u932f\u8aa4\uff0c\u89e3\u6cd5\\n\u53c3\u8003 [\u5b98\u7db2\uff1a\u7ba1\u7406\u591a\u500b\u5e33\u6236](https://docs.github.com/en/account-and-profile/setting-up-and-managing-your-personal-account-on-github/managing-your-personal-account/managing-multiple-accounts)\\n\\n::: tip\\n\u4f46\u662f\uff01\u6211\u5f8c\u4f86\u5207\u56de\u539f\u672c\u90a3\u500b repo \u4ed6\u53c8\u958b\u59cb 403 \u5831\u932f\u4e86\uff0c\u800c\u4e14\u540c\u6a23\u65b9\u5f0f\u518d\u64cd\u4f5c\u4e5f\u5931\u6557\uff0c\u4e4b\u5f8c\u5617\u8a66\u7528 ssh \u65b9\u5f0f\uff0c\u5c31\u6c92\u9047\u5230\u4e0a\u8ff0\u554f\u984c\uff0c\u6240\u4ee5\u5efa\u8b70\u7528 ssh \u4f86\u63a8 code \u5427\uff01\\n:::\\n\\n```\\ngit config --get credential.helper\\n# \u5982\u679c\u8f38\u51fa\u70baosxkeychain\uff0c\u5247\u60a8\u4f7f\u7528\u7684\u662f macOS \u9470\u5319\u4e32\u3002\u8981\u6e05\u9664\u6191\u64da\uff0c\u8acb\u8f38\u5165\u4ee5\u4e0b\u547d\u4ee4\\n#\u6e05\u9664\u6191\u64da\\ngit credential-osxkeychain erase https://github.com\\n# \u5c07 Git \u914d\u7f6e\u70ba\u7de9\u5b58\u60a8\u514b\u9686\u5b58\u5132\u5eab\u7684\u6bcf\u500b\u672c\u5730\u76ee\u9304\u7684\u6191\u64da\\ngit config --global credential.useHttpPath true\\n```\\n\\n\u5275\u7acb repo \u540d\u7a31\u9019\u908a\u5c31\u8b1b\u6bd4\u8f03\u7c21\u55ae\u505a\u6cd5\uff0c\u4e0d\u52a0\u8def\u7531\u7684\u7248\u672c\uff0crepo \u540d\u7a31\u662f\\nusername.github.io (\u628a username \u63db\u6210\u4f60\u7684 git \u8a3b\u518a\u540d\u5b57)\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./git-repo-git-page.png\\").default}\\n      alt=\\"git-repo name set yourusername.github.io\\"\\n    />\\n  </div>\\n</>\\n\\n## step2.\u5728\u4f60\u7684 github repo \u5efa\u7acb gh-pages \u5206\u679d\\n\\n\u9019\u500b\u5c31\u5728 github \u4e0a\u5efa\u7acb\u8a72\u5206\u679d\u5c31\u597d\uff0c\u88e1\u9762\u6a94\u6848\u9810\u8a2d\u6703 copy main \u5206\u679d\uff0c\u9019\u6c92\u95dc\u4fc2\u3002\\n\\n## step3.\u5730\u7aef yml \u6a94\\n\\n```\\n# \u5728git \u6839\u76ee\u9304\\nmkdir -p ./github/workflows\\n```\\n\\n\u8907\u88fd\u4ee5\u4e0b\u9019\u6bb5\u5230\u540d\u70ba deploy.yml \u7684\u6a94\u6848\uff0c\u6ce8\u610f\u7684\u662f\u56e0\u70ba\u6211\u662f\u7528 vite\uff0c\u7136\u5f8c\u7ba1\u7406\u5305\u7528 yarn\uff0cvite build \u7684\u8cc7\u6599\u593e\u653e\u5728 dist \u5e95\u4e0b\uff0c\u5982\u679c\u4f60\u662f\u7528\u4e00\u822c\u5efa\u7acb react \u5305\u7684\u65b9\u6cd5\uff0c\u6703\u5728 build\u3002\\n\\n```jsx {35-36} title=\\"./github/workflows/deploy.yml\\"\\nname: Deploy to GitHub Pages\\n\\non:\\n  push:\\n    branches:\\n      - main\\n    # Review gh actions docs if you want to further define triggers, paths, etc\\n    # https://docs.github.com/en/actions/using-workflows/workflow-syntax-for-github-actions#on\\npermissions:\\n  contents: write\\n  pull-requests: write\\njobs:\\n  deploy:\\n    name: Deploy to GitHub Pages\\n    runs-on: ubuntu-latest\\n    steps:\\n      - uses: actions/checkout@v3\\n      - uses: actions/setup-node@v3\\n        with:\\n          node-version: 18\\n          cache: yarn\\n\\n      - name: Install dependencies\\n        run: yarn install --frozen-lockfile\\n      - name: Build website\\n        run: yarn build\\n\\n      # Popular action to deploy to GitHub Pages:\\n      # Docs: https://github.com/peaceiris/actions-gh-pages#%EF%B8%8F-docusaurus\\n      - name: Deploy to GitHub Pages\\n        uses: peaceiris/actions-gh-pages@v3\\n        with:\\n          github_token: ${{ secrets.GITHUB_TOKEN }}\\n          # Build output to publish to the `gh-pages` branch:\\n          # \u9019\u88e1\u8981\u6539\u6210\u4f60\u7684build\u51fa\u4f86\u7684\u8cc7\u6599\u593e\uff01\uff01\\n          publish_dir: ./dist\\n          # The following lines assign commit authorship to the official\\n          # GH-Actions bot for deploys to `gh-pages` branch:\\n          # https://github.com/actions/checkout/issues/13#issuecomment-724415212\\n          # The GH actions bot is used by default if you didn\'t specify the two fields.\\n          # You can swap them out with your own user credentials.\\n          user_name: github-actions[bot]\\n          user_email: 41898282+github-actions[bot]@users.noreply.github.com\\n```\\n\\n## step4.\u8a2d\u5b9a\u9810\u8a2d\u5206\u679d\u70ba gh-pages\\n\\n\u9019\u5e03\u5f88\u91cd\u8981\uff0c\u56e0\u70ba\u6211\u6bcf\u6b21\u8a2d\u5b9a\u90fd\u5fd8\u8a18\u8981\u8a2d\u5b9a\u9019\u500b\uff01 \u5fd8\u8a18\u7684\u8a71\uff0c\u6700\u5f8c\u9023\u7dda\u5230\u7db2\u7ad9\u90fd\u6703 F12 \u5831\u932f\\nFailed to load module script: Expected a JavaScript module script but the server responded with a MIME type of \\"text/jsx\\". Strict MIME type checking is enforced for module scripts per HTML spec.\\n\\n!!!\u5f88\u91cd\u8981!!! \u4e0d\u7136\u7db2\u7ad9\u6703\u662f\u767d\u7684\uff31\uff21\uff31\\n\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./gh-pages.png\\").default}\\n      alt=\\"how to set default branck of gh-pages\\"\\n    />\\n  </div>\\n</>\\n\\n## step5. \u63a8\u6a94\u6848\u5230 github main branch\\n\\n\u5c31 `git push` \uff0c\u7136\u5f8c\u4f60\u53ef\u4ee5\u5230 action \u90a3\u908a\u78ba\u8a8d\u662f\u5426 CI \u6210\u529f\uff0c\u6210\u529f\u7684\u8a71\u8acb\u5230 gh-pages \u78ba\u8a8d\u8cc7\u6599\u593e\u7d50\u69cb\u662f\u4f60 build \u5b8c\u8cc7\u6599\u593e\u7684\u9577\u76f8\uff0c\u7576\u7136\uff0c\u5730\u7aef\u8acb\u78ba\u8a8d build \u5b8c\u8cc7\u6599\uff0c\u662f\u53ef\u4ee5\u6210\u529f\u63d0\u4f9b\u670d\u52d9\u7684\uff01\\n\\n\u6210\u529f\u756b\u9762\u8981\u9577\u9019\u6a23\\n\\n<>\\n\\n  <div style={{ display: \\"flex\\", justifyContent: \\"center\\" }}>\\n    <img\\n      src={require(\\"./github-ci-success.png\\").default}\\n      alt=\\"picture of the success result of ci\\"\\n    />\\n  </div>\\n</>\\n\\n## DONE\\n\\n\u8acb\u9023\u7dda https://yourusername.github.io/ \u505a\u78ba\u8a8d\\n\\n:::info\\n\u53c3\u8003\u8cc7\u6599\\n\\n1. [Vite Official Documentation](https://vitejs.dev/guide/static-deploy.html#github-pages)\\n\\n2. [Youtube Video - How to deploy Vite App on GitHub Pages](https://www.youtube.com/watch?v=yo2bMGnIKE8)\\n\\n3. [Deployment Docusaurus](https://docusaurus.io/docs/deployment#deploying-to-github-pages)\\n\\n:::"}]}')}}]);